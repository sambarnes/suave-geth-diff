<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.2/font/bootstrap-icons.css">

    <title>suave-geth</title>

    <link rel="icon" type="image/x-icon" href="https://collective.flashbots.net/uploads/default/original/1X/7a99a7f355a2ab01e7eec8bb90f6cc59be63573a.png">

    <style>
        .line-stat {
            width: 14rem;
            float: right;
        }
        .line-stat div {
            width: 50%;
        }
    </style>

    
<style>
    .term-container {
        background: #171717;
        border-radius: 5px;
        color: white;
        word-break: break-word;
        overflow-wrap: break-word;
        font-family: "SFMono-Regular", Monaco, Menlo, Consolas, "Liberation Mono", Courier, monospace;
        font-size: 12px;
        line-height: 20px;
        padding: 14px 18px;
        white-space: pre-wrap;
    }

    .term-container img { max-width: 100%; }

    .term a { color: inherit; text-decoration: underline; text-decoration-style: dashed; }
    .term a:hover { color: #2882F9 }

    @keyframes blink-animation {
        to {
            visibility: hidden;
        }
    }

    .term-fg1 { } /* don't bold beccause it looks weird */
    .term-fg2 { color: #838887; } /* faint (decreased intensity) - same as gray really */
    .term-fg3 { font-style: italic; } /* italic */
    .term-fg4 { text-decoration: underline; } /* underline */
    .term-fg5 { animation: blink-animation 1s steps(3, start) infinite; } /* blink */
    .term-fg9 { text-decoration: line-through; } /* crossed-out */

    .term-fg30 { color: #666666; } /* black (but we can't use black, so a diff color) */
    .term-fg31 { color: #ff7070; } /* red */
    .term-fg32 { color: #b0f986; } /* green */
    .term-fg33 { color: #c6c502; } /* yellow */
    .term-fg34 { color: #8db7e0; } /* blue */
    .term-fg35 { color: #f271fb; } /* magenta */
    .term-fg36 { color: #6bf7ff; } /* cyan */

    /* high intense colors */
    .term-fgi1 { color: #5ef765; }
    .term-fgi90 { color: #838887; } /* grey */
    .term-fgi91 { color: #ff3333; } /* red */
    .term-fgi92 { color: #00FF00; } /* green */
    .term-fgi93 { color: #fffc67; } /* yellow */
    .term-fgi94 { color: #6871ff; } /* blue */
    .term-fgi95 { color: #ff76ff; } /* magenta */
    .term-fgi96 { color: #60fcff; } /* cyan */

    /* background colors */
    .term-bg40 { background: #676767; } /* grey */
    .term-bg41 { background: #ff4343; } /* red */
    .term-bg42 { background: #99ff5f; } /* green */

    /* custom foreground/background combos for readability */
    .term-fg31.term-bg40 { color: #F8A39F; }

    /* xterm colors */
    .term-fgx16 { color: #000000; }
    .term-fgx17 { color: #00005f; }
    .term-fgx18 { color: #000087; }
    .term-fgx19 { color: #0000af; }
    .term-fgx20 { color: #0000d7; }
    .term-fgx21 { color: #0000ff; }
    .term-fgx22 { color: #005f00; }
    .term-fgx23 { color: #005f5f; }
    .term-fgx24 { color: #005f87; }
    .term-fgx25 { color: #005faf; }
    .term-fgx26 { color: #005fd7; }
    .term-fgx27 { color: #005fff; }
    .term-fgx28 { color: #008700; }
    .term-fgx29 { color: #00875f; }
    .term-fgx30 { color: #008787; }
    .term-fgx31 { color: #0087af; }
    .term-fgx32 { color: #0087d7; }
    .term-fgx33 { color: #0087ff; }
    .term-fgx34 { color: #00af00; }
    .term-fgx35 { color: #00af5f; }
    .term-fgx36 { color: #00af87; }
    .term-fgx37 { color: #00afaf; }
    .term-fgx38 { color: #00afd7; }
    .term-fgx39 { color: #00afff; }
    .term-fgx40 { color: #00d700; }
    .term-fgx41 { color: #00d75f; }
    .term-fgx42 { color: #00d787; }
    .term-fgx43 { color: #00d7af; }
    .term-fgx44 { color: #00d7d7; }
    .term-fgx45 { color: #00d7ff; }
    .term-fgx46 { color: #00ff00; }
    .term-fgx47 { color: #00ff5f; }
    .term-fgx48 { color: #00ff87; }
    .term-fgx49 { color: #00ffaf; }
    .term-fgx50 { color: #00ffd7; }
    .term-fgx51 { color: #00ffff; }
    .term-fgx52 { color: #5f0000; }
    .term-fgx53 { color: #5f005f; }
    .term-fgx54 { color: #5f0087; }
    .term-fgx55 { color: #5f00af; }
    .term-fgx56 { color: #5f00d7; }
    .term-fgx57 { color: #5f00ff; }
    .term-fgx58 { color: #5f5f00; }
    .term-fgx59 { color: #5f5f5f; }
    .term-fgx60 { color: #5f5f87; }
    .term-fgx61 { color: #5f5faf; }
    .term-fgx62 { color: #5f5fd7; }
    .term-fgx63 { color: #5f5fff; }
    .term-fgx64 { color: #5f8700; }
    .term-fgx65 { color: #5f875f; }
    .term-fgx66 { color: #5f8787; }
    .term-fgx67 { color: #5f87af; }
    .term-fgx68 { color: #5f87d7; }
    .term-fgx69 { color: #5f87ff; }
    .term-fgx70 { color: #5faf00; }
    .term-fgx71 { color: #5faf5f; }
    .term-fgx72 { color: #5faf87; }
    .term-fgx73 { color: #5fafaf; }
    .term-fgx74 { color: #5fafd7; }
    .term-fgx75 { color: #5fafff; }
    .term-fgx76 { color: #5fd700; }
    .term-fgx77 { color: #5fd75f; }
    .term-fgx78 { color: #5fd787; }
    .term-fgx79 { color: #5fd7af; }
    .term-fgx80 { color: #5fd7d7; }
    .term-fgx81 { color: #5fd7ff; }
    .term-fgx82 { color: #5fff00; }
    .term-fgx83 { color: #5fff5f; }
    .term-fgx84 { color: #5fff87; }
    .term-fgx85 { color: #5fffaf; }
    .term-fgx86 { color: #5fffd7; }
    .term-fgx87 { color: #5fffff; }
    .term-fgx88 { color: #870000; }
    .term-fgx89 { color: #87005f; }
    .term-fgx90 { color: #870087; }
    .term-fgx91 { color: #8700af; }
    .term-fgx92 { color: #8700d7; }
    .term-fgx93 { color: #8700ff; }
    .term-fgx94 { color: #875f00; }
    .term-fgx95 { color: #875f5f; }
    .term-fgx96 { color: #875f87; }
    .term-fgx97 { color: #875faf; }
    .term-fgx98 { color: #875fd7; }
    .term-fgx99 { color: #875fff; }
    .term-fgx100 { color: #878700; }
    .term-fgx101 { color: #87875f; }
    .term-fgx102 { color: #878787; }
    .term-fgx103 { color: #8787af; }
    .term-fgx104 { color: #8787d7; }
    .term-fgx105 { color: #8787ff; }
    .term-fgx106 { color: #87af00; }
    .term-fgx107 { color: #87af5f; }
    .term-fgx108 { color: #87af87; }
    .term-fgx109 { color: #87afaf; }
    .term-fgx110 { color: #87afd7; }
    .term-fgx111 { color: #87afff; }
    .term-fgx112 { color: #87d700; }
    .term-fgx113 { color: #87d75f; }
    .term-fgx114 { color: #87d787; }
    .term-fgx115 { color: #87d7af; }
    .term-fgx116 { color: #87d7d7; }
    .term-fgx117 { color: #87d7ff; }
    .term-fgx118 { color: #87ff00; }
    .term-fgx119 { color: #87ff5f; }
    .term-fgx120 { color: #87ff87; }
    .term-fgx121 { color: #87ffaf; }
    .term-fgx122 { color: #87ffd7; }
    .term-fgx123 { color: #87ffff; }
    .term-fgx124 { color: #af0000; }
    .term-fgx125 { color: #af005f; }
    .term-fgx126 { color: #af0087; }
    .term-fgx127 { color: #af00af; }
    .term-fgx128 { color: #af00d7; }
    .term-fgx129 { color: #af00ff; }
    .term-fgx130 { color: #af5f00; }
    .term-fgx131 { color: #af5f5f; }
    .term-fgx132 { color: #af5f87; }
    .term-fgx133 { color: #af5faf; }
    .term-fgx134 { color: #af5fd7; }
    .term-fgx135 { color: #af5fff; }
    .term-fgx136 { color: #af8700; }
    .term-fgx137 { color: #af875f; }
    .term-fgx138 { color: #af8787; }
    .term-fgx139 { color: #af87af; }
    .term-fgx140 { color: #af87d7; }
    .term-fgx141 { color: #af87ff; }
    .term-fgx142 { color: #afaf00; }
    .term-fgx143 { color: #afaf5f; }
    .term-fgx144 { color: #afaf87; }
    .term-fgx145 { color: #afafaf; }
    .term-fgx146 { color: #afafd7; }
    .term-fgx147 { color: #afafff; }
    .term-fgx148 { color: #afd700; }
    .term-fgx149 { color: #afd75f; }
    .term-fgx150 { color: #afd787; }
    .term-fgx151 { color: #afd7af; }
    .term-fgx152 { color: #afd7d7; }
    .term-fgx153 { color: #afd7ff; }
    .term-fgx154 { color: #afff00; }
    .term-fgx155 { color: #afff5f; }
    .term-fgx156 { color: #afff87; }
    .term-fgx157 { color: #afffaf; }
    .term-fgx158 { color: #afffd7; }
    .term-fgx159 { color: #afffff; }
    .term-fgx160 { color: #d70000; }
    .term-fgx161 { color: #d7005f; }
    .term-fgx162 { color: #d70087; }
    .term-fgx163 { color: #d700af; }
    .term-fgx164 { color: #d700d7; }
    .term-fgx165 { color: #d700ff; }
    .term-fgx166 { color: #d75f00; }
    .term-fgx167 { color: #d75f5f; }
    .term-fgx168 { color: #d75f87; }
    .term-fgx169 { color: #d75faf; }
    .term-fgx170 { color: #d75fd7; }
    .term-fgx171 { color: #d75fff; }
    .term-fgx172 { color: #d78700; }
    .term-fgx173 { color: #d7875f; }
    .term-fgx174 { color: #d78787; }
    .term-fgx175 { color: #d787af; }
    .term-fgx176 { color: #d787d7; }
    .term-fgx177 { color: #d787ff; }
    .term-fgx178 { color: #d7af00; }
    .term-fgx179 { color: #d7af5f; }
    .term-fgx180 { color: #d7af87; }
    .term-fgx181 { color: #d7afaf; }
    .term-fgx182 { color: #d7afd7; }
    .term-fgx183 { color: #d7afff; }
    .term-fgx184 { color: #d7d700; }
    .term-fgx185 { color: #d7d75f; }
    .term-fgx186 { color: #d7d787; }
    .term-fgx187 { color: #d7d7af; }
    .term-fgx188 { color: #d7d7d7; }
    .term-fgx189 { color: #d7d7ff; }
    .term-fgx190 { color: #d7ff00; }
    .term-fgx191 { color: #d7ff5f; }
    .term-fgx192 { color: #d7ff87; }
    .term-fgx193 { color: #d7ffaf; }
    .term-fgx194 { color: #d7ffd7; }
    .term-fgx195 { color: #d7ffff; }
    .term-fgx196 { color: #ff0000; }
    .term-fgx197 { color: #ff005f; }
    .term-fgx198 { color: #ff0087; }
    .term-fgx199 { color: #ff00af; }
    .term-fgx200 { color: #ff00d7; }
    .term-fgx201 { color: #ff00ff; }
    .term-fgx202 { color: #ff5f00; }
    .term-fgx203 { color: #ff5f5f; }
    .term-fgx204 { color: #ff5f87; }
    .term-fgx205 { color: #ff5faf; }
    .term-fgx206 { color: #ff5fd7; }
    .term-fgx207 { color: #ff5fff; }
    .term-fgx208 { color: #ff8700; }
    .term-fgx209 { color: #ff875f; }
    .term-fgx210 { color: #ff8787; }
    .term-fgx211 { color: #ff87af; }
    .term-fgx212 { color: #ff87d7; }
    .term-fgx213 { color: #ff87ff; }
    .term-fgx214 { color: #ffaf00; }
    .term-fgx215 { color: #ffaf5f; }
    .term-fgx216 { color: #ffaf87; }
    .term-fgx217 { color: #ffafaf; }
    .term-fgx218 { color: #ffafd7; }
    .term-fgx219 { color: #ffafff; }
    .term-fgx220 { color: #ffd700; }
    .term-fgx221 { color: #ffd75f; }
    .term-fgx222 { color: #ffd787; }
    .term-fgx223 { color: #ffd7af; }
    .term-fgx224 { color: #ffd7d7; }
    .term-fgx225 { color: #ffd7ff; }
    .term-fgx226 { color: #ffff00; }
    .term-fgx227 { color: #ffff5f; }
    .term-fgx228 { color: #ffff87; }
    .term-fgx229 { color: #ffffaf; }
    .term-fgx230 { color: #ffffd7; }
    .term-fgx231 { color: #ffffff; }
    .term-fgx232 { color: #080808; }
    .term-fgx233 { color: #121212; }
    .term-fgx234 { color: #1c1c1c; }
    .term-fgx235 { color: #262626; }
    .term-fgx236 { color: #303030; }
    .term-fgx237 { color: #3a3a3a; }
    .term-fgx238 { color: #444444; }
    .term-fgx239 { color: #4e4e4e; }
    .term-fgx240 { color: #585858; }
    .term-fgx241 { color: #626262; }
    .term-fgx242 { color: #6c6c6c; }
    .term-fgx243 { color: #767676; }
    .term-fgx244 { color: #808080; }
    .term-fgx245 { color: #8a8a8a; }
    .term-fgx246 { color: #949494; }
    .term-fgx247 { color: #9e9e9e; }
    .term-fgx248 { color: #a8a8a8; }
    .term-fgx249 { color: #b2b2b2; }
    .term-fgx250 { color: #bcbcbc; }
    .term-fgx251 { color: #c6c6c6; }
    .term-fgx252 { color: #d0d0d0; }
    .term-fgx253 { color: #dadada; }
    .term-fgx254 { color: #e4e4e4; }
    .term-fgx255 { color: #eeeeee; }
</style>

</head>
<body>
    <div class="col-xl-10 col-xxl-8 mx-auto px-3 py-1 py-md-3">
        <main class="container-fluid">
            <div class="row">
                <div>
                    <div class="float-end">
                        <div class="form-check form-switch">
                            <i class="bi bi-brightness-low" id="dark-mode-icon"></i>
                            <input class="form-check-input" type="checkbox" role="switch" id="dark-mode-toggle" data-bs-toggle="tooltip"
                                   data-bs-placement="bottom" data-bs-title="Toggle Dark Mode"/>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"role="button" aria-expanded="true" aria-controls="id-61efc90b8e561b42437cf804">
        
            <div class="col-12 col-sm-9 text-start"><h1>⚡🤖 suave-geth</h1></div>
        
        <div class="col-12 col-sm-3 ms-auto mt-2">
            <div class="row line-stat">
                <div class="text-end"><span class="text-success">+6755</span></div>
                <div class="text-start"><span class="text-danger">-57</span></div>
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse show border-1 ps-3 my-3" id="id-61efc90b8e561b42437cf804">
        <div><p>an overview of the changes in <a href="https://github.com/flashbots/suave-geth"><code>suave-geth</code></a>,
a fork of <a href="https://github.com/ethereum/go-ethereum"><code>go-ethereum</code></a></p>

<p><code>NOTE: just personal notes, not official docs</code></p>
</div>
        <div>
            
        </div>
        <div>
            
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-5fc953a1d2f3bb87ea514706"role="button" aria-expanded="false" aria-controls="id-5fc953a1d2f3bb87ea514706">
        
            <div class="col-12 col-sm-9 text-start"><h2>Core modifications</h2></div>
        
        <div class="col-12 col-sm-3 ms-auto mt-2">
            <div class="row line-stat">
                <div class="text-end"><span class="text-success">+1898</span></div>
                <div class="text-start"><span class="text-danger">-40</span></div>
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-5fc953a1d2f3bb87ea514706">
        <div></div>
        <div>
            
        </div>
        <div>
            
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-473d180b37a813d508be7286"role="button" aria-expanded="false" aria-controls="id-473d180b37a813d508be7286">
        
            <div class="col-12 col-sm-9 text-start"><h3>Chain config</h3></div>
        
        <div class="col-12 col-sm-3 ms-auto mt-2">
            <div class="row line-stat">
                <div class="text-end"><span class="text-success">+72</span></div>
                <div class="text-start"><span class="text-danger">-7</span></div>
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-473d180b37a813d508be7286">
        <div><p>Genesis config for a new Suave chain type (just a testnet for now)</p>
</div>
        <div>
            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-8fcc9c37e2a094fabefcec81" role="button"
                   aria-expanded="false" aria-controls="id-8fcc9c37e2a094fabefcec81">
                    <code>params/config.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/e501b3b05db8e169f67dc78b7b59bc352b3c638d/params/config.go" target="_blank">ethereum/go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/params/config.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+35</span></div>
                        <div class="text-start"><span class="text-danger">-1</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-8fcc9c37e2a094fabefcec81"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;params&#47;config.go flashbots&#47;suave-geth&#47;params&#47;config.go</span>
<span class="term-fg1">index 08e5ea0be03d4d5b02cc6876d64e249ef01544e3..a01d47fedc2193793a38df65a71ad0aaee0ab174 100644</span>
<span class="term-fg1">--- ethereum&#47;go-ethereum&#47;params&#47;config.go</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;params&#47;config.go</span>
<span class="term-fg36">@@ -29,6 +29,7 @@</span> 	MainnetGenesisHash = common.HexToHash(&quot;0xd4e56740f876aef8c010b86a40d5f56745a118d0906a34e69aec8c0db1cb8fa3&quot;)
 	SepoliaGenesisHash = common.HexToHash(&quot;0x25a5cc106eea7138acab33231d7160d69cb777ee0c2c553fcddf5138993e6dd9&quot;)
 	RinkebyGenesisHash = common.HexToHash(&quot;0x6341fd3daf94b748c72ced5a5b26028f2474f5f00d824504e4fa37a75767e177&quot;)
 	GoerliGenesisHash  = common.HexToHash(&quot;0xbf7e331f7f7c1dd2e05159666b3bf8bc7a8a3a9eb1d518969eab529dd9b88c1a&quot;)
<span class="term-fg32">+	SuaveGenesisHash   = common.HexToHash(&quot;0xad51dd608af6e4d1d855003d841ba963f3a961f668c858c8ea364d575af197d2&quot;)</span>
 )
&nbsp;
 func newUint64(val uint64) *uint64 { return &amp;val }
<span class="term-fg36">@@ -128,6 +129,29 @@</span> 			Period: 15,
 			Epoch:  30000,
 		},
 	}
<span class="term-fg32">+	&#47;&#47; SuaveChainConfig contains the chain parameters to run a node on the Suave test network.</span>
<span class="term-fg32">+	SuaveChainConfig = &amp;ChainConfig{</span>
<span class="term-fg32">+		ChainID:             big.NewInt(424242),</span>
<span class="term-fg32">+		HomesteadBlock:      big.NewInt(0),</span>
<span class="term-fg32">+		DAOForkBlock:        nil,</span>
<span class="term-fg32">+		DAOForkSupport:      false,</span>
<span class="term-fg32">+		EIP150Block:         big.NewInt(0),</span>
<span class="term-fg32">+		EIP155Block:         big.NewInt(0),</span>
<span class="term-fg32">+		EIP158Block:         big.NewInt(0),</span>
<span class="term-fg32">+		ByzantiumBlock:      big.NewInt(0),</span>
<span class="term-fg32">+		ConstantinopleBlock: big.NewInt(0),</span>
<span class="term-fg32">+		PetersburgBlock:     big.NewInt(0),</span>
<span class="term-fg32">+		IstanbulBlock:       big.NewInt(0),</span>
<span class="term-fg32">+		MuirGlacierBlock:    big.NewInt(0),</span>
<span class="term-fg32">+		BerlinBlock:         big.NewInt(0),</span>
<span class="term-fg32">+		LondonBlock:         big.NewInt(0),</span>
<span class="term-fg32">+		SuaveBlock:          big.NewInt(0),</span>
<span class="term-fg32">+		ArrowGlacierBlock:   nil,</span>
<span class="term-fg32">+		Clique: &amp;CliqueConfig{</span>
<span class="term-fg32">+			Period: 4,</span>
<span class="term-fg32">+			Epoch:  30000,</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+	}</span>
 	&#47;&#47; AllEthashProtocolChanges contains every protocol change (EIPs) introduced
 	&#47;&#47; and accepted by the Ethereum core developers into the Ethash consensus.
 	AllEthashProtocolChanges = &amp;ChainConfig{
<span class="term-fg36">@@ -145,6 +169,7 @@</span> 		IstanbulBlock:                 big.NewInt(0),
 		MuirGlacierBlock:              big.NewInt(0),
 		BerlinBlock:                   big.NewInt(0),
 		LondonBlock:                   big.NewInt(0),
<span class="term-fg32">+		SuaveBlock:                    big.NewInt(0),</span>
 		ArrowGlacierBlock:             big.NewInt(0),
 		GrayGlacierBlock:              big.NewInt(0),
 		MergeNetsplitBlock:            nil,
<span class="term-fg36">@@ -174,6 +199,7 @@</span> 		IstanbulBlock:                 big.NewInt(0),
 		MuirGlacierBlock:              big.NewInt(0),
 		BerlinBlock:                   big.NewInt(0),
 		LondonBlock:                   big.NewInt(0),
<span class="term-fg32">+		SuaveBlock:                    big.NewInt(0),</span>
 		ArrowGlacierBlock:             nil,
 		GrayGlacierBlock:              nil,
 		MergeNetsplitBlock:            nil,
<span class="term-fg36">@@ -232,6 +258,7 @@</span> 		IstanbulBlock:                 nil,
 		MuirGlacierBlock:              nil,
 		BerlinBlock:                   nil,
 		LondonBlock:                   nil,
<span class="term-fg32">+		SuaveBlock:                    nil,</span>
 		ArrowGlacierBlock:             nil,
 		GrayGlacierBlock:              nil,
 		MergeNetsplitBlock:            nil,
<span class="term-fg36">@@ -252,6 +279,7 @@</span> 	MainnetChainConfig.ChainID.String(): &quot;mainnet&quot;,
 	RinkebyChainConfig.ChainID.String(): &quot;rinkeby&quot;,
 	GoerliChainConfig.ChainID.String():  &quot;goerli&quot;,
 	SepoliaChainConfig.ChainID.String(): &quot;sepolia&quot;,
<span class="term-fg32">+	SuaveChainConfig.ChainID.String():   &quot;suavetest&quot;,</span>
 }
&nbsp;
 &#47;&#47; ChainConfig is the core config which determines the blockchain settings.
<span class="term-fg36">@@ -279,6 +307,7 @@</span> 	IstanbulBlock       *big.Int `json:&quot;istanbulBlock,omitempty&quot;`       &#47;&#47; Istanbul switch block (nil = no fork, 0 = already on istanbul)
 	MuirGlacierBlock    *big.Int `json:&quot;muirGlacierBlock,omitempty&quot;`    &#47;&#47; Eip-2384 (bomb delay) switch block (nil = no fork, 0 = already activated)
 	BerlinBlock         *big.Int `json:&quot;berlinBlock,omitempty&quot;`         &#47;&#47; Berlin switch block (nil = no fork, 0 = already on berlin)
 	LondonBlock         *big.Int `json:&quot;londonBlock,omitempty&quot;`         &#47;&#47; London switch block (nil = no fork, 0 = already on london)
<span class="term-fg32">+	SuaveBlock          *big.Int `json:&quot;suaveBlock,omitempty&quot;`          &#47;&#47; London switch block (nil = no fork, 0 = already on london)</span>
 	ArrowGlacierBlock   *big.Int `json:&quot;arrowGlacierBlock,omitempty&quot;`   &#47;&#47; Eip-4345 (bomb delay) switch block (nil = no fork, 0 = already activated)
 	GrayGlacierBlock    *big.Int `json:&quot;grayGlacierBlock,omitempty&quot;`    &#47;&#47; Eip-5133 (bomb delay) switch block (nil = no fork, 0 = already activated)
 	MergeNetsplitBlock  *big.Int `json:&quot;mergeNetsplitBlock,omitempty&quot;`  &#47;&#47; Virtual fork after The Merge to use as a network splitter
<span class="term-fg36">@@ -466,6 +495,10 @@</span>
 &#47;&#47; IsBerlin returns whether num is either equal to the Berlin fork block or greater.
 func (c *ChainConfig) IsBerlin(num *big.Int) bool {
 	return isBlockForked(c.BerlinBlock, num)
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (c *ChainConfig) IsSuave(num *big.Int) bool {</span>
<span class="term-fg32">+	return isBlockForked(c.SuaveBlock, num)</span>
 }
&nbsp;
 &#47;&#47; IsLondon returns whether num is either equal to the London fork block or greater.
<span class="term-fg36">@@ -806,7 +839,7 @@</span> type Rules struct {
 	ChainID                                                 *big.Int
 	IsHomestead, IsEIP150, IsEIP155, IsEIP158               bool
 	IsByzantium, IsConstantinople, IsPetersburg, IsIstanbul bool
<span class="term-fg31">-	IsBerlin, IsLondon                                      bool</span>
<span class="term-fg32">+	IsBerlin, IsLondon, IsSuave                             bool</span>
 	IsMerge, IsShanghai, IsCancun, IsPrague                 bool
 }
&nbsp;
<span class="term-fg36">@@ -828,6 +861,7 @@</span> 		IsPetersburg:     c.IsPetersburg(num),
 		IsIstanbul:       c.IsIstanbul(num),
 		IsBerlin:         c.IsBerlin(num),
 		IsLondon:         c.IsLondon(num),
<span class="term-fg32">+		IsSuave:          c.IsSuave(num),</span>
 		IsMerge:          isMerge,
 		IsShanghai:       c.IsShanghai(num, timestamp),
 		IsCancun:         c.IsCancun(num, timestamp),</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-3680ef725850a9ee6dd4b4aa" role="button"
                   aria-expanded="false" aria-controls="id-3680ef725850a9ee6dd4b4aa">
                    <code>core/genesis.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/e501b3b05db8e169f67dc78b7b59bc352b3c638d/core/genesis.go" target="_blank">ethereum/go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/core/genesis.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+36</span></div>
                        <div class="text-start"><span class="text-danger">-6</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-3680ef725850a9ee6dd4b4aa"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;core&#47;genesis.go flashbots&#47;suave-geth&#47;core&#47;genesis.go</span>
<span class="term-fg1">index 68eeec216151ffc4c39c334dcc057d32d32cdd0d..f42a377c08d9695059c87a873fe4901aa2d4f404 100644</span>
<span class="term-fg1">--- ethereum&#47;go-ethereum&#47;core&#47;genesis.go</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;core&#47;genesis.go</span>
<span class="term-fg36">@@ -195,6 +195,8 @@</span> 		case params.GoerliGenesisHash:
 			genesis = DefaultGoerliGenesisBlock()
 		case params.SepoliaGenesisHash:
 			genesis = DefaultSepoliaGenesisBlock()
<span class="term-fg32">+		case params.SuaveGenesisHash:</span>
<span class="term-fg32">+			genesis = DefaultSuaveGenesisBlock()</span>
 		}
 		if genesis != nil {
 			alloc = genesis.Alloc
<span class="term-fg36">@@ -424,6 +426,8 @@</span> 	case ghash == params.RinkebyGenesisHash:
 		return params.RinkebyChainConfig
 	case ghash == params.GoerliGenesisHash:
 		return params.GoerliChainConfig
<span class="term-fg32">+	case ghash == params.SuaveGenesisHash:</span>
<span class="term-fg32">+		return params.SuaveChainConfig</span>
 	default:
 		return params.AllEthashProtocolChanges
 	}
<span class="term-fg36">@@ -528,6 +532,31 @@</span> 		Alloc:      decodePrealloc(mainnetAllocData),
 	}
 }
&nbsp;
<span class="term-fg32">+&#47;&#47; DefaultSuaveGenesisBlock returns the Suave network genesis block.</span>
<span class="term-fg32">+func DefaultSuaveGenesisBlock() *Genesis {</span>
<span class="term-fg32">+	return &amp;Genesis{</span>
<span class="term-fg32">+		Config:     params.SuaveChainConfig,</span>
<span class="term-fg32">+		Timestamp:  1687192941,</span>
<span class="term-fg32">+		ExtraData:  hexutil.MustDecode(&quot;0x00000000000000000000000000000000000000000000000000000000000000004f91862699aF93251B3e3518E4Ca6278036892520000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000&quot;),</span>
<span class="term-fg32">+		GasLimit:   30000000,</span>
<span class="term-fg32">+		Difficulty: big.NewInt(1),</span>
<span class="term-fg32">+		Alloc: map[common.Address]GenesisAccount{</span>
<span class="term-fg32">+			common.BytesToAddress([]byte{1}): {Balance: big.NewInt(1)}, &#47;&#47; ECRecover</span>
<span class="term-fg32">+			common.BytesToAddress([]byte{2}): {Balance: big.NewInt(1)}, &#47;&#47; SHA256</span>
<span class="term-fg32">+			common.BytesToAddress([]byte{3}): {Balance: big.NewInt(1)}, &#47;&#47; RIPEMD</span>
<span class="term-fg32">+			common.BytesToAddress([]byte{4}): {Balance: big.NewInt(1)}, &#47;&#47; Identity</span>
<span class="term-fg32">+			common.BytesToAddress([]byte{5}): {Balance: big.NewInt(1)}, &#47;&#47; ModExp</span>
<span class="term-fg32">+			common.BytesToAddress([]byte{6}): {Balance: big.NewInt(1)}, &#47;&#47; ECAdd</span>
<span class="term-fg32">+			common.BytesToAddress([]byte{7}): {Balance: big.NewInt(1)}, &#47;&#47; ECScalarMul</span>
<span class="term-fg32">+			common.BytesToAddress([]byte{8}): {Balance: big.NewInt(1)}, &#47;&#47; ECPairing</span>
<span class="term-fg32">+			common.BytesToAddress([]byte{9}): {Balance: big.NewInt(1)}, &#47;&#47; BLAKE2b</span>
<span class="term-fg32">+			common.HexToAddress(&quot;0x4201000&quot;): {Balance: big.NewInt(1)}, &#47;&#47; isOffchain</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+			common.HexToAddress(&quot;0x4f91862699aF93251B3e3518E4Ca627803689252&quot;): {Balance: new(big.Int).Mul(big.NewInt(1000000000000000000), big.NewInt(10000000000))}, &#47;&#47; initial signer</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
 &#47;&#47; DefaultRinkebyGenesisBlock returns the Rinkeby network genesis block.
 func DefaultRinkebyGenesisBlock() *Genesis {
 	return &amp;Genesis{
<span class="term-fg36">@@ -568,11 +597,7 @@</span>
 &#47;&#47; DeveloperGenesisBlock returns the &#39;geth --dev&#39; genesis block.
 func DeveloperGenesisBlock(period uint64, gasLimit uint64, faucet common.Address) *Genesis {
 	&#47;&#47; Override the default period to the user requested one
<span class="term-fg31">-	config := *params.AllCliqueProtocolChanges</span>
<span class="term-fg31">-	config.Clique = &amp;params.CliqueConfig{</span>
<span class="term-fg31">-		Period: period,</span>
<span class="term-fg31">-		Epoch:  config.Clique.Epoch,</span>
<span class="term-fg31">-	}</span>
<span class="term-fg32">+	config := *params.SuaveChainConfig</span>
&nbsp;
 	&#47;&#47; Assemble and return the genesis with the precompiles and faucet pre-funded
 	return &amp;Genesis{
<span class="term-fg36">@@ -591,7 +616,12 @@</span> 			common.BytesToAddress([]byte{6}): {Balance: big.NewInt(1)}, &#47;&#47; ECAdd
 			common.BytesToAddress([]byte{7}): {Balance: big.NewInt(1)}, &#47;&#47; ECScalarMul
 			common.BytesToAddress([]byte{8}): {Balance: big.NewInt(1)}, &#47;&#47; ECPairing
 			common.BytesToAddress([]byte{9}): {Balance: big.NewInt(1)}, &#47;&#47; BLAKE2b
<span class="term-fg31">-			faucet:                           {Balance: new(big.Int).Sub(new(big.Int).Lsh(big.NewInt(1), 256), big.NewInt(9))},</span>
<span class="term-fg32">+			common.HexToAddress(&quot;0x4201000&quot;): {Balance: big.NewInt(1)}, &#47;&#47; isOffchain</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+			common.HexToAddress(&quot;0x4f91862699aF93251B3e3518E4Ca627803689252&quot;): {Balance: new(big.Int).Mul(big.NewInt(1000000000000000000), big.NewInt(10000000000))}, &#47;&#47; initial signer</span>
<span class="term-fg32">+			common.HexToAddress(&quot;0x71B21E9b8029d1E384B71B2A1708005A7d4D0428&quot;): {Balance: new(big.Int).Mul(big.NewInt(1000000000000000000), big.NewInt(10000000000))},</span>
<span class="term-fg32">+			common.HexToAddress(&quot;0xfB8CcAb59b2d3Ef32B966F26891842db2b35d787&quot;): {Balance: new(big.Int).Mul(big.NewInt(1000000000000000000), big.NewInt(10000000000))},</span>
<span class="term-fg32">+			faucet: {Balance: new(big.Int).Sub(new(big.Int).Lsh(big.NewInt(1), 256), big.NewInt(9))},</span>
 		},
 	}
 }</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-dc0541d35bd1792bd1aa2c82" role="button"
                   aria-expanded="false" aria-controls="id-dc0541d35bd1792bd1aa2c82">
                    <code>core/genesis_test.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/e501b3b05db8e169f67dc78b7b59bc352b3c638d/core/genesis_test.go" target="_blank">ethereum/go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/core/genesis_test.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+1</span></div>
                        <div class="text-start"><span class="text-danger">-0</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-dc0541d35bd1792bd1aa2c82"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;core&#47;genesis_test.go flashbots&#47;suave-geth&#47;core&#47;genesis_test.go</span>
<span class="term-fg1">index 0e966bab0334d962e35a3bc42a55758152c93eda..8333264ea52dee97083b9dd5dffca8da810b67d6 100644</span>
<span class="term-fg1">--- ethereum&#47;go-ethereum&#47;core&#47;genesis_test.go</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;core&#47;genesis_test.go</span>
<span class="term-fg36">@@ -174,6 +174,7 @@</span> 		{DefaultGenesisBlock(), params.MainnetGenesisHash},
 		{DefaultGoerliGenesisBlock(), params.GoerliGenesisHash},
 		{DefaultRinkebyGenesisBlock(), params.RinkebyGenesisHash},
 		{DefaultSepoliaGenesisBlock(), params.SepoliaGenesisHash},
<span class="term-fg32">+		{DefaultSuaveGenesisBlock(), params.SuaveGenesisHash},</span>
 	} {
 		&#47;&#47; Test via MustCommit
 		if have := c.genesis.MustCommit(rawdb.NewMemoryDatabase()).Hash(); have != c.want {</div>
    </div>

            
        </div>
        <div>
            
        </div>
    </div>
</div>

            
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-adaa0baf96d4c5fa5fe469b5"role="button" aria-expanded="false" aria-controls="id-adaa0baf96d4c5fa5fe469b5">
        
            <div class="col-12 col-sm-9 text-start"><h3>Block-building modifications</h3></div>
        
        <div class="col-12 col-sm-3 ms-auto mt-2">
            <div class="row line-stat">
                <div class="text-end"><span class="text-success">+226</span></div>
                <div class="text-start"><span class="text-danger">-12</span></div>
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-adaa0baf96d4c5fa5fe469b5">
        <div><p>The block-building code (in the &ldquo;miner&rdquo; package because of Proof-Of-Work
legacy of ethereum) implements the changes to support the new <code>BuildBlockFrom...</code>
interfaces.</p>
</div>
        <div>
            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-9b5001e72c07fb3406f5fb2b" role="button"
                   aria-expanded="false" aria-controls="id-9b5001e72c07fb3406f5fb2b">
                    <code>miner/payload_building.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/e501b3b05db8e169f67dc78b7b59bc352b3c638d/miner/payload_building.go" target="_blank">ethereum/go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/miner/payload_building.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+1</span></div>
                        <div class="text-start"><span class="text-danger">-7</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-9b5001e72c07fb3406f5fb2b"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;miner&#47;payload_building.go flashbots&#47;suave-geth&#47;miner&#47;payload_building.go</span>
<span class="term-fg1">index f84d908e86d68dbb132e2cd75ba5e21887fc018c..0d6b827d0bf50cc3c7d9e25277a944a3a491ef8e 100644</span>
<span class="term-fg1">--- ethereum&#47;go-ethereum&#47;miner&#47;payload_building.go</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;miner&#47;payload_building.go</span>
<span class="term-fg36">@@ -34,13 +34,7 @@</span>
 &#47;&#47; BuildPayloadArgs contains the provided parameters for building payload.
 &#47;&#47; Check engine-api specification for more details.
 &#47;&#47; https:&#47;&#47;github.com&#47;ethereum&#47;execution-apis&#47;blob&#47;main&#47;src&#47;engine&#47;specification.md#payloadattributesv1
<span class="term-fg31">-type BuildPayloadArgs struct {</span>
<span class="term-fg31">-	Parent       common.Hash       &#47;&#47; The parent block to build payload on top</span>
<span class="term-fg31">-	Timestamp    uint64            &#47;&#47; The provided timestamp of generated payload</span>
<span class="term-fg31">-	FeeRecipient common.Address    &#47;&#47; The provided recipient address for collecting transaction fee</span>
<span class="term-fg31">-	Random       common.Hash       &#47;&#47; The provided randomness value</span>
<span class="term-fg31">-	Withdrawals  types.Withdrawals &#47;&#47; The provided withdrawals</span>
<span class="term-fg31">-}</span>
<span class="term-fg32">+type BuildPayloadArgs types.BuildBlockArgs</span>
&nbsp;
 &#47;&#47; Id computes an 8-byte identifier by hashing the components of the payload arguments.
 func (args *BuildPayloadArgs) Id() engine.PayloadID {</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-667f732c330a888cd209f6ee" role="button"
                   aria-expanded="false" aria-controls="id-667f732c330a888cd209f6ee">
                    <code>miner/worker.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/e501b3b05db8e169f67dc78b7b59bc352b3c638d/miner/worker.go" target="_blank">ethereum/go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/miner/worker.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+207</span></div>
                        <div class="text-start"><span class="text-danger">-5</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-667f732c330a888cd209f6ee"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;miner&#47;worker.go flashbots&#47;suave-geth&#47;miner&#47;worker.go</span>
<span class="term-fg1">index 936a9e74a5b6d6ff68c76a399424ca0fa61f7909..124a87d789e60389b93cf59ea43b8c95516bf636 100644</span>
<span class="term-fg1">--- ethereum&#47;go-ethereum&#47;miner&#47;worker.go</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;miner&#47;worker.go</span>
<span class="term-fg36">@@ -17,6 +17,7 @@</span>
 package miner
&nbsp;
 import (
<span class="term-fg32">+	&quot;context&quot;</span>
 	&quot;errors&quot;
 	&quot;fmt&quot;
 	&quot;math&#47;big&quot;
<span class="term-fg36">@@ -31,6 +32,7 @@</span> 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;consensus&#47;misc&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;core&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;core&#47;state&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;core&#47;types&quot;
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;crypto&quot;</span>
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;event&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;log&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;params&quot;
<span class="term-fg36">@@ -646,7 +648,8 @@</span> 			} else {
 				&#47;&#47; Special case, if the consensus engine is 0 period clique(dev mode),
 				&#47;&#47; submit sealing work here since all empty submission will be rejected
 				&#47;&#47; by clique. Of course the advance sealing(empty submission) is disabled.
<span class="term-fg31">-				if w.chainConfig.Clique != nil &amp;&amp; w.chainConfig.Clique.Period == 0 {</span>
<span class="term-fg32">+				if w.chainConfig.Clique != nil &amp;&amp; false { &#47;&#47; &amp;&amp; w.chainConfig.Clique.Period == 0 {</span>
<span class="term-fg32">+					&#47;&#47; Don&#39;t commit empty!</span>
 					w.commitWork(nil, true, time.Now().Unix())
 				}
 			}
<span class="term-fg36">@@ -725,6 +728,9 @@</span> 		select {
 		case block := &lt;-w.resultCh:
 			&#47;&#47; Short circuit when receiving empty result.
 			if block == nil {
<span class="term-fg32">+				continue</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+			if block.Transactions().Len() == 0 {</span>
 				continue
 			}
 			&#47;&#47; Short circuit when receiving duplicate result caused by resubmitting.
<span class="term-fg36">@@ -956,10 +962,11 @@</span> }
&nbsp;
 &#47;&#47; generateParams wraps various of settings for generating sealing task.
 type generateParams struct {
<span class="term-fg31">-	timestamp   uint64            &#47;&#47; The timstamp for sealing task</span>
<span class="term-fg31">-	forceTime   bool              &#47;&#47; Flag whether the given timestamp is immutable or not</span>
<span class="term-fg31">-	parentHash  common.Hash       &#47;&#47; Parent block hash, empty means the latest chain head</span>
<span class="term-fg31">-	coinbase    common.Address    &#47;&#47; The fee recipient address for including transaction</span>
<span class="term-fg32">+	timestamp   uint64         &#47;&#47; The timstamp for sealing task</span>
<span class="term-fg32">+	forceTime   bool           &#47;&#47; Flag whether the given timestamp is immutable or not</span>
<span class="term-fg32">+	parentHash  common.Hash    &#47;&#47; Parent block hash, empty means the latest chain head</span>
<span class="term-fg32">+	coinbase    common.Address &#47;&#47; The fee recipient address for including transaction</span>
<span class="term-fg32">+	gasLimit    uint64</span>
 	random      common.Hash       &#47;&#47; The randomness generated by beacon chain, empty before the merge
 	withdrawals types.Withdrawals &#47;&#47; List of withdrawals to include in block.
 	noUncle     bool              &#47;&#47; Flag whether the uncle block inclusion is allowed
<span class="term-fg36">@@ -1239,6 +1246,201 @@</span> 		return result.block, result.fees, nil
 	case &lt;-w.exitCh:
 		return nil, nil, errors.New(&quot;miner closed&quot;)
 	}
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (w *worker) buildBlockFromTxs(ctx context.Context, args *types.BuildBlockArgs, txs types.Transactions) (*types.Block, *big.Int, error) {</span>
<span class="term-fg32">+	params := &amp;generateParams{</span>
<span class="term-fg32">+		timestamp:   args.Timestamp,</span>
<span class="term-fg32">+		forceTime:   true,</span>
<span class="term-fg32">+		parentHash:  args.Parent,</span>
<span class="term-fg32">+		coinbase:    args.FeeRecipient,</span>
<span class="term-fg32">+		gasLimit:    args.GasLimit,</span>
<span class="term-fg32">+		random:      args.Random,</span>
<span class="term-fg32">+		withdrawals: args.Withdrawals,</span>
<span class="term-fg32">+		noUncle:     true,</span>
<span class="term-fg32">+		noTxs:       false,</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	work, err := w.prepareWork(params)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return nil, nil, err</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	defer work.discard()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	profitPre := work.state.GetBalance(args.FeeRecipient)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	if err := w.rawCommitTransactions(work, txs); err != nil {</span>
<span class="term-fg32">+		return nil, nil, err</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	profitPost := work.state.GetBalance(args.FeeRecipient)</span>
<span class="term-fg32">+	block, err := w.engine.FinalizeAndAssemble(w.chain, work.header, work.state, work.txs, work.unclelist(), work.receipts, params.withdrawals)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return nil, nil, err</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	blockProfit := new(big.Int).Sub(profitPost, profitPre)</span>
<span class="term-fg32">+	return block, blockProfit, nil</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (w *worker) buildBlockFromBundles(ctx context.Context, args *types.BuildBlockArgs, bundles []types.SBundle) (*types.Block, *big.Int, error) {</span>
<span class="term-fg32">+	&#47;&#47; create ephemeral addr and private key for payment txn</span>
<span class="term-fg32">+	ephemeralPrivKey, err := crypto.GenerateKey()</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return nil, nil, err</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	ephemeralAddr := crypto.PubkeyToAddress(ephemeralPrivKey.PublicKey)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	params := &amp;generateParams{</span>
<span class="term-fg32">+		timestamp:   args.Timestamp,</span>
<span class="term-fg32">+		forceTime:   true,</span>
<span class="term-fg32">+		parentHash:  args.Parent,</span>
<span class="term-fg32">+		coinbase:    ephemeralAddr, &#47;&#47; NOTE : overriding BuildBlockArgs.FeeRecipient</span>
<span class="term-fg32">+		gasLimit:    args.GasLimit,</span>
<span class="term-fg32">+		random:      args.Random,</span>
<span class="term-fg32">+		withdrawals: args.Withdrawals,</span>
<span class="term-fg32">+		noUncle:     true,</span>
<span class="term-fg32">+		noTxs:       false,</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	work, err := w.prepareWork(params)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return nil, nil, err</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	defer work.discard()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; Assume static 28000 gas transfers for both mev-share and proposer payments</span>
<span class="term-fg32">+	refundTransferCost := new(big.Int).Mul(big.NewInt(28000), work.header.BaseFee)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	profitPre := work.state.GetBalance(params.coinbase)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	for _, bundle := range bundles {</span>
<span class="term-fg32">+		&#47;&#47; NOTE: failing bundles will cause the block to not be built!</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		&#47;&#47; apply bundle</span>
<span class="term-fg32">+		profitPreBundle := work.state.GetBalance(params.coinbase)</span>
<span class="term-fg32">+		if err := w.rawCommitTransactions(work, bundle.Txs); err != nil {</span>
<span class="term-fg32">+			return nil, nil, err</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		profitPostBundle := work.state.GetBalance(params.coinbase)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		&#47;&#47; calc &amp; refund user if bundle has multiple txns</span>
<span class="term-fg32">+		if len(bundle.Txs) &gt; 1 {</span>
<span class="term-fg32">+			&#47;&#47; Note: PoC logic, this could be gamed by not sending any eth to coinbase</span>
<span class="term-fg32">+			refundPrct := bundle.RefundPercent</span>
<span class="term-fg32">+			if refundPrct == 0 {</span>
<span class="term-fg32">+				&#47;&#47; default refund</span>
<span class="term-fg32">+				refundPrct = 10</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+			bundleProfit := new(big.Int).Sub(profitPostBundle, profitPreBundle)</span>
<span class="term-fg32">+			refundAmt := new(big.Int).Div(bundleProfit, big.NewInt(int64(refundPrct)))</span>
<span class="term-fg32">+			&#47;&#47; subtract payment txn transfer costs</span>
<span class="term-fg32">+			refundAmt = new(big.Int).Sub(refundAmt, refundTransferCost)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+			currNonce := work.state.GetNonce(ephemeralAddr)</span>
<span class="term-fg32">+			&#47;&#47; HACK to include payment txn</span>
<span class="term-fg32">+			&#47;&#47; multi refund block untested</span>
<span class="term-fg32">+			bidTx := bundle.Txs[0] &#47;&#47; NOTE : assumes first txn is refund recipient</span>
<span class="term-fg32">+			refundAddr, err := types.Sender(types.LatestSignerForChainID(bidTx.ChainId()), bidTx)</span>
<span class="term-fg32">+			if err != nil {</span>
<span class="term-fg32">+				return nil, nil, err</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+			paymentTx, err := types.SignTx(types.NewTx(&amp;types.LegacyTx{</span>
<span class="term-fg32">+				Nonce:    currNonce,</span>
<span class="term-fg32">+				To:       &amp;refundAddr,</span>
<span class="term-fg32">+				Value:    refundAmt,</span>
<span class="term-fg32">+				Gas:      28000,</span>
<span class="term-fg32">+				GasPrice: work.header.BaseFee,</span>
<span class="term-fg32">+			}), work.signer, ephemeralPrivKey)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+			if err != nil {</span>
<span class="term-fg32">+				return nil, nil, err</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+			&#47;&#47; commit payment txn</span>
<span class="term-fg32">+			if err := w.rawCommitTransactions(work, types.Transactions{paymentTx}); err != nil {</span>
<span class="term-fg32">+				return nil, nil, err</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	profitPost := work.state.GetBalance(params.coinbase)</span>
<span class="term-fg32">+	proposerProfit := new(big.Int).Set(profitPost) &#47;&#47; = post-pre-transfer_cost</span>
<span class="term-fg32">+	proposerProfit = proposerProfit.Sub(profitPost, profitPre)</span>
<span class="term-fg32">+	proposerProfit = proposerProfit.Sub(proposerProfit, refundTransferCost)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	currNonce := work.state.GetNonce(ephemeralAddr)</span>
<span class="term-fg32">+	paymentTx, err := types.SignTx(types.NewTx(&amp;types.LegacyTx{</span>
<span class="term-fg32">+		Nonce:    currNonce,</span>
<span class="term-fg32">+		To:       &amp;args.FeeRecipient,</span>
<span class="term-fg32">+		Value:    proposerProfit,</span>
<span class="term-fg32">+		Gas:      28000,</span>
<span class="term-fg32">+		GasPrice: work.header.BaseFee,</span>
<span class="term-fg32">+	}), work.signer, ephemeralPrivKey)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return nil, nil, fmt.Errorf(&quot;could not sign proposer payment: %w&quot;, err)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; commit payment txn</span>
<span class="term-fg32">+	if err := w.rawCommitTransactions(work, types.Transactions{paymentTx}); err != nil {</span>
<span class="term-fg32">+		return nil, nil, fmt.Errorf(&quot;could not sign proposer payment: %w&quot;, err)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	log.Info(&quot;buildBlockFromBundles&quot;, &quot;num_bundles&quot;, len(bundles), &quot;num_txns&quot;, len(work.txs), &quot;profit&quot;, proposerProfit)</span>
<span class="term-fg32">+	block, err := w.engine.FinalizeAndAssemble(w.chain, work.header, work.state, work.txs, work.unclelist(), work.receipts, params.withdrawals)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return nil, nil, err</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	return block, proposerProfit, nil</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (w *worker) rawCommitTransactions(env *environment, txs types.Transactions) error {</span>
<span class="term-fg32">+	gasLimit := env.header.GasLimit</span>
<span class="term-fg32">+	if env.gasPool == nil {</span>
<span class="term-fg32">+		env.gasPool = new(core.GasPool).AddGas(gasLimit)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; TODO: logs should be a part of the env and returned to whoever requested the block</span>
<span class="term-fg32">+	&#47;&#47; var coalescedLogs []*types.Log</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	for _, tx := range txs {</span>
<span class="term-fg32">+		&#47;&#47; If we don&#39;t have enough gas for any further transactions then we&#39;re done.</span>
<span class="term-fg32">+		if env.gasPool.Gas() &lt; params.TxGas {</span>
<span class="term-fg32">+			log.Trace(&quot;Not enough gas for further transactions&quot;, &quot;have&quot;, env.gasPool, &quot;want&quot;, params.TxGas)</span>
<span class="term-fg32">+			break</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		&#47;&#47; Error may be ignored here. The error has already been checked</span>
<span class="term-fg32">+		&#47;&#47; during transaction acceptance is the transaction pool.</span>
<span class="term-fg32">+		from, _ := types.Sender(env.signer, tx)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		&#47;&#47; Check whether the tx is replay protected. If we&#39;re not in the EIP155 hf</span>
<span class="term-fg32">+		&#47;&#47; phase, start ignoring the sender until we do.</span>
<span class="term-fg32">+		if tx.Protected() &amp;&amp; !w.chainConfig.IsEIP155(env.header.Number) {</span>
<span class="term-fg32">+			log.Trace(&quot;Ignoring reply protected transaction&quot;, &quot;hash&quot;, tx.Hash(), &quot;eip155&quot;, w.chainConfig.EIP155Block)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+			return fmt.Errorf(&quot;invalid reply protected tx %s&quot;, tx.Hash())</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		&#47;&#47; Start executing the transaction</span>
<span class="term-fg32">+		env.state.SetTxContext(tx.Hash(), env.tcount)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		&#47;&#47; logs, err := w.commitTransaction(env, tx)</span>
<span class="term-fg32">+		_, err := w.commitTransaction(env, tx)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		switch {</span>
<span class="term-fg32">+		case errors.Is(err, core.ErrNonceTooLow):</span>
<span class="term-fg32">+			log.Debug(&quot;Skipping transaction with low nonce&quot;, &quot;hash&quot;, tx.Hash(), &quot;sender&quot;, from, &quot;nonce&quot;, tx.Nonce())</span>
<span class="term-fg32">+			return err</span>
<span class="term-fg32">+		case errors.Is(err, nil):</span>
<span class="term-fg32">+			&#47;&#47; coalescedLogs = append(coalescedLogs, logs...)</span>
<span class="term-fg32">+			env.tcount++</span>
<span class="term-fg32">+		default:</span>
<span class="term-fg32">+			&#47;&#47; Transaction is regarded as invalid, drop all consecutive transactions from</span>
<span class="term-fg32">+			&#47;&#47; the same sender because of `nonce-too-high` clause.</span>
<span class="term-fg32">+			log.Debug(&quot;Transaction failed, account skipped&quot;, &quot;hash&quot;, tx.Hash(), &quot;err&quot;, err)</span>
<span class="term-fg32">+			return err</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	return nil</span>
 }
&nbsp;
 &#47;&#47; isTTDReached returns the indicator if the given block has reached the total</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-3259c4eee6034970511d01be" role="button"
                   aria-expanded="false" aria-controls="id-3259c4eee6034970511d01be">
                    <code>miner/miner.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/e501b3b05db8e169f67dc78b7b59bc352b3c638d/miner/miner.go" target="_blank">ethereum/go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/miner/miner.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+9</span></div>
                        <div class="text-start"><span class="text-danger">-0</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-3259c4eee6034970511d01be"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;miner&#47;miner.go flashbots&#47;suave-geth&#47;miner&#47;miner.go</span>
<span class="term-fg1">index b1d1f7c4cbfe2a9b34f4f68ce345e0d09f209d9c..857c08265cb0deb0906a973abfc96075d0b2a464 100644</span>
<span class="term-fg1">--- ethereum&#47;go-ethereum&#47;miner&#47;miner.go</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;miner&#47;miner.go</span>
<span class="term-fg36">@@ -18,6 +18,7 @@</span> &#47;&#47; Package miner implements Ethereum block creation and mining.
 package miner
&nbsp;
 import (
<span class="term-fg32">+	&quot;context&quot;</span>
 	&quot;fmt&quot;
 	&quot;math&#47;big&quot;
 	&quot;sync&quot;
<span class="term-fg36">@@ -252,3 +253,11 @@</span> &#47;&#47; BuildPayload builds the payload according to the provided parameters.
 func (miner *Miner) BuildPayload(args *BuildPayloadArgs) (*Payload, error) {
 	return miner.worker.buildPayload(args)
 }
<span class="term-fg32">+</span>
<span class="term-fg32">+func (miner *Miner) BuildBlockFromTxs(ctx context.Context, buildArgs *types.BuildBlockArgs, txs types.Transactions) (*types.Block, *big.Int, error) {</span>
<span class="term-fg32">+	return miner.worker.buildBlockFromTxs(ctx, buildArgs, txs)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (miner *Miner) BuildBlockFromBundles(ctx context.Context, buildArgs *types.BuildBlockArgs, bundles []types.SBundle) (*types.Block, *big.Int, error) {</span>
<span class="term-fg32">+	return miner.worker.buildBlockFromBundles(ctx, buildArgs, bundles)</span>
<span class="term-fg32">+}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-674866444e170fe07e7cdbeb" role="button"
                   aria-expanded="false" aria-controls="id-674866444e170fe07e7cdbeb">
                    <code>core/types/block.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/e501b3b05db8e169f67dc78b7b59bc352b3c638d/core/types/block.go" target="_blank">ethereum/go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/core/types/block.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+9</span></div>
                        <div class="text-start"><span class="text-danger">-0</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-674866444e170fe07e7cdbeb"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;core&#47;types&#47;block.go flashbots&#47;suave-geth&#47;core&#47;types&#47;block.go</span>
<span class="term-fg1">index a1a14f5b1657983e25456a4ef7b964938ea927eb..37263e1533cfaf721ba4ba4c1aeaa1513c761aae 100644</span>
<span class="term-fg1">--- ethereum&#47;go-ethereum&#47;core&#47;types&#47;block.go</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;core&#47;types&#47;block.go</span>
<span class="term-fg36">@@ -456,3 +456,12 @@</span> 		return common.Hash{}
 	}
 	return common.BytesToHash(parentHash)
 }
<span class="term-fg32">+</span>
<span class="term-fg32">+type BuildBlockArgs struct {</span>
<span class="term-fg32">+	Parent       common.Hash    &#47;&#47; The parent block to build payload on top</span>
<span class="term-fg32">+	Timestamp    uint64         &#47;&#47; The provided timestamp of generated payload</span>
<span class="term-fg32">+	FeeRecipient common.Address &#47;&#47; The provided recipient address for collecting transaction fee</span>
<span class="term-fg32">+	GasLimit     uint64</span>
<span class="term-fg32">+	Random       common.Hash &#47;&#47; The provided randomness value</span>
<span class="term-fg32">+	Withdrawals  Withdrawals &#47;&#47; The provided withdrawals</span>
<span class="term-fg32">+}</span></div>
    </div>

            
        </div>
        <div>
            
        </div>
    </div>
</div>

            
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-ac4ce0aef06b0f1134f7901c"role="button" aria-expanded="false" aria-controls="id-ac4ce0aef06b0f1134f7901c">
        
            <div class="col-12 col-sm-9 text-start"><h3>New tx types</h3></div>
        
        <div class="col-12 col-sm-3 ms-auto mt-2">
            <div class="row line-stat">
                <div class="text-end"><span class="text-success">+403</span></div>
                <div class="text-start"><span class="text-danger">-6</span></div>
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-ac4ce0aef06b0f1134f7901c">
        <div></div>
        <div>
            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-33e8e9380d0d5519f9438962" role="button"
                   aria-expanded="false" aria-controls="id-33e8e9380d0d5519f9438962">
                    <code>core/types/offchain.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/core/types/offchain.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+140</span></div>
                        <div class="text-start"><span class="text-danger">-0</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-33e8e9380d0d5519f9438962"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;core&#47;types&#47;offchain.go flashbots&#47;suave-geth&#47;core&#47;types&#47;offchain.go</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..d50c36ffdd709926a76678eeefb0f73b3f947d68</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;core&#47;types&#47;offchain.go</span>
<span class="term-fg36">@@ -0,0 +1,140 @@</span>
<span class="term-fg32">+package types</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+import (</span>
<span class="term-fg32">+	&quot;math&#47;big&quot;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&quot;</span>
<span class="term-fg32">+)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+type OffchainTx struct {</span>
<span class="term-fg32">+	ExecutionNode common.Address `json:&quot;executionNode&quot; gencodec:&quot;required&quot;`</span>
<span class="term-fg32">+	Wrapped       Transaction    `json:&quot;wrapped&quot; gencodec:&quot;required&quot;`</span>
<span class="term-fg32">+	ChainID       *big.Int       &#47;&#47; Overwrite the wrapped chain id, since different txs handle it differently. Also probably should overwrite V,R,S</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; copy creates a deep copy of the transaction data and initializes all fields.</span>
<span class="term-fg32">+func (tx *OffchainTx) copy() TxData {</span>
<span class="term-fg32">+	cpy := &amp;OffchainTx{</span>
<span class="term-fg32">+		ExecutionNode: tx.ExecutionNode,</span>
<span class="term-fg32">+		Wrapped:       tx.Wrapped,</span>
<span class="term-fg32">+		ChainID:       new(big.Int),</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	if tx.ChainID != nil {</span>
<span class="term-fg32">+		cpy.ChainID.Set(tx.ChainID)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	return cpy</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; accessors for innerTx.</span>
<span class="term-fg32">+func (tx *OffchainTx) txType() byte {</span>
<span class="term-fg32">+	return OffchainTxType</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (tx *OffchainTx) data() []byte {</span>
<span class="term-fg32">+	return tx.Wrapped.Data()</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; Rest is carried over from wrapped tx</span>
<span class="term-fg32">+func (tx *OffchainTx) chainID() *big.Int         { return tx.ChainID }</span>
<span class="term-fg32">+func (tx *OffchainTx) accessList() AccessList    { return tx.Wrapped.inner.accessList() }</span>
<span class="term-fg32">+func (tx *OffchainTx) gas() uint64               { return tx.Wrapped.inner.gas() }</span>
<span class="term-fg32">+func (tx *OffchainTx) gasFeeCap() *big.Int       { return tx.Wrapped.inner.gasFeeCap() }</span>
<span class="term-fg32">+func (tx *OffchainTx) gasTipCap() *big.Int       { return tx.Wrapped.inner.gasTipCap() }</span>
<span class="term-fg32">+func (tx *OffchainTx) gasPrice() *big.Int        { return tx.Wrapped.inner.gasFeeCap() }</span>
<span class="term-fg32">+func (tx *OffchainTx) value() *big.Int           { return tx.Wrapped.inner.value() }</span>
<span class="term-fg32">+func (tx *OffchainTx) nonce() uint64             { return tx.Wrapped.inner.nonce() }</span>
<span class="term-fg32">+func (tx *OffchainTx) to() *common.Address       { return tx.Wrapped.inner.to() }</span>
<span class="term-fg32">+func (tx *OffchainTx) blobGas() uint64           { return tx.Wrapped.inner.blobGas() }</span>
<span class="term-fg32">+func (tx *OffchainTx) blobGasFeeCap() *big.Int   { return tx.Wrapped.inner.blobGasFeeCap() }</span>
<span class="term-fg32">+func (tx *OffchainTx) blobHashes() []common.Hash { return tx.Wrapped.inner.blobHashes() }</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (tx *OffchainTx) effectiveGasPrice(dst *big.Int, baseFee *big.Int) *big.Int {</span>
<span class="term-fg32">+	return tx.Wrapped.inner.effectiveGasPrice(dst, baseFee)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (tx *OffchainTx) rawSignatureValues() (v, r, s *big.Int) {</span>
<span class="term-fg32">+	return tx.Wrapped.inner.rawSignatureValues()</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (tx *OffchainTx) setSignatureValues(chainID, v, r, s *big.Int) {</span>
<span class="term-fg32">+	tx.ChainID = new(big.Int).Set(chainID)</span>
<span class="term-fg32">+	tx.Wrapped.inner.setSignatureValues(chainID, v, r, s)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+type OffchainExecutedTx struct {</span>
<span class="term-fg32">+	ExecutionNode  common.Address `json:&quot;executionNode&quot; gencodec:&quot;required&quot;`</span>
<span class="term-fg32">+	Wrapped        Transaction    `json:&quot;wrapped&quot; gencodec:&quot;required&quot;`</span>
<span class="term-fg32">+	OffchainResult []byte         &#47;&#47; Should post-execution transaction be its own transaction type &#47; be the main off-chain transaction type?</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; ExecutionNode&#39;s signature</span>
<span class="term-fg32">+	ChainID *big.Int</span>
<span class="term-fg32">+	V       *big.Int</span>
<span class="term-fg32">+	R       *big.Int</span>
<span class="term-fg32">+	S       *big.Int</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; copy creates a deep copy of the transaction data and initializes all fields.</span>
<span class="term-fg32">+func (tx *OffchainExecutedTx) copy() TxData {</span>
<span class="term-fg32">+	cpy := &amp;OffchainExecutedTx{</span>
<span class="term-fg32">+		ExecutionNode:  tx.ExecutionNode,</span>
<span class="term-fg32">+		Wrapped:        tx.Wrapped,</span>
<span class="term-fg32">+		OffchainResult: common.CopyBytes(tx.OffchainResult),</span>
<span class="term-fg32">+		ChainID:        new(big.Int),</span>
<span class="term-fg32">+		V:              new(big.Int),</span>
<span class="term-fg32">+		R:              new(big.Int),</span>
<span class="term-fg32">+		S:              new(big.Int),</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	if tx.ChainID != nil {</span>
<span class="term-fg32">+		cpy.ChainID.Set(tx.ChainID)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	if tx.V != nil {</span>
<span class="term-fg32">+		cpy.V.Set(tx.V)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if tx.R != nil {</span>
<span class="term-fg32">+		cpy.R.Set(tx.R)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if tx.S != nil {</span>
<span class="term-fg32">+		cpy.S.Set(tx.S)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	return cpy</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; accessors for innerTx.</span>
<span class="term-fg32">+func (tx *OffchainExecutedTx) txType() byte {</span>
<span class="term-fg32">+	return OffchainExecutedTxType</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (tx *OffchainExecutedTx) data() []byte {</span>
<span class="term-fg32">+	return tx.OffchainResult</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; Rest is carried over from wrapped tx</span>
<span class="term-fg32">+func (tx *OffchainExecutedTx) chainID() *big.Int         { return tx.ChainID }</span>
<span class="term-fg32">+func (tx *OffchainExecutedTx) accessList() AccessList    { return tx.Wrapped.inner.accessList() }</span>
<span class="term-fg32">+func (tx *OffchainExecutedTx) gas() uint64               { return tx.Wrapped.inner.gas() }</span>
<span class="term-fg32">+func (tx *OffchainExecutedTx) gasFeeCap() *big.Int       { return tx.Wrapped.inner.gasFeeCap() }</span>
<span class="term-fg32">+func (tx *OffchainExecutedTx) gasTipCap() *big.Int       { return tx.Wrapped.inner.gasTipCap() }</span>
<span class="term-fg32">+func (tx *OffchainExecutedTx) gasPrice() *big.Int        { return tx.Wrapped.inner.gasFeeCap() }</span>
<span class="term-fg32">+func (tx *OffchainExecutedTx) value() *big.Int           { return tx.Wrapped.inner.value() }</span>
<span class="term-fg32">+func (tx *OffchainExecutedTx) nonce() uint64             { return tx.Wrapped.inner.nonce() }</span>
<span class="term-fg32">+func (tx *OffchainExecutedTx) to() *common.Address       { return tx.Wrapped.inner.to() }</span>
<span class="term-fg32">+func (tx *OffchainExecutedTx) blobGas() uint64           { return tx.Wrapped.inner.blobGas() }</span>
<span class="term-fg32">+func (tx *OffchainExecutedTx) blobGasFeeCap() *big.Int   { return tx.Wrapped.inner.blobGasFeeCap() }</span>
<span class="term-fg32">+func (tx *OffchainExecutedTx) blobHashes() []common.Hash { return tx.Wrapped.inner.blobHashes() }</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (tx *OffchainExecutedTx) effectiveGasPrice(dst *big.Int, baseFee *big.Int) *big.Int {</span>
<span class="term-fg32">+	return tx.Wrapped.inner.effectiveGasPrice(dst, baseFee)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (tx *OffchainExecutedTx) rawSignatureValues() (v, r, s *big.Int) {</span>
<span class="term-fg32">+	return tx.V, tx.R, tx.S</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (tx *OffchainExecutedTx) setSignatureValues(chainID, v, r, s *big.Int) {</span>
<span class="term-fg32">+	tx.ChainID, tx.V, tx.R, tx.S = chainID, v, r, s</span>
<span class="term-fg32">+}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-69687a2e65572b028c6c4591" role="button"
                   aria-expanded="false" aria-controls="id-69687a2e65572b028c6c4591">
                    <code>core/types/sbundle.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/core/types/sbundle.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+14</span></div>
                        <div class="text-start"><span class="text-danger">-0</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-69687a2e65572b028c6c4591"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;core&#47;types&#47;sbundle.go flashbots&#47;suave-geth&#47;core&#47;types&#47;sbundle.go</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..ab0ff13515525dcbab95e4dcf2ac67853b6b148f</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;core&#47;types&#47;sbundle.go</span>
<span class="term-fg36">@@ -0,0 +1,14 @@</span>
<span class="term-fg32">+package types</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+import (</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&quot;</span>
<span class="term-fg32">+)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; Simplified Share Bundle Type for PoC</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+type SBundle struct {</span>
<span class="term-fg32">+	Txs             Transactions  `json:&quot;txs&quot;`</span>
<span class="term-fg32">+	RevertingHashes []common.Hash `json:&quot;revertingHashes,omitempty&quot;`</span>
<span class="term-fg32">+	RefundPercent   int           `json:&quot;percent,omitempty&quot;`</span>
<span class="term-fg32">+	MatchId         [16]byte      `json:&quot;MatchId,omitempty&quot;`</span>
<span class="term-fg32">+}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-4510a910439ab93abf54c835" role="button"
                   aria-expanded="false" aria-controls="id-4510a910439ab93abf54c835">
                    <code>core/types/transaction_signing.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/e501b3b05db8e169f67dc78b7b59bc352b3c638d/core/types/transaction_signing.go" target="_blank">ethereum/go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/core/types/transaction_signing.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+118</span></div>
                        <div class="text-start"><span class="text-danger">-1</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-4510a910439ab93abf54c835"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;core&#47;types&#47;transaction_signing.go flashbots&#47;suave-geth&#47;core&#47;types&#47;transaction_signing.go</span>
<span class="term-fg1">index 59dd2e76eb86ce46352585b0ddfb814228ce34c2..0ab553293072bded1b4eec6064a405d42337b1aa 100644</span>
<span class="term-fg1">--- ethereum&#47;go-ethereum&#47;core&#47;types&#47;transaction_signing.go</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;core&#47;types&#47;transaction_signing.go</span>
<span class="term-fg36">@@ -42,6 +42,8 @@</span> 	var signer Signer
 	switch {
 	case config.IsCancun(blockNumber, blockTime):
 		signer = NewCancunSigner(config.ChainID)
<span class="term-fg32">+	case config.IsSuave(blockNumber):</span>
<span class="term-fg32">+		signer = NewOffchainSigner(config.ChainID)</span>
 	case config.IsLondon(blockNumber):
 		signer = NewLondonSigner(config.ChainID)
 	case config.IsBerlin(blockNumber):
<span class="term-fg36">@@ -68,6 +70,9 @@</span> 	if config.ChainID != nil {
 		if config.CancunTime != nil {
 			return NewCancunSigner(config.ChainID)
 		}
<span class="term-fg32">+		if config.SuaveBlock != nil {</span>
<span class="term-fg32">+			return NewOffchainSigner(config.ChainID)</span>
<span class="term-fg32">+		}</span>
 		if config.LondonBlock != nil {
 			return NewLondonSigner(config.ChainID)
 		}
<span class="term-fg36">@@ -92,7 +97,7 @@</span> func LatestSignerForChainID(chainID *big.Int) Signer {
 	if chainID == nil {
 		return HomesteadSigner{}
 	}
<span class="term-fg31">-	return NewCancunSigner(chainID)</span>
<span class="term-fg32">+	return NewOffchainSigner(chainID)</span>
 }
&nbsp;
 &#47;&#47; SignTx signs the transaction using the given signer and private key.
<span class="term-fg36">@@ -191,6 +196,7 @@</span> func (s cancunSigner) Sender(tx *Transaction) (common.Address, error) {
 	if tx.Type() != BlobTxType {
 		return s.londonSigner.Sender(tx)
 	}
<span class="term-fg32">+</span>
 	V, R, S := tx.RawSignatureValues()
 	&#47;&#47; Blob txs are defined to use 0 and 1 as their recovery
 	&#47;&#47; id, add 27 to become equivalent to unprotected Homestead signatures.
<span class="term-fg36">@@ -242,6 +248,117 @@</span> 			tx.AccessList(),
 			tx.BlobGasFeeCap(),
 			tx.BlobHashes(),
 		})
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+type suaveSigner struct{ londonSigner }</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; NewOffchainSigner returns a signer that accepts</span>
<span class="term-fg32">+&#47;&#47; - SUAVE offchain transactions</span>
<span class="term-fg32">+&#47;&#47; - EIP-1559 dynamic fee transactions</span>
<span class="term-fg32">+&#47;&#47; - EIP-2930 access list transactions,</span>
<span class="term-fg32">+&#47;&#47; - EIP-155 replay protected transactions, and</span>
<span class="term-fg32">+&#47;&#47; - legacy Homestead transactions.</span>
<span class="term-fg32">+func NewOffchainSigner(chainId *big.Int) Signer {</span>
<span class="term-fg32">+	return suaveSigner{londonSigner{eip2930Signer{NewEIP155Signer(chainId)}}}</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; For offchain transaction, sender refers to the sender of the original transaction</span>
<span class="term-fg32">+func (s suaveSigner) Sender(tx *Transaction) (common.Address, error) {</span>
<span class="term-fg32">+	if tx.Type() != OffchainTxType &amp;&amp; tx.Type() != OffchainExecutedTxType {</span>
<span class="term-fg32">+		return s.londonSigner.Sender(tx)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	var offchainTx *Transaction = tx</span>
<span class="term-fg32">+	if tx.Type() == OffchainExecutedTxType { &#47;&#47; Verify ExecutionNode&#39;s signature</span>
<span class="term-fg32">+		inner := tx.inner.(*OffchainExecutedTx)</span>
<span class="term-fg32">+		offchainTx = NewTx(&amp;OffchainTx{ExecutionNode: inner.ExecutionNode, Wrapped: inner.Wrapped, ChainID: inner.ChainID})</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		V, R, S := tx.RawSignatureValues()</span>
<span class="term-fg32">+		&#47;&#47; DynamicFee txs are defined to use 0 and 1 as their recovery</span>
<span class="term-fg32">+		&#47;&#47; id, add 27 to become equivalent to unprotected Homestead signatures.</span>
<span class="term-fg32">+		V = new(big.Int).Add(V, big.NewInt(27))</span>
<span class="term-fg32">+		if tx.ChainId().Cmp(s.chainId) != 0 {</span>
<span class="term-fg32">+			return common.Address{}, fmt.Errorf(&quot;%w: have %d want %d&quot;, ErrInvalidChainId, tx.ChainId(), s.chainId)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		recovered, err := recoverPlain(s.Hash(tx), R, S, V, true)</span>
<span class="term-fg32">+		if err != nil {</span>
<span class="term-fg32">+			return common.Address{}, err</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		if recovered != inner.ExecutionNode {</span>
<span class="term-fg32">+			return common.Address{}, fmt.Errorf(&quot;offchain tx %s signed by incorrect execution node %s, expected %s&quot;, tx.Hash().Hex(), recovered.Hex(), inner.ExecutionNode.Hex())</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	{ &#47;&#47; Verify wrapped tx&#39;s signature</span>
<span class="term-fg32">+		V, R, S := offchainTx.RawSignatureValues()</span>
<span class="term-fg32">+		&#47;&#47; Offchain txs are defined to use 0 and 1 as their recovery</span>
<span class="term-fg32">+		&#47;&#47; id, add 27 to become equivalent to unprotected Homestead signatures.</span>
<span class="term-fg32">+		V = new(big.Int).Add(V, big.NewInt(27))</span>
<span class="term-fg32">+		if offchainTx.ChainId().Cmp(s.chainId) != 0 {</span>
<span class="term-fg32">+			return common.Address{}, fmt.Errorf(&quot;%w: have %d want %d&quot;, ErrInvalidChainId, offchainTx.ChainId(), s.chainId)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		addr, err := recoverPlain(s.Hash(offchainTx), R, S, V, true)</span>
<span class="term-fg32">+		if err != nil {</span>
<span class="term-fg32">+			return common.Address{}, err</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		return addr, nil</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (s suaveSigner) Equal(s2 Signer) bool {</span>
<span class="term-fg32">+	x, ok := s2.(suaveSigner)</span>
<span class="term-fg32">+	return ok &amp;&amp; x.chainId.Cmp(s.chainId) == 0</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (s suaveSigner) SignatureValues(tx *Transaction, sig []byte) (R, S, V *big.Int, err error) {</span>
<span class="term-fg32">+	txdataOffchain, ok := tx.inner.(*OffchainTx)</span>
<span class="term-fg32">+	if ok {</span>
<span class="term-fg32">+		if txdataOffchain.ChainID.Sign() != 0 &amp;&amp; txdataOffchain.ChainID.Cmp(s.chainId) != 0 {</span>
<span class="term-fg32">+			return nil, nil, nil, fmt.Errorf(&quot;%w: have %d want %d&quot;, ErrInvalidChainId, txdataOffchain.ChainID, s.chainId)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		R, S, _ = decodeSignature(sig)</span>
<span class="term-fg32">+		V = big.NewInt(int64(sig[64]))</span>
<span class="term-fg32">+		return R, S, V, nil</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	txdataExecuted, ok := tx.inner.(*OffchainExecutedTx)</span>
<span class="term-fg32">+	if ok {</span>
<span class="term-fg32">+		if txdataExecuted.ChainID.Sign() != 0 &amp;&amp; txdataExecuted.ChainID.Cmp(s.chainId) != 0 {</span>
<span class="term-fg32">+			return nil, nil, nil, fmt.Errorf(&quot;%w: have %d want %d&quot;, ErrInvalidChainId, txdataExecuted.ChainID, s.chainId)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		R, S, _ = decodeSignature(sig)</span>
<span class="term-fg32">+		V = big.NewInt(int64(sig[64]))</span>
<span class="term-fg32">+		return R, S, V, nil</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	return s.londonSigner.SignatureValues(tx, sig)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; Hash returns the hash to be signed by the sender.</span>
<span class="term-fg32">+&#47;&#47; It does not uniquely identify the transaction.</span>
<span class="term-fg32">+func (s suaveSigner) Hash(tx *Transaction) common.Hash {</span>
<span class="term-fg32">+	switch tx.Type() {</span>
<span class="term-fg32">+	case OffchainTxType:</span>
<span class="term-fg32">+		return prefixedRlpHash(</span>
<span class="term-fg32">+			tx.Type(),</span>
<span class="term-fg32">+			[]interface{}{</span>
<span class="term-fg32">+				tx.inner.(*OffchainTx).ExecutionNode,</span>
<span class="term-fg32">+				s.Hash(&amp;tx.inner.(*OffchainTx).Wrapped),</span>
<span class="term-fg32">+			})</span>
<span class="term-fg32">+	case OffchainExecutedTxType:</span>
<span class="term-fg32">+		return prefixedRlpHash(</span>
<span class="term-fg32">+			tx.Type(),</span>
<span class="term-fg32">+			[]interface{}{</span>
<span class="term-fg32">+				tx.inner.(*OffchainExecutedTx).ExecutionNode,</span>
<span class="term-fg32">+				s.Hash(&amp;tx.inner.(*OffchainExecutedTx).Wrapped),</span>
<span class="term-fg32">+				tx.inner.(*OffchainExecutedTx).OffchainResult,</span>
<span class="term-fg32">+			})</span>
<span class="term-fg32">+	default:</span>
<span class="term-fg32">+		return s.londonSigner.Hash(tx)</span>
<span class="term-fg32">+	}</span>
 }
&nbsp;
 type londonSigner struct{ eip2930Signer }</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-bb9209b73912ca765fee43ce" role="button"
                   aria-expanded="false" aria-controls="id-bb9209b73912ca765fee43ce">
                    <code>core/types/transaction_marshalling.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/e501b3b05db8e169f67dc78b7b59bc352b3c638d/core/types/transaction_marshalling.go" target="_blank">ethereum/go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/core/types/transaction_marshalling.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+112</span></div>
                        <div class="text-start"><span class="text-danger">-1</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-bb9209b73912ca765fee43ce"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;core&#47;types&#47;transaction_marshalling.go flashbots&#47;suave-geth&#47;core&#47;types&#47;transaction_marshalling.go</span>
<span class="term-fg1">index 6c6c50d498d7290439f2e7abf627002bcd2d9356..843dcc4ae24c51c3859fa2ea975413beabce3a76 100644</span>
<span class="term-fg1">--- ethereum&#47;go-ethereum&#47;core&#47;types&#47;transaction_marshalling.go</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;core&#47;types&#47;transaction_marshalling.go</span>
<span class="term-fg36">@@ -42,6 +42,9 @@</span> 	Value                *hexutil.Big    `json:&quot;value&quot;`
 	Input                *hexutil.Bytes  `json:&quot;input&quot;`
 	AccessList           *AccessList     `json:&quot;accessList,omitempty&quot;`
 	BlobVersionedHashes  []common.Hash   `json:&quot;blobVersionedHashes,omitempty&quot;`
<span class="term-fg32">+	ExecutionNode        *common.Address `json:&quot;executionNode,omitempty&quot;`</span>
<span class="term-fg32">+	Wrapped              *hexutil.Bytes  `json:&quot;wrapped,omitempty&quot;`</span>
<span class="term-fg32">+	OffchainResult       *hexutil.Bytes  `json:&quot;offchainResult,omitempty&quot;`</span>
 	V                    *hexutil.Big    `json:&quot;v&quot;`
 	R                    *hexutil.Big    `json:&quot;r&quot;`
 	S                    *hexutil.Big    `json:&quot;s&quot;`
<span class="term-fg36">@@ -112,7 +115,35 @@</span> 		enc.To = tx.To()
 		enc.V = (*hexutil.Big)(itx.V.ToBig())
 		enc.R = (*hexutil.Big)(itx.R.ToBig())
 		enc.S = (*hexutil.Big)(itx.S.ToBig())
<span class="term-fg32">+</span>
<span class="term-fg32">+	case *OffchainTx:</span>
<span class="term-fg32">+		enc.ExecutionNode = &amp;itx.ExecutionNode</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		wrapped, err := itx.Wrapped.MarshalJSON()</span>
<span class="term-fg32">+		if err != nil {</span>
<span class="term-fg32">+			return nil, err</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		enc.Wrapped = (*hexutil.Bytes)(&amp;wrapped)</span>
<span class="term-fg32">+		enc.ChainID = (*hexutil.Big)(itx.ChainID)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	case *OffchainExecutedTx:</span>
<span class="term-fg32">+		enc.ExecutionNode = &amp;itx.ExecutionNode</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		wrapped, err := itx.Wrapped.MarshalJSON()</span>
<span class="term-fg32">+		if err != nil {</span>
<span class="term-fg32">+			return nil, err</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		enc.Wrapped = (*hexutil.Bytes)(&amp;wrapped)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		enc.ChainID = (*hexutil.Big)(itx.ChainID)</span>
<span class="term-fg32">+		enc.OffchainResult = (*hexutil.Bytes)(&amp;itx.OffchainResult)</span>
<span class="term-fg32">+		enc.V = (*hexutil.Big)(itx.V)</span>
<span class="term-fg32">+		enc.R = (*hexutil.Big)(itx.R)</span>
<span class="term-fg32">+		enc.S = (*hexutil.Big)(itx.S)</span>
 	}
<span class="term-fg32">+</span>
 	return json.Marshal(&amp;enc)
 }
&nbsp;
<span class="term-fg36">@@ -167,7 +198,10 @@</span> 		itx.S = (*big.Int)(dec.S)
 		withSignature := itx.V.Sign() != 0 || itx.R.Sign() != 0 || itx.S.Sign() != 0
 		if withSignature {
 			if err := sanityCheckSignature(itx.V, itx.R, itx.S, true); err != nil {
<span class="term-fg31">-				return err</span>
<span class="term-fg32">+				&#47;&#47; Dirty hack! Wrapped legacy txs will be 0-signed</span>
<span class="term-fg32">+				if werr := sanityCheckSignature(itx.V, itx.R, itx.S, false); werr != nil {</span>
<span class="term-fg32">+					return err</span>
<span class="term-fg32">+				}</span>
 			}
 		}
&nbsp;
<span class="term-fg36">@@ -339,6 +373,83 @@</span> 		itx.S = uint256.MustFromBig((*big.Int)(dec.S))
 		withSignature := itx.V.Sign() != 0 || itx.R.Sign() != 0 || itx.S.Sign() != 0
 		if withSignature {
 			if err := sanityCheckSignature(itx.V.ToBig(), itx.R.ToBig(), itx.S.ToBig(), false); err != nil {
<span class="term-fg32">+				return err</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	case OffchainTxType:</span>
<span class="term-fg32">+		var itx OffchainTx</span>
<span class="term-fg32">+		inner = &amp;itx</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		if dec.ExecutionNode == nil {</span>
<span class="term-fg32">+			return errors.New(&quot;missing required field &#39;executionNode&#39; in transaction&quot;)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		itx.ExecutionNode = *dec.ExecutionNode</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		if dec.Wrapped == nil {</span>
<span class="term-fg32">+			return errors.New(&quot;missing required field &#39;wrapped&#39; in transaction&quot;)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		var wrappedTx Transaction</span>
<span class="term-fg32">+		err := wrappedTx.UnmarshalJSON(([]byte)(*dec.Wrapped))</span>
<span class="term-fg32">+		if err != nil {</span>
<span class="term-fg32">+			return err</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		itx.Wrapped = wrappedTx</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		if dec.ChainID == nil {</span>
<span class="term-fg32">+			return errors.New(&quot;missing required field &#39;chainId&#39; in transaction&quot;)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		itx.ChainID = (*big.Int)(dec.ChainID)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	case OffchainExecutedTxType:</span>
<span class="term-fg32">+		var itx OffchainExecutedTx</span>
<span class="term-fg32">+		inner = &amp;itx</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		if dec.ExecutionNode == nil {</span>
<span class="term-fg32">+			return errors.New(&quot;missing required field &#39;executionNode&#39; in transaction&quot;)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		itx.ExecutionNode = *dec.ExecutionNode</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		if dec.Wrapped == nil {</span>
<span class="term-fg32">+			return errors.New(&quot;missing required field &#39;wrapped&#39; in transaction&quot;)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		var wrappedTx Transaction</span>
<span class="term-fg32">+		err := wrappedTx.UnmarshalJSON(([]byte)(*dec.Wrapped))</span>
<span class="term-fg32">+		if err != nil {</span>
<span class="term-fg32">+			return err</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		itx.Wrapped = wrappedTx</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		if dec.OffchainResult != nil {</span>
<span class="term-fg32">+			itx.OffchainResult = ([]byte)(*dec.OffchainResult)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		if dec.ChainID == nil {</span>
<span class="term-fg32">+			return errors.New(&quot;missing required field &#39;chainId&#39; in transaction&quot;)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		itx.ChainID = (*big.Int)(dec.ChainID)</span>
<span class="term-fg32">+		&#47;&#47; Q: should the signature be required? Maybe, leaving in for now</span>
<span class="term-fg32">+		if dec.V == nil {</span>
<span class="term-fg32">+			return errors.New(&quot;missing required field &#39;v&#39; in transaction&quot;)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		itx.V = (*big.Int)(dec.V)</span>
<span class="term-fg32">+		if dec.R == nil {</span>
<span class="term-fg32">+			return errors.New(&quot;missing required field &#39;r&#39; in transaction&quot;)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		itx.R = (*big.Int)(dec.R)</span>
<span class="term-fg32">+		if dec.S == nil {</span>
<span class="term-fg32">+			return errors.New(&quot;missing required field &#39;s&#39; in transaction&quot;)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		itx.S = (*big.Int)(dec.S)</span>
<span class="term-fg32">+		withSignature := itx.V.Sign() != 0 || itx.R.Sign() != 0 || itx.S.Sign() != 0</span>
<span class="term-fg32">+		if withSignature {</span>
<span class="term-fg32">+			if err := sanityCheckSignature(itx.V, itx.R, itx.S, false); err != nil {</span>
 				return err
 			}
 		}</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-31b4ef711493e1a7becb87b6" role="button"
                   aria-expanded="false" aria-controls="id-31b4ef711493e1a7becb87b6">
                    <code>core/types/transaction.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/e501b3b05db8e169f67dc78b7b59bc352b3c638d/core/types/transaction.go" target="_blank">ethereum/go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/core/types/transaction.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+19</span></div>
                        <div class="text-start"><span class="text-danger">-4</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-31b4ef711493e1a7becb87b6"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;core&#47;types&#47;transaction.go flashbots&#47;suave-geth&#47;core&#47;types&#47;transaction.go</span>
<span class="term-fg1">index b7cb36b6026f4fb61ac41b48931ae58afe7864ee..4f17df5bc3841731eef23bd08622f1e9ad5d9805 100644</span>
<span class="term-fg1">--- ethereum&#47;go-ethereum&#47;core&#47;types&#47;transaction.go</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;core&#47;types&#47;transaction.go</span>
<span class="term-fg36">@@ -42,10 +42,12 @@</span> )
&nbsp;
 &#47;&#47; Transaction types.
 const (
<span class="term-fg31">-	LegacyTxType     = 0x00</span>
<span class="term-fg31">-	AccessListTxType = 0x01</span>
<span class="term-fg31">-	DynamicFeeTxType = 0x02</span>
<span class="term-fg31">-	BlobTxType       = 0x03</span>
<span class="term-fg32">+	LegacyTxType           = 0x00</span>
<span class="term-fg32">+	AccessListTxType       = 0x01</span>
<span class="term-fg32">+	DynamicFeeTxType       = 0x02</span>
<span class="term-fg32">+	BlobTxType             = 0x03</span>
<span class="term-fg32">+	OffchainTxType         = 0x42</span>
<span class="term-fg32">+	OffchainExecutedTxType = 0x43</span>
 )
&nbsp;
 &#47;&#47; Transaction is an Ethereum transaction.
<span class="term-fg36">@@ -200,6 +202,14 @@</span> 	case BlobTxType:
 		var inner BlobTx
 		err := rlp.DecodeBytes(b[1:], &amp;inner)
 		return &amp;inner, err
<span class="term-fg32">+	case OffchainTxType:</span>
<span class="term-fg32">+		var inner OffchainTx</span>
<span class="term-fg32">+		err := rlp.DecodeBytes(b[1:], &amp;inner)</span>
<span class="term-fg32">+		return &amp;inner, err</span>
<span class="term-fg32">+	case OffchainExecutedTxType:</span>
<span class="term-fg32">+		var inner OffchainExecutedTx</span>
<span class="term-fg32">+		err := rlp.DecodeBytes(b[1:], &amp;inner)</span>
<span class="term-fg32">+		return &amp;inner, err</span>
 	default:
 		return nil, ErrTxTypeNotSupported
 	}
<span class="term-fg36">@@ -262,6 +272,11 @@</span>
 &#47;&#47; Type returns the transaction type.
 func (tx *Transaction) Type() uint8 {
 	return tx.inner.txType()
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func CastTxInner[T any](tx *Transaction) (T, bool) {</span>
<span class="term-fg32">+	t, ok := tx.inner.(T)</span>
<span class="term-fg32">+	return t, ok</span>
 }
&nbsp;
 &#47;&#47; ChainId returns the EIP155 chain ID of the transaction. The return value will always be</div>
    </div>

            
        </div>
        <div>
            
        </div>
    </div>
</div>

            
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-e8c02bffc7fd9dbfe870391a"role="button" aria-expanded="false" aria-controls="id-e8c02bffc7fd9dbfe870391a">
        
            <div class="col-12 col-sm-9 text-start"><h3>VM modifications & precompiles</h3></div>
        
        <div class="col-12 col-sm-3 ms-auto mt-2">
            <div class="row line-stat">
                <div class="text-end"><span class="text-success">+1197</span></div>
                <div class="text-start"><span class="text-danger">-15</span></div>
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-e8c02bffc7fd9dbfe870391a">
        <div></div>
        <div>
            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-4f83944f70e6cbfaf1eb8453" role="button"
                   aria-expanded="false" aria-controls="id-4f83944f70e6cbfaf1eb8453">
                    <code>core/vm/contracts.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/e501b3b05db8e169f67dc78b7b59bc352b3c638d/core/vm/contracts.go" target="_blank">ethereum/go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/core/vm/contracts.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+44</span></div>
                        <div class="text-start"><span class="text-danger">-4</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-4f83944f70e6cbfaf1eb8453"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;core&#47;vm&#47;contracts.go flashbots&#47;suave-geth&#47;core&#47;vm&#47;contracts.go</span>
<span class="term-fg1">index aa4a3f13df5ec20e88cdf836ba3ca302acc05c56..c1af1591cade9799a2eb25c9a07dde8f9993de21 100644</span>
<span class="term-fg1">--- ethereum&#47;go-ethereum&#47;core&#47;vm&#47;contracts.go</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;core&#47;vm&#47;contracts.go</span>
<span class="term-fg36">@@ -40,6 +40,13 @@</span> 	RequiredGas(input []byte) uint64  &#47;&#47; RequiredPrice calculates the contract gas use
 	Run(input []byte) ([]byte, error) &#47;&#47; Run runs the precompiled contract
 }
&nbsp;
<span class="term-fg32">+&#47;&#47; SuavePrecompiledContract is an optional interface for precompiled Suave contracts.</span>
<span class="term-fg32">+&#47;&#47; During off-chain execution the contract will be called with their RunOffchain method.</span>
<span class="term-fg32">+type SuavePrecompiledContract interface {</span>
<span class="term-fg32">+	PrecompiledContract</span>
<span class="term-fg32">+	RunOffchain(backend *SuaveExecutionBackend, input []byte) ([]byte, error)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
 &#47;&#47; PrecompiledContractsHomestead contains the default set of pre-compiled Ethereum
 &#47;&#47; contracts used in the Frontier and Homestead releases.
 var PrecompiledContractsHomestead = map[common.Address]PrecompiledContract{
<span class="term-fg36">@@ -76,6 +83,26 @@</span> 	common.BytesToAddress([]byte{8}): &amp;bn256PairingIstanbul{},
 	common.BytesToAddress([]byte{9}): &amp;blake2F{},
 }
&nbsp;
<span class="term-fg32">+&#47;&#47; PrecompiledContractsSuave contains the default set of pre-compiled SUAVE VM</span>
<span class="term-fg32">+&#47;&#47; contracts used in the suave testnet. It&#39;s a superset of Berlin precompiles.</span>
<span class="term-fg32">+&#47;&#47; Offchain contracts (implementing OffchainPrecompiledContract)</span>
<span class="term-fg32">+&#47;&#47; are ran with their respective RunOffchain in offchain setting</span>
<span class="term-fg32">+var PrecompiledContractsSuave = map[common.Address]SuavePrecompiledContract{</span>
<span class="term-fg32">+	isOffchainAddress:         &amp;isOffchainPrecompile{},</span>
<span class="term-fg32">+	confidentialInputsAddress: &amp;confidentialInputsPrecompile{},</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	confStoreStoreAddress:    newConfStoreStore(),</span>
<span class="term-fg32">+	confStoreRetrieveAddress: newConfStoreRetrieve(),</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	newBidAddress:      newNewBid(),</span>
<span class="term-fg32">+	fetchBidsAddress:   newFetchBids(),</span>
<span class="term-fg32">+	extractHintAddress: &amp;extractHint{},</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	simulateBundleAddress:           &amp;simulateBundle{},</span>
<span class="term-fg32">+	buildEthBlockAddress:            &amp;buildEthBlock{},</span>
<span class="term-fg32">+	submitEthBlockBidToRelayAddress: &amp;submitEthBlockBidToRelay{},</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
 &#47;&#47; PrecompiledContractsBerlin contains the default set of pre-compiled Ethereum
 &#47;&#47; contracts used in the Berlin release.
 var PrecompiledContractsBerlin = map[common.Address]PrecompiledContract{
<span class="term-fg36">@@ -105,6 +132,7 @@</span> 	common.BytesToAddress([]byte{18}): &amp;bls12381MapG2{},
 }
&nbsp;
 var (
<span class="term-fg32">+	PrecompiledAddressesSuave     []common.Address</span>
 	PrecompiledAddressesBerlin    []common.Address
 	PrecompiledAddressesIstanbul  []common.Address
 	PrecompiledAddressesByzantium []common.Address
<span class="term-fg36">@@ -124,20 +152,31 @@</span> 	}
 	for k := range PrecompiledContractsBerlin {
 		PrecompiledAddressesBerlin = append(PrecompiledAddressesBerlin, k)
 	}
<span class="term-fg32">+	for k := range PrecompiledContractsSuave {</span>
<span class="term-fg32">+		PrecompiledAddressesSuave = append(PrecompiledAddressesSuave, k)</span>
<span class="term-fg32">+	}</span>
 }
&nbsp;
 &#47;&#47; ActivePrecompiles returns the precompiles enabled with the current configuration.
 func ActivePrecompiles(rules params.Rules) []common.Address {
<span class="term-fg32">+	var basePrecompiles []common.Address</span>
<span class="term-fg32">+</span>
 	switch {
 	case rules.IsBerlin:
<span class="term-fg31">-		return PrecompiledAddressesBerlin</span>
<span class="term-fg32">+		basePrecompiles = PrecompiledAddressesBerlin</span>
 	case rules.IsIstanbul:
<span class="term-fg31">-		return PrecompiledAddressesIstanbul</span>
<span class="term-fg32">+		basePrecompiles = PrecompiledAddressesIstanbul</span>
 	case rules.IsByzantium:
<span class="term-fg31">-		return PrecompiledAddressesByzantium</span>
<span class="term-fg32">+		basePrecompiles = PrecompiledAddressesByzantium</span>
 	default:
<span class="term-fg31">-		return PrecompiledAddressesHomestead</span>
<span class="term-fg32">+		basePrecompiles = PrecompiledAddressesHomestead</span>
 	}
<span class="term-fg32">+</span>
<span class="term-fg32">+	if rules.IsSuave {</span>
<span class="term-fg32">+		return append(basePrecompiles, PrecompiledAddressesSuave...)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	return basePrecompiles</span>
 }
&nbsp;
 &#47;&#47; RunPrecompiledContract runs and evaluates the output of a precompiled contract.
<span class="term-fg36">@@ -146,6 +185,7 @@</span> &#47;&#47; - the returned bytes,
 &#47;&#47; - the _remaining_ gas,
 &#47;&#47; - any error that occurred
 func RunPrecompiledContract(p PrecompiledContract, input []byte, suppliedGas uint64) (ret []byte, remainingGas uint64, err error) {
<span class="term-fg32">+	&#47;&#47; TODO: it&#39;d be nice if the offchain contracts&#39; exact gas usage was calculated with execution</span>
 	gasCost := p.RequiredGas(input)
 	if suppliedGas &lt; gasCost {
 		return nil, 0, ErrOutOfGas</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-ff8c350a62ee8af8d4052eb8" role="button"
                   aria-expanded="false" aria-controls="id-ff8c350a62ee8af8d4052eb8">
                    <code>core/vm/suave_abis.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/core/vm/suave_abis.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+329</span></div>
                        <div class="text-start"><span class="text-danger">-0</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-ff8c350a62ee8af8d4052eb8"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;core&#47;vm&#47;suave_abis.go flashbots&#47;suave-geth&#47;core&#47;vm&#47;suave_abis.go</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..b04053ec55c463488efb2d9ae1f7a160fead2e03</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;core&#47;vm&#47;suave_abis.go</span>
<span class="term-fg36">@@ -0,0 +1,329 @@</span>
<span class="term-fg32">+package vm</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+var bidIdsAbi = mustParseMethodAbi(`[{&quot;inputs&quot;: [{ &quot;type&quot;: &quot;bytes16[]&quot; }], &quot;name&quot;: &quot;bidids&quot;, &quot;outputs&quot;:[], &quot;type&quot;: &quot;function&quot;}]`, &quot;bidids&quot;)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+var precompilesAbi = mustParseAbi(`[</span>
<span class="term-fg32">+    {</span>
<span class="term-fg32">+      &quot;inputs&quot;: [</span>
<span class="term-fg32">+        {</span>
<span class="term-fg32">+          &quot;internalType&quot;: &quot;address&quot;,</span>
<span class="term-fg32">+          &quot;name&quot;: &quot;&quot;,</span>
<span class="term-fg32">+          &quot;type&quot;: &quot;address&quot;</span>
<span class="term-fg32">+        },</span>
<span class="term-fg32">+        {</span>
<span class="term-fg32">+          &quot;internalType&quot;: &quot;bytes&quot;,</span>
<span class="term-fg32">+          &quot;name&quot;: &quot;&quot;,</span>
<span class="term-fg32">+          &quot;type&quot;: &quot;bytes&quot;</span>
<span class="term-fg32">+        }</span>
<span class="term-fg32">+      ],</span>
<span class="term-fg32">+      &quot;name&quot;: &quot;PeekerReverted&quot;,</span>
<span class="term-fg32">+      &quot;type&quot;: &quot;error&quot;</span>
<span class="term-fg32">+    },</span>
<span class="term-fg32">+    {</span>
<span class="term-fg32">+      &quot;anonymous&quot;: false,</span>
<span class="term-fg32">+      &quot;inputs&quot;: [</span>
<span class="term-fg32">+        {</span>
<span class="term-fg32">+          &quot;indexed&quot;: false,</span>
<span class="term-fg32">+          &quot;internalType&quot;: &quot;Suave.BidId[]&quot;,</span>
<span class="term-fg32">+          &quot;name&quot;: &quot;ids&quot;,</span>
<span class="term-fg32">+          &quot;type&quot;: &quot;bytes16[]&quot;</span>
<span class="term-fg32">+        }</span>
<span class="term-fg32">+      ],</span>
<span class="term-fg32">+      &quot;name&quot;: &quot;BidIds&quot;,</span>
<span class="term-fg32">+      &quot;type&quot;: &quot;event&quot;</span>
<span class="term-fg32">+    },</span>
<span class="term-fg32">+    {</span>
<span class="term-fg32">+      &quot;inputs&quot;: [</span>
<span class="term-fg32">+        {</span>
<span class="term-fg32">+          &quot;components&quot;: [</span>
<span class="term-fg32">+            {</span>
<span class="term-fg32">+              &quot;internalType&quot;: &quot;uint64&quot;,</span>
<span class="term-fg32">+              &quot;name&quot;: &quot;slot&quot;,</span>
<span class="term-fg32">+              &quot;type&quot;: &quot;uint64&quot;</span>
<span class="term-fg32">+            },</span>
<span class="term-fg32">+            {</span>
<span class="term-fg32">+              &quot;internalType&quot;: &quot;bytes&quot;,</span>
<span class="term-fg32">+              &quot;name&quot;: &quot;proposerPubkey&quot;,</span>
<span class="term-fg32">+              &quot;type&quot;: &quot;bytes&quot;</span>
<span class="term-fg32">+            },</span>
<span class="term-fg32">+            {</span>
<span class="term-fg32">+              &quot;internalType&quot;: &quot;bytes32&quot;,</span>
<span class="term-fg32">+              &quot;name&quot;: &quot;parent&quot;,</span>
<span class="term-fg32">+              &quot;type&quot;: &quot;bytes32&quot;</span>
<span class="term-fg32">+            },</span>
<span class="term-fg32">+            {</span>
<span class="term-fg32">+              &quot;internalType&quot;: &quot;uint64&quot;,</span>
<span class="term-fg32">+              &quot;name&quot;: &quot;timestamp&quot;,</span>
<span class="term-fg32">+              &quot;type&quot;: &quot;uint64&quot;</span>
<span class="term-fg32">+            },</span>
<span class="term-fg32">+            {</span>
<span class="term-fg32">+              &quot;internalType&quot;: &quot;address&quot;,</span>
<span class="term-fg32">+              &quot;name&quot;: &quot;feeRecipient&quot;,</span>
<span class="term-fg32">+              &quot;type&quot;: &quot;address&quot;</span>
<span class="term-fg32">+            },</span>
<span class="term-fg32">+            {</span>
<span class="term-fg32">+              &quot;internalType&quot;: &quot;uint64&quot;,</span>
<span class="term-fg32">+              &quot;name&quot;: &quot;gasLimit&quot;,</span>
<span class="term-fg32">+              &quot;type&quot;: &quot;uint64&quot;</span>
<span class="term-fg32">+            },</span>
<span class="term-fg32">+            {</span>
<span class="term-fg32">+              &quot;internalType&quot;: &quot;bytes32&quot;,</span>
<span class="term-fg32">+              &quot;name&quot;: &quot;random&quot;,</span>
<span class="term-fg32">+              &quot;type&quot;: &quot;bytes32&quot;</span>
<span class="term-fg32">+            },</span>
<span class="term-fg32">+            {</span>
<span class="term-fg32">+              &quot;components&quot;: [</span>
<span class="term-fg32">+                {</span>
<span class="term-fg32">+                  &quot;internalType&quot;: &quot;uint64&quot;,</span>
<span class="term-fg32">+                  &quot;name&quot;: &quot;index&quot;,</span>
<span class="term-fg32">+                  &quot;type&quot;: &quot;uint64&quot;</span>
<span class="term-fg32">+                },</span>
<span class="term-fg32">+                {</span>
<span class="term-fg32">+                  &quot;internalType&quot;: &quot;uint64&quot;,</span>
<span class="term-fg32">+                  &quot;name&quot;: &quot;validator&quot;,</span>
<span class="term-fg32">+                  &quot;type&quot;: &quot;uint64&quot;</span>
<span class="term-fg32">+                },</span>
<span class="term-fg32">+                {</span>
<span class="term-fg32">+                  &quot;internalType&quot;: &quot;address&quot;,</span>
<span class="term-fg32">+                  &quot;name&quot;: &quot;Address&quot;,</span>
<span class="term-fg32">+                  &quot;type&quot;: &quot;address&quot;</span>
<span class="term-fg32">+                },</span>
<span class="term-fg32">+                {</span>
<span class="term-fg32">+                  &quot;internalType&quot;: &quot;uint64&quot;,</span>
<span class="term-fg32">+                  &quot;name&quot;: &quot;amount&quot;,</span>
<span class="term-fg32">+                  &quot;type&quot;: &quot;uint64&quot;</span>
<span class="term-fg32">+                }</span>
<span class="term-fg32">+              ],</span>
<span class="term-fg32">+              &quot;internalType&quot;: &quot;struct Suave.Withdrawal[]&quot;,</span>
<span class="term-fg32">+              &quot;name&quot;: &quot;withdrawals&quot;,</span>
<span class="term-fg32">+              &quot;type&quot;: &quot;tuple[]&quot;</span>
<span class="term-fg32">+            }</span>
<span class="term-fg32">+          ],</span>
<span class="term-fg32">+          &quot;internalType&quot;: &quot;struct Suave.BuildBlockArgs&quot;,</span>
<span class="term-fg32">+          &quot;name&quot;: &quot;blockArgs&quot;,</span>
<span class="term-fg32">+          &quot;type&quot;: &quot;tuple&quot;</span>
<span class="term-fg32">+        },</span>
<span class="term-fg32">+        {</span>
<span class="term-fg32">+          &quot;internalType&quot;: &quot;Suave.BidId&quot;,</span>
<span class="term-fg32">+          &quot;name&quot;: &quot;bid&quot;,</span>
<span class="term-fg32">+          &quot;type&quot;: &quot;bytes16&quot;</span>
<span class="term-fg32">+        },</span>
<span class="term-fg32">+        {</span>
<span class="term-fg32">+          &quot;internalType&quot;: &quot;string&quot;,</span>
<span class="term-fg32">+          &quot;name&quot;: &quot;namespace&quot;,</span>
<span class="term-fg32">+          &quot;type&quot;: &quot;string&quot;</span>
<span class="term-fg32">+        }</span>
<span class="term-fg32">+      ],</span>
<span class="term-fg32">+      &quot;name&quot;: &quot;buildEthBlock&quot;,</span>
<span class="term-fg32">+      &quot;outputs&quot;: [</span>
<span class="term-fg32">+        {</span>
<span class="term-fg32">+          &quot;internalType&quot;: &quot;bytes&quot;,</span>
<span class="term-fg32">+          &quot;name&quot;: &quot;&quot;,</span>
<span class="term-fg32">+          &quot;type&quot;: &quot;bytes&quot;</span>
<span class="term-fg32">+        },</span>
<span class="term-fg32">+        {</span>
<span class="term-fg32">+          &quot;internalType&quot;: &quot;bytes&quot;,</span>
<span class="term-fg32">+          &quot;name&quot;: &quot;&quot;,</span>
<span class="term-fg32">+          &quot;type&quot;: &quot;bytes&quot;</span>
<span class="term-fg32">+        }</span>
<span class="term-fg32">+      ],</span>
<span class="term-fg32">+      &quot;stateMutability&quot;: &quot;view&quot;,</span>
<span class="term-fg32">+      &quot;type&quot;: &quot;function&quot;</span>
<span class="term-fg32">+    },</span>
<span class="term-fg32">+    {</span>
<span class="term-fg32">+      &quot;inputs&quot;: [</span>
<span class="term-fg32">+        {</span>
<span class="term-fg32">+          &quot;internalType&quot;: &quot;Suave.BidId&quot;,</span>
<span class="term-fg32">+          &quot;name&quot;: &quot;bidId&quot;,</span>
<span class="term-fg32">+          &quot;type&quot;: &quot;bytes16&quot;</span>
<span class="term-fg32">+        },</span>
<span class="term-fg32">+        {</span>
<span class="term-fg32">+          &quot;internalType&quot;: &quot;string&quot;,</span>
<span class="term-fg32">+          &quot;name&quot;: &quot;key&quot;,</span>
<span class="term-fg32">+          &quot;type&quot;: &quot;string&quot;</span>
<span class="term-fg32">+        }</span>
<span class="term-fg32">+      ],</span>
<span class="term-fg32">+      &quot;name&quot;: &quot;confidentialStoreRetrieve&quot;,</span>
<span class="term-fg32">+      &quot;outputs&quot;: [</span>
<span class="term-fg32">+        {</span>
<span class="term-fg32">+          &quot;internalType&quot;: &quot;bytes&quot;,</span>
<span class="term-fg32">+          &quot;name&quot;: &quot;&quot;,</span>
<span class="term-fg32">+          &quot;type&quot;: &quot;bytes&quot;</span>
<span class="term-fg32">+        }</span>
<span class="term-fg32">+      ],</span>
<span class="term-fg32">+      &quot;stateMutability&quot;: &quot;view&quot;,</span>
<span class="term-fg32">+      &quot;type&quot;: &quot;function&quot;</span>
<span class="term-fg32">+    },</span>
<span class="term-fg32">+    {</span>
<span class="term-fg32">+      &quot;inputs&quot;: [</span>
<span class="term-fg32">+        {</span>
<span class="term-fg32">+          &quot;internalType&quot;: &quot;Suave.BidId&quot;,</span>
<span class="term-fg32">+          &quot;name&quot;: &quot;bidId&quot;,</span>
<span class="term-fg32">+          &quot;type&quot;: &quot;bytes16&quot;</span>
<span class="term-fg32">+        },</span>
<span class="term-fg32">+        {</span>
<span class="term-fg32">+          &quot;internalType&quot;: &quot;string&quot;,</span>
<span class="term-fg32">+          &quot;name&quot;: &quot;key&quot;,</span>
<span class="term-fg32">+          &quot;type&quot;: &quot;string&quot;</span>
<span class="term-fg32">+        },</span>
<span class="term-fg32">+        {</span>
<span class="term-fg32">+          &quot;internalType&quot;: &quot;bytes&quot;,</span>
<span class="term-fg32">+          &quot;name&quot;: &quot;data&quot;,</span>
<span class="term-fg32">+          &quot;type&quot;: &quot;bytes&quot;</span>
<span class="term-fg32">+        }</span>
<span class="term-fg32">+      ],</span>
<span class="term-fg32">+      &quot;name&quot;: &quot;confidentialStoreStore&quot;,</span>
<span class="term-fg32">+      &quot;outputs&quot;: [],</span>
<span class="term-fg32">+      &quot;stateMutability&quot;: &quot;view&quot;,</span>
<span class="term-fg32">+      &quot;type&quot;: &quot;function&quot;</span>
<span class="term-fg32">+    },</span>
<span class="term-fg32">+    {</span>
<span class="term-fg32">+      &quot;inputs&quot;: [</span>
<span class="term-fg32">+        {</span>
<span class="term-fg32">+          &quot;internalType&quot;: &quot;bytes&quot;,</span>
<span class="term-fg32">+          &quot;name&quot;: &quot;bundleData&quot;,</span>
<span class="term-fg32">+          &quot;type&quot;: &quot;bytes&quot;</span>
<span class="term-fg32">+        }</span>
<span class="term-fg32">+      ],</span>
<span class="term-fg32">+      &quot;name&quot;: &quot;extractHint&quot;,</span>
<span class="term-fg32">+      &quot;outputs&quot;: [</span>
<span class="term-fg32">+        {</span>
<span class="term-fg32">+          &quot;internalType&quot;: &quot;bytes&quot;,</span>
<span class="term-fg32">+          &quot;name&quot;: &quot;&quot;,</span>
<span class="term-fg32">+          &quot;type&quot;: &quot;bytes&quot;</span>
<span class="term-fg32">+        }</span>
<span class="term-fg32">+      ],</span>
<span class="term-fg32">+      &quot;stateMutability&quot;: &quot;view&quot;,</span>
<span class="term-fg32">+      &quot;type&quot;: &quot;function&quot;</span>
<span class="term-fg32">+    },</span>
<span class="term-fg32">+    {</span>
<span class="term-fg32">+      &quot;inputs&quot;: [</span>
<span class="term-fg32">+        {</span>
<span class="term-fg32">+          &quot;internalType&quot;: &quot;uint64&quot;,</span>
<span class="term-fg32">+          &quot;name&quot;: &quot;cond&quot;,</span>
<span class="term-fg32">+          &quot;type&quot;: &quot;uint64&quot;</span>
<span class="term-fg32">+        },</span>
<span class="term-fg32">+        {</span>
<span class="term-fg32">+          &quot;internalType&quot;: &quot;string&quot;,</span>
<span class="term-fg32">+          &quot;name&quot;: &quot;namespace&quot;,</span>
<span class="term-fg32">+          &quot;type&quot;: &quot;string&quot;</span>
<span class="term-fg32">+        }</span>
<span class="term-fg32">+      ],</span>
<span class="term-fg32">+      &quot;name&quot;: &quot;fetchBids&quot;,</span>
<span class="term-fg32">+      &quot;outputs&quot;: [</span>
<span class="term-fg32">+        {</span>
<span class="term-fg32">+          &quot;components&quot;: [</span>
<span class="term-fg32">+            {</span>
<span class="term-fg32">+              &quot;internalType&quot;: &quot;Suave.BidId&quot;,</span>
<span class="term-fg32">+              &quot;name&quot;: &quot;id&quot;,</span>
<span class="term-fg32">+              &quot;type&quot;: &quot;bytes16&quot;</span>
<span class="term-fg32">+            },</span>
<span class="term-fg32">+            {</span>
<span class="term-fg32">+              &quot;internalType&quot;: &quot;uint64&quot;,</span>
<span class="term-fg32">+              &quot;name&quot;: &quot;decryptionCondition&quot;,</span>
<span class="term-fg32">+              &quot;type&quot;: &quot;uint64&quot;</span>
<span class="term-fg32">+            },</span>
<span class="term-fg32">+            {</span>
<span class="term-fg32">+              &quot;internalType&quot;: &quot;address[]&quot;,</span>
<span class="term-fg32">+              &quot;name&quot;: &quot;allowedPeekers&quot;,</span>
<span class="term-fg32">+              &quot;type&quot;: &quot;address[]&quot;</span>
<span class="term-fg32">+            }</span>
<span class="term-fg32">+          ],</span>
<span class="term-fg32">+          &quot;internalType&quot;: &quot;struct Suave.Bid[]&quot;,</span>
<span class="term-fg32">+          &quot;name&quot;: &quot;&quot;,</span>
<span class="term-fg32">+          &quot;type&quot;: &quot;tuple[]&quot;</span>
<span class="term-fg32">+        }</span>
<span class="term-fg32">+      ],</span>
<span class="term-fg32">+      &quot;stateMutability&quot;: &quot;view&quot;,</span>
<span class="term-fg32">+      &quot;type&quot;: &quot;function&quot;</span>
<span class="term-fg32">+    },</span>
<span class="term-fg32">+    {</span>
<span class="term-fg32">+      &quot;inputs&quot;: [</span>
<span class="term-fg32">+        {</span>
<span class="term-fg32">+          &quot;internalType&quot;: &quot;uint64&quot;,</span>
<span class="term-fg32">+          &quot;name&quot;: &quot;decryptionCondition&quot;,</span>
<span class="term-fg32">+          &quot;type&quot;: &quot;uint64&quot;</span>
<span class="term-fg32">+        },</span>
<span class="term-fg32">+        {</span>
<span class="term-fg32">+          &quot;internalType&quot;: &quot;address[]&quot;,</span>
<span class="term-fg32">+          &quot;name&quot;: &quot;allowedPeekers&quot;,</span>
<span class="term-fg32">+          &quot;type&quot;: &quot;address[]&quot;</span>
<span class="term-fg32">+        },</span>
<span class="term-fg32">+        {</span>
<span class="term-fg32">+          &quot;internalType&quot;: &quot;string&quot;,</span>
<span class="term-fg32">+          &quot;name&quot;: &quot;BidType&quot;,</span>
<span class="term-fg32">+          &quot;type&quot;: &quot;string&quot;</span>
<span class="term-fg32">+        }</span>
<span class="term-fg32">+      ],</span>
<span class="term-fg32">+      &quot;name&quot;: &quot;newBid&quot;,</span>
<span class="term-fg32">+      &quot;outputs&quot;: [</span>
<span class="term-fg32">+        {</span>
<span class="term-fg32">+          &quot;components&quot;: [</span>
<span class="term-fg32">+            {</span>
<span class="term-fg32">+              &quot;internalType&quot;: &quot;Suave.BidId&quot;,</span>
<span class="term-fg32">+              &quot;name&quot;: &quot;id&quot;,</span>
<span class="term-fg32">+              &quot;type&quot;: &quot;bytes16&quot;</span>
<span class="term-fg32">+            },</span>
<span class="term-fg32">+            {</span>
<span class="term-fg32">+              &quot;internalType&quot;: &quot;uint64&quot;,</span>
<span class="term-fg32">+              &quot;name&quot;: &quot;decryptionCondition&quot;,</span>
<span class="term-fg32">+              &quot;type&quot;: &quot;uint64&quot;</span>
<span class="term-fg32">+            },</span>
<span class="term-fg32">+            {</span>
<span class="term-fg32">+              &quot;internalType&quot;: &quot;address[]&quot;,</span>
<span class="term-fg32">+              &quot;name&quot;: &quot;allowedPeekers&quot;,</span>
<span class="term-fg32">+              &quot;type&quot;: &quot;address[]&quot;</span>
<span class="term-fg32">+            }</span>
<span class="term-fg32">+          ],</span>
<span class="term-fg32">+          &quot;internalType&quot;: &quot;struct Suave.Bid&quot;,</span>
<span class="term-fg32">+          &quot;name&quot;: &quot;&quot;,</span>
<span class="term-fg32">+          &quot;type&quot;: &quot;tuple&quot;</span>
<span class="term-fg32">+        }</span>
<span class="term-fg32">+      ],</span>
<span class="term-fg32">+      &quot;stateMutability&quot;: &quot;view&quot;,</span>
<span class="term-fg32">+      &quot;type&quot;: &quot;function&quot;</span>
<span class="term-fg32">+    },</span>
<span class="term-fg32">+    {</span>
<span class="term-fg32">+      &quot;inputs&quot;: [</span>
<span class="term-fg32">+        {</span>
<span class="term-fg32">+          &quot;internalType&quot;: &quot;bytes&quot;,</span>
<span class="term-fg32">+          &quot;name&quot;: &quot;bundleData&quot;,</span>
<span class="term-fg32">+          &quot;type&quot;: &quot;bytes&quot;</span>
<span class="term-fg32">+        }</span>
<span class="term-fg32">+      ],</span>
<span class="term-fg32">+      &quot;name&quot;: &quot;simulateBundle&quot;,</span>
<span class="term-fg32">+      &quot;outputs&quot;: [</span>
<span class="term-fg32">+        {</span>
<span class="term-fg32">+          &quot;internalType&quot;: &quot;uint64&quot;,</span>
<span class="term-fg32">+          &quot;name&quot;: &quot;&quot;,</span>
<span class="term-fg32">+          &quot;type&quot;: &quot;uint64&quot;</span>
<span class="term-fg32">+        }</span>
<span class="term-fg32">+      ],</span>
<span class="term-fg32">+      &quot;stateMutability&quot;: &quot;view&quot;,</span>
<span class="term-fg32">+      &quot;type&quot;: &quot;function&quot;</span>
<span class="term-fg32">+    },</span>
<span class="term-fg32">+    {</span>
<span class="term-fg32">+      &quot;inputs&quot;: [</span>
<span class="term-fg32">+        {</span>
<span class="term-fg32">+          &quot;internalType&quot;: &quot;string&quot;,</span>
<span class="term-fg32">+          &quot;name&quot;: &quot;relayUrl&quot;,</span>
<span class="term-fg32">+          &quot;type&quot;: &quot;string&quot;</span>
<span class="term-fg32">+        },</span>
<span class="term-fg32">+        {</span>
<span class="term-fg32">+          &quot;internalType&quot;: &quot;bytes&quot;,</span>
<span class="term-fg32">+          &quot;name&quot;: &quot;builderBid&quot;,</span>
<span class="term-fg32">+          &quot;type&quot;: &quot;bytes&quot;</span>
<span class="term-fg32">+        }</span>
<span class="term-fg32">+      ],</span>
<span class="term-fg32">+      &quot;name&quot;: &quot;submitEthBlockBidToRelay&quot;,</span>
<span class="term-fg32">+      &quot;outputs&quot;: [</span>
<span class="term-fg32">+        {</span>
<span class="term-fg32">+          &quot;internalType&quot;: &quot;bytes&quot;,</span>
<span class="term-fg32">+          &quot;name&quot;: &quot;&quot;,</span>
<span class="term-fg32">+          &quot;type&quot;: &quot;bytes&quot;</span>
<span class="term-fg32">+        }</span>
<span class="term-fg32">+      ],</span>
<span class="term-fg32">+      &quot;stateMutability&quot;: &quot;view&quot;,</span>
<span class="term-fg32">+      &quot;type&quot;: &quot;function&quot;</span>
<span class="term-fg32">+    }</span>
<span class="term-fg32">+  ]`)</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-11413dd4bf54e3c2cfdc2005" role="button"
                   aria-expanded="false" aria-controls="id-11413dd4bf54e3c2cfdc2005">
                    <code>core/vm/evm.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/e501b3b05db8e169f67dc78b7b59bc352b3c638d/core/vm/evm.go" target="_blank">ethereum/go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/core/vm/evm.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+44</span></div>
                        <div class="text-start"><span class="text-danger">-5</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-11413dd4bf54e3c2cfdc2005"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;core&#47;vm&#47;evm.go flashbots&#47;suave-geth&#47;core&#47;vm&#47;evm.go</span>
<span class="term-fg1">index 01017572d178c2111d9728a7938bf9c890d632a3..0b274a12f5e5182d9fa8fbac1d62c532a125d254 100644</span>
<span class="term-fg1">--- ethereum&#47;go-ethereum&#47;core&#47;vm&#47;evm.go</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;core&#47;vm&#47;evm.go</span>
<span class="term-fg36">@@ -41,6 +41,16 @@</span> 	GetHashFunc func(uint64) common.Hash
 )
&nbsp;
 func (evm *EVM) precompile(addr common.Address) (PrecompiledContract, bool) {
<span class="term-fg32">+	&#47;&#47; First check offchain precompiles, only then continue to the regular ones</span>
<span class="term-fg32">+	if evm.chainRules.IsSuave {</span>
<span class="term-fg32">+		if p, ok := PrecompiledContractsSuave[addr]; ok {</span>
<span class="term-fg32">+			if evm.Config.IsOffchain {</span>
<span class="term-fg32">+				runtimeBackend := NewRuntimeSuaveExecutionBackend(evm, addr)</span>
<span class="term-fg32">+				return NewSuavePrecompiledContractWrapper(runtimeBackend, p), true</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+			return p, ok</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
 	var precompiles map[common.Address]PrecompiledContract
 	switch {
 	case evm.chainRules.IsBerlin:
<span class="term-fg36">@@ -119,6 +129,11 @@</span> 	&#47;&#47; callGasTemp holds the gas available for the current call. This is needed because the
 	&#47;&#47; available gas is calculated in gasCall* according to the 63&#47;64 rule and later
 	&#47;&#47; applied in opCall*.
 	callGasTemp uint64
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; Backend for off-chain execution</span>
<span class="term-fg32">+	&#47;&#47; Set only if EVM was instantiated with NewOffchainEVM</span>
<span class="term-fg32">+	&#47;&#47; !!! WILL PANIC IF OFFCHAIN EXECUTION REQUESTED AND THIS IS NOT SET</span>
<span class="term-fg32">+	suaveExecutionBackend *SuaveExecutionBackend</span>
 }
&nbsp;
 &#47;&#47; NewEVM returns a new EVM. The returned EVM is not thread safe and should
<span class="term-fg36">@@ -136,11 +151,30 @@</span> 	evm.interpreter = NewEVMInterpreter(evm)
 	return evm
 }
&nbsp;
<span class="term-fg32">+func NewOffchainEVM(suaveExecutionBackend *SuaveExecutionBackend, blockCtx BlockContext, txCtx TxContext, statedb StateDB, chainConfig *params.ChainConfig, config Config) *EVM {</span>
<span class="term-fg32">+	evm := &amp;EVM{</span>
<span class="term-fg32">+		Context:               blockCtx,</span>
<span class="term-fg32">+		TxContext:             txCtx,</span>
<span class="term-fg32">+		StateDB:               statedb,</span>
<span class="term-fg32">+		Config:                config,</span>
<span class="term-fg32">+		chainConfig:           chainConfig,</span>
<span class="term-fg32">+		chainRules:            chainConfig.Rules(blockCtx.BlockNumber, blockCtx.Random != nil, blockCtx.Time),</span>
<span class="term-fg32">+		suaveExecutionBackend: suaveExecutionBackend,</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	evm.interpreter = NewEVMInterpreter(evm)</span>
<span class="term-fg32">+	return evm</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (evm *EVM) SetConfidentialInput(data []byte) {</span>
<span class="term-fg32">+	evm.suaveExecutionBackend.confidentialInputs = data</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
 &#47;&#47; Reset resets the EVM with a new transaction context.Reset
 &#47;&#47; This is not threadsafe and should only be done very cautiously.
 func (evm *EVM) Reset(txCtx TxContext, statedb StateDB) {
 	evm.TxContext = txCtx
 	evm.StateDB = statedb
<span class="term-fg32">+	evm.suaveExecutionBackend = nil</span>
 }
&nbsp;
 &#47;&#47; Cancel cancels any running EVM operation. This may be called concurrently and
<span class="term-fg36">@@ -232,7 +266,8 @@</span> 			&#47;&#47; If the account has no code, we can abort here
 			&#47;&#47; The depth-check is already done, and precompiles handled above
 			contract := NewContract(caller, AccountRef(addrCopy), value, gas)
 			contract.SetCallCode(&amp;addrCopy, evm.StateDB.GetCodeHash(addrCopy), code)
<span class="term-fg31">-			ret, err = evm.interpreter.Run(contract, input, false)</span>
<span class="term-fg32">+			runtimeBackend := NewRuntimeSuaveExecutionBackend(evm, addrCopy)</span>
<span class="term-fg32">+			ret, err = evm.interpreter.Run(runtimeBackend, contract, input, false)</span>
 			gas = contract.Gas
 		}
 	}
<span class="term-fg36">@@ -289,7 +324,8 @@</span> 		&#47;&#47; Initialise a new contract and set the code that is to be used by the EVM.
 		&#47;&#47; The contract is a scoped environment for this execution context only.
 		contract := NewContract(caller, AccountRef(caller.Address()), value, gas)
 		contract.SetCallCode(&amp;addrCopy, evm.StateDB.GetCodeHash(addrCopy), evm.StateDB.GetCode(addrCopy))
<span class="term-fg31">-		ret, err = evm.interpreter.Run(contract, input, false)</span>
<span class="term-fg32">+		runtimeBackend := NewRuntimeSuaveExecutionBackend(evm, addrCopy)</span>
<span class="term-fg32">+		ret, err = evm.interpreter.Run(runtimeBackend, contract, input, false)</span>
 		gas = contract.Gas
 	}
 	if err != nil {
<span class="term-fg36">@@ -333,7 +369,8 @@</span> 		addrCopy := addr
 		&#47;&#47; Initialise a new contract and make initialise the delegate values
 		contract := NewContract(caller, AccountRef(caller.Address()), nil, gas).AsDelegate()
 		contract.SetCallCode(&amp;addrCopy, evm.StateDB.GetCodeHash(addrCopy), evm.StateDB.GetCode(addrCopy))
<span class="term-fg31">-		ret, err = evm.interpreter.Run(contract, input, false)</span>
<span class="term-fg32">+		runtimeBackend := NewRuntimeSuaveExecutionBackend(evm, addrCopy)</span>
<span class="term-fg32">+		ret, err = evm.interpreter.Run(runtimeBackend, contract, input, false)</span>
 		gas = contract.Gas
 	}
 	if err != nil {
<span class="term-fg36">@@ -389,7 +426,8 @@</span> 		contract.SetCallCode(&amp;addrCopy, evm.StateDB.GetCodeHash(addrCopy), evm.StateDB.GetCode(addrCopy))
 		&#47;&#47; When an error was returned by the EVM or when setting the creation code
 		&#47;&#47; above we revert to the snapshot and consume any gas remaining. Additionally
 		&#47;&#47; when we&#39;re in Homestead this also counts for code storage gas errors.
<span class="term-fg31">-		ret, err = evm.interpreter.Run(contract, input, true)</span>
<span class="term-fg32">+		runtimeBackend := NewRuntimeSuaveExecutionBackend(evm, addrCopy)</span>
<span class="term-fg32">+		ret, err = evm.interpreter.Run(runtimeBackend, contract, input, true)</span>
 		gas = contract.Gas
 	}
 	if err != nil {
<span class="term-fg36">@@ -459,7 +497,8 @@</span> 			evm.Config.Tracer.CaptureEnter(typ, caller.Address(), address, codeAndHash.code, gas, value)
 		}
 	}
&nbsp;
<span class="term-fg31">-	ret, err := evm.interpreter.Run(contract, nil, false)</span>
<span class="term-fg32">+	runtimeBackend := NewRuntimeSuaveExecutionBackend(evm, address)</span>
<span class="term-fg32">+	ret, err := evm.interpreter.Run(runtimeBackend, contract, nil, false)</span>
&nbsp;
 	&#47;&#47; Check whether the max code size has been exceeded, assign err if the case.
 	if err == nil &amp;&amp; evm.chainRules.IsEIP158 &amp;&amp; len(ret) &gt; params.MaxCodeSize {</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-aaacf2bf595e9ecbf2f308bd" role="button"
                   aria-expanded="false" aria-controls="id-aaacf2bf595e9ecbf2f308bd">
                    <code>core/vm/contracts_suave.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/core/vm/contracts_suave.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+276</span></div>
                        <div class="text-start"><span class="text-danger">-0</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-aaacf2bf595e9ecbf2f308bd"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;core&#47;vm&#47;contracts_suave.go flashbots&#47;suave-geth&#47;core&#47;vm&#47;contracts_suave.go</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..0f572bca0b0c43ccfa7afe2e68ece3daea0b9e99</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;core&#47;vm&#47;contracts_suave.go</span>
<span class="term-fg36">@@ -0,0 +1,276 @@</span>
<span class="term-fg32">+package vm</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+import (</span>
<span class="term-fg32">+	&quot;errors&quot;</span>
<span class="term-fg32">+	&quot;fmt&quot;</span>
<span class="term-fg32">+	&quot;strings&quot;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&quot;github.com&#47;google&#47;uuid&quot;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;accounts&#47;abi&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;log&quot;</span>
<span class="term-fg32">+	suave &quot;github.com&#47;ethereum&#47;go-ethereum&#47;suave&#47;core&quot;</span>
<span class="term-fg32">+)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+var (</span>
<span class="term-fg32">+	isOffchainAddress               = common.HexToAddress(&quot;0x42010000&quot;)</span>
<span class="term-fg32">+	errIsOffchainInvalidInputLength = errors.New(&quot;invalid input length&quot;)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	confidentialInputsAddress = common.HexToAddress(&quot;0x42010001&quot;)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	confStoreStoreAddress    = common.HexToAddress(&quot;0x42020000&quot;)</span>
<span class="term-fg32">+	confStoreRetrieveAddress = common.HexToAddress(&quot;0x42020001&quot;)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	newBidAddress    = common.HexToAddress(&quot;0x42030000&quot;)</span>
<span class="term-fg32">+	fetchBidsAddress = common.HexToAddress(&quot;0x42030001&quot;)</span>
<span class="term-fg32">+)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;* General utility precompiles *&#47;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+type isOffchainPrecompile struct{}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (c *isOffchainPrecompile) RequiredGas(input []byte) uint64 {</span>
<span class="term-fg32">+	return 0 &#47;&#47; incurs only the call cost (100)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (c *isOffchainPrecompile) Run(input []byte) ([]byte, error) {</span>
<span class="term-fg32">+	if len(input) == 1 {</span>
<span class="term-fg32">+		&#47;&#47; The precompile was called *directly* off-chain, and the result was cached - return 1</span>
<span class="term-fg32">+		if input[0] == 0x01 {</span>
<span class="term-fg32">+			return []byte{0x01}, nil</span>
<span class="term-fg32">+		} else {</span>
<span class="term-fg32">+			return nil, errors.New(&quot;incorrect value passed in&quot;)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	if len(input) &gt; 1 {</span>
<span class="term-fg32">+		return nil, errIsOffchainInvalidInputLength</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	return []byte{0x00}, nil</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (c *isOffchainPrecompile) RunOffchain(backend *SuaveExecutionBackend, input []byte) ([]byte, error) {</span>
<span class="term-fg32">+	if len(input) != 0 {</span>
<span class="term-fg32">+		return nil, errIsOffchainInvalidInputLength</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	return []byte{0x01}, nil</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+type confidentialInputsPrecompile struct{}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (c *confidentialInputsPrecompile) RequiredGas(input []byte) uint64 {</span>
<span class="term-fg32">+	return 0 &#47;&#47; incurs only the call cost (100)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (c *confidentialInputsPrecompile) Run(input []byte) ([]byte, error) {</span>
<span class="term-fg32">+	return nil, errors.New(&quot;not available in this context&quot;)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (c *confidentialInputsPrecompile) RunOffchain(backend *SuaveExecutionBackend, input []byte) ([]byte, error) {</span>
<span class="term-fg32">+	return backend.confidentialInputs, nil</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;* Confidential store precompiles *&#47;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+type confStoreStore struct {</span>
<span class="term-fg32">+	inoutAbi abi.Method</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func newConfStoreStore() *confStoreStore {</span>
<span class="term-fg32">+	inoutAbi := mustParseMethodAbi(`[{&quot;inputs&quot;:[{&quot;type&quot;:&quot;bytes16&quot;}, {&quot;type&quot;:&quot;string&quot;}, {&quot;type&quot;:&quot;bytes&quot;}],&quot;name&quot;:&quot;store&quot;,&quot;outputs&quot;:[],&quot;stateMutability&quot;:&quot;nonpayable&quot;,&quot;type&quot;:&quot;function&quot;}]`, &quot;store&quot;)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	return &amp;confStoreStore{inoutAbi}</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (c *confStoreStore) RequiredGas(input []byte) uint64 {</span>
<span class="term-fg32">+	return uint64(100 * len(input))</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (c *confStoreStore) Run(input []byte) ([]byte, error) {</span>
<span class="term-fg32">+	return nil, errors.New(&quot;not available in this context&quot;)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (c *confStoreStore) RunOffchain(backend *SuaveExecutionBackend, input []byte) ([]byte, error) {</span>
<span class="term-fg32">+	if len(backend.callerStack) == 0 {</span>
<span class="term-fg32">+		return []byte(&quot;not allowed&quot;), errors.New(&quot;not allowed in this context&quot;)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	unpacked, err := c.inoutAbi.Inputs.Unpack(input)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return []byte(err.Error()), err</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	bidId := unpacked[0].([16]byte)</span>
<span class="term-fg32">+	key := unpacked[1].(string)</span>
<span class="term-fg32">+	data := unpacked[2].([]byte)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; Can be zeroes in some fringe cases!</span>
<span class="term-fg32">+	var caller common.Address</span>
<span class="term-fg32">+	for i := len(backend.callerStack) - 1; i &gt;= 0; i-- {</span>
<span class="term-fg32">+		&#47;&#47; Most recent non-nil non-this caller</span>
<span class="term-fg32">+		if _c := backend.callerStack[i]; _c != nil &amp;&amp; *_c != confStoreStoreAddress {</span>
<span class="term-fg32">+			caller = *_c</span>
<span class="term-fg32">+			break</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	_, err = backend.ConfiendialStoreBackend.Store(bidId, caller, key, data)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return []byte(err.Error()), err</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	return nil, nil</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+type confStoreRetrieve struct {</span>
<span class="term-fg32">+	inoutAbi abi.Method</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func newConfStoreRetrieve() *confStoreRetrieve {</span>
<span class="term-fg32">+	inoutAbi := mustParseMethodAbi(`[{&quot;inputs&quot;:[{&quot;type&quot;:&quot;bytes16&quot;}, {&quot;type&quot;:&quot;string&quot;}],&quot;name&quot;:&quot;retrieve&quot;,&quot;outputs&quot;:[{&quot;type&quot;:&quot;bytes&quot;}],&quot;stateMutability&quot;:&quot;nonpayable&quot;,&quot;type&quot;:&quot;function&quot;}]`, &quot;retrieve&quot;)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	return &amp;confStoreRetrieve{inoutAbi}</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (c *confStoreRetrieve) RequiredGas(input []byte) uint64 {</span>
<span class="term-fg32">+	return 100</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (c *confStoreRetrieve) Run(input []byte) ([]byte, error) {</span>
<span class="term-fg32">+	return nil, errors.New(&quot;not available in this context&quot;)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (c *confStoreRetrieve) RunOffchain(backend *SuaveExecutionBackend, input []byte) ([]byte, error) {</span>
<span class="term-fg32">+	if len(backend.callerStack) == 0 {</span>
<span class="term-fg32">+		return []byte(&quot;not allowed&quot;), errors.New(&quot;not allowed in this context&quot;)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	unpacked, err := c.inoutAbi.Inputs.Unpack(input)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return []byte(err.Error()), err</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	bidId := unpacked[0].([16]byte)</span>
<span class="term-fg32">+	key := unpacked[1].(string)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	log.Info(&quot;confStoreRetrieve&quot;, &quot;bidId&quot;, bidId, &quot;key&quot;, key)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; Can be zeroes in some fringe cases!</span>
<span class="term-fg32">+	var caller common.Address</span>
<span class="term-fg32">+	for i := len(backend.callerStack) - 1; i &gt;= 0; i-- {</span>
<span class="term-fg32">+		&#47;&#47; Most recent non-nil non-this caller</span>
<span class="term-fg32">+		if _c := backend.callerStack[i]; _c != nil &amp;&amp; *_c != confStoreRetrieveAddress {</span>
<span class="term-fg32">+			caller = *_c</span>
<span class="term-fg32">+			break</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	data, err := backend.ConfiendialStoreBackend.Retrieve(bidId, caller, key)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return []byte(err.Error()), err</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	return data, nil</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;* Bid precompiles *&#47;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+type newBid struct {</span>
<span class="term-fg32">+	inoutAbi abi.Method</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func newNewBid() *newBid {</span>
<span class="term-fg32">+	inoutAbi := mustParseMethodAbi(`[{ &quot;inputs&quot;: [ { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;decryptionCondition&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address[]&quot;, &quot;name&quot;: &quot;allowedPeekers&quot;, &quot;type&quot;: &quot;address[]&quot; }, { &quot;internalType&quot;: &quot;string&quot;, &quot;name&quot;: &quot;BidType&quot;, &quot;type&quot;: &quot;string&quot; } ], &quot;name&quot;: &quot;newBid&quot;, &quot;outputs&quot;: [ { &quot;components&quot;: [ { &quot;internalType&quot;: &quot;Suave.BidId&quot;, &quot;name&quot;: &quot;id&quot;, &quot;type&quot;: &quot;bytes16&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;decryptionCondition&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address[]&quot;, &quot;name&quot;: &quot;allowedPeekers&quot;, &quot;type&quot;: &quot;address[]&quot; } ], &quot;internalType&quot;: &quot;struct Suave.Bid&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;tuple&quot; } ], &quot;stateMutability&quot;: &quot;view&quot;, &quot;type&quot;: &quot;function&quot; }]`, &quot;newBid&quot;)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	return &amp;newBid{inoutAbi}</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (c *newBid) RequiredGas(input []byte) uint64 {</span>
<span class="term-fg32">+	return 1000</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (c *newBid) Run(input []byte) ([]byte, error) {</span>
<span class="term-fg32">+	return input, nil</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (c *newBid) RunOffchain(backend *SuaveExecutionBackend, input []byte) ([]byte, error) {</span>
<span class="term-fg32">+	unpacked, err := c.inoutAbi.Inputs.Unpack(input)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return []byte(err.Error()), err</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	version := unpacked[2].(string)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	decryptionCondition := unpacked[0].(uint64)</span>
<span class="term-fg32">+	allowedPeekers := unpacked[1].([]common.Address)</span>
<span class="term-fg32">+	bid := suave.Bid{</span>
<span class="term-fg32">+		Id:                  suave.BidId(uuid.New()),</span>
<span class="term-fg32">+		DecryptionCondition: decryptionCondition,</span>
<span class="term-fg32">+		AllowedPeekers:      allowedPeekers,</span>
<span class="term-fg32">+		Version:             version, &#47;&#47; TODO : make generic</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	bid, err = backend.ConfiendialStoreBackend.Initialize(bid, &quot;&quot;, nil)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return []byte(err.Error()), err</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	err = backend.MempoolBackend.SubmitBid(bid)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return []byte(err.Error()), err</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	return c.inoutAbi.Outputs.Pack(bid)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+type fetchBids struct {</span>
<span class="term-fg32">+	inoutAbi abi.Method</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func newFetchBids() *fetchBids {</span>
<span class="term-fg32">+	inoutAbi := mustParseMethodAbi(`[ { &quot;inputs&quot;: [ { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;cond&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;string&quot;, &quot;name&quot;: &quot;namespace&quot;, &quot;type&quot;: &quot;string&quot; } ], &quot;name&quot;: &quot;fetchBids&quot;, &quot;outputs&quot;: [ { &quot;components&quot;: [ { &quot;internalType&quot;: &quot;Suave.BidId&quot;, &quot;name&quot;: &quot;id&quot;, &quot;type&quot;: &quot;bytes16&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;decryptionCondition&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address[]&quot;, &quot;name&quot;: &quot;allowedPeekers&quot;, &quot;type&quot;: &quot;address[]&quot; }, { &quot;internalType&quot;: &quot;string&quot;, &quot;name&quot;: &quot;version&quot;, &quot;type&quot;: &quot;string&quot; } ], &quot;internalType&quot;: &quot;struct Suave.Bid[]&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;tuple[]&quot; } ], &quot;stateMutability&quot;: &quot;view&quot;, &quot;type&quot;: &quot;function&quot; } ]`, &quot;fetchBids&quot;)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	return &amp;fetchBids{inoutAbi}</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (c *fetchBids) RequiredGas(input []byte) uint64 {</span>
<span class="term-fg32">+	return 1000</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (c *fetchBids) Run(input []byte) ([]byte, error) {</span>
<span class="term-fg32">+	return input, nil</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (c *fetchBids) RunOffchain(backend *SuaveExecutionBackend, input []byte) ([]byte, error) {</span>
<span class="term-fg32">+	unpacked, err := c.inoutAbi.Inputs.Unpack(input)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return []byte(err.Error()), err</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	targetBlock := unpacked[0].(uint64)</span>
<span class="term-fg32">+	namespace := unpacked[1].(string)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	bids := backend.MempoolBackend.FetchBidsByProtocolAndBlock(targetBlock, namespace)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	return c.inoutAbi.Outputs.Pack(bids)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func mustParseAbi(data string) abi.ABI {</span>
<span class="term-fg32">+	inoutAbi, err := abi.JSON(strings.NewReader(data))</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		panic(err.Error())</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	return inoutAbi</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func mustParseMethodAbi(data string, method string) abi.Method {</span>
<span class="term-fg32">+	inoutAbi := mustParseAbi(data)</span>
<span class="term-fg32">+	return inoutAbi.Methods[method]</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func formatPeekerError(format string, args ...any) ([]byte, error) {</span>
<span class="term-fg32">+	err := fmt.Errorf(format, args...)</span>
<span class="term-fg32">+	return []byte(err.Error()), err</span>
<span class="term-fg32">+}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-e079d16cfc442010ec7b598e" role="button"
                   aria-expanded="false" aria-controls="id-e079d16cfc442010ec7b598e">
                    <code>core/vm/suave.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/core/vm/suave.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+46</span></div>
                        <div class="text-start"><span class="text-danger">-0</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-e079d16cfc442010ec7b598e"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;core&#47;vm&#47;suave.go flashbots&#47;suave-geth&#47;core&#47;vm&#47;suave.go</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..6e10430bd69420f0c9358a30d436ba061a9d9ccc</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;core&#47;vm&#47;suave.go</span>
<span class="term-fg36">@@ -0,0 +1,46 @@</span>
<span class="term-fg32">+package vm</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+import (</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&quot;</span>
<span class="term-fg32">+	suave &quot;github.com&#47;ethereum&#47;go-ethereum&#47;suave&#47;core&quot;</span>
<span class="term-fg32">+)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+type SuaveExecutionBackend struct {</span>
<span class="term-fg32">+	ConfiendialStoreBackend suave.ConfiendialStoreBackend</span>
<span class="term-fg32">+	MempoolBackend          suave.MempoolBackend</span>
<span class="term-fg32">+	OffchainEthBackend      suave.OffchainEthBackend</span>
<span class="term-fg32">+	confidentialInputs      []byte</span>
<span class="term-fg32">+	callerStack             []*common.Address</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func NewRuntimeSuaveExecutionBackend(evm *EVM, caller common.Address) *SuaveExecutionBackend {</span>
<span class="term-fg32">+	if !evm.Config.IsOffchain {</span>
<span class="term-fg32">+		return nil</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	return &amp;SuaveExecutionBackend{</span>
<span class="term-fg32">+		ConfiendialStoreBackend: evm.suaveExecutionBackend.ConfiendialStoreBackend,</span>
<span class="term-fg32">+		MempoolBackend:          evm.suaveExecutionBackend.MempoolBackend,</span>
<span class="term-fg32">+		OffchainEthBackend:      evm.suaveExecutionBackend.OffchainEthBackend,</span>
<span class="term-fg32">+		confidentialInputs:      evm.suaveExecutionBackend.confidentialInputs,</span>
<span class="term-fg32">+		callerStack:             append(evm.suaveExecutionBackend.callerStack, &amp;caller),</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; Implements PrecompiledContract for Offchain smart contracts</span>
<span class="term-fg32">+type SuavePrecompiledContractWrapper struct {</span>
<span class="term-fg32">+	backend  *SuaveExecutionBackend</span>
<span class="term-fg32">+	contract SuavePrecompiledContract</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func NewSuavePrecompiledContractWrapper(backend *SuaveExecutionBackend, contract SuavePrecompiledContract) *SuavePrecompiledContractWrapper {</span>
<span class="term-fg32">+	return &amp;SuavePrecompiledContractWrapper{backend: backend, contract: contract}</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (p *SuavePrecompiledContractWrapper) RequiredGas(input []byte) uint64 {</span>
<span class="term-fg32">+	return p.contract.RequiredGas(input)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (p *SuavePrecompiledContractWrapper) Run(input []byte) ([]byte, error) {</span>
<span class="term-fg32">+	return p.contract.RunOffchain(p.backend, input)</span>
<span class="term-fg32">+}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-b3cf7251ec1ded369e8ac7e3" role="button"
                   aria-expanded="false" aria-controls="id-b3cf7251ec1ded369e8ac7e3">
                    <code>core/vm/contracts_suave_eth.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/core/vm/contracts_suave_eth.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+436</span></div>
                        <div class="text-start"><span class="text-danger">-0</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-b3cf7251ec1ded369e8ac7e3"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;core&#47;vm&#47;contracts_suave_eth.go flashbots&#47;suave-geth&#47;core&#47;vm&#47;contracts_suave_eth.go</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..79bb5f4ccd137c572d1915a8025b1011d3fced9f</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;core&#47;vm&#47;contracts_suave_eth.go</span>
<span class="term-fg36">@@ -0,0 +1,436 @@</span>
<span class="term-fg32">+package vm</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+import (</span>
<span class="term-fg32">+	&quot;bytes&quot;</span>
<span class="term-fg32">+	&quot;context&quot;</span>
<span class="term-fg32">+	&quot;encoding&#47;json&quot;</span>
<span class="term-fg32">+	&quot;io&quot;</span>
<span class="term-fg32">+	&quot;math&#47;big&quot;</span>
<span class="term-fg32">+	&quot;net&#47;http&quot;</span>
<span class="term-fg32">+	&quot;time&quot;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;beacon&#47;engine&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;core&#47;types&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;log&quot;</span>
<span class="term-fg32">+	suave &quot;github.com&#47;ethereum&#47;go-ethereum&#47;suave&#47;core&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;flashbots&#47;go-boost-utils&#47;bls&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;flashbots&#47;go-boost-utils&#47;ssz&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;holiman&#47;uint256&quot;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	builderCapella &quot;github.com&#47;attestantio&#47;go-builder-client&#47;api&#47;capella&quot;</span>
<span class="term-fg32">+	builderV1 &quot;github.com&#47;attestantio&#47;go-builder-client&#47;api&#47;v1&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;attestantio&#47;go-eth2-client&#47;spec&#47;bellatrix&quot;</span>
<span class="term-fg32">+	specCapella &quot;github.com&#47;attestantio&#47;go-eth2-client&#47;spec&#47;capella&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;attestantio&#47;go-eth2-client&#47;spec&#47;phase0&quot;</span>
<span class="term-fg32">+	boostTypes &quot;github.com&#47;flashbots&#47;go-boost-utils&#47;types&quot;</span>
<span class="term-fg32">+	boostUtils &quot;github.com&#47;flashbots&#47;go-boost-utils&#47;utils&quot;</span>
<span class="term-fg32">+)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+var (</span>
<span class="term-fg32">+	simulateBundleAddress           = common.HexToAddress(&quot;0x42100000&quot;)</span>
<span class="term-fg32">+	extractHintAddress              = common.HexToAddress(&quot;0x42100037&quot;)</span>
<span class="term-fg32">+	buildEthBlockAddress            = common.HexToAddress(&quot;0x42100001&quot;)</span>
<span class="term-fg32">+	submitEthBlockBidToRelayAddress = common.HexToAddress(&quot;0x42100002&quot;)</span>
<span class="term-fg32">+)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+type simulateBundle struct {</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (c *simulateBundle) RequiredGas(input []byte) uint64 {</span>
<span class="term-fg32">+	&#47;&#47; Should be proportional to bundle gas limit</span>
<span class="term-fg32">+	return 10000</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (c *simulateBundle) Run(input []byte) ([]byte, error) {</span>
<span class="term-fg32">+	return input, nil</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (c *simulateBundle) RunOffchain(backend *SuaveExecutionBackend, input []byte) ([]byte, error) {</span>
<span class="term-fg32">+	bundle := struct {</span>
<span class="term-fg32">+		Txs             types.Transactions `json:&quot;txs&quot;`</span>
<span class="term-fg32">+		RevertingHashes []common.Hash      `json:&quot;revertingHashes&quot;`</span>
<span class="term-fg32">+	}{}</span>
<span class="term-fg32">+	err := json.Unmarshal(input, &amp;bundle)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return formatPeekerError(&quot;could not unmarshal bundle: %w&quot;, err)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	ctx, cancel := context.WithDeadline(context.Background(), time.Now().Add(time.Second))</span>
<span class="term-fg32">+	defer cancel()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	envelope, err := backend.OffchainEthBackend.BuildEthBlock(ctx, nil, bundle.Txs)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return formatPeekerError(&quot;could not build eth block for bundle simulation: %w&quot;, err)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	if envelope.ExecutionPayload.GasUsed == 0 {</span>
<span class="term-fg32">+		return formatPeekerError(&quot;transaction not applied correctly: %v&quot;, envelope)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	egp := new(big.Int).Div(envelope.BlockValue, big.NewInt(int64(envelope.ExecutionPayload.GasUsed)))</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; Return the EGP</span>
<span class="term-fg32">+	egpBytes, err := precompilesAbi.Methods[&quot;simulateBundle&quot;].Outputs.Pack(egp.Uint64())</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return formatPeekerError(&quot;could not pack egp %v: %w&quot;, egp, err)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	return egpBytes, nil</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+type extractHint struct{}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (c *extractHint) RequiredGas(input []byte) uint64 {</span>
<span class="term-fg32">+	return 10000</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (c *extractHint) Run(input []byte) ([]byte, error) {</span>
<span class="term-fg32">+	return input, nil</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (c *extractHint) RunOffchain(backend *SuaveExecutionBackend, input []byte) ([]byte, error) {</span>
<span class="term-fg32">+	unpacked, err := precompilesAbi.Methods[&quot;extractHint&quot;].Inputs.Unpack(input)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return []byte(err.Error()), err</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	bundleBytes := unpacked[0].([]byte)</span>
<span class="term-fg32">+	bundle := struct {</span>
<span class="term-fg32">+		Txs             types.Transactions `json:&quot;txs&quot;`</span>
<span class="term-fg32">+		RevertingHashes []common.Hash      `json:&quot;revertingHashes&quot;`</span>
<span class="term-fg32">+		RefundPercent   int                `json:&quot;percent&quot;`</span>
<span class="term-fg32">+		MatchId         [16]byte           `json:&quot;MatchId&quot;`</span>
<span class="term-fg32">+	}{}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	err = json.Unmarshal(bundleBytes, &amp;bundle)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return []byte(err.Error()), err</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	tx := bundle.Txs[0]</span>
<span class="term-fg32">+	hint := struct {</span>
<span class="term-fg32">+		To   common.Address</span>
<span class="term-fg32">+		Data []byte</span>
<span class="term-fg32">+	}{</span>
<span class="term-fg32">+		To:   *tx.To(),</span>
<span class="term-fg32">+		Data: tx.Data(),</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	hintBytes, err := json.Marshal(hint)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return []byte(err.Error()), err</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	return hintBytes, nil</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+type buildEthBlock struct {</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (c *buildEthBlock) RequiredGas(input []byte) uint64 {</span>
<span class="term-fg32">+	&#47;&#47; Should be proportional to bundle gas limit</span>
<span class="term-fg32">+	return 10000</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (c *buildEthBlock) Run(input []byte) ([]byte, error) {</span>
<span class="term-fg32">+	return input, nil</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (c *buildEthBlock) RunOffchain(backend *SuaveExecutionBackend, input []byte) ([]byte, error) {</span>
<span class="term-fg32">+	unpacked, err := precompilesAbi.Methods[&quot;buildEthBlock&quot;].Inputs.Unpack(input)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return formatPeekerError(&quot;could not unpack inputs: %w&quot;, err)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; blockArgs := unpacked[0].(types.BuildBlockArgs)</span>
<span class="term-fg32">+	blockArgsRaw := unpacked[0].(struct {</span>
<span class="term-fg32">+		Slot           uint64         &quot;json:\&quot;slot\&quot;&quot;</span>
<span class="term-fg32">+		ProposerPubkey []uint8        &quot;json:\&quot;proposerPubkey\&quot;&quot;</span>
<span class="term-fg32">+		Parent         [32]uint8      &quot;json:\&quot;parent\&quot;&quot;</span>
<span class="term-fg32">+		Timestamp      uint64         &quot;json:\&quot;timestamp\&quot;&quot;</span>
<span class="term-fg32">+		FeeRecipient   common.Address &quot;json:\&quot;feeRecipient\&quot;&quot;</span>
<span class="term-fg32">+		GasLimit       uint64         &quot;json:\&quot;gasLimit\&quot;&quot;</span>
<span class="term-fg32">+		Random         [32]uint8      &quot;json:\&quot;random\&quot;&quot;</span>
<span class="term-fg32">+		Withdrawals    []struct {</span>
<span class="term-fg32">+			Index     uint64         &quot;json:\&quot;index\&quot;&quot;</span>
<span class="term-fg32">+			Validator uint64         &quot;json:\&quot;validator\&quot;&quot;</span>
<span class="term-fg32">+			Address   common.Address &quot;json:\&quot;Address\&quot;&quot;</span>
<span class="term-fg32">+			Amount    uint64         &quot;json:\&quot;amount\&quot;&quot;</span>
<span class="term-fg32">+		} &quot;json:\&quot;withdrawals\&quot;&quot;</span>
<span class="term-fg32">+	})</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	blockArgs := types.BuildBlockArgs{</span>
<span class="term-fg32">+		Parent:       blockArgsRaw.Parent,</span>
<span class="term-fg32">+		Timestamp:    blockArgsRaw.Timestamp,</span>
<span class="term-fg32">+		FeeRecipient: blockArgsRaw.FeeRecipient,</span>
<span class="term-fg32">+		GasLimit:     blockArgsRaw.GasLimit,</span>
<span class="term-fg32">+		Random:       blockArgsRaw.Random,</span>
<span class="term-fg32">+		Withdrawals:  types.Withdrawals{},</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	for _, w := range blockArgsRaw.Withdrawals {</span>
<span class="term-fg32">+		blockArgs.Withdrawals = append(blockArgs.Withdrawals, &amp;types.Withdrawal{</span>
<span class="term-fg32">+			Index:     w.Index,</span>
<span class="term-fg32">+			Validator: w.Validator,</span>
<span class="term-fg32">+			Address:   w.Address,</span>
<span class="term-fg32">+			Amount:    w.Amount,</span>
<span class="term-fg32">+		})</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	inputBidId := unpacked[1].(suave.BidId)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	bidIds := []suave.BidId{}</span>
<span class="term-fg32">+	&#47;&#47; first check for merged bid, else assume regular bid</span>
<span class="term-fg32">+	if mergedBidsBytes, err := backend.ConfiendialStoreBackend.Retrieve(inputBidId, buildEthBlockAddress, &quot;default:v0:mergedBids&quot;); err == nil {</span>
<span class="term-fg32">+		unpacked, err := bidIdsAbi.Inputs.Unpack(mergedBidsBytes)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		if err != nil {</span>
<span class="term-fg32">+			return formatPeekerError(&quot;could not unpack merged bid ids: %w&quot;, err)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		log.Info(&quot;x&quot;, &quot;x&quot;, unpacked, &quot;x&quot;, mergedBidsBytes)</span>
<span class="term-fg32">+		bidIds = unpacked[0].([]suave.BidId)</span>
<span class="term-fg32">+	} else {</span>
<span class="term-fg32">+		bidIds = append(bidIds, inputBidId)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	var bidsToMerge = make([]suave.Bid, len(bidIds))</span>
<span class="term-fg32">+	for i, bidId := range bidIds {</span>
<span class="term-fg32">+		bidsToMerge[i], err = backend.MempoolBackend.FetchBidById(bidId)</span>
<span class="term-fg32">+		if err != nil {</span>
<span class="term-fg32">+			return formatPeekerError(&quot;could not fetch bid id %v: %w&quot;, bidId, err)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	var mergedBundles []types.SBundle</span>
<span class="term-fg32">+	for _, bid := range bidsToMerge {</span>
<span class="term-fg32">+		switch bid.Version {</span>
<span class="term-fg32">+		case &quot;mevshare:v0:matchBids&quot;:</span>
<span class="term-fg32">+			&#47;&#47; fetch the matched ids and merge the bundle</span>
<span class="term-fg32">+			matchedBundleIdsBytes, err := backend.ConfiendialStoreBackend.Retrieve(bid.Id, buildEthBlockAddress, &quot;mevshare:v0:mergedBids&quot;)</span>
<span class="term-fg32">+			if err != nil {</span>
<span class="term-fg32">+				return formatPeekerError(&quot;could not retrieve bid ids data for bid %v, from cdas: %w&quot;, bid, err)</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+			unpackedBidIds, err := bidIdsAbi.Inputs.Unpack(matchedBundleIdsBytes)</span>
<span class="term-fg32">+			if err != nil {</span>
<span class="term-fg32">+				return formatPeekerError(&quot;could not unpack bid ids data for bid %v, from cdas: %w&quot;, bid, err)</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+			matchBidIds := unpackedBidIds[0].([]suave.BidId)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+			userBundleBytes, err := backend.ConfiendialStoreBackend.Retrieve(matchBidIds[0], buildEthBlockAddress, &quot;mevshare:v0:ethBundles&quot;)</span>
<span class="term-fg32">+			if err != nil {</span>
<span class="term-fg32">+				return formatPeekerError(&quot;could not retrieve bundle data for bidId %v: %w&quot;, matchBidIds[0], err)</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+			var userBundle types.SBundle</span>
<span class="term-fg32">+			if err := json.Unmarshal(userBundleBytes, &amp;userBundle); err != nil {</span>
<span class="term-fg32">+				return formatPeekerError(&quot;could not unmarshal user bundle data for bidId %v: %w&quot;, matchBidIds[0], err)</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+			matchBundleBytes, err := backend.ConfiendialStoreBackend.Retrieve(matchBidIds[1], buildEthBlockAddress, &quot;mevshare:v0:ethBundles&quot;)</span>
<span class="term-fg32">+			if err != nil {</span>
<span class="term-fg32">+				return formatPeekerError(&quot;could not retrieve match bundle data for bidId %v: %w&quot;, matchBidIds[1], err)</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+			var matchBundle types.SBundle</span>
<span class="term-fg32">+			if err := json.Unmarshal(matchBundleBytes, &amp;matchBundle); err != nil {</span>
<span class="term-fg32">+				return formatPeekerError(&quot;could not unmarshal match bundle data for bidId %v: %w&quot;, matchBidIds[1], err)</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+			userBundle.Txs = append(userBundle.Txs, matchBundle.Txs...)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+			mergedBundles = append(mergedBundles, userBundle)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		case &quot;mevshare:v0:unmatchedBundles&quot;:</span>
<span class="term-fg32">+			bundleBytes, err := backend.ConfiendialStoreBackend.Retrieve(bid.Id, buildEthBlockAddress, &quot;mevshare:v0:ethBundles&quot;)</span>
<span class="term-fg32">+			if err != nil {</span>
<span class="term-fg32">+				return formatPeekerError(&quot;could not retrieve bundle data for bidId %v, from cdas: %w&quot;, bid.Id, err)</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+			var bundle types.SBundle</span>
<span class="term-fg32">+			if err := json.Unmarshal(bundleBytes, &amp;bundle); err != nil {</span>
<span class="term-fg32">+				return formatPeekerError(&quot;could not unmarshal bundle data for bidId %v, from cdas: %w&quot;, bid.Id, err)</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+			mergedBundles = append(mergedBundles, bundle)</span>
<span class="term-fg32">+		case &quot;default:v0:ethBundles&quot;:</span>
<span class="term-fg32">+			bundleBytes, err := backend.ConfiendialStoreBackend.Retrieve(bid.Id, buildEthBlockAddress, &quot;default:v0:ethBundles&quot;)</span>
<span class="term-fg32">+			if err != nil {</span>
<span class="term-fg32">+				return formatPeekerError(&quot;could not retrieve bundle data for bidId %v, from cdas: %w&quot;, bid.Id, err)</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+			var bundle types.SBundle</span>
<span class="term-fg32">+			if err := json.Unmarshal(bundleBytes, &amp;bundle); err != nil {</span>
<span class="term-fg32">+				return formatPeekerError(&quot;could not unmarshal bundle data for bidId %v, from cdas: %w&quot;, bid.Id, err)</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+			mergedBundles = append(mergedBundles, bundle)</span>
<span class="term-fg32">+		default:</span>
<span class="term-fg32">+			return formatPeekerError(&quot;unknown bid version %s&quot;, bid.Version)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	log.Info(&quot;requesting a block be built&quot;, &quot;mergedBundles&quot;, mergedBundles)</span>
<span class="term-fg32">+	envelope, err := backend.OffchainEthBackend.BuildEthBlockFromBundles(context.TODO(), &amp;blockArgs, mergedBundles)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return formatPeekerError(&quot;could not build eth block: %w&quot;, err)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	log.Info(&quot;built block from bundles&quot;, &quot;payload&quot;, *envelope.ExecutionPayload)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	payload, err := executableDataToCapellaExecutionPayload(envelope.ExecutionPayload)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return formatPeekerError(&quot;could not format execution payload as capella payload: %w&quot;, err)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; really should not be generated here</span>
<span class="term-fg32">+	blsSk, blsPk, err := bls.GenerateNewKeypair()</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return formatPeekerError(&quot;could not generate new bls key pair: %w&quot;, err)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	pk, err := boostUtils.BlsPublicKeyToPublicKey(blsPk)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return formatPeekerError(&quot;could not format bls pubkey as bytes: %w&quot;, err)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	value, overflow := uint256.FromBig(envelope.BlockValue)</span>
<span class="term-fg32">+	if overflow {</span>
<span class="term-fg32">+		return formatPeekerError(&quot;block value %v overflows&quot;, *envelope.BlockValue)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	var proposerPubkey [48]byte</span>
<span class="term-fg32">+	copy(proposerPubkey[:], blockArgsRaw.ProposerPubkey)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	blockBidMsg := builderV1.BidTrace{</span>
<span class="term-fg32">+		Slot:                 blockArgsRaw.Slot,</span>
<span class="term-fg32">+		ParentHash:           payload.ParentHash,</span>
<span class="term-fg32">+		BlockHash:            payload.BlockHash,</span>
<span class="term-fg32">+		BuilderPubkey:        pk,</span>
<span class="term-fg32">+		ProposerPubkey:       phase0.BLSPubKey(proposerPubkey),</span>
<span class="term-fg32">+		ProposerFeeRecipient: bellatrix.ExecutionAddress(blockArgsRaw.FeeRecipient),</span>
<span class="term-fg32">+		GasLimit:             envelope.ExecutionPayload.GasLimit,</span>
<span class="term-fg32">+		GasUsed:              envelope.ExecutionPayload.GasUsed,</span>
<span class="term-fg32">+		Value:                value,</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; hardcoded for goerli, should be passed in with the inputs</span>
<span class="term-fg32">+	genesisForkVersion := phase0.Version{0x00, 0x00, 0x10, 0x20}</span>
<span class="term-fg32">+	builderSigningDomain := ssz.ComputeDomain(ssz.DomainTypeAppBuilder, genesisForkVersion, phase0.Root{})</span>
<span class="term-fg32">+	signature, err := ssz.SignMessage(&amp;blockBidMsg, builderSigningDomain, blsSk)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return formatPeekerError(&quot;could not sign builder bid: %w&quot;, err)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	bidRequest := builderCapella.SubmitBlockRequest{</span>
<span class="term-fg32">+		Message:          &amp;blockBidMsg,</span>
<span class="term-fg32">+		ExecutionPayload: payload,</span>
<span class="term-fg32">+		Signature:        signature,</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	bidBytes, err := bidRequest.MarshalJSON()</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return formatPeekerError(&quot;could not marshal builder bid request: %w&quot;, err)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	envelopeBytes, err := json.Marshal(envelope)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return formatPeekerError(&quot;could not marshal payload envelope: %w&quot;, err)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	return precompilesAbi.Methods[&quot;buildEthBlock&quot;].Outputs.Pack(bidBytes, envelopeBytes)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+type submitEthBlockBidToRelay struct {</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (c *submitEthBlockBidToRelay) RequiredGas(input []byte) uint64 {</span>
<span class="term-fg32">+	return 1000</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (c *submitEthBlockBidToRelay) Run(input []byte) ([]byte, error) {</span>
<span class="term-fg32">+	return input, nil</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (c *submitEthBlockBidToRelay) RunOffchain(backend *SuaveExecutionBackend, input []byte) ([]byte, error) {</span>
<span class="term-fg32">+	unpacked, err := precompilesAbi.Methods[&quot;submitEthBlockBidToRelay&quot;].Inputs.Unpack(input)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return formatPeekerError(&quot;could not unpack inputs: %w&quot;, err)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	relayUrl := unpacked[0].(string)</span>
<span class="term-fg32">+	builderBidJson := unpacked[1].([]byte)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	ctx, cancel := context.WithDeadline(context.Background(), time.Now().Add(3*time.Second))</span>
<span class="term-fg32">+	defer cancel()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	endpoint := relayUrl + &quot;&#47;relay&#47;v1&#47;builder&#47;blocks&quot;</span>
<span class="term-fg32">+	req, err := http.NewRequestWithContext(ctx, http.MethodPost, endpoint, bytes.NewReader(builderBidJson))</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return formatPeekerError(&quot;could not prepare request to relay: %w&quot;, err)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	req.Header.Add(&quot;Content-Type&quot;, &quot;application&#47;json&quot;)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; Execute request</span>
<span class="term-fg32">+	resp, err := http.DefaultClient.Do(req)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return formatPeekerError(&quot;could not send request to relay: %w&quot;, err)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	defer resp.Body.Close()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	if resp.StatusCode == http.StatusNoContent {</span>
<span class="term-fg32">+		return nil, nil</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	if resp.StatusCode &gt; 299 {</span>
<span class="term-fg32">+		bodyBytes, err := io.ReadAll(resp.Body)</span>
<span class="term-fg32">+		if err != nil {</span>
<span class="term-fg32">+			return formatPeekerError(&quot;could not read error response body for status code %d: %w&quot;, resp.StatusCode, err)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		return formatPeekerError(&quot;relay request failed with code %d: %s&quot;, resp.StatusCode, string(bodyBytes))</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	return nil, nil</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func executableDataToCapellaExecutionPayload(data *engine.ExecutableData) (*specCapella.ExecutionPayload, error) {</span>
<span class="term-fg32">+	transactionData := make([]bellatrix.Transaction, len(data.Transactions))</span>
<span class="term-fg32">+	for i, tx := range data.Transactions {</span>
<span class="term-fg32">+		transactionData[i] = bellatrix.Transaction(tx)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	withdrawalData := make([]*specCapella.Withdrawal, len(data.Withdrawals))</span>
<span class="term-fg32">+	for i, wd := range data.Withdrawals {</span>
<span class="term-fg32">+		withdrawalData[i] = &amp;specCapella.Withdrawal{</span>
<span class="term-fg32">+			Index:          specCapella.WithdrawalIndex(wd.Index),</span>
<span class="term-fg32">+			ValidatorIndex: phase0.ValidatorIndex(wd.Validator),</span>
<span class="term-fg32">+			Address:        bellatrix.ExecutionAddress(wd.Address),</span>
<span class="term-fg32">+			Amount:         phase0.Gwei(wd.Amount),</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	baseFeePerGas := new(boostTypes.U256Str)</span>
<span class="term-fg32">+	err := baseFeePerGas.FromBig(data.BaseFeePerGas)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return nil, err</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	return &amp;specCapella.ExecutionPayload{</span>
<span class="term-fg32">+		ParentHash:    [32]byte(data.ParentHash),</span>
<span class="term-fg32">+		FeeRecipient:  [20]byte(data.FeeRecipient),</span>
<span class="term-fg32">+		StateRoot:     [32]byte(data.StateRoot),</span>
<span class="term-fg32">+		ReceiptsRoot:  [32]byte(data.ReceiptsRoot),</span>
<span class="term-fg32">+		LogsBloom:     types.BytesToBloom(data.LogsBloom),</span>
<span class="term-fg32">+		PrevRandao:    [32]byte(data.Random),</span>
<span class="term-fg32">+		BlockNumber:   data.Number,</span>
<span class="term-fg32">+		GasLimit:      data.GasLimit,</span>
<span class="term-fg32">+		GasUsed:       data.GasUsed,</span>
<span class="term-fg32">+		Timestamp:     data.Timestamp,</span>
<span class="term-fg32">+		ExtraData:     data.ExtraData,</span>
<span class="term-fg32">+		BaseFeePerGas: *baseFeePerGas,</span>
<span class="term-fg32">+		BlockHash:     [32]byte(data.BlockHash),</span>
<span class="term-fg32">+		Transactions:  transactionData,</span>
<span class="term-fg32">+		Withdrawals:   withdrawalData,</span>
<span class="term-fg32">+	}, nil</span>
<span class="term-fg32">+}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-5eb4c44a993ff1b0cf5fd3e1" role="button"
                   aria-expanded="false" aria-controls="id-5eb4c44a993ff1b0cf5fd3e1">
                    <code>core/vm/jump_table.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/e501b3b05db8e169f67dc78b7b59bc352b3c638d/core/vm/jump_table.go" target="_blank">ethereum/go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/core/vm/jump_table.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+6</span></div>
                        <div class="text-start"><span class="text-danger">-0</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-5eb4c44a993ff1b0cf5fd3e1"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;core&#47;vm&#47;jump_table.go flashbots&#47;suave-geth&#47;core&#47;vm&#47;jump_table.go</span>
<span class="term-fg1">index a45287de80dfeda56c2431bbb30133ec34c281d8..f3c6e81097900f76d41706b26c9ee96cdb27c49e 100644</span>
<span class="term-fg1">--- ethereum&#47;go-ethereum&#47;core&#47;vm&#47;jump_table.go</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;core&#47;vm&#47;jump_table.go</span>
<span class="term-fg36">@@ -56,6 +56,7 @@</span> 	berlinInstructionSet           = newBerlinInstructionSet()
 	londonInstructionSet           = newLondonInstructionSet()
 	mergeInstructionSet            = newMergeInstructionSet()
 	shanghaiInstructionSet         = newShanghaiInstructionSet()
<span class="term-fg32">+	suaveInstructionSet            = newSuaveInstructionSet()</span>
 )
&nbsp;
 &#47;&#47; JumpTable contains the EVM opcodes supported at a given fork.
<span class="term-fg36">@@ -77,6 +78,11 @@</span> 			panic(fmt.Sprintf(&quot;op %v has dynamic memory but not dynamic gas&quot;, OpCode(i).String()))
 		}
 	}
 	return jt
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func newSuaveInstructionSet() JumpTable {</span>
<span class="term-fg32">+	instructionSet := newShanghaiInstructionSet()</span>
<span class="term-fg32">+	return validate(instructionSet)</span>
 }
&nbsp;
 func newShanghaiInstructionSet() JumpTable {</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-67d4a6583ab7100e6b0e1913" role="button"
                   aria-expanded="false" aria-controls="id-67d4a6583ab7100e6b0e1913">
                    <code>core/vm/interpreter.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/e501b3b05db8e169f67dc78b7b59bc352b3c638d/core/vm/interpreter.go" target="_blank">ethereum/go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/core/vm/interpreter.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+13</span></div>
                        <div class="text-start"><span class="text-danger">-5</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-67d4a6583ab7100e6b0e1913"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;core&#47;vm&#47;interpreter.go flashbots&#47;suave-geth&#47;core&#47;vm&#47;interpreter.go</span>
<span class="term-fg1">index 5b2082bc9e90fe2b832c6172238c937b8ccc282d..1ce7eaa36c60203f2d2ad2a988b5258ba905cc1f 100644</span>
<span class="term-fg1">--- ethereum&#47;go-ethereum&#47;core&#47;vm&#47;interpreter.go</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;core&#47;vm&#47;interpreter.go</span>
<span class="term-fg36">@@ -26,9 +26,10 @@</span>
 &#47;&#47; Config are the configuration options for the Interpreter
 type Config struct {
 	Tracer                  EVMLogger &#47;&#47; Opcode logger
<span class="term-fg31">-	NoBaseFee               bool      &#47;&#47; Forces the EIP-1559 baseFee to 0 (needed for 0 price calls)</span>
<span class="term-fg31">-	EnablePreimageRecording bool      &#47;&#47; Enables recording of SHA3&#47;keccak preimages</span>
<span class="term-fg31">-	ExtraEips               []int     &#47;&#47; Additional EIPS that are to be enabled</span>
<span class="term-fg32">+	IsOffchain              bool</span>
<span class="term-fg32">+	NoBaseFee               bool  &#47;&#47; Forces the EIP-1559 baseFee to 0 (needed for 0 price calls)</span>
<span class="term-fg32">+	EnablePreimageRecording bool  &#47;&#47; Enables recording of SHA3&#47;keccak preimages</span>
<span class="term-fg32">+	ExtraEips               []int &#47;&#47; Additional EIPS that are to be enabled</span>
 }
&nbsp;
 &#47;&#47; ScopeContext contains the things that are per-call, such as stack and memory,
<span class="term-fg36">@@ -56,6 +57,8 @@</span> func NewEVMInterpreter(evm *EVM) *EVMInterpreter {
 	&#47;&#47; If jump table was not initialised we set the default one.
 	var table *JumpTable
 	switch {
<span class="term-fg32">+	case evm.chainRules.IsSuave:</span>
<span class="term-fg32">+		table = &amp;suaveInstructionSet &#47;&#47; just like shanghai, reserving the option to extend or modify</span>
 	case evm.chainRules.IsShanghai:
 		table = &amp;shanghaiInstructionSet
 	case evm.chainRules.IsMerge:
<span class="term-fg36">@@ -102,10 +105,15 @@</span> &#47;&#47;
 &#47;&#47; It&#39;s important to note that any errors returned by the interpreter should be
 &#47;&#47; considered a revert-and-consume-all-gas operation except for
 &#47;&#47; ErrExecutionReverted which means revert-and-keep-gas-left.
<span class="term-fg31">-func (in *EVMInterpreter) Run(contract *Contract, input []byte, readOnly bool) (ret []byte, err error) {</span>
<span class="term-fg32">+func (in *EVMInterpreter) Run(backend *SuaveExecutionBackend, contract *Contract, input []byte, readOnly bool) (ret []byte, err error) {</span>
 	&#47;&#47; Increment the call depth which is restricted to 1024
 	in.evm.depth++
<span class="term-fg31">-	defer func() { in.evm.depth-- }()</span>
<span class="term-fg32">+	prevBackend := in.evm.suaveExecutionBackend</span>
<span class="term-fg32">+	in.evm.suaveExecutionBackend = backend</span>
<span class="term-fg32">+	defer func() {</span>
<span class="term-fg32">+		in.evm.depth--</span>
<span class="term-fg32">+		in.evm.suaveExecutionBackend = prevBackend</span>
<span class="term-fg32">+	}()</span>
&nbsp;
 	&#47;&#47; Make sure the readOnly is only set if we aren&#39;t in readOnly yet.
 	&#47;&#47; This also makes sure that the readOnly flag isn&#39;t removed for child calls.</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-f5b3d5e15f1734c46f59dcdb" role="button"
                   aria-expanded="false" aria-controls="id-f5b3d5e15f1734c46f59dcdb">
                    <code>core/vm/gas_table_test.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/e501b3b05db8e169f67dc78b7b59bc352b3c638d/core/vm/gas_table_test.go" target="_blank">ethereum/go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/core/vm/gas_table_test.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+3</span></div>
                        <div class="text-start"><span class="text-danger">-1</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-f5b3d5e15f1734c46f59dcdb"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;core&#47;vm&#47;gas_table_test.go flashbots&#47;suave-geth&#47;core&#47;vm&#47;gas_table_test.go</span>
<span class="term-fg1">index 4a5259a262a65685971c61e25f9da4d15cf5801d..ec0aee8c3f3d8fd74650f2539ed62a9c740239a6 100644</span>
<span class="term-fg1">--- ethereum&#47;go-ethereum&#47;core&#47;vm&#47;gas_table_test.go</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;core&#47;vm&#47;gas_table_test.go</span>
<span class="term-fg36">@@ -150,7 +150,9 @@</span> 			if tt.eip3860 {
 				config.ExtraEips = []int{3860}
 			}
&nbsp;
<span class="term-fg31">-			vmenv := NewEVM(vmctx, TxContext{}, statedb, params.AllEthashProtocolChanges, config)</span>
<span class="term-fg32">+			chainParams := *params.AllEthashProtocolChanges</span>
<span class="term-fg32">+			chainParams.SuaveBlock = nil</span>
<span class="term-fg32">+			vmenv := NewEVM(vmctx, TxContext{}, statedb, &amp;chainParams, config)</span>
 			var startGas = uint64(testGas)
 			ret, gas, err := vmenv.Call(AccountRef(common.Address{}), address, nil, startGas, new(big.Int))
 			if err != nil {</div>
    </div>

            
        </div>
        <div>
            
        </div>
    </div>
</div>

            
        </div>
    </div>
</div>

            
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-0dd34bf9a7d4e7008bc83d44"role="button" aria-expanded="false" aria-controls="id-0dd34bf9a7d4e7008bc83d44">
        
            <div class="col-12 col-sm-9 text-start"><h2>Node modifications</h2></div>
        
        <div class="col-12 col-sm-3 ms-auto mt-2">
            <div class="row line-stat">
                <div class="text-end"><span class="text-success">+57</span></div>
                <div class="text-start"><span class="text-danger">-3</span></div>
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-0dd34bf9a7d4e7008bc83d44">
        <div></div>
        <div>
            
        </div>
        <div>
            
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-ddf1038ea65a634e8db33e03"role="button" aria-expanded="false" aria-controls="id-ddf1038ea65a634e8db33e03">
        
            <div class="col-12 col-sm-9 text-start"><h3>CLI Flags</h3></div>
        
        <div class="col-12 col-sm-3 ms-auto mt-2">
            <div class="row line-stat">
                <div class="text-end"><span class="text-success">+53</span></div>
                <div class="text-start"><span class="text-danger">-3</span></div>
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-ddf1038ea65a634e8db33e03">
        <div><p>Simple additions to for starting/using the Suave testnet</p>
</div>
        <div>
            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-9eb2d60d6f140ec05e79a438" role="button"
                   aria-expanded="false" aria-controls="id-9eb2d60d6f140ec05e79a438">
                    <code>cmd/utils/flags.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/e501b3b05db8e169f67dc78b7b59bc352b3c638d/cmd/utils/flags.go" target="_blank">ethereum/go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/cmd/utils/flags.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+36</span></div>
                        <div class="text-start"><span class="text-danger">-1</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-9eb2d60d6f140ec05e79a438"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;cmd&#47;utils&#47;flags.go flashbots&#47;suave-geth&#47;cmd&#47;utils&#47;flags.go</span>
<span class="term-fg1">index b67671e03b9867ea4aeb51df001b8342ff49bb0e..32ddc5b806f0c6708d616baf885b519c117d3fe4 100644</span>
<span class="term-fg1">--- ethereum&#47;go-ethereum&#47;cmd&#47;utils&#47;flags.go</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;cmd&#47;utils&#47;flags.go</span>
<span class="term-fg36">@@ -74,6 +74,7 @@</span> 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;p2p&#47;netutil&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;params&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;rlp&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;rpc&quot;
<span class="term-fg32">+	suave &quot;github.com&#47;ethereum&#47;go-ethereum&#47;suave&#47;core&quot;</span>
 	pcsclite &quot;github.com&#47;gballet&#47;go-libpcsclite&quot;
 	gopsutil &quot;github.com&#47;shirou&#47;gopsutil&#47;mem&quot;
 	&quot;github.com&#47;urfave&#47;cli&#47;v2&quot;
<span class="term-fg36">@@ -155,6 +156,11 @@</span> 	}
 	SepoliaFlag = &amp;cli.BoolFlag{
 		Name:     &quot;sepolia&quot;,
 		Usage:    &quot;Sepolia network: pre-configured proof-of-work test network&quot;,
<span class="term-fg32">+		Category: flags.EthCategory,</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	SuaveFlag = &amp;cli.BoolFlag{</span>
<span class="term-fg32">+		Name:     &quot;suave&quot;,</span>
<span class="term-fg32">+		Usage:    &quot;suave network: pre-configured proof-of-authority suave test network&quot;,</span>
 		Category: flags.EthCategory,
 	}
&nbsp;
<span class="term-fg36">@@ -503,6 +509,13 @@</span> 		Value:    ethconfig.Defaults.Miner.NewPayloadTimeout,
 		Category: flags.MinerCategory,
 	}
&nbsp;
<span class="term-fg32">+	&#47;&#47; Suave settings</span>
<span class="term-fg32">+	SuaveEthRemoteBackendEndpointFlag = &amp;cli.StringFlag{</span>
<span class="term-fg32">+		Name:     &quot;suave.eth.remote_endpoint&quot;,</span>
<span class="term-fg32">+		Usage:    &quot;Ethereum RPC endpoint to use as eth backend&quot;,</span>
<span class="term-fg32">+		Category: flags.SuaveCategory,</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
 	&#47;&#47; Account settings
 	UnlockedAccountFlag = &amp;cli.StringFlag{
 		Name:     &quot;unlock&quot;,
<span class="term-fg36">@@ -933,6 +946,7 @@</span> 	&#47;&#47; TestnetFlags is the flag group of all built-in supported testnets.
 	TestnetFlags = []cli.Flag{
 		RinkebyFlag,
 		GoerliFlag,
<span class="term-fg32">+		SuaveFlag,</span>
 		SepoliaFlag,
 	}
 	&#47;&#47; NetworkFlags is the flag group of all built-in supported networks.
<span class="term-fg36">@@ -966,6 +980,9 @@</span> 			return filepath.Join(path, &quot;goerli&quot;)
 		}
 		if ctx.Bool(SepoliaFlag.Name) {
 			return filepath.Join(path, &quot;sepolia&quot;)
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		if ctx.Bool(SuaveFlag.Name) {</span>
<span class="term-fg32">+			return filepath.Join(path, &quot;suave&quot;)</span>
 		}
 		return path
 	}
<span class="term-fg36">@@ -1015,6 +1032,8 @@</span> 	case ctx.IsSet(BootnodesFlag.Name):
 		urls = SplitAndTrim(ctx.String(BootnodesFlag.Name))
 	case ctx.Bool(SepoliaFlag.Name):
 		urls = params.SepoliaBootnodes
<span class="term-fg32">+	case ctx.Bool(SuaveFlag.Name):</span>
<span class="term-fg32">+		return &#47;&#47; None!</span>
 	case ctx.Bool(RinkebyFlag.Name):
 		urls = params.RinkebyBootnodes
 	case ctx.Bool(GoerliFlag.Name):
<span class="term-fg36">@@ -1470,6 +1489,8 @@</span> 	case ctx.Bool(GoerliFlag.Name) &amp;&amp; cfg.DataDir == node.DefaultDataDir():
 		cfg.DataDir = filepath.Join(node.DefaultDataDir(), &quot;goerli&quot;)
 	case ctx.Bool(SepoliaFlag.Name) &amp;&amp; cfg.DataDir == node.DefaultDataDir():
 		cfg.DataDir = filepath.Join(node.DefaultDataDir(), &quot;sepolia&quot;)
<span class="term-fg32">+	case ctx.Bool(SuaveFlag.Name) &amp;&amp; cfg.DataDir == node.DefaultDataDir():</span>
<span class="term-fg32">+		cfg.DataDir = filepath.Join(node.DefaultDataDir(), &quot;suave&quot;)</span>
 	}
 }
&nbsp;
<span class="term-fg36">@@ -1623,10 +1644,16 @@</span> 		Fatalf(&quot;Flags %v can&#39;t be used at the same time&quot;, strings.Join(set, &quot;, &quot;))
 	}
 }
&nbsp;
<span class="term-fg32">+func SetSuaveConfig(ctx *cli.Context, stack *node.Node, cfg *suave.Config) {</span>
<span class="term-fg32">+	if ctx.IsSet(SuaveEthRemoteBackendEndpointFlag.Name) {</span>
<span class="term-fg32">+		cfg.SuaveEthRemoteBackendEndpoint = ctx.String(SuaveEthRemoteBackendEndpointFlag.Name)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
 &#47;&#47; SetEthConfig applies eth-related command line flags to the config.
 func SetEthConfig(ctx *cli.Context, stack *node.Node, cfg *ethconfig.Config) {
 	&#47;&#47; Avoid conflicting network flags
<span class="term-fg31">-	CheckExclusive(ctx, MainnetFlag, DeveloperFlag, RinkebyFlag, GoerliFlag, SepoliaFlag)</span>
<span class="term-fg32">+	CheckExclusive(ctx, MainnetFlag, DeveloperFlag, RinkebyFlag, GoerliFlag, SepoliaFlag, SuaveFlag)</span>
 	CheckExclusive(ctx, LightServeFlag, SyncModeFlag, &quot;light&quot;)
 	CheckExclusive(ctx, DeveloperFlag, ExternalSignerFlag) &#47;&#47; Can&#39;t use both ephemeral unlocked and external signer
 	if ctx.String(GCModeFlag.Name) == &quot;archive&quot; &amp;&amp; ctx.Uint64(TxLookupLimitFlag.Name) != 0 {
<span class="term-fg36">@@ -1790,6 +1817,12 @@</span> 			cfg.NetworkId = 5
 		}
 		cfg.Genesis = core.DefaultGoerliGenesisBlock()
 		SetDNSDiscoveryDefaults(cfg, params.GoerliGenesisHash)
<span class="term-fg32">+	case ctx.Bool(SuaveFlag.Name):</span>
<span class="term-fg32">+		if !ctx.IsSet(NetworkIdFlag.Name) {</span>
<span class="term-fg32">+			cfg.NetworkId = 424242</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		cfg.Genesis = core.DefaultSuaveGenesisBlock()</span>
<span class="term-fg32">+		SetDNSDiscoveryDefaults(cfg, params.SuaveGenesisHash)</span>
 	case ctx.Bool(DeveloperFlag.Name):
 		if !ctx.IsSet(NetworkIdFlag.Name) {
 			cfg.NetworkId = 1337
<span class="term-fg36">@@ -2118,6 +2151,8 @@</span> 	case ctx.Bool(RinkebyFlag.Name):
 		genesis = core.DefaultRinkebyGenesisBlock()
 	case ctx.Bool(GoerliFlag.Name):
 		genesis = core.DefaultGoerliGenesisBlock()
<span class="term-fg32">+	case ctx.Bool(SuaveFlag.Name):</span>
<span class="term-fg32">+		genesis = core.DefaultSuaveGenesisBlock()</span>
 	case ctx.Bool(DeveloperFlag.Name):
 		Fatalf(&quot;Developer chains are ephemeral&quot;)
 	}</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-5a7d0385a754f02d29b254c7" role="button"
                   aria-expanded="false" aria-controls="id-5a7d0385a754f02d29b254c7">
                    <code>cmd/geth/main.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/e501b3b05db8e169f67dc78b7b59bc352b3c638d/cmd/geth/main.go" target="_blank">ethereum/go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/cmd/geth/main.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+9</span></div>
                        <div class="text-start"><span class="text-danger">-0</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-5a7d0385a754f02d29b254c7"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;cmd&#47;geth&#47;main.go flashbots&#47;suave-geth&#47;cmd&#47;geth&#47;main.go</span>
<span class="term-fg1">index b4a7b5fa95c26c5ce1cb487992f8b8058b6aec6f..3c15d9652858c2a3b087715e726d8843051f45bd 100644</span>
<span class="term-fg1">--- ethereum&#47;go-ethereum&#47;cmd&#47;geth&#47;main.go</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;cmd&#47;geth&#47;main.go</span>
<span class="term-fg36">@@ -186,6 +186,10 @@</span> 		utils.MetricsInfluxDBTokenFlag,
 		utils.MetricsInfluxDBBucketFlag,
 		utils.MetricsInfluxDBOrganizationFlag,
 	}
<span class="term-fg32">+</span>
<span class="term-fg32">+	suaveFlags = []cli.Flag{</span>
<span class="term-fg32">+		utils.SuaveEthRemoteBackendEndpointFlag,</span>
<span class="term-fg32">+	}</span>
 )
&nbsp;
 var app = flags.NewApp(&quot;the go-ethereum command line interface&quot;)
<span class="term-fg36">@@ -234,6 +238,7 @@</span> 		rpcFlags,
 		consoleFlags,
 		debug.Flags,
 		metricsFlags,
<span class="term-fg32">+		suaveFlags,</span>
 	)
&nbsp;
 	app.Before = func(ctx *cli.Context) error {
<span class="term-fg36">@@ -265,6 +270,9 @@</span>
 	case ctx.IsSet(utils.GoerliFlag.Name):
 		log.Info(&quot;Starting Geth on Görli testnet...&quot;)
&nbsp;
<span class="term-fg32">+	case ctx.IsSet(utils.SuaveFlag.Name):</span>
<span class="term-fg32">+		log.Info(&quot;Starting Geth on Suave testnet...&quot;)</span>
<span class="term-fg32">+</span>
 	case ctx.IsSet(utils.SepoliaFlag.Name):
 		log.Info(&quot;Starting Geth on Sepolia testnet...&quot;)
&nbsp;
<span class="term-fg36">@@ -295,6 +303,7 @@</span> 		&#47;&#47; Make sure we&#39;re not on any supported preconfigured testnet either
 		if !ctx.IsSet(utils.SepoliaFlag.Name) &amp;&amp;
 			!ctx.IsSet(utils.RinkebyFlag.Name) &amp;&amp;
 			!ctx.IsSet(utils.GoerliFlag.Name) &amp;&amp;
<span class="term-fg32">+			!ctx.IsSet(utils.SuaveFlag.Name) &amp;&amp;</span>
 			!ctx.IsSet(utils.DeveloperFlag.Name) {
 			&#47;&#47; Nope, we&#39;re really on mainnet. Bump that cache up!
 			log.Info(&quot;Bumping default cache on mainnet&quot;, &quot;provided&quot;, ctx.Int(utils.CacheFlag.Name), &quot;updated&quot;, 4096)</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-e899cdd76ccc1e6c6c573ba8" role="button"
                   aria-expanded="false" aria-controls="id-e899cdd76ccc1e6c6c573ba8">
                    <code>cmd/geth/config.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/e501b3b05db8e169f67dc78b7b59bc352b3c638d/cmd/geth/config.go" target="_blank">ethereum/go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/cmd/geth/config.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+2</span></div>
                        <div class="text-start"><span class="text-danger">-0</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-e899cdd76ccc1e6c6c573ba8"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;cmd&#47;geth&#47;config.go flashbots&#47;suave-geth&#47;cmd&#47;geth&#47;config.go</span>
<span class="term-fg1">index 42ded493224bba679b25a404dd413c3a88ad57f9..5ac1c1eaf81dd7a790dfee230dfa22cff0b4c05c 100644</span>
<span class="term-fg1">--- ethereum&#47;go-ethereum&#47;cmd&#47;geth&#47;config.go</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;cmd&#47;geth&#47;config.go</span>
<span class="term-fg36">@@ -160,6 +160,8 @@</span> 		cfg.Ethstats.URL = ctx.String(utils.EthStatsURLFlag.Name)
 	}
 	applyMetricConfig(ctx, &amp;cfg)
&nbsp;
<span class="term-fg32">+	utils.SetSuaveConfig(ctx, stack, &amp;cfg.Eth.Suave)</span>
<span class="term-fg32">+</span>
 	return stack, cfg
 }
</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-9690c6131acbb7e38b1ae822" role="button"
                   aria-expanded="false" aria-controls="id-9690c6131acbb7e38b1ae822">
                    <code>internal/flags/categories.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/e501b3b05db8e169f67dc78b7b59bc352b3c638d/internal/flags/categories.go" target="_blank">ethereum/go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/internal/flags/categories.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+1</span></div>
                        <div class="text-start"><span class="text-danger">-0</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-9690c6131acbb7e38b1ae822"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;internal&#47;flags&#47;categories.go flashbots&#47;suave-geth&#47;internal&#47;flags&#47;categories.go</span>
<span class="term-fg1">index c2db6c6c1d25c115c77c8a829d481133a932faa7..5427d25638e80055c525a4e27f657c2eb41a276a 100644</span>
<span class="term-fg1">--- ethereum&#47;go-ethereum&#47;internal&#47;flags&#47;categories.go</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;internal&#47;flags&#47;categories.go</span>
<span class="term-fg36">@@ -23,6 +23,7 @@</span> 	EthCategory        = &quot;ETHEREUM&quot;
 	LightCategory      = &quot;LIGHT CLIENT&quot;
 	DevCategory        = &quot;DEVELOPER CHAIN&quot;
 	EthashCategory     = &quot;ETHASH&quot;
<span class="term-fg32">+	SuaveCategory      = &quot;SUAVE&quot;</span>
 	TxPoolCategory     = &quot;TRANSACTION POOL&quot;
 	PerfCategory       = &quot;PERFORMANCE TUNING&quot;
 	AccountCategory    = &quot;ACCOUNT&quot;</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-278af84e71be2d58c6ac2262" role="button"
                   aria-expanded="false" aria-controls="id-278af84e71be2d58c6ac2262">
                    <code>cmd/faucet/faucet.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/e501b3b05db8e169f67dc78b7b59bc352b3c638d/cmd/faucet/faucet.go" target="_blank">ethereum/go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/cmd/faucet/faucet.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+5</span></div>
                        <div class="text-start"><span class="text-danger">-2</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-278af84e71be2d58c6ac2262"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;cmd&#47;faucet&#47;faucet.go flashbots&#47;suave-geth&#47;cmd&#47;faucet&#47;faucet.go</span>
<span class="term-fg1">index b66cc461411e8fec215fe9a043be0082315e3d87..67c2a790f0e30441421159d6bb6e3f14bf7c95b0 100644</span>
<span class="term-fg1">--- ethereum&#47;go-ethereum&#47;cmd&#47;faucet&#47;faucet.go</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;cmd&#47;faucet&#47;faucet.go</span>
<span class="term-fg36">@@ -88,6 +88,7 @@</span>
 	goerliFlag  = flag.Bool(&quot;goerli&quot;, false, &quot;Initializes the faucet with Görli network config&quot;)
 	rinkebyFlag = flag.Bool(&quot;rinkeby&quot;, false, &quot;Initializes the faucet with Rinkeby network config&quot;)
 	sepoliaFlag = flag.Bool(&quot;sepolia&quot;, false, &quot;Initializes the faucet with Sepolia network config&quot;)
<span class="term-fg32">+	suaveFlag   = flag.Bool(&quot;suave&quot;, false, &quot;Initializes the faucet with Suave testnet network config&quot;)</span>
 )
&nbsp;
 var (
<span class="term-fg36">@@ -140,7 +141,7 @@</span> 	if err != nil {
 		log.Crit(&quot;Failed to render the faucet template&quot;, &quot;err&quot;, err)
 	}
 	&#47;&#47; Load and parse the genesis block requested by the user
<span class="term-fg31">-	genesis, err := getGenesis(*genesisFlag, *goerliFlag, *rinkebyFlag, *sepoliaFlag)</span>
<span class="term-fg32">+	genesis, err := getGenesis(*genesisFlag, *goerliFlag, *rinkebyFlag, *sepoliaFlag, *suaveFlag)</span>
 	if err != nil {
 		log.Crit(&quot;Failed to parse genesis config&quot;, &quot;err&quot;, err)
 	}
<span class="term-fg36">@@ -880,7 +881,7 @@</span> 	return address.Hex() + &quot;@noauth&quot;, &quot;&quot;, address, nil
 }
&nbsp;
 &#47;&#47; getGenesis returns a genesis based on input args
<span class="term-fg31">-func getGenesis(genesisFlag string, goerliFlag bool, rinkebyFlag bool, sepoliaFlag bool) (*core.Genesis, error) {</span>
<span class="term-fg32">+func getGenesis(genesisFlag string, goerliFlag bool, rinkebyFlag bool, sepoliaFlag bool, suaveFlag bool) (*core.Genesis, error) {</span>
 	switch {
 	case genesisFlag != &quot;&quot;:
 		var genesis core.Genesis
<span class="term-fg36">@@ -890,6 +891,8 @@</span> 	case goerliFlag:
 		return core.DefaultGoerliGenesisBlock(), nil
 	case rinkebyFlag:
 		return core.DefaultRinkebyGenesisBlock(), nil
<span class="term-fg32">+	case suaveFlag:</span>
<span class="term-fg32">+		return core.DefaultSuaveGenesisBlock(), nil</span>
 	case sepoliaFlag:
 		return core.DefaultSepoliaGenesisBlock(), nil
 	default:</div>
    </div>

            
        </div>
        <div>
            
        </div>
    </div>
</div>

            
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-b754ff7bb79cd3f3961c96ae"role="button" aria-expanded="false" aria-controls="id-b754ff7bb79cd3f3961c96ae">
        
            <div class="col-12 col-sm-9 text-start"><h3>Node config</h3></div>
        
        <div class="col-12 col-sm-3 ms-auto mt-2">
            <div class="row line-stat">
                <div class="text-end"><span class="text-success">+4</span></div>
                <div class="text-start"><span class="text-danger">-0</span></div>
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-b754ff7bb79cd3f3961c96ae">
        <div></div>
        <div>
            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-40556e05e148d4bddefae249" role="button"
                   aria-expanded="false" aria-controls="id-40556e05e148d4bddefae249">
                    <code>eth/ethconfig/config.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/e501b3b05db8e169f67dc78b7b59bc352b3c638d/eth/ethconfig/config.go" target="_blank">ethereum/go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/eth/ethconfig/config.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+4</span></div>
                        <div class="text-start"><span class="text-danger">-0</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-40556e05e148d4bddefae249"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;eth&#47;ethconfig&#47;config.go flashbots&#47;suave-geth&#47;eth&#47;ethconfig&#47;config.go</span>
<span class="term-fg1">index a98d9ee4aaffd25349e678f4e1c0c415ef540604..c12dc64fc2b4d028b29f6d1718fafa85cc526bd1 100644</span>
<span class="term-fg1">--- ethereum&#47;go-ethereum&#47;eth&#47;ethconfig&#47;config.go</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;eth&#47;ethconfig&#47;config.go</span>
<span class="term-fg36">@@ -33,6 +33,7 @@</span> 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;eth&#47;gasprice&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;ethdb&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;miner&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;params&quot;
<span class="term-fg32">+	suave &quot;github.com&#47;ethereum&#47;go-ethereum&#47;suave&#47;core&quot;</span>
 )
&nbsp;
 &#47;&#47; FullNodeGPO contains default gasprice oracle settings for full node.
<span class="term-fg36">@@ -137,6 +138,9 @@</span> 	FilterLogCacheSize int
&nbsp;
 	&#47;&#47; Mining options
 	Miner miner.Config
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; Suave options</span>
<span class="term-fg32">+	Suave suave.Config</span>
&nbsp;
 	&#47;&#47; Transaction pool options
 	TxPool txpool.Config</div>
    </div>

            
        </div>
        <div>
            
        </div>
    </div>
</div>

            
        </div>
    </div>
</div>

            
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-4371bf8f6aa709ee9218e245"role="button" aria-expanded="false" aria-controls="id-4371bf8f6aa709ee9218e245">
        
            <div class="col-12 col-sm-9 text-start"><h2>API</h2></div>
        
        <div class="col-12 col-sm-3 ms-auto mt-2">
            <div class="row line-stat">
                <div class="text-end"><span class="text-success">+301</span></div>
                <div class="text-start"><span class="text-danger">-7</span></div>
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-4371bf8f6aa709ee9218e245">
        <div><ul>
<li><p>Adds <code>BuildBlockFromTxs</code>and <code>BuildBlockFromBundles</code> to the <code>ethapi.Backend</code>
interface.</p></li>

<li><p>Hooks in SUAVE execution backends (<code>ConfiendialStoreBackend</code>,
<code>MempoolBackend</code>, and <code>OffchainEthBackend</code>) to the full-node&rsquo;s interface.</p></li>

<li><p>Support for <code>OffchainTxType</code> and <code>OffchainExecutedTxType</code></p></li>

<li><p>New fields on <code>TransactionArgs</code> to support offchain tx types</p></li>
</ul>
</div>
        <div>
            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-30c6353e8f3cee5e6234a5cf" role="button"
                   aria-expanded="false" aria-controls="id-30c6353e8f3cee5e6234a5cf">
                    <code>eth/api_backend.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/e501b3b05db8e169f67dc78b7b59bc352b3c638d/eth/api_backend.go" target="_blank">ethereum/go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/eth/api_backend.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+21</span></div>
                        <div class="text-start"><span class="text-danger">-1</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-30c6353e8f3cee5e6234a5cf"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;eth&#47;api_backend.go flashbots&#47;suave-geth&#47;eth&#47;api_backend.go</span>
<span class="term-fg1">index 1789f106e9f2be41d58259206fd59112abf007f3..84cf1a60fd977d0aacdc38758f29af605dc1094f 100644</span>
<span class="term-fg1">--- ethereum&#47;go-ethereum&#47;eth&#47;api_backend.go</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;eth&#47;api_backend.go</span>
<span class="term-fg36">@@ -40,6 +40,7 @@</span> 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;event&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;miner&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;params&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;rpc&quot;
<span class="term-fg32">+	suave &quot;github.com&#47;ethereum&#47;go-ethereum&#47;suave&#47;core&quot;</span>
 )
&nbsp;
 &#47;&#47; EthAPIBackend implements ethapi.Backend for full nodes
<span class="term-fg36">@@ -48,6 +49,12 @@</span> 	extRPCEnabled       bool
 	allowUnprotectedTxs bool
 	eth                 *Ethereum
 	gpo                 *gasprice.Oracle
<span class="term-fg32">+	offchainBackend     *vm.SuaveExecutionBackend</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (b *EthAPIBackend) OffchainBackend() *vm.SuaveExecutionBackend {</span>
<span class="term-fg32">+	&#47;&#47; For testing purposes</span>
<span class="term-fg32">+	return b.offchainBackend</span>
 }
&nbsp;
 &#47;&#47; ChainConfig returns the active chain configuration.
<span class="term-fg36">@@ -257,7 +264,12 @@</span> 		context = *blockCtx
 	} else {
 		context = core.NewEVMBlockContext(header, b.eth.BlockChain(), nil)
 	}
<span class="term-fg31">-	return vm.NewEVM(context, txContext, state, b.eth.blockchain.Config(), *vmConfig), state.Error</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	if vmConfig.IsOffchain {</span>
<span class="term-fg32">+		return vm.NewOffchainEVM(b.offchainBackend, context, txContext, state, b.eth.blockchain.Config(), *vmConfig), state.Error</span>
<span class="term-fg32">+	} else {</span>
<span class="term-fg32">+		return vm.NewEVM(context, txContext, state, b.eth.blockchain.Config(), *vmConfig), state.Error</span>
<span class="term-fg32">+	}</span>
 }
&nbsp;
 func (b *EthAPIBackend) SubscribeRemovedLogsEvent(ch chan&lt;- core.RemovedLogsEvent) event.Subscription {
<span class="term-fg36">@@ -399,6 +411,14 @@</span> }
&nbsp;
 func (b *EthAPIBackend) StartMining() error {
 	return b.eth.StartMining()
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (b *EthAPIBackend) BuildBlockFromTxs(ctx context.Context, buildArgs *suave.BuildBlockArgs, txs types.Transactions) (*types.Block, *big.Int, error) {</span>
<span class="term-fg32">+	return b.eth.Miner().BuildBlockFromTxs(ctx, buildArgs, txs)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (b *EthAPIBackend) BuildBlockFromBundles(ctx context.Context, buildArgs *suave.BuildBlockArgs, bundles []types.SBundle) (*types.Block, *big.Int, error) {</span>
<span class="term-fg32">+	return b.eth.Miner().BuildBlockFromBundles(ctx, buildArgs, bundles)</span>
 }
&nbsp;
 func (b *EthAPIBackend) StateAtBlock(ctx context.Context, block *types.Block, reexec uint64, base *state.StateDB, readOnly bool, preferDisk bool) (*state.StateDB, tracers.StateReleaseFunc, error) {</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-abc8967a268da87bf110c837" role="button"
                   aria-expanded="false" aria-controls="id-abc8967a268da87bf110c837">
                    <code>eth/backend.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/e501b3b05db8e169f67dc78b7b59bc352b3c638d/eth/backend.go" target="_blank">ethereum/go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/eth/backend.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+16</span></div>
                        <div class="text-start"><span class="text-danger">-1</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-abc8967a268da87bf110c837"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;eth&#47;backend.go flashbots&#47;suave-geth&#47;eth&#47;backend.go</span>
<span class="term-fg1">index 4ba8df951b1b709f548e73ab3cf3d07ce8295cd8..29f3ebd631059308254642d5efbe5fd39e7b92d6 100644</span>
<span class="term-fg1">--- ethereum&#47;go-ethereum&#47;eth&#47;backend.go</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;eth&#47;backend.go</span>
<span class="term-fg36">@@ -55,6 +55,8 @@</span> 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;p2p&#47;enode&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;params&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;rlp&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;rpc&quot;
<span class="term-fg32">+	suave_backends &quot;github.com&#47;ethereum&#47;go-ethereum&#47;suave&#47;backends&quot;</span>
<span class="term-fg32">+	suave &quot;github.com&#47;ethereum&#47;go-ethereum&#47;suave&#47;core&quot;</span>
 )
&nbsp;
 &#47;&#47; Config contains the configuration options of the ETH protocol.
<span class="term-fg36">@@ -227,7 +229,20 @@</span>
 	eth.miner = miner.New(eth, &amp;config.Miner, eth.blockchain.Config(), eth.EventMux(), eth.engine, eth.isLocalBlock)
 	eth.miner.SetExtra(makeExtraData(config.Miner.ExtraData))
&nbsp;
<span class="term-fg31">-	eth.APIBackend = &amp;EthAPIBackend{stack.Config().ExtRPCEnabled(), stack.Config().AllowUnprotectedTxs, eth, nil}</span>
<span class="term-fg32">+	cdas := suave_backends.NewLocalConfidentialStore()</span>
<span class="term-fg32">+	var suaveEthBackend suave.OffchainEthBackend</span>
<span class="term-fg32">+	if config.Suave.SuaveEthRemoteBackendEndpoint != &quot;&quot; {</span>
<span class="term-fg32">+		suaveEthBackend = suave_backends.NewRemoteEthBackend(config.Suave.SuaveEthRemoteBackendEndpoint)</span>
<span class="term-fg32">+	} else {</span>
<span class="term-fg32">+		suaveEthBackend = &amp;suave_backends.EthMock{}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	offchainBackend := &amp;vm.SuaveExecutionBackend{</span>
<span class="term-fg32">+		ConfiendialStoreBackend: cdas,</span>
<span class="term-fg32">+		MempoolBackend:          suave_backends.NewMempoolOnConfidentialStore(cdas),</span>
<span class="term-fg32">+		OffchainEthBackend:      suaveEthBackend,</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	eth.APIBackend = &amp;EthAPIBackend{stack.Config().ExtRPCEnabled(), stack.Config().AllowUnprotectedTxs, eth, nil, offchainBackend}</span>
 	if eth.APIBackend.allowUnprotectedTxs {
 		log.Info(&quot;Unprotected transactions allowed&quot;)
 	}</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-3f4eef90e3e30d4bd444fc94" role="button"
                   aria-expanded="false" aria-controls="id-3f4eef90e3e30d4bd444fc94">
                    <code>internal/ethapi/transaction_args_test.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/e501b3b05db8e169f67dc78b7b59bc352b3c638d/internal/ethapi/transaction_args_test.go" target="_blank">ethereum/go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/internal/ethapi/transaction_args_test.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+9</span></div>
                        <div class="text-start"><span class="text-danger">-0</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-3f4eef90e3e30d4bd444fc94"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;internal&#47;ethapi&#47;transaction_args_test.go flashbots&#47;suave-geth&#47;internal&#47;ethapi&#47;transaction_args_test.go</span>
<span class="term-fg1">index 0868f8762cb521dd2c5d68d5815ee12f93ed59ab..cae49853606c405746ab92ebf73ce79859810dee 100644</span>
<span class="term-fg1">--- ethereum&#47;go-ethereum&#47;internal&#47;ethapi&#47;transaction_args_test.go</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;internal&#47;ethapi&#47;transaction_args_test.go</span>
<span class="term-fg36">@@ -38,6 +38,7 @@</span> 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;ethdb&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;event&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;params&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;rpc&quot;
<span class="term-fg32">+	suave &quot;github.com&#47;ethereum&#47;go-ethereum&#47;suave&#47;core&quot;</span>
 )
&nbsp;
 &#47;&#47; TestSetFeeDefaults tests the logic for filling in default fee values works as expected.
<span class="term-fg36">@@ -343,3 +344,11 @@</span> 	return nil
 }
&nbsp;
 func (b *backendMock) Engine() consensus.Engine { return nil }
<span class="term-fg32">+</span>
<span class="term-fg32">+func (b *backendMock) BuildBlockFromTxs(ctx context.Context, buildArgs *suave.BuildBlockArgs, txs types.Transactions) (*types.Block, *big.Int, error) {</span>
<span class="term-fg32">+	return nil, nil, errors.New(&quot;not implemented&quot;)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (b *backendMock) BuildBlockFromBundles(ctx context.Context, buildArgs *suave.BuildBlockArgs, bundles []types.SBundle) (*types.Block, *big.Int, error) {</span>
<span class="term-fg32">+	return nil, nil, errors.New(&quot;not implemented&quot;)</span>
<span class="term-fg32">+}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-f092349ce0d477acb7ce92c6" role="button"
                   aria-expanded="false" aria-controls="id-f092349ce0d477acb7ce92c6">
                    <code>internal/ethapi/transaction_args.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/e501b3b05db8e169f67dc78b7b59bc352b3c638d/internal/ethapi/transaction_args.go" target="_blank">ethereum/go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/internal/ethapi/transaction_args.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+11</span></div>
                        <div class="text-start"><span class="text-danger">-0</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-f092349ce0d477acb7ce92c6"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;internal&#47;ethapi&#47;transaction_args.go flashbots&#47;suave-geth&#47;internal&#47;ethapi&#47;transaction_args.go</span>
<span class="term-fg1">index 6e2690e095d9b178600623d05dc3911939ec552f..abab4d4cec2fe2f24a742bebae4efc3372e93238 100644</span>
<span class="term-fg1">--- ethereum&#47;go-ethereum&#47;internal&#47;ethapi&#47;transaction_args.go</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;internal&#47;ethapi&#47;transaction_args.go</span>
<span class="term-fg36">@@ -42,6 +42,8 @@</span> 	GasPrice             *hexutil.Big    `json:&quot;gasPrice&quot;`
 	MaxFeePerGas         *hexutil.Big    `json:&quot;maxFeePerGas&quot;`
 	MaxPriorityFeePerGas *hexutil.Big    `json:&quot;maxPriorityFeePerGas&quot;`
 	Value                *hexutil.Big    `json:&quot;value&quot;`
<span class="term-fg32">+	ExecutionNode        *common.Address `json:&quot;executionNode&quot;`</span>
<span class="term-fg32">+	IsOffchain           bool            `json:&quot;isOffchain&quot;`</span>
 	Nonce                *hexutil.Uint64 `json:&quot;nonce&quot;`
&nbsp;
 	&#47;&#47; We accept &quot;data&quot; and &quot;input&quot; for backwards-compatibility reasons.
<span class="term-fg36">@@ -321,6 +323,15 @@</span> 			Value:    (*big.Int)(args.Value),
 			Data:     args.data(),
 		}
 	}
<span class="term-fg32">+</span>
<span class="term-fg32">+	if args.IsOffchain {</span>
<span class="term-fg32">+		var executionNode common.Address</span>
<span class="term-fg32">+		if args.ExecutionNode != nil {</span>
<span class="term-fg32">+			executionNode = *args.ExecutionNode</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		data = &amp;types.OffchainTx{ExecutionNode: executionNode, Wrapped: *types.NewTx(data), ChainID: (*big.Int)(args.ChainID)}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
 	return types.NewTx(data)
 }
</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-4dd79cb70783b019187d2b0d" role="button"
                   aria-expanded="false" aria-controls="id-4dd79cb70783b019187d2b0d">
                    <code>internal/ethapi/backend.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/e501b3b05db8e169f67dc78b7b59bc352b3c638d/internal/ethapi/backend.go" target="_blank">ethereum/go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/internal/ethapi/backend.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+4</span></div>
                        <div class="text-start"><span class="text-danger">-0</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-4dd79cb70783b019187d2b0d"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;internal&#47;ethapi&#47;backend.go flashbots&#47;suave-geth&#47;internal&#47;ethapi&#47;backend.go</span>
<span class="term-fg1">index 918b3b630922687fff53c7ae8940ef896b5bc8b3..bd43f4d29050df4af58c5f13aae51e438b38be57 100644</span>
<span class="term-fg1">--- ethereum&#47;go-ethereum&#47;internal&#47;ethapi&#47;backend.go</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;internal&#47;ethapi&#47;backend.go</span>
<span class="term-fg36">@@ -35,6 +35,7 @@</span> 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;ethdb&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;event&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;params&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;rpc&quot;
<span class="term-fg32">+	suave &quot;github.com&#47;ethereum&#47;go-ethereum&#47;suave&#47;core&quot;</span>
 )
&nbsp;
 &#47;&#47; Backend interface provides the common API services (that are provided by
<span class="term-fg36">@@ -97,6 +98,9 @@</span> 	SubscribeLogsEvent(ch chan&lt;- []*types.Log) event.Subscription
 	SubscribePendingLogsEvent(ch chan&lt;- []*types.Log) event.Subscription
 	BloomStatus() (uint64, uint64)
 	ServiceFilter(ctx context.Context, session *bloombits.MatcherSession)
<span class="term-fg32">+</span>
<span class="term-fg32">+	BuildBlockFromTxs(ctx context.Context, buildArgs *suave.BuildBlockArgs, txs types.Transactions) (*types.Block, *big.Int, error)</span>
<span class="term-fg32">+	BuildBlockFromBundles(ctx context.Context, buildArgs *suave.BuildBlockArgs, bundles []types.SBundle) (*types.Block, *big.Int, error)</span>
 }
&nbsp;
 func GetAPIs(apiBackend Backend) []rpc.API {</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-ce9d142f226fc393a1e65b4f" role="button"
                   aria-expanded="false" aria-controls="id-ce9d142f226fc393a1e65b4f">
                    <code>internal/ethapi/api.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/e501b3b05db8e169f67dc78b7b59bc352b3c638d/internal/ethapi/api.go" target="_blank">ethereum/go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/internal/ethapi/api.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+210</span></div>
                        <div class="text-start"><span class="text-danger">-4</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-ce9d142f226fc393a1e65b4f"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;internal&#47;ethapi&#47;api.go flashbots&#47;suave-geth&#47;internal&#47;ethapi&#47;api.go</span>
<span class="term-fg1">index 69b5bf1304bbea7466df73b1f392dcfe68da4c22..633b85725730ae2f89e58cd069a42a38ade2f1aa 100644</span>
<span class="term-fg1">--- ethereum&#47;go-ethereum&#47;internal&#47;ethapi&#47;api.go</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;internal&#47;ethapi&#47;api.go</span>
<span class="term-fg36">@@ -30,6 +30,7 @@</span> 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;accounts&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;accounts&#47;abi&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;accounts&#47;keystore&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;accounts&#47;scwallet&quot;
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;beacon&#47;engine&quot;</span>
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&#47;hexutil&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&#47;math&quot;
<span class="term-fg36">@@ -1019,7 +1020,9 @@</span> 	blockCtx := core.NewEVMBlockContext(header, NewChainContext(ctx, b), nil)
 	if blockOverrides != nil {
 		blockOverrides.Apply(&amp;blockCtx)
 	}
<span class="term-fg31">-	evm, vmError := b.GetEVM(ctx, msg, state, header, &amp;vm.Config{NoBaseFee: true}, &amp;blockCtx)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	vmConfig := vm.Config{NoBaseFee: true, IsOffchain: args.IsOffchain}</span>
<span class="term-fg32">+	evm, vmError := b.GetEVM(ctx, msg, state, header, &amp;vmConfig, &amp;blockCtx)</span>
&nbsp;
 	&#47;&#47; Wait for the context to be done and cancel the evm. Even if the
 	&#47;&#47; EVM has finished, cancelling may be done (repeatedly)
<span class="term-fg36">@@ -1312,6 +1315,48 @@</span> 	}
 	return fields, err
 }
&nbsp;
<span class="term-fg32">+func (s *BlockChainAPI) BuildEth2Block(ctx context.Context, buildArgs *types.BuildBlockArgs, txs types.Transactions) (*engine.ExecutionPayloadEnvelope, error) {</span>
<span class="term-fg32">+	if buildArgs == nil {</span>
<span class="term-fg32">+		head := s.b.CurrentHeader()</span>
<span class="term-fg32">+		buildArgs = &amp;types.BuildBlockArgs{</span>
<span class="term-fg32">+			Parent:       head.Hash(),</span>
<span class="term-fg32">+			Timestamp:    head.Time + uint64(12),</span>
<span class="term-fg32">+			FeeRecipient: common.Address{0x42},</span>
<span class="term-fg32">+			GasLimit:     30000000,</span>
<span class="term-fg32">+			Random:       head.Root,</span>
<span class="term-fg32">+			Withdrawals:  nil,</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	block, profit, err := s.b.BuildBlockFromTxs(ctx, buildArgs, txs)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return nil, err</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	return engine.BlockToExecutableData(block, profit), nil</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (s *BlockChainAPI) BuildEth2BlockFromBundles(ctx context.Context, buildArgs *types.BuildBlockArgs, bundles []types.SBundle) (*engine.ExecutionPayloadEnvelope, error) {</span>
<span class="term-fg32">+	if buildArgs == nil {</span>
<span class="term-fg32">+		head := s.b.CurrentHeader()</span>
<span class="term-fg32">+		buildArgs = &amp;types.BuildBlockArgs{</span>
<span class="term-fg32">+			Parent:       head.Hash(),</span>
<span class="term-fg32">+			Timestamp:    head.Time + uint64(12),</span>
<span class="term-fg32">+			FeeRecipient: common.Address{0x42},</span>
<span class="term-fg32">+			GasLimit:     30000000,</span>
<span class="term-fg32">+			Random:       head.Root,</span>
<span class="term-fg32">+			Withdrawals:  nil,</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	block, profit, err := s.b.BuildBlockFromBundles(ctx, buildArgs, bundles)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return nil, err</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	return engine.BlockToExecutableData(block, profit), nil</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
 &#47;&#47; RPCTransaction represents a transaction that will serialize to the RPC representation of a transaction
 type RPCTransaction struct {
 	BlockHash        *common.Hash      `json:&quot;blockHash&quot;`
<span class="term-fg36">@@ -1330,6 +1375,9 @@</span> 	Value            *hexutil.Big      `json:&quot;value&quot;`
 	Type             hexutil.Uint64    `json:&quot;type&quot;`
 	Accesses         *types.AccessList `json:&quot;accessList,omitempty&quot;`
 	ChainID          *hexutil.Big      `json:&quot;chainId,omitempty&quot;`
<span class="term-fg32">+	ExecutionNode    *common.Address   `json:&quot;executionNode,omitempty&quot;`</span>
<span class="term-fg32">+	Wrapped          *hexutil.Bytes    `json:&quot;wrapped,omitempty&quot;`</span>
<span class="term-fg32">+	OffchainResult   *hexutil.Bytes    `json:&quot;offchainResult,omitempty&quot;`</span>
 	V                *hexutil.Big      `json:&quot;v&quot;`
 	R                *hexutil.Big      `json:&quot;r&quot;`
 	S                *hexutil.Big      `json:&quot;s&quot;`
<span class="term-fg36">@@ -1355,6 +1403,7 @@</span> 		V:        (*hexutil.Big)(v),
 		R:        (*hexutil.Big)(r),
 		S:        (*hexutil.Big)(s),
 	}
<span class="term-fg32">+</span>
 	if blockHash != (common.Hash{}) {
 		result.BlockHash = &amp;blockHash
 		result.BlockNumber = (*hexutil.Big)(new(big.Int).SetUint64(blockNumber))
<span class="term-fg36">@@ -1384,6 +1433,43 @@</span> 			result.GasPrice = (*hexutil.Big)(price)
 		} else {
 			result.GasPrice = (*hexutil.Big)(tx.GasFeeCap())
 		}
<span class="term-fg32">+	case types.OffchainTxType:</span>
<span class="term-fg32">+		inner, ok := types.CastTxInner[*types.OffchainTx](tx)</span>
<span class="term-fg32">+		if !ok {</span>
<span class="term-fg32">+			log.Error(&quot;could not marshal rpc transaction: tx did not cast correctly&quot;)</span>
<span class="term-fg32">+			return nil</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		result.ExecutionNode = &amp;inner.ExecutionNode</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		&#47;&#47; TODO: should be rpc marshaled</span>
<span class="term-fg32">+		wrappedBytes, err := inner.Wrapped.MarshalJSON()</span>
<span class="term-fg32">+		if err != nil {</span>
<span class="term-fg32">+			log.Error(&quot;could not marshal rpc transaction&quot;, &quot;err&quot;, err)</span>
<span class="term-fg32">+			return nil</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		result.Wrapped = (*hexutil.Bytes)(&amp;wrappedBytes)</span>
<span class="term-fg32">+		result.ChainID = (*hexutil.Big)(tx.ChainId())</span>
<span class="term-fg32">+	case types.OffchainExecutedTxType:</span>
<span class="term-fg32">+		inner, ok := types.CastTxInner[*types.OffchainExecutedTx](tx)</span>
<span class="term-fg32">+		if !ok {</span>
<span class="term-fg32">+			log.Error(&quot;could not marshal rpc transaction: tx did not cast correctly&quot;)</span>
<span class="term-fg32">+			return nil</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		result.ExecutionNode = &amp;inner.ExecutionNode</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		&#47;&#47; TODO: should be rpc marshaled</span>
<span class="term-fg32">+		wrappedBytes, err := inner.Wrapped.MarshalJSON()</span>
<span class="term-fg32">+		if err != nil {</span>
<span class="term-fg32">+			log.Error(&quot;could not marshal rpc transaction&quot;, &quot;err&quot;, err)</span>
<span class="term-fg32">+			return nil</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		result.Wrapped = (*hexutil.Bytes)(&amp;wrappedBytes)</span>
<span class="term-fg32">+		result.OffchainResult = (*hexutil.Bytes)(&amp;inner.OffchainResult)</span>
<span class="term-fg32">+		result.ChainID = (*hexutil.Big)(tx.ChainId())</span>
 	}
 	return result
 }
<span class="term-fg36">@@ -1718,6 +1804,7 @@</span> 	if !b.UnprotectedAllowed() &amp;&amp; !tx.Protected() {
 		&#47;&#47; Ensure only eip155 signed transactions are submitted if EIP155Required is set.
 		return common.Hash{}, errors.New(&quot;only replay-protected (EIP-155) transactions allowed over RPC&quot;)
 	}
<span class="term-fg32">+</span>
 	if err := b.SendTx(ctx, tx); err != nil {
 		return common.Hash{}, err
 	}
<span class="term-fg36">@@ -1731,7 +1818,7 @@</span> 	}
&nbsp;
 	if tx.To() == nil {
 		addr := crypto.CreateAddress(from, tx.Nonce())
<span class="term-fg31">-		log.Info(&quot;Submitted contract creation&quot;, &quot;hash&quot;, tx.Hash().Hex(), &quot;from&quot;, from, &quot;nonce&quot;, tx.Nonce(), &quot;contract&quot;, addr.Hex(), &quot;value&quot;, tx.Value())</span>
<span class="term-fg32">+		log.Info(&quot;Submitted contract creation&quot;, &quot;hash&quot;, tx.Hash().Hex(), &quot;from&quot;, from, &quot;nonce&quot;, tx.Nonce(), &quot;contract&quot;, addr.Hex(), &quot;value&quot;, tx.Value(), &quot;data&quot;, tx.Data())</span>
 	} else {
 		log.Info(&quot;Submitted transaction&quot;, &quot;hash&quot;, tx.Hash().Hex(), &quot;from&quot;, from, &quot;nonce&quot;, tx.Nonce(), &quot;recipient&quot;, tx.To(), &quot;value&quot;, tx.Value())
 	}
<span class="term-fg36">@@ -1740,7 +1827,7 @@</span> }
&nbsp;
 &#47;&#47; SendTransaction creates a transaction for the given argument, sign it and submit it to the
 &#47;&#47; transaction pool.
<span class="term-fg31">-func (s *TransactionAPI) SendTransaction(ctx context.Context, args TransactionArgs) (common.Hash, error) {</span>
<span class="term-fg32">+func (s *TransactionAPI) SendTransaction(ctx context.Context, args TransactionArgs, confidential *hexutil.Bytes) (common.Hash, error) {</span>
 	&#47;&#47; Look up the wallet containing the requested signer
 	account := accounts.Account{Address: args.from()}
&nbsp;
<span class="term-fg36">@@ -1767,6 +1854,15 @@</span> 	signed, err := wallet.SignTx(account, tx, s.b.ChainConfig().ChainID)
 	if err != nil {
 		return common.Hash{}, err
 	}
<span class="term-fg32">+</span>
<span class="term-fg32">+	if tx.Type() == types.OffchainTxType {</span>
<span class="term-fg32">+		&#47;&#47; TODO: this is a huge dos vector!</span>
<span class="term-fg32">+		log.Info(&quot;received offchain tx&quot;, &quot;tx&quot;, tx.Hash())</span>
<span class="term-fg32">+		tx, err := s.executeOffchainCall(ctx, tx, confidential)</span>
<span class="term-fg32">+		if err != nil {</span>
<span class="term-fg32">+			return tx.Hash(), err</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
 	return SubmitTransaction(ctx, s.b, signed)
 }
&nbsp;
<span class="term-fg36">@@ -1789,12 +1885,122 @@</span> }
&nbsp;
 &#47;&#47; SendRawTransaction will add the signed transaction to the transaction pool.
 &#47;&#47; The sender is responsible for signing the transaction and using the correct nonce.
<span class="term-fg31">-func (s *TransactionAPI) SendRawTransaction(ctx context.Context, input hexutil.Bytes) (common.Hash, error) {</span>
<span class="term-fg32">+func (s *TransactionAPI) SendRawTransaction(ctx context.Context, input hexutil.Bytes, confidential *hexutil.Bytes) (common.Hash, error) {</span>
 	tx := new(types.Transaction)
 	if err := tx.UnmarshalBinary(input); err != nil {
 		return common.Hash{}, err
 	}
<span class="term-fg32">+</span>
<span class="term-fg32">+	if tx.Type() == types.OffchainTxType {</span>
<span class="term-fg32">+		&#47;&#47; TODO: only if not yet signed</span>
<span class="term-fg32">+		&#47;&#47; TODO: this is a huge dos vector!</span>
<span class="term-fg32">+		ntx, err := s.executeOffchainCall(ctx, tx, confidential)</span>
<span class="term-fg32">+		if err != nil {</span>
<span class="term-fg32">+			return tx.Hash(), err</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		tx = ntx</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
 	return SubmitTransaction(ctx, s.b, tx)
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (s *TransactionAPI) executeOffchainCall(ctx context.Context, tx *types.Transaction, confidential *hexutil.Bytes) (*types.Transaction, error) {</span>
<span class="term-fg32">+	defer func(start time.Time) { log.Info(&quot;Executing offchain call finished&quot;, &quot;runtime&quot;, time.Since(start)) }(time.Now())</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; TODO: copy the inner, but only once</span>
<span class="term-fg32">+	offchainTx, ok := types.CastTxInner[*types.OffchainTx](tx)</span>
<span class="term-fg32">+	if !ok {</span>
<span class="term-fg32">+		return nil, errors.New(&quot;invalid transaction passed&quot;)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	log.Info(&quot;executeOffchainCall&quot;, &quot;hello$$$&quot;, &quot;hello$$$&quot;)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; Look up the wallet containing the requested execution node</span>
<span class="term-fg32">+	account := accounts.Account{Address: offchainTx.ExecutionNode}</span>
<span class="term-fg32">+	wallet, err := s.b.AccountManager().Find(account)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return nil, err</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	state, header, err := s.b.StateAndHeaderByNumber(ctx, rpc.LatestBlockNumber)</span>
<span class="term-fg32">+	if state == nil || err != nil {</span>
<span class="term-fg32">+		return nil, err</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	var cancel context.CancelFunc</span>
<span class="term-fg32">+	ctx, cancel = context.WithCancel(ctx)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; Make sure the context is cancelled when the call has completed</span>
<span class="term-fg32">+	&#47;&#47; this makes sure resources are cleaned up.</span>
<span class="term-fg32">+	defer cancel()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; Get a new instance of the EVM.</span>
<span class="term-fg32">+	msg, err := core.TransactionToMessage(tx, s.signer, header.BaseFee)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return nil, err</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	blockCtx := core.NewEVMBlockContext(header, NewChainContext(ctx, s.b), nil)</span>
<span class="term-fg32">+	evm, vmError := s.b.GetEVM(ctx, msg, state, header, &amp;vm.Config{IsOffchain: true}, &amp;blockCtx)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	if confidential != nil {</span>
<span class="term-fg32">+		evm.SetConfidentialInput(*confidential)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	log.Info(&quot;executeOffchainCall&quot;, &quot;confidential&quot;, confidential)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; Wait for the context to be done and cancel the evm. Even if the</span>
<span class="term-fg32">+	&#47;&#47; EVM has finished, cancelling may be done (repeatedly)</span>
<span class="term-fg32">+	go func() {</span>
<span class="term-fg32">+		&lt;-ctx.Done()</span>
<span class="term-fg32">+		evm.Cancel()</span>
<span class="term-fg32">+	}()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; Execute the message.</span>
<span class="term-fg32">+	gp := new(core.GasPool).AddGas(header.GasLimit)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	log.Info(&quot;executeOffchainCall&quot;, &quot;msg&quot;, msg)</span>
<span class="term-fg32">+	msg.SkipAccountChecks = true &#47;&#47; validate elsewhere!</span>
<span class="term-fg32">+	result, err := core.ApplyMessage(evm, msg, gp)</span>
<span class="term-fg32">+	&#47;&#47; If the timer caused an abort, return an appropriate error message</span>
<span class="term-fg32">+	if evm.Cancelled() {</span>
<span class="term-fg32">+		return nil, fmt.Errorf(&quot;execution aborted&quot;)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return tx, fmt.Errorf(&quot;err: %w (supplied gas %d)&quot;, err, msg.GasLimit)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if err := vmError(); err != nil {</span>
<span class="term-fg32">+		return nil, err</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	if result.Failed() {</span>
<span class="term-fg32">+		return nil, fmt.Errorf(&quot;%w: %s&quot;, result.Err, hexutil.Encode(result.Revert()))</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; Check for call in return</span>
<span class="term-fg32">+	var offchainResult []byte</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	args := abi.Arguments{abi.Argument{Type: abi.Type{T: abi.BytesTy}}}</span>
<span class="term-fg32">+	unpacked, err := args.Unpack(result.ReturnData)</span>
<span class="term-fg32">+	log.Info(&quot;executeOffchainCall&quot;, &quot;offchainResult1&quot;, unpacked)</span>
<span class="term-fg32">+	if err == nil &amp;&amp; len(unpacked[0].([]byte))%32 == 4 {</span>
<span class="term-fg32">+		log.Info(&quot;executeOffchainCall&quot;, &quot;offchainResult2&quot;, unpacked[0])</span>
<span class="term-fg32">+		&#47;&#47; This is supposed to be the case for all off-chain smart contracts!</span>
<span class="term-fg32">+		offchainResult = unpacked[0].([]byte)</span>
<span class="term-fg32">+	} else {</span>
<span class="term-fg32">+		offchainResult = result.ReturnData &#47;&#47; Or should it be nil maybe in this case?</span>
<span class="term-fg32">+		log.Info(&quot;executeOffchainCall&quot;, &quot;offchainResult3&quot;, result.ReturnData)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	log.Info(&quot;executeOffchainCall&quot;, &quot;offchainResult&quot;, offchainResult)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	offchainExecutedTxData := &amp;types.OffchainExecutedTx{ExecutionNode: offchainTx.ExecutionNode, Wrapped: offchainTx.Wrapped, OffchainResult: offchainResult}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	signed, err := wallet.SignTx(account, types.NewTx(offchainExecutedTxData), s.b.ChainConfig().ChainID)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return nil, err</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; will copy the inner tx again!</span>
<span class="term-fg32">+	return signed, nil</span>
 }
&nbsp;
 &#47;&#47; Sign calculates an ECDSA signature for:</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-805f4177d677852a67cda187" role="button"
                   aria-expanded="false" aria-controls="id-805f4177d677852a67cda187">
                    <code>internal/ethapi/api_test.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/e501b3b05db8e169f67dc78b7b59bc352b3c638d/internal/ethapi/api_test.go" target="_blank">ethereum/go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/internal/ethapi/api_test.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+9</span></div>
                        <div class="text-start"><span class="text-danger">-0</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-805f4177d677852a67cda187"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;internal&#47;ethapi&#47;api_test.go flashbots&#47;suave-geth&#47;internal&#47;ethapi&#47;api_test.go</span>
<span class="term-fg1">index 61024900b20fd5368e6740df5e8dff8938f87167..4d2d802e736c2d8fafbc4b9590adaec56915e129 100644</span>
<span class="term-fg1">--- ethereum&#47;go-ethereum&#47;internal&#47;ethapi&#47;api_test.go</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;internal&#47;ethapi&#47;api_test.go</span>
<span class="term-fg36">@@ -46,6 +46,7 @@</span> 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;ethdb&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;event&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;params&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;rpc&quot;
<span class="term-fg32">+	suave &quot;github.com&#47;ethereum&#47;go-ethereum&#47;suave&#47;core&quot;</span>
 	&quot;golang.org&#47;x&#47;crypto&#47;sha3&quot;
 )
&nbsp;
<span class="term-fg36">@@ -343,6 +344,14 @@</span> 	panic(&quot;implement me&quot;)
 }
 func (b testBackend) BloomStatus() (uint64, uint64) { panic(&quot;implement me&quot;) }
 func (b testBackend) ServiceFilter(ctx context.Context, session *bloombits.MatcherSession) {
<span class="term-fg32">+	panic(&quot;implement me&quot;)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (b testBackend) BuildBlockFromTxs(ctx context.Context, buildArgs *suave.BuildBlockArgs, txs types.Transactions) (*types.Block, *big.Int, error) {</span>
<span class="term-fg32">+	panic(&quot;implement me&quot;)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (b testBackend) BuildBlockFromBundles(ctx context.Context, buildArgs *suave.BuildBlockArgs, bundles []types.SBundle) (*types.Block, *big.Int, error) {</span>
 	panic(&quot;implement me&quot;)
 }
</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-cb3db3ca781ea8240fd3c839" role="button"
                   aria-expanded="false" aria-controls="id-cb3db3ca781ea8240fd3c839">
                    <code>les/api_backend.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/e501b3b05db8e169f67dc78b7b59bc352b3c638d/les/api_backend.go" target="_blank">ethereum/go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/les/api_backend.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+9</span></div>
                        <div class="text-start"><span class="text-danger">-0</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-cb3db3ca781ea8240fd3c839"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;les&#47;api_backend.go flashbots&#47;suave-geth&#47;les&#47;api_backend.go</span>
<span class="term-fg1">index 97665757b19a6793fb34c6aa78eb6c453f97e272..10168f5932ad7f7300265069ed67c21d9d1a2f42 100644</span>
<span class="term-fg1">--- ethereum&#47;go-ethereum&#47;les&#47;api_backend.go</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;les&#47;api_backend.go</span>
<span class="term-fg36">@@ -39,6 +39,7 @@</span> 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;event&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;light&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;params&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;rpc&quot;
<span class="term-fg32">+	suave &quot;github.com&#47;ethereum&#47;go-ethereum&#47;suave&#47;core&quot;</span>
 )
&nbsp;
 type LesApiBackend struct {
<span class="term-fg36">@@ -336,3 +337,11 @@</span>
 func (b *LesApiBackend) StateAtTransaction(ctx context.Context, block *types.Block, txIndex int, reexec uint64) (*core.Message, vm.BlockContext, *state.StateDB, tracers.StateReleaseFunc, error) {
 	return b.eth.stateAtTransaction(ctx, block, txIndex, reexec)
 }
<span class="term-fg32">+</span>
<span class="term-fg32">+func (b *LesApiBackend) BuildBlockFromTxs(ctx context.Context, buildArgs *suave.BuildBlockArgs, txs types.Transactions) (*types.Block, *big.Int, error) {</span>
<span class="term-fg32">+	return nil, nil, errors.New(&quot;not implemented&quot;)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (b *LesApiBackend) BuildBlockFromBundles(context.Context, *types.BuildBlockArgs, []types.SBundle) (*types.Block, *big.Int, error) {</span>
<span class="term-fg32">+	return nil, nil, errors.New(&quot;not implemented&quot;)</span>
<span class="term-fg32">+}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-1319b9d2249bfcb65b6a01ea" role="button"
                   aria-expanded="false" aria-controls="id-1319b9d2249bfcb65b6a01ea">
                    <code>core/types/receipt.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/e501b3b05db8e169f67dc78b7b59bc352b3c638d/core/types/receipt.go" target="_blank">ethereum/go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/core/types/receipt.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+7</span></div>
                        <div class="text-start"><span class="text-danger">-1</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-1319b9d2249bfcb65b6a01ea"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;core&#47;types&#47;receipt.go flashbots&#47;suave-geth&#47;core&#47;types&#47;receipt.go</span>
<span class="term-fg1">index 8fc9ec9894e5e6ad444814b06645e5eb23a8bacb..3604efc24bff33d422d2500c6cfa0bd906498e74 100644</span>
<span class="term-fg1">--- ethereum&#47;go-ethereum&#47;core&#47;types&#47;receipt.go</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;core&#47;types&#47;receipt.go</span>
<span class="term-fg36">@@ -194,7 +194,7 @@</span> 	if len(b) &lt;= 1 {
 		return errShortTypedReceipt
 	}
 	switch b[0] {
<span class="term-fg31">-	case DynamicFeeTxType, AccessListTxType:</span>
<span class="term-fg32">+	case DynamicFeeTxType, AccessListTxType, OffchainTxType, OffchainExecutedTxType:</span>
 		var data receiptRLP
 		err := rlp.DecodeBytes(b[1:], &amp;data)
 		if err != nil {
<span class="term-fg36">@@ -304,6 +304,12 @@</span> 		w.WriteByte(AccessListTxType)
 		rlp.Encode(w, data)
 	case DynamicFeeTxType:
 		w.WriteByte(DynamicFeeTxType)
<span class="term-fg32">+		rlp.Encode(w, data)</span>
<span class="term-fg32">+	case OffchainTxType:</span>
<span class="term-fg32">+		w.WriteByte(OffchainTxType)</span>
<span class="term-fg32">+		rlp.Encode(w, data)</span>
<span class="term-fg32">+	case OffchainExecutedTxType:</span>
<span class="term-fg32">+		w.WriteByte(OffchainExecutedTxType)</span>
 		rlp.Encode(w, data)
 	default:
 		&#47;&#47; For unsupported types, write nothing. Since this is for</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-1d9f25eab58a9ed1315b1c51" role="button"
                   aria-expanded="false" aria-controls="id-1d9f25eab58a9ed1315b1c51">
                    <code>accounts/external/backend.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/e501b3b05db8e169f67dc78b7b59bc352b3c638d/accounts/external/backend.go" target="_blank">ethereum/go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/accounts/external/backend.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+5</span></div>
                        <div class="text-start"><span class="text-danger">-0</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-1d9f25eab58a9ed1315b1c51"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;accounts&#47;external&#47;backend.go flashbots&#47;suave-geth&#47;accounts&#47;external&#47;backend.go</span>
<span class="term-fg1">index d403b7e562d41c2e46eecd2ac8934ed9eea16c1f..47230a4ae002c07c95f0b2e8dd2ad8f029cd008e 100644</span>
<span class="term-fg1">--- ethereum&#47;go-ethereum&#47;accounts&#47;external&#47;backend.go</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;accounts&#47;external&#47;backend.go</span>
<span class="term-fg36">@@ -17,6 +17,7 @@</span>
 package external
&nbsp;
 import (
<span class="term-fg32">+	&quot;errors&quot;</span>
 	&quot;fmt&quot;
 	&quot;math&#47;big&quot;
 	&quot;sync&quot;
<span class="term-fg36">@@ -197,6 +198,10 @@</span> &#47;&#47; If chainID is nil, or tx.ChainID is zero, the chain ID will be assigned
 &#47;&#47; by the external signer. For non-legacy transactions, the chain ID of the
 &#47;&#47; transaction overrides the chainID parameter.
 func (api *ExternalSigner) SignTx(account accounts.Account, tx *types.Transaction, chainID *big.Int) (*types.Transaction, error) {
<span class="term-fg32">+	if tx.Type() == types.OffchainTxType || tx.Type() == types.OffchainExecutedTxType {</span>
<span class="term-fg32">+		return nil, errors.New(&quot;off-chain not supported by external signers&quot;)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
 	data := hexutil.Bytes(tx.Data())
 	var to *common.MixedcaseAddress
 	if tx.To() != nil {</div>
    </div>

            
        </div>
        <div>
            
        </div>
    </div>
</div>

            
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-4cb42246b57f882ac4c08fc7"role="button" aria-expanded="false" aria-controls="id-4cb42246b57f882ac4c08fc7">
        
            <div class="col-12 col-sm-9 text-start"><h2>SUAVE extras</h2></div>
        
        <div class="col-12 col-sm-3 ms-auto mt-2">
            <div class="row line-stat">
                <div class="text-end"><span class="text-success">+4490</span></div>
                <div class="text-start"><span class="text-danger">-0</span></div>
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-4cb42246b57f882ac4c08fc7">
        <div><p>New packages with SUAVE-specific libraries &amp; tooling</p>
</div>
        <div>
            
        </div>
        <div>
            
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-1bc44fb444e041c988ee60c9"role="button" aria-expanded="false" aria-controls="id-1bc44fb444e041c988ee60c9">
        
            <div class="col-12 col-sm-9 text-start"><h3>Backends</h3></div>
        
        <div class="col-12 col-sm-3 ms-auto mt-2">
            <div class="row line-stat">
                <div class="text-end"><span class="text-success">+314</span></div>
                <div class="text-start"><span class="text-danger">-0</span></div>
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-1bc44fb444e041c988ee60c9">
        <div><p>Offchain APIs that offchain precompiles can access during execution.</p>

<p>Interfaces defined in <code>core/</code> and implementations in <code>backend/</code></p>
</div>
        <div>
            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-37b62558c2adc1304ebf73db" role="button"
                   aria-expanded="false" aria-controls="id-37b62558c2adc1304ebf73db">
                    <code>suave/backends/cdas.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/suave/backends/cdas.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+95</span></div>
                        <div class="text-start"><span class="text-danger">-0</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-37b62558c2adc1304ebf73db"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;suave&#47;backends&#47;cdas.go flashbots&#47;suave-geth&#47;suave&#47;backends&#47;cdas.go</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..2a3fb74611d281ca42c2cd07c93c1e4705488459</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;suave&#47;backends&#47;cdas.go</span>
<span class="term-fg36">@@ -0,0 +1,95 @@</span>
<span class="term-fg32">+package backends</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+import (</span>
<span class="term-fg32">+	&quot;errors&quot;</span>
<span class="term-fg32">+	&quot;fmt&quot;</span>
<span class="term-fg32">+	&quot;sync&quot;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&quot;github.com&#47;google&#47;uuid&quot;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;log&quot;</span>
<span class="term-fg32">+	suave &quot;github.com&#47;ethereum&#47;go-ethereum&#47;suave&#47;core&quot;</span>
<span class="term-fg32">+	&quot;golang.org&#47;x&#47;exp&#47;slices&quot;</span>
<span class="term-fg32">+)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+type LocalConfidentialStore struct {</span>
<span class="term-fg32">+	lock sync.Mutex</span>
<span class="term-fg32">+	bids map[suave.BidId]ACData</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func NewLocalConfidentialStore() *LocalConfidentialStore {</span>
<span class="term-fg32">+	return &amp;LocalConfidentialStore{</span>
<span class="term-fg32">+		bids: make(map[suave.BidId]ACData),</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+type ACData struct {</span>
<span class="term-fg32">+	bid     suave.Bid</span>
<span class="term-fg32">+	dataMap map[string][]byte</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; Optional key, if provided will initialize with the value</span>
<span class="term-fg32">+&#47;&#47; This function is *trusted* and not available directly through precompiles</span>
<span class="term-fg32">+&#47;&#47; In particular wrt bid id not being maliciously crafted</span>
<span class="term-fg32">+func (s *LocalConfidentialStore) Initialize(bid suave.Bid, key string, value []byte) (suave.Bid, error) {</span>
<span class="term-fg32">+	if bid.Id == [16]byte{} {</span>
<span class="term-fg32">+		bid.Id = [16]byte(uuid.New())</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	s.lock.Lock()</span>
<span class="term-fg32">+	defer s.lock.Unlock()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	_, found := s.bids[bid.Id]</span>
<span class="term-fg32">+	if found {</span>
<span class="term-fg32">+		return suave.Bid{}, errors.New(&quot;bid already present&quot;)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	acData := ACData{bid, make(map[string][]byte)}</span>
<span class="term-fg32">+	if key != &quot;&quot; {</span>
<span class="term-fg32">+		acData.dataMap[key] = value</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	s.bids[bid.Id] = acData</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	return bid, nil</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (s *LocalConfidentialStore) Store(bidId suave.BidId, caller common.Address, key string, value []byte) (suave.Bid, error) {</span>
<span class="term-fg32">+	s.lock.Lock()</span>
<span class="term-fg32">+	defer s.lock.Unlock()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	bidAcd, found := s.bids[bidId]</span>
<span class="term-fg32">+	if !found {</span>
<span class="term-fg32">+		return suave.Bid{}, errors.New(&quot;bid not initialized&quot;)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	if !slices.Contains(bidAcd.bid.AllowedPeekers, caller) {</span>
<span class="term-fg32">+		return suave.Bid{}, fmt.Errorf(&quot;%x not allowed to store %s on %x&quot;, caller, key, bidId)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	bidAcd.dataMap[key] = append(make([]byte, 0, len(value)), value...)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	defer log.Trace(&quot;CSSW&quot;, &quot;caller&quot;, caller, &quot;key&quot;, key, &quot;value&quot;, value, &quot;stored&quot;, s.bids[bidId].dataMap[key])</span>
<span class="term-fg32">+	return bidAcd.bid, nil</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (s *LocalConfidentialStore) Retrieve(bidId suave.BidId, caller common.Address, key string) ([]byte, error) {</span>
<span class="term-fg32">+	s.lock.Lock()</span>
<span class="term-fg32">+	defer s.lock.Unlock()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	bidAcd, found := s.bids[bidId]</span>
<span class="term-fg32">+	if !found {</span>
<span class="term-fg32">+		return []byte{}, fmt.Errorf(&quot;%v not found&quot;, bidId)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	if !slices.Contains(bidAcd.bid.AllowedPeekers, caller) {</span>
<span class="term-fg32">+		return []byte{}, fmt.Errorf(&quot;%x not allowed to fetch %s on %x&quot;, caller, key, bidId)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	data, found := bidAcd.dataMap[key]</span>
<span class="term-fg32">+	if !found {</span>
<span class="term-fg32">+		return []byte{}, fmt.Errorf(&quot;data for key %s not found&quot;, key)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	log.Trace(&quot;CSRW&quot;, &quot;caller&quot;, caller, &quot;key&quot;, key, &quot;data&quot;, data)</span>
<span class="term-fg32">+	return append(make([]byte, 0, len(data)), data...), nil</span>
<span class="term-fg32">+}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-8087520dee89c79912369e06" role="button"
                   aria-expanded="false" aria-controls="id-8087520dee89c79912369e06">
                    <code>suave/backends/eth_backends.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/suave/backends/eth_backends.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+85</span></div>
                        <div class="text-start"><span class="text-danger">-0</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-8087520dee89c79912369e06"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;suave&#47;backends&#47;eth_backends.go flashbots&#47;suave-geth&#47;suave&#47;backends&#47;eth_backends.go</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..73ec56b51127e90175c40e48b6034e6ad7e50e0d</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;suave&#47;backends&#47;eth_backends.go</span>
<span class="term-fg36">@@ -0,0 +1,85 @@</span>
<span class="term-fg32">+package backends</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+import (</span>
<span class="term-fg32">+	&quot;context&quot;</span>
<span class="term-fg32">+	&quot;math&#47;big&quot;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;beacon&#47;engine&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;core&#47;types&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;rpc&quot;</span>
<span class="term-fg32">+	suave &quot;github.com&#47;ethereum&#47;go-ethereum&#47;suave&#47;core&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;trie&quot;</span>
<span class="term-fg32">+)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+type EthMock struct{}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (e *EthMock) BuildEthBlock(ctx context.Context, args *suave.BuildBlockArgs, txs types.Transactions) (*engine.ExecutionPayloadEnvelope, error) {</span>
<span class="term-fg32">+	block := types.NewBlock(&amp;types.Header{GasUsed: 1000}, txs, nil, nil, trie.NewStackTrie(nil))</span>
<span class="term-fg32">+	return engine.BlockToExecutableData(block, big.NewInt(11000)), nil</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (e *EthMock) BuildEthBlockFromBundles(ctx context.Context, args *suave.BuildBlockArgs, bundles []types.SBundle) (*engine.ExecutionPayloadEnvelope, error) {</span>
<span class="term-fg32">+	var txs types.Transactions</span>
<span class="term-fg32">+	for _, bundle := range bundles {</span>
<span class="term-fg32">+		txs = append(txs, bundle.Txs...)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	block := types.NewBlock(&amp;types.Header{GasUsed: 1000}, txs, nil, nil, trie.NewStackTrie(nil))</span>
<span class="term-fg32">+	return engine.BlockToExecutableData(block, big.NewInt(11000)), nil</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+type RemoteEthBackend struct {</span>
<span class="term-fg32">+	endpoint string</span>
<span class="term-fg32">+	client   *rpc.Client</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func NewRemoteEthBackend(endpoint string) *RemoteEthBackend {</span>
<span class="term-fg32">+	return &amp;RemoteEthBackend{</span>
<span class="term-fg32">+		endpoint: endpoint,</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (e *RemoteEthBackend) BuildEthBlock(ctx context.Context, args *suave.BuildBlockArgs, txs types.Transactions) (*engine.ExecutionPayloadEnvelope, error) {</span>
<span class="term-fg32">+	if e.client == nil {</span>
<span class="term-fg32">+		&#47;&#47; should lock</span>
<span class="term-fg32">+		var err error</span>
<span class="term-fg32">+		client, err := rpc.DialContext(ctx, e.endpoint)</span>
<span class="term-fg32">+		if err != nil {</span>
<span class="term-fg32">+			return nil, err</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		e.client = client</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	var result engine.ExecutionPayloadEnvelope</span>
<span class="term-fg32">+	err := e.client.CallContext(ctx, &amp;result, &quot;eth_buildEth2Block&quot;, args, txs)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		client := e.client</span>
<span class="term-fg32">+		e.client = nil</span>
<span class="term-fg32">+		client.Close()</span>
<span class="term-fg32">+		return nil, err</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	return &amp;result, nil</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (e *RemoteEthBackend) BuildEthBlockFromBundles(ctx context.Context, args *suave.BuildBlockArgs, bundles []types.SBundle) (*engine.ExecutionPayloadEnvelope, error) {</span>
<span class="term-fg32">+	if e.client == nil {</span>
<span class="term-fg32">+		&#47;&#47; should lock</span>
<span class="term-fg32">+		var err error</span>
<span class="term-fg32">+		client, err := rpc.DialContext(ctx, e.endpoint)</span>
<span class="term-fg32">+		if err != nil {</span>
<span class="term-fg32">+			return nil, err</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		e.client = client</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	var result engine.ExecutionPayloadEnvelope</span>
<span class="term-fg32">+	err := e.client.CallContext(ctx, &amp;result, &quot;eth_buildEth2BlockFromBundles&quot;, args, bundles)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		client := e.client</span>
<span class="term-fg32">+		e.client = nil</span>
<span class="term-fg32">+		client.Close()</span>
<span class="term-fg32">+		return nil, err</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	return &amp;result, nil</span>
<span class="term-fg32">+}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-f831fe9af5bfa6104b05705a" role="button"
                   aria-expanded="false" aria-controls="id-f831fe9af5bfa6104b05705a">
                    <code>suave/backends/mempool_on_cdas.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/suave/backends/mempool_on_cdas.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+65</span></div>
                        <div class="text-start"><span class="text-danger">-0</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-f831fe9af5bfa6104b05705a"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;suave&#47;backends&#47;mempool_on_cdas.go flashbots&#47;suave-geth&#47;suave&#47;backends&#47;mempool_on_cdas.go</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..d1bc41227f45144061818b3bd5e5f84981274c0d</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;suave&#47;backends&#47;mempool_on_cdas.go</span>
<span class="term-fg36">@@ -0,0 +1,65 @@</span>
<span class="term-fg32">+package backends</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+import (</span>
<span class="term-fg32">+	&quot;errors&quot;</span>
<span class="term-fg32">+	&quot;fmt&quot;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;log&quot;</span>
<span class="term-fg32">+	suave &quot;github.com&#47;ethereum&#47;go-ethereum&#47;suave&#47;core&quot;</span>
<span class="term-fg32">+)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+type MempoolOnConfidentialStore struct {</span>
<span class="term-fg32">+	cs suave.ConfiendialStoreBackend</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func NewMempoolOnConfidentialStore(cs suave.ConfiendialStoreBackend) *MempoolOnConfidentialStore {</span>
<span class="term-fg32">+	_, err := cs.Initialize(mempoolConfidentialStoreBid, &quot;&quot;, nil)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		panic(&quot;could not initialize mempool&quot;)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	return &amp;MempoolOnConfidentialStore{</span>
<span class="term-fg32">+		cs: cs,</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+var (</span>
<span class="term-fg32">+	mempoolConfStoreId          = [16]byte{0x39}</span>
<span class="term-fg32">+	mempoolConfStoreAddr        = common.HexToAddress(&quot;0x39&quot;)</span>
<span class="term-fg32">+	mempoolConfidentialStoreBid = suave.Bid{Id: mempoolConfStoreId, AllowedPeekers: []common.Address{mempoolConfStoreAddr}}</span>
<span class="term-fg32">+)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (m *MempoolOnConfidentialStore) SubmitBid(bid suave.Bid) error {</span>
<span class="term-fg32">+	m.cs.Store(mempoolConfidentialStoreBid.Id, mempoolConfStoreAddr, fmt.Sprintf(&quot;id-%x&quot;, bid.Id), suave.MustEncode(bid))</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	defer log.Info(&quot;bid submitted&quot;, &quot;bid&quot;, bid, &quot;store&quot;, m.cs.Store)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	var bidsByBlockAndProtocol []suave.Bid</span>
<span class="term-fg32">+	bidsByBlockAndProtocolBytes, err := m.cs.Retrieve(mempoolConfidentialStoreBid.Id, mempoolConfStoreAddr, fmt.Sprintf(&quot;protocol-%s-bn-%d&quot;, bid.Version, bid.DecryptionCondition))</span>
<span class="term-fg32">+	if err == nil {</span>
<span class="term-fg32">+		bidsByBlockAndProtocol = suave.MustDecode[[]suave.Bid](bidsByBlockAndProtocolBytes)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	&#47;&#47; store bid by block number and by protocol + block number</span>
<span class="term-fg32">+	bidsByBlockAndProtocol = append(bidsByBlockAndProtocol, bid)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	m.cs.Store(mempoolConfidentialStoreBid.Id, mempoolConfStoreAddr, fmt.Sprintf(&quot;protocol-%s-bn-%d&quot;, bid.Version, bid.DecryptionCondition), suave.MustEncode(bidsByBlockAndProtocol))</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	return nil</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (m *MempoolOnConfidentialStore) FetchBidById(bidId suave.BidId) (suave.Bid, error) {</span>
<span class="term-fg32">+	bidBytes, err := m.cs.Retrieve(mempoolConfidentialStoreBid.Id, mempoolConfStoreAddr, fmt.Sprintf(&quot;id-%x&quot;, bidId))</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return suave.Bid{}, errors.New(&quot;not found&quot;)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	return suave.MustDecode[suave.Bid](bidBytes), nil</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (m *MempoolOnConfidentialStore) FetchBidsByProtocolAndBlock(blockNumber uint64, namespace string) []suave.Bid {</span>
<span class="term-fg32">+	bidsByProtocolBytes, err := m.cs.Retrieve(mempoolConfidentialStoreBid.Id, mempoolConfStoreAddr, fmt.Sprintf(&quot;protocol-%s-bn-%d&quot;, namespace, blockNumber))</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return nil</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	defer log.Info(&quot;bids fetched&quot;, &quot;bids&quot;, bidsByProtocolBytes, &quot;store&quot;, m.cs.Store)</span>
<span class="term-fg32">+	return suave.MustDecode[[]suave.Bid](bidsByProtocolBytes)</span>
<span class="term-fg32">+}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-3345e9781f4d2df916cb10ba" role="button"
                   aria-expanded="false" aria-controls="id-3345e9781f4d2df916cb10ba">
                    <code>suave/core/config.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/suave/core/config.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+7</span></div>
                        <div class="text-start"><span class="text-danger">-0</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-3345e9781f4d2df916cb10ba"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;suave&#47;core&#47;config.go flashbots&#47;suave-geth&#47;suave&#47;core&#47;config.go</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..83f34feeb9d7e490b6d5e0fb5dba43be6ab95934</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;suave&#47;core&#47;config.go</span>
<span class="term-fg36">@@ -0,0 +1,7 @@</span>
<span class="term-fg32">+package suave</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+type Config struct {</span>
<span class="term-fg32">+	SuaveEthRemoteBackendEndpoint string</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+var DefaultConfig = Config{}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-bb225d29635d15d6df7771ee" role="button"
                   aria-expanded="false" aria-controls="id-bb225d29635d15d6df7771ee">
                    <code>suave/core/utils.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/suave/core/utils.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+21</span></div>
                        <div class="text-start"><span class="text-danger">-0</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-bb225d29635d15d6df7771ee"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;suave&#47;core&#47;utils.go flashbots&#47;suave-geth&#47;suave&#47;core&#47;utils.go</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..2e45af0e1f49ccfd00ed609e2ac239ae2e8bc985</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;suave&#47;core&#47;utils.go</span>
<span class="term-fg36">@@ -0,0 +1,21 @@</span>
<span class="term-fg32">+package suave</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+import (</span>
<span class="term-fg32">+	&quot;encoding&#47;json&quot;</span>
<span class="term-fg32">+)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func MustEncode[T any](data T) []byte {</span>
<span class="term-fg32">+	res, err := json.Marshal(data)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		panic(err.Error())</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	return res</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func MustDecode[T any](data []byte) T {</span>
<span class="term-fg32">+	var t T</span>
<span class="term-fg32">+	if err := json.Unmarshal(data, &amp;t); err != nil {</span>
<span class="term-fg32">+		panic(err.Error())</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	return t</span>
<span class="term-fg32">+}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-0ff1451e10e0662058f486ad" role="button"
                   aria-expanded="false" aria-controls="id-0ff1451e10e0662058f486ad">
                    <code>suave/core/types.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/suave/core/types.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+41</span></div>
                        <div class="text-start"><span class="text-danger">-0</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-0ff1451e10e0662058f486ad"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;suave&#47;core&#47;types.go flashbots&#47;suave-geth&#47;suave&#47;core&#47;types.go</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..7b083479a086b4cd81178e91d1fdf2e328a725ec</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;suave&#47;core&#47;types.go</span>
<span class="term-fg36">@@ -0,0 +1,41 @@</span>
<span class="term-fg32">+package suave</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+import (</span>
<span class="term-fg32">+	&quot;context&quot;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;beacon&#47;engine&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&#47;hexutil&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;core&#47;types&quot;</span>
<span class="term-fg32">+)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+type Bytes = hexutil.Bytes</span>
<span class="term-fg32">+type BidId = [16]byte</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+type Bid struct {</span>
<span class="term-fg32">+	Id                  BidId            `json:&quot;id&quot;`</span>
<span class="term-fg32">+	DecryptionCondition uint64           `json:&quot;decryptionCondition&quot;` &#47;&#47; For now simply the block number. Should be either derived from the source contract, or be a contract itself</span>
<span class="term-fg32">+	AllowedPeekers      []common.Address `json:&quot;allowedPeekers&quot;`</span>
<span class="term-fg32">+	Version             string           `json:&quot;version&quot;`</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+var ConfStoreAllowedAny common.Address = common.HexToAddress(&quot;0x42&quot;)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+type ConfiendialStoreBackend interface {</span>
<span class="term-fg32">+	Initialize(bid Bid, key string, value []byte) (Bid, error)</span>
<span class="term-fg32">+	Store(bidId BidId, caller common.Address, key string, value []byte) (Bid, error)</span>
<span class="term-fg32">+	Retrieve(bid BidId, caller common.Address, key string) ([]byte, error)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+type MempoolBackend interface {</span>
<span class="term-fg32">+	SubmitBid(Bid) error</span>
<span class="term-fg32">+	FetchBidById(BidId) (Bid, error)</span>
<span class="term-fg32">+	FetchBidsByProtocolAndBlock(blockNumber uint64, namespace string) []Bid</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+type OffchainEthBackend interface {</span>
<span class="term-fg32">+	BuildEthBlock(ctx context.Context, args *BuildBlockArgs, txs types.Transactions) (*engine.ExecutionPayloadEnvelope, error)</span>
<span class="term-fg32">+	BuildEthBlockFromBundles(ctx context.Context, args *BuildBlockArgs, bundles []types.SBundle) (*engine.ExecutionPayloadEnvelope, error)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+type BuildBlockArgs = types.BuildBlockArgs</span></div>
    </div>

            
        </div>
        <div>
            
        </div>
    </div>
</div>

            
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-05219a342257252f465f98f7"role="button" aria-expanded="false" aria-controls="id-05219a342257252f465f98f7">
        
            <div class="col-12 col-sm-9 text-start"><h3>Precompiles Library</h3></div>
        
        <div class="col-12 col-sm-3 ms-auto mt-2">
            <div class="row line-stat">
                <div class="text-end"><span class="text-success">+474</span></div>
                <div class="text-start"><span class="text-danger">-0</span></div>
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-05219a342257252f465f98f7">
        <div><p>A convenient wrapper for calling the SUAVE precompiles from Solidity. The
library makes the precompiles easier to call by providing the signatures,
and the library functions themselves simply perform a staticcall of the
requested precompile.</p>
</div>
        <div>
            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-3ed90b504c05a9dc9616bfa8" role="button"
                   aria-expanded="false" aria-controls="id-3ed90b504c05a9dc9616bfa8">
                    <code>suave/sol/libraries/Suave.sol</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/suave/sol/libraries/Suave.sol" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+172</span></div>
                        <div class="text-start"><span class="text-danger">-0</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-3ed90b504c05a9dc9616bfa8"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;suave&#47;sol&#47;libraries&#47;Suave.sol flashbots&#47;suave-geth&#47;suave&#47;sol&#47;libraries&#47;Suave.sol</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..48ece877148070a1af4839c0284c829fb3f1480e</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;suave&#47;sol&#47;libraries&#47;Suave.sol</span>
<span class="term-fg36">@@ -0,0 +1,172 @@</span>
<span class="term-fg32">+pragma solidity ^0.8.8;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+library Suave {</span>
<span class="term-fg32">+    error PeekerReverted(address, bytes);</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+    address public constant IS_OFFCHAIN_ADDR =</span>
<span class="term-fg32">+        0x0000000000000000000000000000000042010000;</span>
<span class="term-fg32">+    address public constant CONFIDENTIAL_INPUTS =</span>
<span class="term-fg32">+        0x0000000000000000000000000000000042010001;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+    address public constant CONFIDENTIAL_STORE =</span>
<span class="term-fg32">+        0x0000000000000000000000000000000042020000;</span>
<span class="term-fg32">+    address public constant CONFIDENTIAL_RETRIEVE =</span>
<span class="term-fg32">+        0x0000000000000000000000000000000042020001;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+    address public constant NEW_BID =</span>
<span class="term-fg32">+        0x0000000000000000000000000000000042030000;</span>
<span class="term-fg32">+    address public constant FETCH_BIDS =</span>
<span class="term-fg32">+        0x0000000000000000000000000000000042030001;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+    address public constant SIMULATE_BUNDLE_PEEKER =</span>
<span class="term-fg32">+        0x0000000000000000000000000000000042100000;</span>
<span class="term-fg32">+    address public constant EXTRACT_HINT =</span>
<span class="term-fg32">+        0x0000000000000000000000000000000042100037;</span>
<span class="term-fg32">+    address public constant BUILD_ETH_BLOCK_PEEKER =</span>
<span class="term-fg32">+        0x0000000000000000000000000000000042100001;</span>
<span class="term-fg32">+    address public constant SUBMIT_ETH_BLOCK_BID_TO_RELAY =</span>
<span class="term-fg32">+        0x0000000000000000000000000000000042100002;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	type BidId is bytes16;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+    struct Bid {</span>
<span class="term-fg32">+        BidId id;</span>
<span class="term-fg32">+        uint64 decryptionCondition;</span>
<span class="term-fg32">+        address[] allowedPeekers;</span>
<span class="term-fg32">+    }</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+    struct Withdrawal {</span>
<span class="term-fg32">+         uint64 index;</span>
<span class="term-fg32">+         uint64 validator;</span>
<span class="term-fg32">+         address Address;</span>
<span class="term-fg32">+         uint64 amount;</span>
<span class="term-fg32">+    }</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+    struct BuildBlockArgs {</span>
<span class="term-fg32">+         uint64 slot;</span>
<span class="term-fg32">+         bytes proposerPubkey;</span>
<span class="term-fg32">+         bytes32 parent;</span>
<span class="term-fg32">+         uint64 timestamp;</span>
<span class="term-fg32">+         address feeRecipient;</span>
<span class="term-fg32">+         uint64 gasLimit;</span>
<span class="term-fg32">+         bytes32 random;</span>
<span class="term-fg32">+         Withdrawal[] withdrawals;</span>
<span class="term-fg32">+    }</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+    &#47;&#47; Returns whether execution is off- or on-chain</span>
<span class="term-fg32">+    function isOffchain() internal view returns (bool b) {</span>
<span class="term-fg32">+        (bool success, bytes memory isOffchainBytes) = IS_OFFCHAIN_ADDR.staticcall(&quot;&quot;);</span>
<span class="term-fg32">+        if (!success) {</span>
<span class="term-fg32">+            revert PeekerReverted(IS_OFFCHAIN_ADDR, isOffchainBytes);</span>
<span class="term-fg32">+        }</span>
<span class="term-fg32">+        assembly {</span>
<span class="term-fg32">+            &#47;&#47; Load the length of data (first 32 bytes)</span>
<span class="term-fg32">+            let len := mload(isOffchainBytes)</span>
<span class="term-fg32">+            &#47;&#47; Load the data after 32 bytes, so add 0x20</span>
<span class="term-fg32">+            b := mload(add(isOffchainBytes, 0x20))</span>
<span class="term-fg32">+        }</span>
<span class="term-fg32">+    }</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+    &#47;&#47; Temporay with this call</span>
<span class="term-fg32">+    function confidentialInputs() internal view returns (bytes memory) {</span>
<span class="term-fg32">+        (bool success, bytes memory inputs) = CONFIDENTIAL_INPUTS.staticcall(&quot;&quot;);</span>
<span class="term-fg32">+        if (!success) {</span>
<span class="term-fg32">+            revert PeekerReverted(CONFIDENTIAL_INPUTS, inputs);</span>
<span class="term-fg32">+        }</span>
<span class="term-fg32">+        return inputs;</span>
<span class="term-fg32">+    }</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+    &#47;&#47; Generates a new, random id and stores the bid</span>
<span class="term-fg32">+    function newBid(uint64 decryptionCondition, address[] memory allowedPeekers, string memory BidType) internal view returns (Bid memory) {</span>
<span class="term-fg32">+        (bool success, bytes memory bidBytes) = NEW_BID.staticcall(abi.encode(decryptionCondition, allowedPeekers, BidType));</span>
<span class="term-fg32">+        if (!success) {</span>
<span class="term-fg32">+            revert PeekerReverted(NEW_BID, bidBytes);</span>
<span class="term-fg32">+        }</span>
<span class="term-fg32">+        return abi.decode(bidBytes, (Bid));</span>
<span class="term-fg32">+    }</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; Returns bids matching the decryption condition.</span>
<span class="term-fg32">+	function fetchBids(uint64 cond, string memory namespace) internal view returns (Bid[] memory) {</span>
<span class="term-fg32">+        (bool success, bytes memory packedBids) = FETCH_BIDS.staticcall(</span>
<span class="term-fg32">+            abi.encode(cond, namespace)</span>
<span class="term-fg32">+        );</span>
<span class="term-fg32">+        if (!success) {</span>
<span class="term-fg32">+            revert PeekerReverted(FETCH_BIDS, packedBids);</span>
<span class="term-fg32">+        }</span>
<span class="term-fg32">+        Bid[] memory bids = abi.decode(packedBids, (Bid[]));</span>
<span class="term-fg32">+        return bids;</span>
<span class="term-fg32">+    }</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+     &#47;&#47; Stores confidential bid&#39;s data</span>
<span class="term-fg32">+    &#47;&#47; Both the caller AND store peeker have to be allowed on the bid!</span>
<span class="term-fg32">+    function confidentialStoreStore(BidId bidId, string memory key, bytes memory data) internal view {</span>
<span class="term-fg32">+        (bool success, bytes memory resp) = CONFIDENTIAL_STORE.staticcall(abi.encode(bidId, key, data));</span>
<span class="term-fg32">+        if (!success) {</span>
<span class="term-fg32">+            revert PeekerReverted(CONFIDENTIAL_STORE, resp);</span>
<span class="term-fg32">+        }</span>
<span class="term-fg32">+    }</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+    function confidentialStoreRetrieve(BidId bidId, string memory key) internal view returns (bytes memory) {</span>
<span class="term-fg32">+        (bool success, bytes memory data) = CONFIDENTIAL_RETRIEVE.staticcall(abi.encode(bidId, key));</span>
<span class="term-fg32">+        if (!success) {</span>
<span class="term-fg32">+            revert PeekerReverted(CONFIDENTIAL_RETRIEVE, data);</span>
<span class="term-fg32">+        }</span>
<span class="term-fg32">+        return data;</span>
<span class="term-fg32">+    }</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+    function simulateBundle(bytes memory bundleData) internal view returns (bool, uint64) { &#47;&#47; returns egp</span>
<span class="term-fg32">+        (bool success, bytes memory simResults) = SIMULATE_BUNDLE_PEEKER.staticcall(bundleData);</span>
<span class="term-fg32">+        if (!success) {</span>
<span class="term-fg32">+            return (false, 0);</span>
<span class="term-fg32">+        }</span>
<span class="term-fg32">+        return (success, abi.decode(simResults, (uint64)));</span>
<span class="term-fg32">+    }</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+    function extractHint(bytes memory bundleData) internal view returns (bytes memory) {</span>
<span class="term-fg32">+		require(isOffchain());</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+        (bool success, bytes memory data) = EXTRACT_HINT.staticcall(abi.encode(bundleData));</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+        if (!success) {</span>
<span class="term-fg32">+            revert PeekerReverted(EXTRACT_HINT, data);</span>
<span class="term-fg32">+        }</span>
<span class="term-fg32">+        return data;</span>
<span class="term-fg32">+    }</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; Builds a block based on the single bid passed in.</span>
<span class="term-fg32">+	&#47;&#47; Returns a bid which contains the built block and can be queried.</span>
<span class="term-fg32">+	&#47;&#47; The input bid may contain some intermediate cached results</span>
<span class="term-fg32">+	&#47;&#47; speeding up the subsequent block building calls.</span>
<span class="term-fg32">+	function buildEthBlock(BuildBlockArgs memory blockArgs, BidId bid, string memory namespace) internal view returns (bytes memory, bytes memory) {</span>
<span class="term-fg32">+        (bool success, bytes memory builderBid) = BUILD_ETH_BLOCK_PEEKER.staticcall(</span>
<span class="term-fg32">+            abi.encode(blockArgs, bid, namespace)</span>
<span class="term-fg32">+        );</span>
<span class="term-fg32">+        if (!success) {</span>
<span class="term-fg32">+            revert PeekerReverted(BUILD_ETH_BLOCK_PEEKER, builderBid);</span>
<span class="term-fg32">+        }</span>
<span class="term-fg32">+        return abi.decode(builderBid, (bytes, bytes));</span>
<span class="term-fg32">+    }</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+    function submitEthBlockBidToRelay(string memory relayUrl, bytes memory builderBid) internal view returns (bool, bytes memory) {</span>
<span class="term-fg32">+		require(isOffchain());</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+        (bool success, bytes memory err) = SUBMIT_ETH_BLOCK_BID_TO_RELAY.staticcall(</span>
<span class="term-fg32">+            abi.encode(relayUrl, builderBid)</span>
<span class="term-fg32">+        );</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+        return (success, err);</span>
<span class="term-fg32">+    }</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+function idsEqual(Suave.BidId _l, Suave.BidId _r) pure returns (bool) {</span>
<span class="term-fg32">+    bytes memory l = abi.encodePacked(_l);</span>
<span class="term-fg32">+    bytes memory r = abi.encodePacked(_r);</span>
<span class="term-fg32">+    for (uint i = 0; i &lt; l.length; i++) {</span>
<span class="term-fg32">+        if (bytes(l)[i] != r[i]) {</span>
<span class="term-fg32">+            return false;</span>
<span class="term-fg32">+        }</span>
<span class="term-fg32">+    }</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+    return true;</span>
<span class="term-fg32">+}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-869e09ca8146ac01c8baeb4e" role="button"
                   aria-expanded="false" aria-controls="id-869e09ca8146ac01c8baeb4e">
                    <code>suave/sol/libraries/SuaveAbi.sol</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/suave/sol/libraries/SuaveAbi.sol" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+16</span></div>
                        <div class="text-start"><span class="text-danger">-0</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-869e09ca8146ac01c8baeb4e"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;suave&#47;sol&#47;libraries&#47;SuaveAbi.sol flashbots&#47;suave-geth&#47;suave&#47;sol&#47;libraries&#47;SuaveAbi.sol</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..ba9815d5db5f8149cdfecfe24208b5523ba19830</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;suave&#47;sol&#47;libraries&#47;SuaveAbi.sol</span>
<span class="term-fg36">@@ -0,0 +1,16 @@</span>
<span class="term-fg32">+pragma solidity ^0.8.8;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+import {Suave} from &quot;libraries&#47;Suave.sol&quot;;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+contract SuaveAbi {</span>
<span class="term-fg32">+    error PeekerReverted(address, bytes);</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+    function newBid(uint64 decryptionCondition, address[] memory allowedPeekers, string memory BidType) external view returns (Suave.Bid memory) {}</span>
<span class="term-fg32">+	function fetchBids(uint64 cond, string memory namespace) external view returns (Suave.Bid[] memory) {}</span>
<span class="term-fg32">+    function confidentialStoreStore(Suave.BidId bidId, string memory key, bytes memory data) external view {}</span>
<span class="term-fg32">+    function confidentialStoreRetrieve(Suave.BidId bidId, string memory key) external view returns (bytes memory) {}</span>
<span class="term-fg32">+    function simulateBundle(bytes memory bundleData) external view returns (uint64) {}</span>
<span class="term-fg32">+    function extractHint(bytes memory bundleData) external view returns (bytes memory) {}</span>
<span class="term-fg32">+	function buildEthBlock(Suave.BuildBlockArgs memory blockArgs, Suave.BidId bid, string memory namespace) external view returns (bytes memory, bytes memory) {}</span>
<span class="term-fg32">+    function submitEthBlockBidToRelay(string memory relayUrl, bytes memory builderBid) external view returns (bytes memory) {}</span>
<span class="term-fg32">+}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-a03d5cb0d69eedfddb49523f" role="button"
                   aria-expanded="false" aria-controls="id-a03d5cb0d69eedfddb49523f">
                    <code>suave/sol/standard_peekers/bids.sol</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/suave/sol/standard_peekers/bids.sol" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+286</span></div>
                        <div class="text-start"><span class="text-danger">-0</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-a03d5cb0d69eedfddb49523f"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;suave&#47;sol&#47;standard_peekers&#47;bids.sol flashbots&#47;suave-geth&#47;suave&#47;sol&#47;standard_peekers&#47;bids.sol</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..abad1f1330944ffd6a2a117feda6485d08decce3</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;suave&#47;sol&#47;standard_peekers&#47;bids.sol</span>
<span class="term-fg36">@@ -0,0 +1,286 @@</span>
<span class="term-fg32">+pragma solidity ^0.8.8;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+import &quot;..&#47;libraries&#47;Suave.sol&quot;;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+contract AnyBidContract {</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	event BidEvent(</span>
<span class="term-fg32">+		Suave.BidId bidId,</span>
<span class="term-fg32">+		uint64 decryptionCondition,</span>
<span class="term-fg32">+		address[] allowedPeekers</span>
<span class="term-fg32">+	);</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	function fetchBidConfidentialBundleData() public returns (bytes memory) {</span>
<span class="term-fg32">+		require(Suave.isOffchain());</span>
<span class="term-fg32">+		</span>
<span class="term-fg32">+		bytes memory confidentialInputs = Suave.confidentialInputs();</span>
<span class="term-fg32">+		return abi.decode(confidentialInputs, (bytes));</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; Bids to this contract should not be trusted!</span>
<span class="term-fg32">+	function emitBid(Suave.Bid calldata bid) public {</span>
<span class="term-fg32">+		emit BidEvent(bid.id, bid.decryptionCondition, bid.allowedPeekers);</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+contract BundleBidContract is AnyBidContract {</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	function newBid(uint64 decryptionCondition, address[] memory bidAllowedPeekers) external payable returns (bytes memory) {</span>
<span class="term-fg32">+		require(Suave.isOffchain());</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		bytes memory bundleData = this.fetchBidConfidentialBundleData();</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		(bool simOk, uint64 egp) = Suave.simulateBundle(bundleData);</span>
<span class="term-fg32">+		if (!simOk) {</span>
<span class="term-fg32">+			revert Suave.PeekerReverted(address(this), &quot;bundle did not simulate correctly&quot;);</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		Suave.Bid memory bid = Suave.newBid(decryptionCondition, bidAllowedPeekers, &quot;default:v0:ethBundles&quot;);</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		Suave.confidentialStoreStore(bid.id, &quot;default:v0:ethBundles&quot;, bundleData);</span>
<span class="term-fg32">+		Suave.confidentialStoreStore(bid.id, &quot;default:v0:ethBundleSimResults&quot;, abi.encode(egp));</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		emit BidEvent(bid.id, bid.decryptionCondition, bid.allowedPeekers);</span>
<span class="term-fg32">+		return bytes.concat(this.emitBid.selector, abi.encode(bid));</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+contract MevShareBidContract is AnyBidContract {</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	event HintEvent(</span>
<span class="term-fg32">+		Suave.BidId bidId,</span>
<span class="term-fg32">+		bytes hint</span>
<span class="term-fg32">+	);</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	event MatchEvent(</span>
<span class="term-fg32">+		Suave.BidId matchBidId,</span>
<span class="term-fg32">+		bytes bidhint,</span>
<span class="term-fg32">+		bytes matchHint</span>
<span class="term-fg32">+	);</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	function newBid(uint64 decryptionCondition, address[] memory bidAllowedPeekers) external payable returns (bytes memory) {</span>
<span class="term-fg32">+		&#47;&#47; 0. check offchain execution</span>
<span class="term-fg32">+		require(Suave.isOffchain());</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		&#47;&#47; 1. fetch bundle data</span>
<span class="term-fg32">+		bytes memory bundleData = this.fetchBidConfidentialBundleData();</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		&#47;&#47; 2. sim bundle</span>
<span class="term-fg32">+		(bool simOk, uint64 egp) = Suave.simulateBundle(bundleData);</span>
<span class="term-fg32">+		if (!simOk) {</span>
<span class="term-fg32">+			revert Suave.PeekerReverted(address(this), &quot;bundle does not simulate correctly&quot;);</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		</span>
<span class="term-fg32">+		&#47;&#47; 3. extract hint</span>
<span class="term-fg32">+		bytes memory hint = Suave.extractHint(bundleData);</span>
<span class="term-fg32">+		</span>
<span class="term-fg32">+		&#47;&#47; &#47;&#47; 4. store bundle and sim results</span>
<span class="term-fg32">+		Suave.Bid memory bid = Suave.newBid(decryptionCondition, bidAllowedPeekers, &quot;mevshare:v0:unmatchedBundles&quot;);</span>
<span class="term-fg32">+		Suave.confidentialStoreStore(bid.id, &quot;mevshare:v0:ethBundles&quot;, bundleData);</span>
<span class="term-fg32">+		Suave.confidentialStoreStore(bid.id, &quot;mevshare:v0:ethBundleSimResults&quot;, abi.encode(egp));</span>
<span class="term-fg32">+		emit BidEvent(bid.id, bid.decryptionCondition, bid.allowedPeekers);</span>
<span class="term-fg32">+		emit HintEvent(bid.id, hint);</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		&#47;&#47; &#47;&#47; 5. return &quot;callback&quot; to emit hint onchain</span>
<span class="term-fg32">+		return bytes.concat(this.emitBidAndHint.selector, abi.encode(bid, hint));</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	function emitBidAndHint(Suave.Bid calldata bid, bytes memory hint) public {</span>
<span class="term-fg32">+		emit BidEvent(bid.id, bid.decryptionCondition, bid.allowedPeekers);</span>
<span class="term-fg32">+		emit HintEvent(bid.id, hint);</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	function newMatch(uint64 decryptionCondition, address[] memory bidAllowedPeekers, Suave.BidId shareBidId) external payable returns (bytes memory) {</span>
<span class="term-fg32">+		&#47;&#47; WARNING : this function will copy the original mev share bid</span>
<span class="term-fg32">+		&#47;&#47; into a new key with potentially different permsissions</span>
<span class="term-fg32">+		</span>
<span class="term-fg32">+		require(Suave.isOffchain());</span>
<span class="term-fg32">+		&#47;&#47; 1. fetch confidential data</span>
<span class="term-fg32">+		bytes memory matchBundleData = this.fetchBidConfidentialBundleData();</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		&#47;&#47; 2. sim match alone for validity</span>
<span class="term-fg32">+		(bool simOk, uint64 egp) = Suave.simulateBundle(matchBundleData);</span>
<span class="term-fg32">+		require(simOk, &quot;bundle does not simulate correctly&quot;);</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		&#47;&#47; 3. extract hint</span>
<span class="term-fg32">+		bytes memory matchHint = Suave.extractHint(matchBundleData);</span>
<span class="term-fg32">+		</span>
<span class="term-fg32">+		Suave.Bid memory bid = Suave.newBid(decryptionCondition, bidAllowedPeekers, &quot;mevshare:v0:matchBids&quot;);</span>
<span class="term-fg32">+		Suave.confidentialStoreStore(bid.id, &quot;mevshare:v0:ethBundles&quot;, matchBundleData);</span>
<span class="term-fg32">+		Suave.confidentialStoreStore(bid.id, &quot;mevshare:v0:ethBundleSimResults&quot;, abi.encode(0));</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		&#47;&#47;4. merge bids</span>
<span class="term-fg32">+		Suave.BidId[] memory bids = new Suave.BidId[](2);</span>
<span class="term-fg32">+		bids[0] = shareBidId;</span>
<span class="term-fg32">+		bids[1] = bid.id;</span>
<span class="term-fg32">+		Suave.confidentialStoreStore(bid.id, &quot;mevshare:v0:mergedBids&quot;, abi.encode(bids));</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		return bytes.concat(this.emitBid.selector, abi.encode(bid));</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	function emitMatchBidAndHint(Suave.Bid calldata bid, bytes memory bidHint, bytes memory matchHint) public {</span>
<span class="term-fg32">+		emit BidEvent(bid.id, bid.decryptionCondition, bid.allowedPeekers);</span>
<span class="term-fg32">+		emit MatchEvent(bid.id, bidHint, matchHint);</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;* Not tested or implemented on the precompile side *&#47;</span>
<span class="term-fg32">+struct EgpBidPair {</span>
<span class="term-fg32">+	uint64 egp; &#47;&#47; in wei, beware overflow</span>
<span class="term-fg32">+	Suave.BidId bidId;</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+contract EthBlockBidContract is AnyBidContract {</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	event BuilderBoostBidEvent(</span>
<span class="term-fg32">+		Suave.BidId bidId,</span>
<span class="term-fg32">+		bytes builderBid</span>
<span class="term-fg32">+	);</span>
<span class="term-fg32">+	</span>
<span class="term-fg32">+	function buildMevShare(Suave.BuildBlockArgs memory blockArgs, uint64 blockHeight) public returns (bytes memory) {</span>
<span class="term-fg32">+		require(Suave.isOffchain());</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		Suave.Bid[] memory allShareMatchBids = Suave.fetchBids(blockHeight, &quot;mevshare:v0:matchBids&quot;);</span>
<span class="term-fg32">+		Suave.Bid[] memory allShareUserBids = Suave.fetchBids(blockHeight, &quot;mevshare:v0:unmatchedBundles&quot;);</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		if (allShareUserBids.length == 0) {</span>
<span class="term-fg32">+			revert Suave.PeekerReverted(address(this), &quot;no bids&quot;);</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		Suave.Bid[] memory allBids = new Suave.Bid[](allShareUserBids.length);</span>
<span class="term-fg32">+		for (uint i = 0; i &lt; allShareUserBids.length; i++) {</span>
<span class="term-fg32">+			&#47;&#47; TODO: sort matches by egp first!</span>
<span class="term-fg32">+			Suave.Bid memory bidToInsert = allShareUserBids[i]; &#47;&#47; will be updated with the best match if any</span>
<span class="term-fg32">+			for (uint j = 0; j &lt; allShareMatchBids.length; j++) {</span>
<span class="term-fg32">+				&#47;&#47; TODO: should be done once at the start and sorted</span>
<span class="term-fg32">+				Suave.BidId[] memory mergedBidIds = abi.decode(Suave.confidentialStoreRetrieve(allShareMatchBids[j].id, &quot;mevshare:v0:mergedBids&quot;), (Suave.BidId[]));</span>
<span class="term-fg32">+				if (idsEqual(mergedBidIds[0], allShareUserBids[i].id)) {</span>
<span class="term-fg32">+					bidToInsert = allShareMatchBids[j];</span>
<span class="term-fg32">+					break;</span>
<span class="term-fg32">+				}</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+			allBids[i] = bidToInsert;</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		EgpBidPair[] memory bidsByEGP = new EgpBidPair[](allBids.length);</span>
<span class="term-fg32">+		for (uint i = 0; i &lt; allBids.length; i++) {</span>
<span class="term-fg32">+			bytes memory simResults = Suave.confidentialStoreRetrieve(allBids[i].id, &quot;mevshare:v0:ethBundleSimResults&quot;);</span>
<span class="term-fg32">+			uint64 egp = abi.decode(simResults, (uint64));</span>
<span class="term-fg32">+			bidsByEGP[i] = EgpBidPair(egp, allBids[i].id);</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		&#47;&#47; Bubble sort, cause why not</span>
<span class="term-fg32">+		uint n = bidsByEGP.length;</span>
<span class="term-fg32">+		for (uint i = 0; i &lt; n - 1; i++) {</span>
<span class="term-fg32">+			for (uint j = i + 1; j &lt; n; j++) {</span>
<span class="term-fg32">+				if (bidsByEGP[i].egp &lt; bidsByEGP[j].egp) {</span>
<span class="term-fg32">+					EgpBidPair memory temp = bidsByEGP[i];</span>
<span class="term-fg32">+					bidsByEGP[i] = bidsByEGP[j];</span>
<span class="term-fg32">+					bidsByEGP[j] = temp;</span>
<span class="term-fg32">+				}</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		Suave.BidId[] memory allBidIds = new Suave.BidId[](allBids.length);</span>
<span class="term-fg32">+		for (uint i = 0; i &lt; bidsByEGP.length; i++) {</span>
<span class="term-fg32">+			allBidIds[i] = bidsByEGP[i].bidId;</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		return buildAndEmit(blockArgs, blockHeight, allBidIds, &quot;mevshare:v0&quot;);</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	function buildFromPool(Suave.BuildBlockArgs memory blockArgs, uint64 blockHeight) public returns (bytes memory) {</span>
<span class="term-fg32">+		require(Suave.isOffchain());</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		Suave.Bid[] memory allBids = Suave.fetchBids(blockHeight, &quot;default:v0:ethBundles&quot;);</span>
<span class="term-fg32">+		if (allBids.length == 0) {</span>
<span class="term-fg32">+			revert Suave.PeekerReverted(address(this), &quot;no bids&quot;);</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		EgpBidPair[] memory bidsByEGP = new EgpBidPair[](allBids.length);</span>
<span class="term-fg32">+		for (uint i = 0; i &lt; allBids.length; i++) {</span>
<span class="term-fg32">+			bytes memory simResults = Suave.confidentialStoreRetrieve(allBids[i].id, &quot;default:v0:ethBundleSimResults&quot;);</span>
<span class="term-fg32">+			uint64 egp = abi.decode(simResults, (uint64));</span>
<span class="term-fg32">+			bidsByEGP[i] = EgpBidPair(egp, allBids[i].id);</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		&#47;&#47; Bubble sort, cause why not</span>
<span class="term-fg32">+		uint n = bidsByEGP.length;</span>
<span class="term-fg32">+		for (uint i = 0; i &lt; n - 1; i++) {</span>
<span class="term-fg32">+			for (uint j = i + 1; j &lt; n; j++) {</span>
<span class="term-fg32">+				if (bidsByEGP[i].egp &lt; bidsByEGP[j].egp) {</span>
<span class="term-fg32">+					EgpBidPair memory temp = bidsByEGP[i];</span>
<span class="term-fg32">+					bidsByEGP[i] = bidsByEGP[j];</span>
<span class="term-fg32">+					bidsByEGP[j] = temp;</span>
<span class="term-fg32">+				}</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		Suave.BidId[] memory allBidIds = new Suave.BidId[](allBids.length);</span>
<span class="term-fg32">+		for (uint i = 0; i &lt; bidsByEGP.length; i++) {</span>
<span class="term-fg32">+			allBidIds[i] = bidsByEGP[i].bidId;</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		return buildAndEmit(blockArgs, blockHeight, allBidIds, &quot;&quot;);</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	function buildAndEmit(Suave.BuildBlockArgs memory blockArgs, uint64 blockHeight, Suave.BidId[] memory bids, string memory namespace) public virtual returns (bytes memory) {</span>
<span class="term-fg32">+		require(Suave.isOffchain());</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		(Suave.Bid memory blockBid, bytes memory builderBid) = this.doBuild(blockArgs, blockHeight, bids, namespace);</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		emit BuilderBoostBidEvent(blockBid.id, builderBid);</span>
<span class="term-fg32">+		emit BidEvent(blockBid.id, blockBid.decryptionCondition, blockBid.allowedPeekers);</span>
<span class="term-fg32">+		return bytes.concat(this.emitBuilderBidAndBid.selector, abi.encode(blockBid, builderBid));</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	function doBuild(Suave.BuildBlockArgs memory blockArgs, uint64 blockHeight, Suave.BidId[] memory bids, string memory namespace) public view returns (Suave.Bid memory, bytes memory) {</span>
<span class="term-fg32">+		address[] memory allowedPeekers = new address[](2);</span>
<span class="term-fg32">+		allowedPeekers[0] = address(this);</span>
<span class="term-fg32">+		allowedPeekers[1] = Suave.BUILD_ETH_BLOCK_PEEKER;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		Suave.Bid memory blockBid = Suave.newBid(blockHeight, allowedPeekers, &quot;default:v0:mergedBids&quot;);</span>
<span class="term-fg32">+		Suave.confidentialStoreStore(blockBid.id, &quot;default:v0:mergedBids&quot;, abi.encode(bids));</span>
<span class="term-fg32">+		 </span>
<span class="term-fg32">+		(bytes memory builderBid, bytes memory payload) = Suave.buildEthBlock(blockArgs, blockBid.id, namespace);</span>
<span class="term-fg32">+		Suave.confidentialStoreStore(blockBid.id, &quot;default:v0:builderPayload&quot;, payload); &#47;&#47; only through this.unlock</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		return (blockBid, builderBid);</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	function emitBuilderBidAndBid(Suave.Bid memory bid, bytes memory builderBid) public returns (Suave.Bid memory, bytes memory) {</span>
<span class="term-fg32">+		emit BuilderBoostBidEvent(bid.id, builderBid);</span>
<span class="term-fg32">+		emit BidEvent(bid.id, bid.decryptionCondition, bid.allowedPeekers);</span>
<span class="term-fg32">+		return (bid, builderBid);</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	function unlock(Suave.BidId bidId, bytes memory signedBlindedHeader) public view returns (bytes memory) {</span>
<span class="term-fg32">+		require(Suave.isOffchain());</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		&#47;&#47; TODO: verify the header is correct</span>
<span class="term-fg32">+		&#47;&#47; TODO: incorporate protocol name</span>
<span class="term-fg32">+		bytes memory payload = Suave.confidentialStoreRetrieve(bidId, &quot;default:v0:builderPayload&quot;);</span>
<span class="term-fg32">+		return payload;</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+contract EthBlockBidSenderContract is EthBlockBidContract {</span>
<span class="term-fg32">+	string boostRelayUrl;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	constructor(string memory boostRelayUrl_) {</span>
<span class="term-fg32">+		boostRelayUrl = boostRelayUrl_;</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	function buildAndEmit(Suave.BuildBlockArgs memory blockArgs, uint64 blockHeight, Suave.BidId[] memory bids, string memory namespace) public virtual override returns (bytes memory) {</span>
<span class="term-fg32">+		require(Suave.isOffchain());</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		(Suave.Bid memory blockBid, bytes memory builderBid) = this.doBuild(blockArgs, blockHeight, bids, namespace);</span>
<span class="term-fg32">+		(bool ok, bytes memory err) = Suave.submitEthBlockBidToRelay(boostRelayUrl, builderBid);</span>
<span class="term-fg32">+		if (!ok) {</span>
<span class="term-fg32">+			revert Suave.PeekerReverted(address(this), err);</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		emit BidEvent(blockBid.id, blockBid.decryptionCondition, blockBid.allowedPeekers);</span>
<span class="term-fg32">+		return bytes.concat(this.emitBid.selector, abi.encode(blockBid));</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span></div>
    </div>

            
        </div>
        <div>
            
        </div>
    </div>
</div>

            
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-fe276682ee65225e71ad8ea3"role="button" aria-expanded="false" aria-controls="id-fe276682ee65225e71ad8ea3">
        
            <div class="col-12 col-sm-9 text-start"><h3>suavecli</h3></div>
        
        <div class="col-12 col-sm-3 ms-auto mt-2">
            <div class="row line-stat">
                <div class="text-end"><span class="text-success">+2487</span></div>
                <div class="text-start"><span class="text-danger">-0</span></div>
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-fe276682ee65225e71ad8ea3">
        <div><p>This repository contains the Command Line Interface (CLI) for interacting
with a Suave Geth node for live testing and demo&rsquo;ing purposes. The Suave
CLI allows users to deploy contracts, send bids, and perform various
actions related to MEV-Share and Block Building.</p>
</div>
        <div>
            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-732d201b537e58a86f5196e1" role="button"
                   aria-expanded="false" aria-controls="id-732d201b537e58a86f5196e1">
                    <code>suave/cmd/suavecli/deployMevShare.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/suave/cmd/suavecli/deployMevShare.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+106</span></div>
                        <div class="text-start"><span class="text-danger">-0</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-732d201b537e58a86f5196e1"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;suave&#47;cmd&#47;suavecli&#47;deployMevShare.go flashbots&#47;suave-geth&#47;suave&#47;cmd&#47;suavecli&#47;deployMevShare.go</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..6f86a7c8848b6e4f2e44ca3b71877ff13ff090d3</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;suave&#47;cmd&#47;suavecli&#47;deployMevShare.go</span>
<span class="term-fg36">@@ -0,0 +1,106 @@</span>
<span class="term-fg32">+package main</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+import (</span>
<span class="term-fg32">+	&quot;context&quot;</span>
<span class="term-fg32">+	&quot;crypto&#47;ecdsa&quot;</span>
<span class="term-fg32">+	&quot;flag&quot;</span>
<span class="term-fg32">+	&quot;math&#47;big&quot;</span>
<span class="term-fg32">+	&quot;os&quot;</span>
<span class="term-fg32">+	&quot;time&quot;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;cmd&#47;utils&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&#47;hexutil&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;core&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;core&#47;types&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;crypto&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;log&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;rpc&quot;</span>
<span class="term-fg32">+)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func cmdDeployMevShareContract() {</span>
<span class="term-fg32">+	flagset := flag.NewFlagSet(&quot;deployMevShare&quot;, flag.ExitOnError)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	var (</span>
<span class="term-fg32">+		suaveRpc   = flagset.String(&quot;suave_rpc&quot;, &quot;http:&#47;&#47;127.0.0.1:8545&quot;, &quot;address of suave rpc&quot;)</span>
<span class="term-fg32">+		privKeyHex = flagset.String(&quot;privkey&quot;, &quot;&quot;, &quot;private key as hex (for testing)&quot;)</span>
<span class="term-fg32">+		verbosity  = flagset.Int(&quot;verbosity&quot;, int(log.LvlInfo), &quot;log verbosity (0-5)&quot;)</span>
<span class="term-fg32">+		privKey    *ecdsa.PrivateKey</span>
<span class="term-fg32">+	)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	flagset.Parse(os.Args[2:])</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	glogger := log.NewGlogHandler(log.StreamHandler(os.Stderr, log.TerminalFormat(false)))</span>
<span class="term-fg32">+	log.Root().SetHandler(glogger)</span>
<span class="term-fg32">+	glogger.Verbosity(log.Lvl(*verbosity))</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	privKey, err := crypto.HexToECDSA(*privKeyHex)</span>
<span class="term-fg32">+	RequireNoErrorf(err, &quot;-nodekeyhex: %v&quot;, err)</span>
<span class="term-fg32">+	&#47;* shush linter *&#47; privKey.Public()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	suaveClient, err := rpc.DialContext(context.TODO(), *suaveRpc)</span>
<span class="term-fg32">+	RequireNoErrorf(err, &quot;could not connect to suave rpc: %v&quot;, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	genesis := core.DefaultSuaveGenesisBlock()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	suaveSigner := types.NewOffchainSigner(genesis.Config.ChainID)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	mevShareAddr, txHash, err := sendMevShareCreationTx(suaveClient, suaveSigner, privKey)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		log.Error(&quot;error deploying mevshare&quot;, &quot;error&quot;, err.Error())</span>
<span class="term-fg32">+		panic(err.Error())</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	RequireNoErrorf(err, &quot;could not send the deployment transaction to suave node: %v&quot;, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	for i := 0; i &lt; 10; i++ {</span>
<span class="term-fg32">+		time.Sleep(time.Duration(1+i&#47;2) * time.Second)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		var receipt = make(map[string]interface{})</span>
<span class="term-fg32">+		err = suaveClient.Call(&amp;receipt, &quot;eth_getTransactionReceipt&quot;, txHash)</span>
<span class="term-fg32">+		if err == nil &amp;&amp; receipt != nil {</span>
<span class="term-fg32">+			log.Info(&quot;All is good!&quot;, &quot;receipt&quot;, receipt, &quot;address&quot;, mevShareAddr)</span>
<span class="term-fg32">+			return</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	utils.Fatalf(&quot;did not see the receipt succeed in time. hash: %s&quot;, txHash.String())</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func sendMevShareCreationTx(suaveClient *rpc.Client, suaveSigner types.Signer, privKey *ecdsa.PrivateKey) (*common.Address, *common.Hash, error) {</span>
<span class="term-fg32">+	var suaveAccNonceBytes hexutil.Uint64</span>
<span class="term-fg32">+	err := suaveClient.Call(&amp;suaveAccNonceBytes, &quot;eth_getTransactionCount&quot;, crypto.PubkeyToAddress(privKey.PublicKey), &quot;latest&quot;)</span>
<span class="term-fg32">+	RequireNoErrorf(err, &quot;could not call eth_getTransactionCount on suave: %v&quot;, err)</span>
<span class="term-fg32">+	suaveAccNonce := uint64(suaveAccNonceBytes)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	var suaveGp hexutil.Big</span>
<span class="term-fg32">+	err = suaveClient.Call(&amp;suaveGp, &quot;eth_gasPrice&quot;)</span>
<span class="term-fg32">+	RequireNoErrorf(err, &quot;could not call eth_gasPrice on suave: %v&quot;, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	calldata := hexutil.MustDecode(mevshareContractBytecode)</span>
<span class="term-fg32">+	log.Info(&quot;contract address will be&quot;, &quot;mevshareContractBytecode&quot;, mevshareContractBytecode)</span>
<span class="term-fg32">+	log.Info(&quot;contract address will be&quot;, &quot;calldata&quot;, calldata)</span>
<span class="term-fg32">+	ccTxData := &amp;types.LegacyTx{</span>
<span class="term-fg32">+		Nonce:    suaveAccNonce,</span>
<span class="term-fg32">+		To:       nil, &#47;&#47; contract creation</span>
<span class="term-fg32">+		Value:    big.NewInt(0),</span>
<span class="term-fg32">+		Gas:      10000000,</span>
<span class="term-fg32">+		GasPrice: (*big.Int)(&amp;suaveGp),</span>
<span class="term-fg32">+		Data:     calldata,</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	tx, err := types.SignTx(types.NewTx(ccTxData), suaveSigner, privKey)</span>
<span class="term-fg32">+	RequireNoErrorf(err, &quot;could not sign the deployment transaction: %v&quot;, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	from, _ := types.Sender(suaveSigner, tx)</span>
<span class="term-fg32">+	mevshareAddr := crypto.CreateAddress(from, tx.Nonce())</span>
<span class="term-fg32">+	log.Info(&quot;contract address will be&quot;, &quot;addr&quot;, mevshareAddr)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	txBytes, err := tx.MarshalBinary()</span>
<span class="term-fg32">+	RequireNoErrorf(err, &quot;could not marshal the deployment transaction: %v&quot;, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	var txHash common.Hash</span>
<span class="term-fg32">+	err = suaveClient.Call(&amp;txHash, &quot;eth_sendRawTransaction&quot;, hexutil.Encode(txBytes))</span>
<span class="term-fg32">+	RequireNoErrorf(err, &quot;could not send the deployment transaction to suave node: %v&quot;, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	return &amp;mevshareAddr, &amp;txHash, nil</span>
<span class="term-fg32">+}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-1eb8a4d2ae2a8814c1f13a7c" role="button"
                   aria-expanded="false" aria-controls="id-1eb8a4d2ae2a8814c1f13a7c">
                    <code>suave/cmd/suavecli/sendBuildShareBlock.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/suave/cmd/suavecli/sendBuildShareBlock.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+202</span></div>
                        <div class="text-start"><span class="text-danger">-0</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-1eb8a4d2ae2a8814c1f13a7c"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;suave&#47;cmd&#47;suavecli&#47;sendBuildShareBlock.go flashbots&#47;suave-geth&#47;suave&#47;cmd&#47;suavecli&#47;sendBuildShareBlock.go</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..f4681cf62e15c01f9daa64764836c8ccced6f0bf</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;suave&#47;cmd&#47;suavecli&#47;sendBuildShareBlock.go</span>
<span class="term-fg36">@@ -0,0 +1,202 @@</span>
<span class="term-fg32">+package main</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+import (</span>
<span class="term-fg32">+	&quot;context&quot;</span>
<span class="term-fg32">+	&quot;crypto&#47;ecdsa&quot;</span>
<span class="term-fg32">+	&quot;flag&quot;</span>
<span class="term-fg32">+	&quot;math&#47;big&quot;</span>
<span class="term-fg32">+	&quot;os&quot;</span>
<span class="term-fg32">+	&quot;strings&quot;</span>
<span class="term-fg32">+	&quot;time&quot;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;cmd&#47;utils&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&#47;hexutil&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;core&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;core&#47;types&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;crypto&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;log&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;rpc&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;pkg&#47;errors&quot;</span>
<span class="term-fg32">+)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+type payloadArgs struct {</span>
<span class="term-fg32">+	Slot           uint64</span>
<span class="term-fg32">+	ProposerPubkey []byte</span>
<span class="term-fg32">+	Parent         common.Hash</span>
<span class="term-fg32">+	Timestamp      uint64</span>
<span class="term-fg32">+	FeeRecipient   common.Address</span>
<span class="term-fg32">+	GasLimit       uint64</span>
<span class="term-fg32">+	Random         common.Hash</span>
<span class="term-fg32">+	Withdrawals    []struct {</span>
<span class="term-fg32">+		Index     uint64</span>
<span class="term-fg32">+		Validator uint64</span>
<span class="term-fg32">+		Address   common.Address</span>
<span class="term-fg32">+		Amount    uint64</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func cmdSendBuildShareBlock() {</span>
<span class="term-fg32">+	flagset := flag.NewFlagSet(&quot;sendBuildShareBlock&quot;, flag.ExitOnError)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	var (</span>
<span class="term-fg32">+		suaveRpc                = flagset.String(&quot;suave_rpc&quot;, &quot;http:&#47;&#47;127.0.0.1:8545&quot;, &quot;address of suave rpc&quot;)</span>
<span class="term-fg32">+		goerliRpc               = flagset.String(&quot;goerli_rpc&quot;, &quot;http:&#47;&#47;127.0.0.1:8545&quot;, &quot;address of goerli rpc&quot;)</span>
<span class="term-fg32">+		goerliBeaconRpc         = flagset.String(&quot;goerli_beacon_rpc&quot;, &quot;http:&#47;&#47;127.0.0.1:5052&quot;, &quot;address of goerli beacon rpc&quot;)</span>
<span class="term-fg32">+		boostRelayUrl           = flagset.String(&quot;relay_url&quot;, &quot;http:&#47;&#47;127.0.0.1:8091&quot;, &quot;address of boost relay that the contract will send blocks to&quot;)</span>
<span class="term-fg32">+		blockSenderAddressHex   = flagset.String(&quot;block_sender_addr&quot;, &quot;0x42042042028AE1CDE26d5BcF17Ba83f447068E5B&quot;, &quot;address of block sender contract&quot;)</span>
<span class="term-fg32">+		executionNodeAddressHex = flagset.String(&quot;ex_node_addr&quot;, &quot;0x4E2B0c0e428AE1CDE26d5BcF17Ba83f447068E5B&quot;, &quot;wallet address of execution node&quot;)</span>
<span class="term-fg32">+		privKeyHex              = flagset.String(&quot;privkey&quot;, &quot;&quot;, &quot;private key as hex (for testing)&quot;)</span>
<span class="term-fg32">+		verbosity               = flagset.Int(&quot;verbosity&quot;, int(log.LvlInfo), &quot;log verbosity (0-5)&quot;)</span>
<span class="term-fg32">+		privKey                 *ecdsa.PrivateKey</span>
<span class="term-fg32">+	)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	flagset.Parse(os.Args[2:])</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	glogger := log.NewGlogHandler(log.StreamHandler(os.Stderr, log.TerminalFormat(false)))</span>
<span class="term-fg32">+	log.Root().SetHandler(glogger)</span>
<span class="term-fg32">+	glogger.Verbosity(log.Lvl(*verbosity))</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	privKey, err := crypto.HexToECDSA(*privKeyHex)</span>
<span class="term-fg32">+	RequireNoErrorf(err, &quot;-nodekeyhex: %v&quot;, err)</span>
<span class="term-fg32">+	&#47;* shush linter *&#47; privKey.Public()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	if executionNodeAddressHex == nil || *executionNodeAddressHex == &quot;&quot; {</span>
<span class="term-fg32">+		utils.Fatalf(&quot;please provide ex_node_addr&quot;)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	executionNodeAddress := common.HexToAddress(*executionNodeAddressHex)</span>
<span class="term-fg32">+	blockSenderAddr := common.HexToAddress(*blockSenderAddressHex)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	suaveClient, err := rpc.DialContext(context.TODO(), *suaveRpc)</span>
<span class="term-fg32">+	RequireNoErrorf(err, &quot;could not connect to suave rpc: %v&quot;, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	goerliClient, err := rpc.DialContext(context.TODO(), *goerliRpc)</span>
<span class="term-fg32">+	RequireNoErrorf(err, &quot;could not connect to goerli rpc: %v&quot;, err)</span>
<span class="term-fg32">+	genesis := core.DefaultSuaveGenesisBlock()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	suaveSigner := types.NewOffchainSigner(genesis.Config.ChainID)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	payloadAttrC := make(chan PayloadAttributesEvent)</span>
<span class="term-fg32">+	ctx, cancel := context.WithCancel(context.TODO())</span>
<span class="term-fg32">+	defer cancel()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	go SubscribeToPayloadAttributesEvents(ctx, *goerliBeaconRpc, payloadAttrC)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; subscribe to payload attribute events from beacon chain to build blocks</span>
<span class="term-fg32">+	for paEvent := range payloadAttrC {</span>
<span class="term-fg32">+		var goerliBlockNum hexutil.Uint64</span>
<span class="term-fg32">+		err = goerliClient.Call(&amp;goerliBlockNum, &quot;eth_blockNumber&quot;)</span>
<span class="term-fg32">+		if err != nil {</span>
<span class="term-fg32">+			log.Error(&quot;could not get goerli block&quot;, &quot;err&quot;, err)</span>
<span class="term-fg32">+			continue</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		validatorData, err := getValidatorForSlot(*boostRelayUrl, paEvent.Data.ProposalSlot)</span>
<span class="term-fg32">+		if err != nil || len(validatorData.Pubkey) == 0 {</span>
<span class="term-fg32">+			log.Error(&quot;could not get validator&quot;, &quot;slot&quot;, paEvent.Data.ProposalSlot, &quot;err&quot;, err)</span>
<span class="term-fg32">+			continue</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		log.Info(&quot;got validator&quot;, &quot;vd&quot;, validatorData)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		payloadArgsTuple := struct {</span>
<span class="term-fg32">+			Slot           uint64</span>
<span class="term-fg32">+			ProposerPubkey []byte</span>
<span class="term-fg32">+			Parent         common.Hash</span>
<span class="term-fg32">+			Timestamp      uint64</span>
<span class="term-fg32">+			FeeRecipient   common.Address</span>
<span class="term-fg32">+			GasLimit       uint64</span>
<span class="term-fg32">+			Random         common.Hash</span>
<span class="term-fg32">+			Withdrawals    []struct {</span>
<span class="term-fg32">+				Index     uint64</span>
<span class="term-fg32">+				Validator uint64</span>
<span class="term-fg32">+				Address   common.Address</span>
<span class="term-fg32">+				Amount    uint64</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+		}{</span>
<span class="term-fg32">+			Slot:           paEvent.Data.ProposalSlot,</span>
<span class="term-fg32">+			Parent:         paEvent.Data.ParentBlockHash,</span>
<span class="term-fg32">+			Timestamp:      paEvent.Data.PayloadAttributes.Timestamp,</span>
<span class="term-fg32">+			Random:         paEvent.Data.PayloadAttributes.PrevRandao,</span>
<span class="term-fg32">+			ProposerPubkey: hexutil.MustDecode(validatorData.Pubkey),</span>
<span class="term-fg32">+			FeeRecipient:   validatorData.FeeRecipient,</span>
<span class="term-fg32">+			GasLimit:       validatorData.GasLimit,</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		for _, w := range paEvent.Data.PayloadAttributes.Withdrawals {</span>
<span class="term-fg32">+			payloadArgsTuple.Withdrawals = append(payloadArgsTuple.Withdrawals, struct {</span>
<span class="term-fg32">+				Index     uint64</span>
<span class="term-fg32">+				Validator uint64</span>
<span class="term-fg32">+				Address   common.Address</span>
<span class="term-fg32">+				Amount    uint64</span>
<span class="term-fg32">+			}{</span>
<span class="term-fg32">+				Index:     uint64(w.Index),</span>
<span class="term-fg32">+				Validator: uint64(w.ValidatorIndex),</span>
<span class="term-fg32">+				Address:   common.Address(w.Address),</span>
<span class="term-fg32">+				Amount:    uint64(w.Amount),</span>
<span class="term-fg32">+			})</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		for i := 0; i &lt; 3; i++ {</span>
<span class="term-fg32">+			_, err = sendBuildShareBlockTx(suaveClient, suaveSigner, privKey, executionNodeAddress, blockSenderAddr, payloadArgsTuple, uint64(goerliBlockNum)+1)</span>
<span class="term-fg32">+			if err != nil {</span>
<span class="term-fg32">+				err = errors.Wrap(err, unwrapPeekerError(err).Error())</span>
<span class="term-fg32">+				if strings.Contains(err.Error(), &quot;no bids&quot;) {</span>
<span class="term-fg32">+					log.Error(&quot;Failed to build a block, no bids&quot;)</span>
<span class="term-fg32">+					time.Sleep(2 * time.Second)</span>
<span class="term-fg32">+					continue</span>
<span class="term-fg32">+				}</span>
<span class="term-fg32">+				log.Error(&quot;Failed to send BuildShareBlockTx&quot;, &quot;err&quot;, err)</span>
<span class="term-fg32">+				time.Sleep(2 * time.Second)</span>
<span class="term-fg32">+				continue</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+			log.Info(&quot;Sent block to relay&quot;, &quot;payload args&quot;, payloadArgsTuple, &quot;blockNum&quot;, uint64(goerliBlockNum)+1)</span>
<span class="term-fg32">+			break</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func sendBuildShareBlockTx(</span>
<span class="term-fg32">+	suaveClient *rpc.Client,</span>
<span class="term-fg32">+	suaveSigner types.Signer,</span>
<span class="term-fg32">+	privKey *ecdsa.PrivateKey,</span>
<span class="term-fg32">+	executionNodeAddress common.Address,</span>
<span class="term-fg32">+	blockSenderAddr common.Address,</span>
<span class="term-fg32">+	payloadArgsTuple payloadArgs,</span>
<span class="term-fg32">+	goerliBlockNum uint64,</span>
<span class="term-fg32">+) (*common.Hash, error) {</span>
<span class="term-fg32">+	var suaveAccNonceBytes hexutil.Uint64</span>
<span class="term-fg32">+	err := suaveClient.Call(&amp;suaveAccNonceBytes, &quot;eth_getTransactionCount&quot;, crypto.PubkeyToAddress(privKey.PublicKey), &quot;pending&quot;)</span>
<span class="term-fg32">+	RequireNoErrorf(err, &quot;could not call eth_getTransactionCount on suave: %v&quot;, err)</span>
<span class="term-fg32">+	suaveAccNonce := uint64(suaveAccNonceBytes)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	calldata, err := ethBlockBidSenderAbi.Pack(&quot;buildMevShare&quot;, payloadArgsTuple, goerliBlockNum)</span>
<span class="term-fg32">+	RequireNoErrorf(err, &quot;could not pack buildMevShare args: %v&quot;, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	wrappedTxData := &amp;types.DynamicFeeTx{</span>
<span class="term-fg32">+		Nonce:     suaveAccNonce,</span>
<span class="term-fg32">+		To:        &amp;blockSenderAddr,</span>
<span class="term-fg32">+		Value:     nil,</span>
<span class="term-fg32">+		Gas:       1000000,</span>
<span class="term-fg32">+		GasTipCap: big.NewInt(10),</span>
<span class="term-fg32">+		GasFeeCap: big.NewInt(33000000000),</span>
<span class="term-fg32">+		Data:      calldata,</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	offchainTx, err := types.SignTx(types.NewTx(&amp;types.OffchainTx{</span>
<span class="term-fg32">+		ExecutionNode: executionNodeAddress,</span>
<span class="term-fg32">+		Wrapped:       *types.NewTx(wrappedTxData),</span>
<span class="term-fg32">+	}), suaveSigner, privKey)</span>
<span class="term-fg32">+	RequireNoErrorf(err, &quot;could not sign offchainTx: %v&quot;, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	offchainTxBytes, err := offchainTx.MarshalBinary()</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return nil, err</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	var offchainTxHash common.Hash</span>
<span class="term-fg32">+	err = suaveClient.Call(&amp;offchainTxHash, &quot;eth_sendRawTransaction&quot;, hexutil.Encode(offchainTxBytes))</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	return &amp;offchainTxHash, err</span>
<span class="term-fg32">+}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-c7ab3232664e6ff4e77e5918" role="button"
                   aria-expanded="false" aria-controls="id-c7ab3232664e6ff4e77e5918">
                    <code>suave/cmd/suavecli/subscribeBeaconAndBoost.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/suave/cmd/suavecli/subscribeBeaconAndBoost.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+85</span></div>
                        <div class="text-start"><span class="text-danger">-0</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-c7ab3232664e6ff4e77e5918"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;suave&#47;cmd&#47;suavecli&#47;subscribeBeaconAndBoost.go flashbots&#47;suave-geth&#47;suave&#47;cmd&#47;suavecli&#47;subscribeBeaconAndBoost.go</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..f592780330ef0978cf9890378d631292e89106a6</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;suave&#47;cmd&#47;suavecli&#47;subscribeBeaconAndBoost.go</span>
<span class="term-fg36">@@ -0,0 +1,85 @@</span>
<span class="term-fg32">+package main</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+import (</span>
<span class="term-fg32">+	&quot;context&quot;</span>
<span class="term-fg32">+	&quot;flag&quot;</span>
<span class="term-fg32">+	&quot;os&quot;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&#47;hexutil&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;log&quot;</span>
<span class="term-fg32">+)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func cmdSubscribeBeaconAndBoost() {</span>
<span class="term-fg32">+	flagset := flag.NewFlagSet(&quot;cmdSubscribeBeaconAndBoost&quot;, flag.ExitOnError)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	var (</span>
<span class="term-fg32">+		&#47;&#47; goerliRpc               = flagset.String(&quot;goerli_rpc&quot;, &quot;http:&#47;&#47;127.0.0.1:8545&quot;, &quot;address of goerli rpc&quot;)</span>
<span class="term-fg32">+		goerliBeaconRpc = flagset.String(&quot;goerli_beacon_rpc&quot;, &quot;http:&#47;&#47;127.0.0.1:5052&quot;, &quot;address of goerli beacon rpc&quot;)</span>
<span class="term-fg32">+		boostRelayUrl   = flagset.String(&quot;relay_url&quot;, &quot;http:&#47;&#47;127.0.0.1:8091&quot;, &quot;address of boost relay that the contract will send blocks to&quot;)</span>
<span class="term-fg32">+		verbosity       = flagset.Int(&quot;verbosity&quot;, int(log.LvlInfo), &quot;log verbosity (0-5)&quot;)</span>
<span class="term-fg32">+	)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	flagset.Parse(os.Args[2:])</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	glogger := log.NewGlogHandler(log.StreamHandler(os.Stderr, log.TerminalFormat(false)))</span>
<span class="term-fg32">+	log.Root().SetHandler(glogger)</span>
<span class="term-fg32">+	glogger.Verbosity(log.Lvl(*verbosity))</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	payloadAttrC := make(chan PayloadAttributesEvent)</span>
<span class="term-fg32">+	ctx, cancel := context.WithCancel(context.TODO())</span>
<span class="term-fg32">+	defer cancel()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	go SubscribeToPayloadAttributesEvents(ctx, *goerliBeaconRpc, payloadAttrC)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	for paEvent := range payloadAttrC {</span>
<span class="term-fg32">+		validatorData, err := getValidatorForSlot(*boostRelayUrl, paEvent.Data.ProposalSlot)</span>
<span class="term-fg32">+		if err != nil {</span>
<span class="term-fg32">+			log.Error(&quot;could not get validator&quot;, &quot;slot&quot;, paEvent.Data.ProposalSlot, &quot;err&quot;, err)</span>
<span class="term-fg32">+			continue</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		log.Info(&quot;got validator&quot;, &quot;vd&quot;, validatorData)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		payloadArgsTuple := struct {</span>
<span class="term-fg32">+			Slot           uint64</span>
<span class="term-fg32">+			ProposerPubkey []byte</span>
<span class="term-fg32">+			Parent         common.Hash</span>
<span class="term-fg32">+			Timestamp      uint64</span>
<span class="term-fg32">+			FeeRecipient   common.Address</span>
<span class="term-fg32">+			GasLimit       uint64</span>
<span class="term-fg32">+			Random         common.Hash</span>
<span class="term-fg32">+			Withdrawals    []struct {</span>
<span class="term-fg32">+				Index     uint64</span>
<span class="term-fg32">+				Validator uint64</span>
<span class="term-fg32">+				Address   common.Address</span>
<span class="term-fg32">+				Amount    uint64</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+		}{</span>
<span class="term-fg32">+			Slot:           paEvent.Data.ProposalSlot,</span>
<span class="term-fg32">+			Parent:         paEvent.Data.ParentBlockHash,</span>
<span class="term-fg32">+			Timestamp:      paEvent.Data.PayloadAttributes.Timestamp,</span>
<span class="term-fg32">+			Random:         paEvent.Data.PayloadAttributes.PrevRandao,</span>
<span class="term-fg32">+			ProposerPubkey: hexutil.MustDecode(validatorData.Pubkey),</span>
<span class="term-fg32">+			FeeRecipient:   validatorData.FeeRecipient,</span>
<span class="term-fg32">+			GasLimit:       validatorData.GasLimit,</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		for _, w := range paEvent.Data.PayloadAttributes.Withdrawals {</span>
<span class="term-fg32">+			payloadArgsTuple.Withdrawals = append(payloadArgsTuple.Withdrawals, struct {</span>
<span class="term-fg32">+				Index     uint64</span>
<span class="term-fg32">+				Validator uint64</span>
<span class="term-fg32">+				Address   common.Address</span>
<span class="term-fg32">+				Amount    uint64</span>
<span class="term-fg32">+			}{</span>
<span class="term-fg32">+				Index:     uint64(w.Index),</span>
<span class="term-fg32">+				Validator: uint64(w.ValidatorIndex),</span>
<span class="term-fg32">+				Address:   common.Address(w.Address),</span>
<span class="term-fg32">+				Amount:    uint64(w.Amount),</span>
<span class="term-fg32">+			})</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		&#47;&#47; TODO: build a block using the above! also needs to get goerli block height I guess, but thats simple</span>
<span class="term-fg32">+		log.Info(&quot;PA&quot;, &quot;data&quot;, payloadArgsTuple)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-1d24ffae83081ac91a7e403b" role="button"
                   aria-expanded="false" aria-controls="id-1d24ffae83081ac91a7e403b">
                    <code>suave/cmd/suavecli/sendMevShareBundle.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/suave/cmd/suavecli/sendMevShareBundle.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+201</span></div>
                        <div class="text-start"><span class="text-danger">-0</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-1d24ffae83081ac91a7e403b"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;suave&#47;cmd&#47;suavecli&#47;sendMevShareBundle.go flashbots&#47;suave-geth&#47;suave&#47;cmd&#47;suavecli&#47;sendMevShareBundle.go</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..cd9be84a88bf033d8217412324689b8053d80e0c</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;suave&#47;cmd&#47;suavecli&#47;sendMevShareBundle.go</span>
<span class="term-fg36">@@ -0,0 +1,201 @@</span>
<span class="term-fg32">+package main</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+import (</span>
<span class="term-fg32">+	&quot;context&quot;</span>
<span class="term-fg32">+	&quot;crypto&#47;ecdsa&quot;</span>
<span class="term-fg32">+	&quot;encoding&#47;json&quot;</span>
<span class="term-fg32">+	&quot;flag&quot;</span>
<span class="term-fg32">+	&quot;math&#47;big&quot;</span>
<span class="term-fg32">+	&quot;os&quot;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;cmd&#47;utils&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&#47;hexutil&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;core&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;core&#47;types&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;crypto&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;log&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;rpc&quot;</span>
<span class="term-fg32">+)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func cmdSendMevShareBundle() {</span>
<span class="term-fg32">+	flagset := flag.NewFlagSet(&quot;sendBundle&quot;, flag.ExitOnError)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	var (</span>
<span class="term-fg32">+		suaveRpc                = flagset.String(&quot;suave_rpc&quot;, &quot;http:&#47;&#47;127.0.0.1:8545&quot;, &quot;address of suave rpc&quot;)</span>
<span class="term-fg32">+		executionNodeAddressHex = flagset.String(&quot;ex_node_addr&quot;, &quot;0x4E2B0c0e428AE1CDE26d5BcF17Ba83f447068E5B&quot;, &quot;wallet address of execution node&quot;)</span>
<span class="term-fg32">+		mevshareAddressHex      = flagset.String(&quot;mev_share_addr&quot;, &quot;0x42042042028AE1CDE26d5BcF17Ba83f447068E5B&quot;, &quot;address of mev share contract&quot;)</span>
<span class="term-fg32">+		goerliRpc               = flagset.String(&quot;goerli_rpc&quot;, &quot;http:&#47;&#47;127.0.0.1:8545&quot;, &quot;address of goerli rpc&quot;)</span>
<span class="term-fg32">+		privKeyHex              = flagset.String(&quot;privkey&quot;, &quot;&quot;, &quot;private key as hex (for testing)&quot;)</span>
<span class="term-fg32">+		verbosity               = flagset.Int(&quot;verbosity&quot;, int(log.LvlInfo), &quot;log verbosity (0-5)&quot;)</span>
<span class="term-fg32">+		privKey                 *ecdsa.PrivateKey</span>
<span class="term-fg32">+	)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	flagset.Parse(os.Args[2:])</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	glogger := log.NewGlogHandler(log.StreamHandler(os.Stderr, log.TerminalFormat(false)))</span>
<span class="term-fg32">+	log.Root().SetHandler(glogger)</span>
<span class="term-fg32">+	glogger.Verbosity(log.Lvl(*verbosity))</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	privKey, err := crypto.HexToECDSA(*privKeyHex)</span>
<span class="term-fg32">+	RequireNoErrorf(err, &quot;-nodekeyhex: %v&quot;, err)</span>
<span class="term-fg32">+	&#47;* shush linter *&#47; privKey.Public()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	if executionNodeAddressHex == nil || *executionNodeAddressHex == &quot;&quot; {</span>
<span class="term-fg32">+		utils.Fatalf(&quot;please provide ex_node_addr&quot;)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	executionNodeAddress := common.HexToAddress(*executionNodeAddressHex)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	mevshareAddresss := common.HexToAddress(*mevshareAddressHex)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	suaveClient, err := rpc.DialContext(context.TODO(), *suaveRpc)</span>
<span class="term-fg32">+	RequireNoErrorf(err, &quot;could not connect to suave rpc: %v&quot;, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	goerliClient, err := rpc.DialContext(context.TODO(), *goerliRpc)</span>
<span class="term-fg32">+	RequireNoErrorf(err, &quot;could not connect to goerli rpc: %v&quot;, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	genesis := core.DefaultSuaveGenesisBlock()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	goerliSigner := types.LatestSigner(core.DefaultGoerliGenesisBlock().Config)</span>
<span class="term-fg32">+	suaveSigner := types.NewOffchainSigner(genesis.Config.ChainID)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	log.Root().SetHandler(log.LvlFilterHandler(log.LvlInfo, log.StreamHandler(os.Stdout, log.TerminalFormat(true))))</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	_, err = sendMevShareBidTxs(suaveClient, goerliClient, suaveSigner, goerliSigner, 1, mevshareAddresss, mevshareAddresss, executionNodeAddress, privKey)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		log.Info(&quot;err&quot;, &quot;error&quot;, err.Error())</span>
<span class="term-fg32">+		panic(err.Error())</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+type mevShareBidData struct {</span>
<span class="term-fg32">+	blockNumber uint64</span>
<span class="term-fg32">+	txHash      common.Hash</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func sendMevShareBidTxs(</span>
<span class="term-fg32">+	&#47;&#47; clients</span>
<span class="term-fg32">+	suaveClient *rpc.Client,</span>
<span class="term-fg32">+	goerliClient *rpc.Client,</span>
<span class="term-fg32">+	&#47;&#47; signers</span>
<span class="term-fg32">+	suaveSigner types.Signer,</span>
<span class="term-fg32">+	goerliSigner types.Signer,</span>
<span class="term-fg32">+	&#47;&#47; tx specific</span>
<span class="term-fg32">+	nBlocks uint64,</span>
<span class="term-fg32">+	mevShareAddr common.Address,</span>
<span class="term-fg32">+	blockBuilderAddr common.Address,</span>
<span class="term-fg32">+	executionNodeAddr common.Address,</span>
<span class="term-fg32">+	privKey *ecdsa.PrivateKey,</span>
<span class="term-fg32">+) ([]mevShareBidData, error) {</span>
<span class="term-fg32">+	log.Info(&quot;sendMevShareBidTx&quot;, &quot;executionNodeAddr&quot;, executionNodeAddr)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	var startingGoerliBlockNum uint64</span>
<span class="term-fg32">+	err = goerliClient.Call((*hexutil.Uint64)(&amp;startingGoerliBlockNum), &quot;eth_blockNumber&quot;)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		utils.Fatalf(&quot;could not get goerli block: %v&quot;, err)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	_, ethBundleBytes, err := prepareEthBundle(goerliClient, goerliSigner, privKey)</span>
<span class="term-fg32">+	RequireNoErrorf(err, &quot;could not prepare eth bundle: %v&quot;, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; Prepare a bundle bid</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	var suaveAccNonce hexutil.Uint64</span>
<span class="term-fg32">+	err = suaveClient.Call(&amp;suaveAccNonce, &quot;eth_getTransactionCount&quot;, crypto.PubkeyToAddress(privKey.PublicKey), &quot;pending&quot;)</span>
<span class="term-fg32">+	RequireNoErrorf(err, &quot;could not call eth_getTransactionCount on suave: %v&quot;, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; NOTE: reusing this function selector from bid contract to avoid creating another ABI</span>
<span class="term-fg32">+	confidentialDataBytes, err := mevShareABI.Methods[&quot;fetchBidConfidentialBundleData&quot;].Outputs.Pack(ethBundleBytes)</span>
<span class="term-fg32">+	RequireNoErrorf(err, &quot;could not encode mev share bid: %v&quot;, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	allowedPeekers := []common.Address{newBlockBidAddress, extractHintAddress, buildEthBlockAddress, mevShareAddr, blockBuilderAddr}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	mevShareTxHashes := []mevShareBidData{}</span>
<span class="term-fg32">+	for blockNum := startingGoerliBlockNum + 1; blockNum &lt; startingGoerliBlockNum+nBlocks; blockNum++ {</span>
<span class="term-fg32">+		calldata, err := mevShareABI.Pack(&quot;newBid&quot;, blockNum, allowedPeekers)</span>
<span class="term-fg32">+		if err != nil {</span>
<span class="term-fg32">+			return mevShareTxHashes, err</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		mevShareTx, mevShareTxBytes, err := prepareMevShareBidTx(suaveSigner, privKey, executionNodeAddr, uint64(suaveAccNonce), calldata, mevShareAddr)</span>
<span class="term-fg32">+		if err != nil {</span>
<span class="term-fg32">+			return mevShareTxHashes, err</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		suaveAccNonce++</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		txJson, _ := mevShareTx.MarshalJSON()</span>
<span class="term-fg32">+		log.Info(&quot;sendMevShareBidTx&quot;, &quot;mevShareTx&quot;, string(txJson))</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		var offchainTxHash common.Hash</span>
<span class="term-fg32">+		err = suaveClient.Call(&amp;offchainTxHash, &quot;eth_sendRawTransaction&quot;, hexutil.Encode(mevShareTxBytes), hexutil.Encode(confidentialDataBytes))</span>
<span class="term-fg32">+		if err != nil {</span>
<span class="term-fg32">+			return mevShareTxHashes, err</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		mevShareTxHashes = append(mevShareTxHashes, mevShareBidData{blockNumber: blockNum, txHash: offchainTxHash})</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	return mevShareTxHashes, nil</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func prepareEthBundle(</span>
<span class="term-fg32">+	goerliClient *rpc.Client,</span>
<span class="term-fg32">+	goerliSigner types.Signer,</span>
<span class="term-fg32">+	privKey *ecdsa.PrivateKey,</span>
<span class="term-fg32">+) (types.SBundle, []byte, error) {</span>
<span class="term-fg32">+	var goerliAccNonce hexutil.Uint64</span>
<span class="term-fg32">+	err := goerliClient.Call(&amp;goerliAccNonce, &quot;eth_getTransactionCount&quot;, crypto.PubkeyToAddress(privKey.PublicKey), &quot;latest&quot;)</span>
<span class="term-fg32">+	RequireNoErrorf(err, &quot;could not call eth_getTransactionCount on suave: %v&quot;, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	ethTx, err := types.SignTx(types.NewTx(&amp;types.LegacyTx{</span>
<span class="term-fg32">+		Nonce:    uint64(goerliAccNonce),</span>
<span class="term-fg32">+		To:       &amp;common.Address{},</span>
<span class="term-fg32">+		Value:    big.NewInt(1000),</span>
<span class="term-fg32">+		Gas:      21000,</span>
<span class="term-fg32">+		Data:     []byte{},</span>
<span class="term-fg32">+		GasPrice: big.NewInt(15048452934800),</span>
<span class="term-fg32">+	}), goerliSigner, privKey)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return types.SBundle{}, nil, err</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	bundle := types.SBundle{</span>
<span class="term-fg32">+		Txs:             types.Transactions{ethTx},</span>
<span class="term-fg32">+		RevertingHashes: []common.Hash{},</span>
<span class="term-fg32">+		RefundPercent:   10,</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	bundleBytes, err := json.Marshal(bundle)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return types.SBundle{}, nil, err</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	return bundle, bundleBytes, nil</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func prepareMevShareBidTx(suaveSigner types.Signer, privKey *ecdsa.PrivateKey, executionNodeAddr common.Address, suaveAccNonce uint64, calldata []byte, mevShareAddr common.Address) (*types.Transaction, hexutil.Bytes, error) {</span>
<span class="term-fg32">+	wrappedTxData := &amp;types.DynamicFeeTx{</span>
<span class="term-fg32">+		Nonce:     suaveAccNonce,</span>
<span class="term-fg32">+		To:        &amp;mevShareAddr,</span>
<span class="term-fg32">+		Value:     nil,</span>
<span class="term-fg32">+		Gas:       10000000,</span>
<span class="term-fg32">+		GasTipCap: big.NewInt(10),</span>
<span class="term-fg32">+		GasFeeCap: big.NewInt(33000000000),</span>
<span class="term-fg32">+		Data:      calldata,</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	offchainTx, err := types.SignTx(types.NewTx(&amp;types.OffchainTx{</span>
<span class="term-fg32">+		ExecutionNode: executionNodeAddr,</span>
<span class="term-fg32">+		Wrapped:       *types.NewTx(wrappedTxData),</span>
<span class="term-fg32">+	}), suaveSigner, privKey)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return nil, nil, err</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	offchainTxBytes, err := offchainTx.MarshalBinary()</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return nil, nil, err</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	return offchainTx, offchainTxBytes, nil</span>
<span class="term-fg32">+}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-10c67d24e9ff09efd2c9bd0c" role="button"
                   aria-expanded="false" aria-controls="id-10c67d24e9ff09efd2c9bd0c">
                    <code>suave/cmd/suavecli/testDeployAndShare.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/suave/cmd/suavecli/testDeployAndShare.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+199</span></div>
                        <div class="text-start"><span class="text-danger">-0</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-10c67d24e9ff09efd2c9bd0c"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;suave&#47;cmd&#47;suavecli&#47;testDeployAndShare.go flashbots&#47;suave-geth&#47;suave&#47;cmd&#47;suavecli&#47;testDeployAndShare.go</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..b432f7731b52d0868d0deaaf1bd3dac2c8bbd1f1</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;suave&#47;cmd&#47;suavecli&#47;testDeployAndShare.go</span>
<span class="term-fg36">@@ -0,0 +1,199 @@</span>
<span class="term-fg32">+package main</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+import (</span>
<span class="term-fg32">+	&quot;context&quot;</span>
<span class="term-fg32">+	&quot;crypto&#47;ecdsa&quot;</span>
<span class="term-fg32">+	&quot;flag&quot;</span>
<span class="term-fg32">+	&quot;os&quot;</span>
<span class="term-fg32">+	&quot;strings&quot;</span>
<span class="term-fg32">+	&quot;time&quot;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&#47;hexutil&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;log&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;pkg&#47;errors&quot;</span>
<span class="term-fg32">+)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func cmdTestDeployAndShare() {</span>
<span class="term-fg32">+	flagset := flag.NewFlagSet(&quot;deployBlockSenderContract&quot;, flag.ExitOnError)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	var (</span>
<span class="term-fg32">+		suaveRpc                = flagset.String(&quot;suave_rpc&quot;, &quot;http:&#47;&#47;127.0.0.1:8545&quot;, &quot;address of suave rpc&quot;)</span>
<span class="term-fg32">+		goerliRpc               = flagset.String(&quot;goerli_rpc&quot;, &quot;http:&#47;&#47;127.0.0.1:8545&quot;, &quot;address of goerli rpc&quot;)</span>
<span class="term-fg32">+		goerliBeaconRpc         = flagset.String(&quot;goerli_beacon_rpc&quot;, &quot;http:&#47;&#47;127.0.0.1:5052&quot;, &quot;address of goerli beacon rpc&quot;)</span>
<span class="term-fg32">+		executionNodeAddressHex = flagset.String(&quot;ex_node_addr&quot;, &quot;0x4E2B0c0e428AE1CDE26d5BcF17Ba83f447068E5B&quot;, &quot;wallet address of execution node&quot;)</span>
<span class="term-fg32">+		privKeyHex              = flagset.String(&quot;privkey&quot;, &quot;&quot;, &quot;private key as hex (for testing)&quot;)</span>
<span class="term-fg32">+		boostRelayUrl           = flagset.String(&quot;relay_url&quot;, &quot;http:&#47;&#47;127.0.0.1:8091&quot;, &quot;address of boost relay that the contract will send blocks to&quot;)</span>
<span class="term-fg32">+		verbosity               = flagset.Int(&quot;verbosity&quot;, int(log.LvlInfo), &quot;log verbosity (0-5)&quot;)</span>
<span class="term-fg32">+		privKey                 *ecdsa.PrivateKey</span>
<span class="term-fg32">+	)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	flagset.Parse(os.Args[2:])</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	glogger := log.NewGlogHandler(log.StreamHandler(os.Stderr, log.TerminalFormat(false)))</span>
<span class="term-fg32">+	log.Root().SetHandler(glogger)</span>
<span class="term-fg32">+	glogger.Verbosity(log.Lvl(*verbosity))</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	privKey, executionNodeAddress, suaveClient, goerliClient, suaveSigner, goerliSigner := setUpSuaveAndGoerli(privKeyHex, executionNodeAddressHex, suaveRpc, goerliRpc)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; ********** Deploy Builder Contract **********</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	blockSenderAddrPtr, txHash, err := sendBlockSenderCreationTx(suaveClient, suaveSigner, privKey, boostRelayUrl)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		panic(err.Error())</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	waitForTransactionToBeConfirmed(suaveClient, txHash)</span>
<span class="term-fg32">+	blockSenderAddr := *blockSenderAddrPtr</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;*</span>
<span class="term-fg32">+		&#47;&#47; To avoid redeploying the contract, use this instead of the above</span>
<span class="term-fg32">+		blockSenderAddr := common.HexToAddress(&quot;0xFcF6C8bBa8507E494D2aDf4F5C3CE11D8B749E4C&quot;)</span>
<span class="term-fg32">+	*&#47;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; ********** 2. Deploy Mevshare Contract **********</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	mevShareAddrPtr, txHash, err := sendMevShareCreationTx(suaveClient, suaveSigner, privKey)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		panic(err.Error())</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	waitForTransactionToBeConfirmed(suaveClient, txHash)</span>
<span class="term-fg32">+	mevShareAddr := *mevShareAddrPtr</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;*</span>
<span class="term-fg32">+		&#47;&#47; To avoid redeploying the contract, use this instead of the above</span>
<span class="term-fg32">+		mevShareAddr := common.HexToAddress(&quot;0x2847FA9D1d5e8992d7281AF1B205c147cEc83817&quot;)</span>
<span class="term-fg32">+	*&#47;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; ********** 3. Send Mevshare Bundles for the next 26 blocks **********</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	mevShareTxs, err := sendMevShareBidTxs(suaveClient, goerliClient, suaveSigner, goerliSigner, 5, mevShareAddr, blockSenderAddr, executionNodeAddress, privKey)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		err = errors.Wrap(err, unwrapPeekerError(err).Error())</span>
<span class="term-fg32">+		panic(err.Error())</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; Wait only for the last one, all previous txs must have been included by that time</span>
<span class="term-fg32">+	&#47;&#47; We have to wait as otherwise we can&#39;t get the bid id via receipts</span>
<span class="term-fg32">+	waitForTransactionToBeConfirmed(suaveClient, &amp;mevShareTxs[len(mevShareTxs)-1].txHash)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; ********** 4. Send Mevshare Matches **********</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	for _, mevShareTx := range mevShareTxs {</span>
<span class="term-fg32">+		bidIdBytes, err := extractBidId(suaveClient, mevShareTx.txHash)</span>
<span class="term-fg32">+		if err != nil {</span>
<span class="term-fg32">+			panic(err.Error())</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		_, err = sendMevShareMatchTx(</span>
<span class="term-fg32">+			suaveClient,</span>
<span class="term-fg32">+			goerliClient,</span>
<span class="term-fg32">+			suaveSigner,</span>
<span class="term-fg32">+			goerliSigner,</span>
<span class="term-fg32">+			mevShareTx.blockNumber,</span>
<span class="term-fg32">+			mevShareAddr,</span>
<span class="term-fg32">+			blockSenderAddr,</span>
<span class="term-fg32">+			executionNodeAddress,</span>
<span class="term-fg32">+			bidIdBytes,</span>
<span class="term-fg32">+			privKey,</span>
<span class="term-fg32">+		)</span>
<span class="term-fg32">+		if err != nil {</span>
<span class="term-fg32">+			err = errors.Wrap(err, unwrapPeekerError(err).Error())</span>
<span class="term-fg32">+			panic(err.Error())</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; No need to wait for the backruns!</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; ********** 5. Send Build Block **********</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	payloadAttrC := make(chan PayloadAttributesEvent)</span>
<span class="term-fg32">+	ctx, cancel := context.WithCancel(context.TODO())</span>
<span class="term-fg32">+	defer cancel()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	go SubscribeToPayloadAttributesEvents(ctx, *goerliBeaconRpc, payloadAttrC)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; subscribe to payload attribute events from beacon chain to build blocks</span>
<span class="term-fg32">+	for paEvent := range payloadAttrC {</span>
<span class="term-fg32">+		var goerliBlockNum hexutil.Uint64</span>
<span class="term-fg32">+		err = goerliClient.Call(&amp;goerliBlockNum, &quot;eth_blockNumber&quot;)</span>
<span class="term-fg32">+		if err != nil {</span>
<span class="term-fg32">+			log.Error(&quot;could not get goerli block&quot;, &quot;err&quot;, err)</span>
<span class="term-fg32">+			continue</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		if uint64(goerliBlockNum) &gt;= mevShareTxs[len(mevShareTxs)-1].blockNumber {</span>
<span class="term-fg32">+			cancel()</span>
<span class="term-fg32">+			continue</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		validatorData, err := getValidatorForSlot(*boostRelayUrl, paEvent.Data.ProposalSlot)</span>
<span class="term-fg32">+		if err != nil || len(validatorData.Pubkey) == 0 {</span>
<span class="term-fg32">+			log.Error(&quot;could not get validator&quot;, &quot;slot&quot;, paEvent.Data.ProposalSlot, &quot;err&quot;, err)</span>
<span class="term-fg32">+			continue</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		log.Info(&quot;got validator&quot;, &quot;vd&quot;, validatorData)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		payloadArgsTuple := struct {</span>
<span class="term-fg32">+			Slot           uint64</span>
<span class="term-fg32">+			ProposerPubkey []byte</span>
<span class="term-fg32">+			Parent         common.Hash</span>
<span class="term-fg32">+			Timestamp      uint64</span>
<span class="term-fg32">+			FeeRecipient   common.Address</span>
<span class="term-fg32">+			GasLimit       uint64</span>
<span class="term-fg32">+			Random         common.Hash</span>
<span class="term-fg32">+			Withdrawals    []struct {</span>
<span class="term-fg32">+				Index     uint64</span>
<span class="term-fg32">+				Validator uint64</span>
<span class="term-fg32">+				Address   common.Address</span>
<span class="term-fg32">+				Amount    uint64</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+		}{</span>
<span class="term-fg32">+			Slot:           paEvent.Data.ProposalSlot,</span>
<span class="term-fg32">+			Parent:         paEvent.Data.ParentBlockHash,</span>
<span class="term-fg32">+			Timestamp:      paEvent.Data.PayloadAttributes.Timestamp,</span>
<span class="term-fg32">+			Random:         paEvent.Data.PayloadAttributes.PrevRandao,</span>
<span class="term-fg32">+			ProposerPubkey: hexutil.MustDecode(validatorData.Pubkey),</span>
<span class="term-fg32">+			FeeRecipient:   validatorData.FeeRecipient,</span>
<span class="term-fg32">+			GasLimit:       validatorData.GasLimit,</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		for _, w := range paEvent.Data.PayloadAttributes.Withdrawals {</span>
<span class="term-fg32">+			payloadArgsTuple.Withdrawals = append(payloadArgsTuple.Withdrawals, struct {</span>
<span class="term-fg32">+				Index     uint64</span>
<span class="term-fg32">+				Validator uint64</span>
<span class="term-fg32">+				Address   common.Address</span>
<span class="term-fg32">+				Amount    uint64</span>
<span class="term-fg32">+			}{</span>
<span class="term-fg32">+				Index:     uint64(w.Index),</span>
<span class="term-fg32">+				Validator: uint64(w.ValidatorIndex),</span>
<span class="term-fg32">+				Address:   common.Address(w.Address),</span>
<span class="term-fg32">+				Amount:    uint64(w.Amount),</span>
<span class="term-fg32">+			})</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		for i := 0; i &lt; 3; i++ {</span>
<span class="term-fg32">+			_, err = sendBuildShareBlockTx(suaveClient, suaveSigner, privKey, executionNodeAddress, blockSenderAddr, payloadArgsTuple, uint64(goerliBlockNum)+1)</span>
<span class="term-fg32">+			if err != nil {</span>
<span class="term-fg32">+				err = errors.Wrap(err, unwrapPeekerError(err).Error())</span>
<span class="term-fg32">+				if strings.Contains(err.Error(), &quot;no bids&quot;) {</span>
<span class="term-fg32">+					log.Error(&quot;Failed to build a block, no bids&quot;)</span>
<span class="term-fg32">+					time.Sleep(2 * time.Second)</span>
<span class="term-fg32">+					continue</span>
<span class="term-fg32">+				}</span>
<span class="term-fg32">+				log.Error(&quot;Failed to send BuildShareBlockTx&quot;, &quot;err&quot;, err)</span>
<span class="term-fg32">+				time.Sleep(2 * time.Second)</span>
<span class="term-fg32">+				continue</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+			log.Info(&quot;Sent block to relay&quot;, &quot;payload args&quot;, payloadArgsTuple, &quot;blockNum&quot;, uint64(goerliBlockNum)+1)</span>
<span class="term-fg32">+			break</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+var (</span>
<span class="term-fg32">+	err error &#47;&#47; shush linter</span>
<span class="term-fg32">+)</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-f3d7972a7c519e16daedd901" role="button"
                   aria-expanded="false" aria-controls="id-f3d7972a7c519e16daedd901">
                    <code>suave/cmd/suavecli/abis.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/suave/cmd/suavecli/abis.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+28</span></div>
                        <div class="text-start"><span class="text-danger">-0</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-f3d7972a7c519e16daedd901"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;suave&#47;cmd&#47;suavecli&#47;abis.go flashbots&#47;suave-geth&#47;suave&#47;cmd&#47;suavecli&#47;abis.go</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..e5f7975ca28b8e5799a3c7e94176ba83160468c2</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;suave&#47;cmd&#47;suavecli&#47;abis.go</span>
<span class="term-fg36">@@ -0,0 +1,28 @@</span>
<span class="term-fg32">+package main</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+import (</span>
<span class="term-fg32">+	&quot;strings&quot;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;accounts&#47;abi&quot;</span>
<span class="term-fg32">+)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func mustParseAbi(data string) abi.ABI {</span>
<span class="term-fg32">+	inoutAbi, err := abi.JSON(strings.NewReader(data))</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		panic(err.Error())</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	return inoutAbi</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+var (</span>
<span class="term-fg32">+	suaveLibAbi = mustParseAbi(`[ { &quot;inputs&quot;: [ { &quot;internalType&quot;: &quot;address&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;address&quot; }, { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;name&quot;: &quot;PeekerReverted&quot;, &quot;type&quot;: &quot;error&quot; }, { &quot;inputs&quot;: [], &quot;name&quot;: &quot;BUILD_ETH_BLOCK_PEEKER&quot;, &quot;outputs&quot;: [ { &quot;internalType&quot;: &quot;address&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;address&quot; } ], &quot;stateMutability&quot;: &quot;view&quot;, &quot;type&quot;: &quot;function&quot; }, { &quot;inputs&quot;: [], &quot;name&quot;: &quot;CONFIDENTIAL_INPUTS&quot;, &quot;outputs&quot;: [ { &quot;internalType&quot;: &quot;address&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;address&quot; } ], &quot;stateMutability&quot;: &quot;view&quot;, &quot;type&quot;: &quot;function&quot; }, { &quot;inputs&quot;: [], &quot;name&quot;: &quot;CONFIDENTIAL_RETRIEVE&quot;, &quot;outputs&quot;: [ { &quot;internalType&quot;: &quot;address&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;address&quot; } ], &quot;stateMutability&quot;: &quot;view&quot;, &quot;type&quot;: &quot;function&quot; }, { &quot;inputs&quot;: [], &quot;name&quot;: &quot;CONFIDENTIAL_STORE&quot;, &quot;outputs&quot;: [ { &quot;internalType&quot;: &quot;address&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;address&quot; } ], &quot;stateMutability&quot;: &quot;view&quot;, &quot;type&quot;: &quot;function&quot; }, { &quot;inputs&quot;: [], &quot;name&quot;: &quot;EXTRACT_HINT&quot;, &quot;outputs&quot;: [ { &quot;internalType&quot;: &quot;address&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;address&quot; } ], &quot;stateMutability&quot;: &quot;view&quot;, &quot;type&quot;: &quot;function&quot; }, { &quot;inputs&quot;: [], &quot;name&quot;: &quot;FETCH_BIDS&quot;, &quot;outputs&quot;: [ { &quot;internalType&quot;: &quot;address&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;address&quot; } ], &quot;stateMutability&quot;: &quot;view&quot;, &quot;type&quot;: &quot;function&quot; }, { &quot;inputs&quot;: [], &quot;name&quot;: &quot;IS_OFFCHAIN_ADDR&quot;, &quot;outputs&quot;: [ { &quot;internalType&quot;: &quot;address&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;address&quot; } ], &quot;stateMutability&quot;: &quot;view&quot;, &quot;type&quot;: &quot;function&quot; }, { &quot;inputs&quot;: [], &quot;name&quot;: &quot;NEW_BID&quot;, &quot;outputs&quot;: [ { &quot;internalType&quot;: &quot;address&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;address&quot; } ], &quot;stateMutability&quot;: &quot;view&quot;, &quot;type&quot;: &quot;function&quot; }, { &quot;inputs&quot;: [], &quot;name&quot;: &quot;SIMULATE_BUNDLE_PEEKER&quot;, &quot;outputs&quot;: [ { &quot;internalType&quot;: &quot;address&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;address&quot; } ], &quot;stateMutability&quot;: &quot;view&quot;, &quot;type&quot;: &quot;function&quot; }, { &quot;inputs&quot;: [], &quot;name&quot;: &quot;SUBMIT_ETH_BLOCK_BID_TO_RELAY&quot;, &quot;outputs&quot;: [ { &quot;internalType&quot;: &quot;address&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;address&quot; } ], &quot;stateMutability&quot;: &quot;view&quot;, &quot;type&quot;: &quot;function&quot; } ]`)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	bundleBidAbi = mustParseAbi(`[ { &quot;inputs&quot;: [ { &quot;internalType&quot;: &quot;address&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;address&quot; }, { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;name&quot;: &quot;PeekerReverted&quot;, &quot;type&quot;: &quot;error&quot; }, { &quot;anonymous&quot;: false, &quot;inputs&quot;: [ { &quot;indexed&quot;: false, &quot;internalType&quot;: &quot;Suave.BidId&quot;, &quot;name&quot;: &quot;bidId&quot;, &quot;type&quot;: &quot;bytes16&quot; }, { &quot;indexed&quot;: false, &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;decryptionCondition&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;indexed&quot;: false, &quot;internalType&quot;: &quot;address[]&quot;, &quot;name&quot;: &quot;allowedPeekers&quot;, &quot;type&quot;: &quot;address[]&quot; } ], &quot;name&quot;: &quot;BidEvent&quot;, &quot;type&quot;: &quot;event&quot; }, { &quot;inputs&quot;: [ { &quot;components&quot;: [ { &quot;internalType&quot;: &quot;Suave.BidId&quot;, &quot;name&quot;: &quot;id&quot;, &quot;type&quot;: &quot;bytes16&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;decryptionCondition&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address[]&quot;, &quot;name&quot;: &quot;allowedPeekers&quot;, &quot;type&quot;: &quot;address[]&quot; } ], &quot;internalType&quot;: &quot;struct Suave.Bid&quot;, &quot;name&quot;: &quot;bid&quot;, &quot;type&quot;: &quot;tuple&quot; } ], &quot;name&quot;: &quot;emitBid&quot;, &quot;outputs&quot;: [], &quot;stateMutability&quot;: &quot;nonpayable&quot;, &quot;type&quot;: &quot;function&quot; }, { &quot;inputs&quot;: [], &quot;name&quot;: &quot;fetchBidConfidentialBundleData&quot;, &quot;outputs&quot;: [ { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;stateMutability&quot;: &quot;view&quot;, &quot;type&quot;: &quot;function&quot; }, { &quot;inputs&quot;: [ { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;decryptionCondition&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address[]&quot;, &quot;name&quot;: &quot;bidAllowedPeekers&quot;, &quot;type&quot;: &quot;address[]&quot; } ], &quot;name&quot;: &quot;newBid&quot;, &quot;outputs&quot;: [ { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;stateMutability&quot;: &quot;payable&quot;, &quot;type&quot;: &quot;function&quot; } ]`)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	buildEthBlockAbi = mustParseAbi(`[ { &quot;anonymous&quot;: false, &quot;inputs&quot;: [ { &quot;indexed&quot;: false, &quot;internalType&quot;: &quot;Suave.BidId&quot;, &quot;name&quot;: &quot;bidId&quot;, &quot;type&quot;: &quot;bytes16&quot; }, { &quot;indexed&quot;: false, &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;decryptionCondition&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;indexed&quot;: false, &quot;internalType&quot;: &quot;address[]&quot;, &quot;name&quot;: &quot;allowedPeekers&quot;, &quot;type&quot;: &quot;address[]&quot; } ], &quot;name&quot;: &quot;BidEvent&quot;, &quot;type&quot;: &quot;event&quot; }, { &quot;anonymous&quot;: false, &quot;inputs&quot;: [ { &quot;indexed&quot;: false, &quot;internalType&quot;: &quot;Suave.BidId&quot;, &quot;name&quot;: &quot;bidId&quot;, &quot;type&quot;: &quot;bytes16&quot; }, { &quot;indexed&quot;: false, &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;builderBid&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;name&quot;: &quot;BuilderBoostBidEvent&quot;, &quot;type&quot;: &quot;event&quot; }, { &quot;inputs&quot;: [ { &quot;components&quot;: [ { &quot;internalType&quot;: &quot;bytes32&quot;, &quot;name&quot;: &quot;parent&quot;, &quot;type&quot;: &quot;bytes32&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;timestamp&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address&quot;, &quot;name&quot;: &quot;feeRecipient&quot;, &quot;type&quot;: &quot;address&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;gasLimit&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;bytes32&quot;, &quot;name&quot;: &quot;random&quot;, &quot;type&quot;: &quot;bytes32&quot; }, { &quot;components&quot;: [ { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;index&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;validator&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address&quot;, &quot;name&quot;: &quot;Address&quot;, &quot;type&quot;: &quot;address&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;amount&quot;, &quot;type&quot;: &quot;uint64&quot; } ], &quot;internalType&quot;: &quot;struct Suave.Withdrawal[]&quot;, &quot;name&quot;: &quot;withdrawals&quot;, &quot;type&quot;: &quot;tuple[]&quot; } ], &quot;internalType&quot;: &quot;struct Suave.BuildBlockArgs&quot;, &quot;name&quot;: &quot;blockArgs&quot;, &quot;type&quot;: &quot;tuple&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;blockHeight&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;components&quot;: [ { &quot;internalType&quot;: &quot;Suave.BidId&quot;, &quot;name&quot;: &quot;id&quot;, &quot;type&quot;: &quot;bytes16&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;decryptionCondition&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address[]&quot;, &quot;name&quot;: &quot;allowedPeekers&quot;, &quot;type&quot;: &quot;address[]&quot; } ], &quot;internalType&quot;: &quot;struct Suave.Bid[]&quot;, &quot;name&quot;: &quot;bids&quot;, &quot;type&quot;: &quot;tuple[]&quot; } ], &quot;name&quot;: &quot;build&quot;, &quot;outputs&quot;: [ { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;stateMutability&quot;: &quot;nonpayable&quot;, &quot;type&quot;: &quot;function&quot; }, { &quot;inputs&quot;: [ { &quot;components&quot;: [ { &quot;internalType&quot;: &quot;bytes32&quot;, &quot;name&quot;: &quot;parent&quot;, &quot;type&quot;: &quot;bytes32&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;timestamp&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address&quot;, &quot;name&quot;: &quot;feeRecipient&quot;, &quot;type&quot;: &quot;address&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;gasLimit&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;bytes32&quot;, &quot;name&quot;: &quot;random&quot;, &quot;type&quot;: &quot;bytes32&quot; }, { &quot;components&quot;: [ { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;index&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;validator&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address&quot;, &quot;name&quot;: &quot;Address&quot;, &quot;type&quot;: &quot;address&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;amount&quot;, &quot;type&quot;: &quot;uint64&quot; } ], &quot;internalType&quot;: &quot;struct Suave.Withdrawal[]&quot;, &quot;name&quot;: &quot;withdrawals&quot;, &quot;type&quot;: &quot;tuple[]&quot; } ], &quot;internalType&quot;: &quot;struct Suave.BuildBlockArgs&quot;, &quot;name&quot;: &quot;blockArgs&quot;, &quot;type&quot;: &quot;tuple&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;blockHeight&quot;, &quot;type&quot;: &quot;uint64&quot; } ], &quot;name&quot;: &quot;buildFromPool&quot;, &quot;outputs&quot;: [ { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;stateMutability&quot;: &quot;nonpayable&quot;, &quot;type&quot;: &quot;function&quot; }, { &quot;inputs&quot;: [ { &quot;components&quot;: [ { &quot;internalType&quot;: &quot;Suave.BidId&quot;, &quot;name&quot;: &quot;id&quot;, &quot;type&quot;: &quot;bytes16&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;decryptionCondition&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address[]&quot;, &quot;name&quot;: &quot;allowedPeekers&quot;, &quot;type&quot;: &quot;address[]&quot; } ], &quot;internalType&quot;: &quot;struct Suave.Bid&quot;, &quot;name&quot;: &quot;bid&quot;, &quot;type&quot;: &quot;tuple&quot; } ], &quot;name&quot;: &quot;emitBid&quot;, &quot;outputs&quot;: [], &quot;stateMutability&quot;: &quot;nonpayable&quot;, &quot;type&quot;: &quot;function&quot; }, { &quot;inputs&quot;: [ { &quot;components&quot;: [ { &quot;internalType&quot;: &quot;Suave.BidId&quot;, &quot;name&quot;: &quot;id&quot;, &quot;type&quot;: &quot;bytes16&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;decryptionCondition&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address[]&quot;, &quot;name&quot;: &quot;allowedPeekers&quot;, &quot;type&quot;: &quot;address[]&quot; } ], &quot;internalType&quot;: &quot;struct Suave.Bid&quot;, &quot;name&quot;: &quot;bid&quot;, &quot;type&quot;: &quot;tuple&quot; }, { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;builderBid&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;name&quot;: &quot;emitBuilderBidAndBid&quot;, &quot;outputs&quot;: [ { &quot;components&quot;: [ { &quot;internalType&quot;: &quot;Suave.BidId&quot;, &quot;name&quot;: &quot;id&quot;, &quot;type&quot;: &quot;bytes16&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;decryptionCondition&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address[]&quot;, &quot;name&quot;: &quot;allowedPeekers&quot;, &quot;type&quot;: &quot;address[]&quot; } ], &quot;internalType&quot;: &quot;struct Suave.Bid&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;tuple&quot; }, { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;stateMutability&quot;: &quot;nonpayable&quot;, &quot;type&quot;: &quot;function&quot; }, { &quot;inputs&quot;: [ { &quot;internalType&quot;: &quot;Suave.BidId&quot;, &quot;name&quot;: &quot;bidId&quot;, &quot;type&quot;: &quot;bytes16&quot; }, { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;signedBlindedHeader&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;name&quot;: &quot;unlock&quot;, &quot;outputs&quot;: [ { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;stateMutability&quot;: &quot;nonpayable&quot;, &quot;type&quot;: &quot;function&quot; } ]`)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	ethBlockBidSenderAbi = mustParseAbi(`[ { &quot;inputs&quot;: [ { &quot;internalType&quot;: &quot;string&quot;, &quot;name&quot;: &quot;boostRelayUrl_&quot;, &quot;type&quot;: &quot;string&quot; } ], &quot;stateMutability&quot;: &quot;nonpayable&quot;, &quot;type&quot;: &quot;constructor&quot; }, { &quot;inputs&quot;: [ { &quot;internalType&quot;: &quot;address&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;address&quot; }, { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;name&quot;: &quot;PeekerReverted&quot;, &quot;type&quot;: &quot;error&quot; }, { &quot;anonymous&quot;: false, &quot;inputs&quot;: [ { &quot;indexed&quot;: false, &quot;internalType&quot;: &quot;Suave.BidId&quot;, &quot;name&quot;: &quot;bidId&quot;, &quot;type&quot;: &quot;bytes16&quot; }, { &quot;indexed&quot;: false, &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;decryptionCondition&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;indexed&quot;: false, &quot;internalType&quot;: &quot;address[]&quot;, &quot;name&quot;: &quot;allowedPeekers&quot;, &quot;type&quot;: &quot;address[]&quot; } ], &quot;name&quot;: &quot;BidEvent&quot;, &quot;type&quot;: &quot;event&quot; }, { &quot;anonymous&quot;: false, &quot;inputs&quot;: [ { &quot;indexed&quot;: false, &quot;internalType&quot;: &quot;Suave.BidId&quot;, &quot;name&quot;: &quot;bidId&quot;, &quot;type&quot;: &quot;bytes16&quot; }, { &quot;indexed&quot;: false, &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;builderBid&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;name&quot;: &quot;BuilderBoostBidEvent&quot;, &quot;type&quot;: &quot;event&quot; }, { &quot;inputs&quot;: [ { &quot;components&quot;: [ { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;slot&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;proposerPubkey&quot;, &quot;type&quot;: &quot;bytes&quot; }, { &quot;internalType&quot;: &quot;bytes32&quot;, &quot;name&quot;: &quot;parent&quot;, &quot;type&quot;: &quot;bytes32&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;timestamp&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address&quot;, &quot;name&quot;: &quot;feeRecipient&quot;, &quot;type&quot;: &quot;address&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;gasLimit&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;bytes32&quot;, &quot;name&quot;: &quot;random&quot;, &quot;type&quot;: &quot;bytes32&quot; }, { &quot;components&quot;: [ { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;index&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;validator&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address&quot;, &quot;name&quot;: &quot;Address&quot;, &quot;type&quot;: &quot;address&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;amount&quot;, &quot;type&quot;: &quot;uint64&quot; } ], &quot;internalType&quot;: &quot;struct Suave.Withdrawal[]&quot;, &quot;name&quot;: &quot;withdrawals&quot;, &quot;type&quot;: &quot;tuple[]&quot; } ], &quot;internalType&quot;: &quot;struct Suave.BuildBlockArgs&quot;, &quot;name&quot;: &quot;blockArgs&quot;, &quot;type&quot;: &quot;tuple&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;blockHeight&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;Suave.BidId[]&quot;, &quot;name&quot;: &quot;bids&quot;, &quot;type&quot;: &quot;bytes16[]&quot; }, { &quot;internalType&quot;: &quot;string&quot;, &quot;name&quot;: &quot;namespace&quot;, &quot;type&quot;: &quot;string&quot; } ], &quot;name&quot;: &quot;buildAndEmit&quot;, &quot;outputs&quot;: [ { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;stateMutability&quot;: &quot;nonpayable&quot;, &quot;type&quot;: &quot;function&quot; }, { &quot;inputs&quot;: [ { &quot;components&quot;: [ { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;slot&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;proposerPubkey&quot;, &quot;type&quot;: &quot;bytes&quot; }, { &quot;internalType&quot;: &quot;bytes32&quot;, &quot;name&quot;: &quot;parent&quot;, &quot;type&quot;: &quot;bytes32&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;timestamp&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address&quot;, &quot;name&quot;: &quot;feeRecipient&quot;, &quot;type&quot;: &quot;address&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;gasLimit&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;bytes32&quot;, &quot;name&quot;: &quot;random&quot;, &quot;type&quot;: &quot;bytes32&quot; }, { &quot;components&quot;: [ { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;index&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;validator&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address&quot;, &quot;name&quot;: &quot;Address&quot;, &quot;type&quot;: &quot;address&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;amount&quot;, &quot;type&quot;: &quot;uint64&quot; } ], &quot;internalType&quot;: &quot;struct Suave.Withdrawal[]&quot;, &quot;name&quot;: &quot;withdrawals&quot;, &quot;type&quot;: &quot;tuple[]&quot; } ], &quot;internalType&quot;: &quot;struct Suave.BuildBlockArgs&quot;, &quot;name&quot;: &quot;blockArgs&quot;, &quot;type&quot;: &quot;tuple&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;blockHeight&quot;, &quot;type&quot;: &quot;uint64&quot; } ], &quot;name&quot;: &quot;buildFromPool&quot;, &quot;outputs&quot;: [ { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;stateMutability&quot;: &quot;nonpayable&quot;, &quot;type&quot;: &quot;function&quot; }, { &quot;inputs&quot;: [ { &quot;components&quot;: [ { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;slot&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;proposerPubkey&quot;, &quot;type&quot;: &quot;bytes&quot; }, { &quot;internalType&quot;: &quot;bytes32&quot;, &quot;name&quot;: &quot;parent&quot;, &quot;type&quot;: &quot;bytes32&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;timestamp&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address&quot;, &quot;name&quot;: &quot;feeRecipient&quot;, &quot;type&quot;: &quot;address&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;gasLimit&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;bytes32&quot;, &quot;name&quot;: &quot;random&quot;, &quot;type&quot;: &quot;bytes32&quot; }, { &quot;components&quot;: [ { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;index&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;validator&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address&quot;, &quot;name&quot;: &quot;Address&quot;, &quot;type&quot;: &quot;address&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;amount&quot;, &quot;type&quot;: &quot;uint64&quot; } ], &quot;internalType&quot;: &quot;struct Suave.Withdrawal[]&quot;, &quot;name&quot;: &quot;withdrawals&quot;, &quot;type&quot;: &quot;tuple[]&quot; } ], &quot;internalType&quot;: &quot;struct Suave.BuildBlockArgs&quot;, &quot;name&quot;: &quot;blockArgs&quot;, &quot;type&quot;: &quot;tuple&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;blockHeight&quot;, &quot;type&quot;: &quot;uint64&quot; } ], &quot;name&quot;: &quot;buildMevShare&quot;, &quot;outputs&quot;: [ { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;stateMutability&quot;: &quot;nonpayable&quot;, &quot;type&quot;: &quot;function&quot; }, { &quot;inputs&quot;: [ { &quot;components&quot;: [ { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;slot&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;proposerPubkey&quot;, &quot;type&quot;: &quot;bytes&quot; }, { &quot;internalType&quot;: &quot;bytes32&quot;, &quot;name&quot;: &quot;parent&quot;, &quot;type&quot;: &quot;bytes32&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;timestamp&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address&quot;, &quot;name&quot;: &quot;feeRecipient&quot;, &quot;type&quot;: &quot;address&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;gasLimit&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;bytes32&quot;, &quot;name&quot;: &quot;random&quot;, &quot;type&quot;: &quot;bytes32&quot; }, { &quot;components&quot;: [ { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;index&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;validator&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address&quot;, &quot;name&quot;: &quot;Address&quot;, &quot;type&quot;: &quot;address&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;amount&quot;, &quot;type&quot;: &quot;uint64&quot; } ], &quot;internalType&quot;: &quot;struct Suave.Withdrawal[]&quot;, &quot;name&quot;: &quot;withdrawals&quot;, &quot;type&quot;: &quot;tuple[]&quot; } ], &quot;internalType&quot;: &quot;struct Suave.BuildBlockArgs&quot;, &quot;name&quot;: &quot;blockArgs&quot;, &quot;type&quot;: &quot;tuple&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;blockHeight&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;Suave.BidId[]&quot;, &quot;name&quot;: &quot;bids&quot;, &quot;type&quot;: &quot;bytes16[]&quot; }, { &quot;internalType&quot;: &quot;string&quot;, &quot;name&quot;: &quot;namespace&quot;, &quot;type&quot;: &quot;string&quot; } ], &quot;name&quot;: &quot;doBuild&quot;, &quot;outputs&quot;: [ { &quot;components&quot;: [ { &quot;internalType&quot;: &quot;Suave.BidId&quot;, &quot;name&quot;: &quot;id&quot;, &quot;type&quot;: &quot;bytes16&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;decryptionCondition&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address[]&quot;, &quot;name&quot;: &quot;allowedPeekers&quot;, &quot;type&quot;: &quot;address[]&quot; } ], &quot;internalType&quot;: &quot;struct Suave.Bid&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;tuple&quot; }, { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;stateMutability&quot;: &quot;view&quot;, &quot;type&quot;: &quot;function&quot; }, { &quot;inputs&quot;: [ { &quot;components&quot;: [ { &quot;internalType&quot;: &quot;Suave.BidId&quot;, &quot;name&quot;: &quot;id&quot;, &quot;type&quot;: &quot;bytes16&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;decryptionCondition&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address[]&quot;, &quot;name&quot;: &quot;allowedPeekers&quot;, &quot;type&quot;: &quot;address[]&quot; } ], &quot;internalType&quot;: &quot;struct Suave.Bid&quot;, &quot;name&quot;: &quot;bid&quot;, &quot;type&quot;: &quot;tuple&quot; } ], &quot;name&quot;: &quot;emitBid&quot;, &quot;outputs&quot;: [], &quot;stateMutability&quot;: &quot;nonpayable&quot;, &quot;type&quot;: &quot;function&quot; }, { &quot;inputs&quot;: [ { &quot;components&quot;: [ { &quot;internalType&quot;: &quot;Suave.BidId&quot;, &quot;name&quot;: &quot;id&quot;, &quot;type&quot;: &quot;bytes16&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;decryptionCondition&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address[]&quot;, &quot;name&quot;: &quot;allowedPeekers&quot;, &quot;type&quot;: &quot;address[]&quot; } ], &quot;internalType&quot;: &quot;struct Suave.Bid&quot;, &quot;name&quot;: &quot;bid&quot;, &quot;type&quot;: &quot;tuple&quot; }, { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;builderBid&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;name&quot;: &quot;emitBuilderBidAndBid&quot;, &quot;outputs&quot;: [ { &quot;components&quot;: [ { &quot;internalType&quot;: &quot;Suave.BidId&quot;, &quot;name&quot;: &quot;id&quot;, &quot;type&quot;: &quot;bytes16&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;decryptionCondition&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address[]&quot;, &quot;name&quot;: &quot;allowedPeekers&quot;, &quot;type&quot;: &quot;address[]&quot; } ], &quot;internalType&quot;: &quot;struct Suave.Bid&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;tuple&quot; }, { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;stateMutability&quot;: &quot;nonpayable&quot;, &quot;type&quot;: &quot;function&quot; }, { &quot;inputs&quot;: [ { &quot;internalType&quot;: &quot;Suave.BidId&quot;, &quot;name&quot;: &quot;bidId&quot;, &quot;type&quot;: &quot;bytes16&quot; }, { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;signedBlindedHeader&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;name&quot;: &quot;unlock&quot;, &quot;outputs&quot;: [ { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;stateMutability&quot;: &quot;view&quot;, &quot;type&quot;: &quot;function&quot; } ]`)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	mevShareABI = mustParseAbi(`[ { &quot;inputs&quot;: [ { &quot;internalType&quot;: &quot;address&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;address&quot; }, { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;name&quot;: &quot;PeekerReverted&quot;, &quot;type&quot;: &quot;error&quot; }, { &quot;anonymous&quot;: false, &quot;inputs&quot;: [ { &quot;indexed&quot;: false, &quot;internalType&quot;: &quot;Suave.BidId&quot;, &quot;name&quot;: &quot;bidId&quot;, &quot;type&quot;: &quot;bytes16&quot; }, { &quot;indexed&quot;: false, &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;decryptionCondition&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;indexed&quot;: false, &quot;internalType&quot;: &quot;address[]&quot;, &quot;name&quot;: &quot;allowedPeekers&quot;, &quot;type&quot;: &quot;address[]&quot; } ], &quot;name&quot;: &quot;BidEvent&quot;, &quot;type&quot;: &quot;event&quot; }, { &quot;anonymous&quot;: false, &quot;inputs&quot;: [ { &quot;indexed&quot;: false, &quot;internalType&quot;: &quot;Suave.BidId&quot;, &quot;name&quot;: &quot;bidId&quot;, &quot;type&quot;: &quot;bytes16&quot; }, { &quot;indexed&quot;: false, &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;hint&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;name&quot;: &quot;HintEvent&quot;, &quot;type&quot;: &quot;event&quot; }, { &quot;anonymous&quot;: false, &quot;inputs&quot;: [ { &quot;indexed&quot;: false, &quot;internalType&quot;: &quot;Suave.BidId&quot;, &quot;name&quot;: &quot;matchBidId&quot;, &quot;type&quot;: &quot;bytes16&quot; }, { &quot;indexed&quot;: false, &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;bidhint&quot;, &quot;type&quot;: &quot;bytes&quot; }, { &quot;indexed&quot;: false, &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;matchHint&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;name&quot;: &quot;MatchEvent&quot;, &quot;type&quot;: &quot;event&quot; }, { &quot;inputs&quot;: [ { &quot;components&quot;: [ { &quot;internalType&quot;: &quot;Suave.BidId&quot;, &quot;name&quot;: &quot;id&quot;, &quot;type&quot;: &quot;bytes16&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;decryptionCondition&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address[]&quot;, &quot;name&quot;: &quot;allowedPeekers&quot;, &quot;type&quot;: &quot;address[]&quot; } ], &quot;internalType&quot;: &quot;struct Suave.Bid&quot;, &quot;name&quot;: &quot;bid&quot;, &quot;type&quot;: &quot;tuple&quot; } ], &quot;name&quot;: &quot;emitBid&quot;, &quot;outputs&quot;: [], &quot;stateMutability&quot;: &quot;nonpayable&quot;, &quot;type&quot;: &quot;function&quot; }, { &quot;inputs&quot;: [ { &quot;components&quot;: [ { &quot;internalType&quot;: &quot;Suave.BidId&quot;, &quot;name&quot;: &quot;id&quot;, &quot;type&quot;: &quot;bytes16&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;decryptionCondition&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address[]&quot;, &quot;name&quot;: &quot;allowedPeekers&quot;, &quot;type&quot;: &quot;address[]&quot; } ], &quot;internalType&quot;: &quot;struct Suave.Bid&quot;, &quot;name&quot;: &quot;bid&quot;, &quot;type&quot;: &quot;tuple&quot; }, { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;hint&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;name&quot;: &quot;emitBidAndHint&quot;, &quot;outputs&quot;: [], &quot;stateMutability&quot;: &quot;nonpayable&quot;, &quot;type&quot;: &quot;function&quot; }, { &quot;inputs&quot;: [ { &quot;components&quot;: [ { &quot;internalType&quot;: &quot;Suave.BidId&quot;, &quot;name&quot;: &quot;id&quot;, &quot;type&quot;: &quot;bytes16&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;decryptionCondition&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address[]&quot;, &quot;name&quot;: &quot;allowedPeekers&quot;, &quot;type&quot;: &quot;address[]&quot; } ], &quot;internalType&quot;: &quot;struct Suave.Bid&quot;, &quot;name&quot;: &quot;bid&quot;, &quot;type&quot;: &quot;tuple&quot; }, { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;bidHint&quot;, &quot;type&quot;: &quot;bytes&quot; }, { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;matchHint&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;name&quot;: &quot;emitMatchBidAndHint&quot;, &quot;outputs&quot;: [], &quot;stateMutability&quot;: &quot;nonpayable&quot;, &quot;type&quot;: &quot;function&quot; }, { &quot;inputs&quot;: [], &quot;name&quot;: &quot;fetchBidConfidentialBundleData&quot;, &quot;outputs&quot;: [ { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;stateMutability&quot;: &quot;nonpayable&quot;, &quot;type&quot;: &quot;function&quot; }, { &quot;inputs&quot;: [ { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;decryptionCondition&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address[]&quot;, &quot;name&quot;: &quot;bidAllowedPeekers&quot;, &quot;type&quot;: &quot;address[]&quot; } ], &quot;name&quot;: &quot;newBid&quot;, &quot;outputs&quot;: [ { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;stateMutability&quot;: &quot;payable&quot;, &quot;type&quot;: &quot;function&quot; }, { &quot;inputs&quot;: [ { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;decryptionCondition&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address[]&quot;, &quot;name&quot;: &quot;bidAllowedPeekers&quot;, &quot;type&quot;: &quot;address[]&quot; }, { &quot;internalType&quot;: &quot;Suave.BidId&quot;, &quot;name&quot;: &quot;shareBidId&quot;, &quot;type&quot;: &quot;bytes16&quot; } ], &quot;name&quot;: &quot;newMatch&quot;, &quot;outputs&quot;: [ { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;stateMutability&quot;: &quot;payable&quot;, &quot;type&quot;: &quot;function&quot; } ]`)</span>
<span class="term-fg32">+)</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-0377f1dde18251759d57b35a" role="button"
                   aria-expanded="false" aria-controls="id-0377f1dde18251759d57b35a">
                    <code>suave/cmd/suavecli/sendMevShareMatch.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/suave/cmd/suavecli/sendMevShareMatch.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+200</span></div>
                        <div class="text-start"><span class="text-danger">-0</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-0377f1dde18251759d57b35a"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;suave&#47;cmd&#47;suavecli&#47;sendMevShareMatch.go flashbots&#47;suave-geth&#47;suave&#47;cmd&#47;suavecli&#47;sendMevShareMatch.go</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..a81475c5e32541d4c1d17b11bbbc06401dbc6b7e</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;suave&#47;cmd&#47;suavecli&#47;sendMevShareMatch.go</span>
<span class="term-fg36">@@ -0,0 +1,200 @@</span>
<span class="term-fg32">+package main</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+import (</span>
<span class="term-fg32">+	&quot;context&quot;</span>
<span class="term-fg32">+	&quot;crypto&#47;ecdsa&quot;</span>
<span class="term-fg32">+	&quot;encoding&#47;json&quot;</span>
<span class="term-fg32">+	&quot;flag&quot;</span>
<span class="term-fg32">+	&quot;fmt&quot;</span>
<span class="term-fg32">+	&quot;math&#47;big&quot;</span>
<span class="term-fg32">+	&quot;os&quot;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;cmd&#47;utils&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&#47;hexutil&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;core&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;core&#47;types&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;crypto&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;log&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;rpc&quot;</span>
<span class="term-fg32">+)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func cmdSendMevShareMatch() {</span>
<span class="term-fg32">+	flagset := flag.NewFlagSet(&quot;sendBundle&quot;, flag.ExitOnError)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	var (</span>
<span class="term-fg32">+		suaveRpc                = flagset.String(&quot;suave_rpc&quot;, &quot;http:&#47;&#47;127.0.0.1:8545&quot;, &quot;address of suave rpc&quot;)</span>
<span class="term-fg32">+		executionNodeAddressHex = flagset.String(&quot;ex_node_addr&quot;, &quot;0x4E2B0c0e428AE1CDE26d5BcF17Ba83f447068E5B&quot;, &quot;wallet address of execution node&quot;)</span>
<span class="term-fg32">+		mevshareAddressHex      = flagset.String(&quot;mev_share_addr&quot;, &quot;0x42042042028AE1CDE26d5BcF17Ba83f447068E5B&quot;, &quot;address of mev share contract&quot;)</span>
<span class="term-fg32">+		blockSenderHex          = flagset.String(&quot;block_sender_addr&quot;, &quot;0x42042042028AE1CDE26d5BcF17Ba83f447068E5B&quot;, &quot;address of mev share contract&quot;)</span>
<span class="term-fg32">+		matchBidId              = flagset.String(&quot;match_bid_id&quot;, &quot;123-123-123&quot;, &quot;ID of mev share bundle bid to back run&quot;)</span>
<span class="term-fg32">+		goerliRpc               = flagset.String(&quot;goerli_rpc&quot;, &quot;http:&#47;&#47;127.0.0.1:8545&quot;, &quot;address of goerli rpc&quot;)</span>
<span class="term-fg32">+		privKeyHex              = flagset.String(&quot;privkey&quot;, &quot;&quot;, &quot;private key as hex (for testing)&quot;)</span>
<span class="term-fg32">+		verbosity               = flagset.Int(&quot;verbosity&quot;, int(log.LvlInfo), &quot;log verbosity (0-5)&quot;)</span>
<span class="term-fg32">+		privKey                 *ecdsa.PrivateKey</span>
<span class="term-fg32">+	)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	flagset.Parse(os.Args[2:])</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	glogger := log.NewGlogHandler(log.StreamHandler(os.Stderr, log.TerminalFormat(false)))</span>
<span class="term-fg32">+	log.Root().SetHandler(glogger)</span>
<span class="term-fg32">+	glogger.Verbosity(log.Lvl(*verbosity))</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	privKey, err := crypto.HexToECDSA(*privKeyHex)</span>
<span class="term-fg32">+	RequireNoErrorf(err, &quot;-nodekeyhex: %v&quot;, err)</span>
<span class="term-fg32">+	&#47;* shush linter *&#47; privKey.Public()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	if executionNodeAddressHex == nil || *executionNodeAddressHex == &quot;&quot; {</span>
<span class="term-fg32">+		utils.Fatalf(&quot;please provide ex_node_addr&quot;)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	executionNodeAddress := common.HexToAddress(*executionNodeAddressHex)</span>
<span class="term-fg32">+	mevshareAddresss := common.HexToAddress(*mevshareAddressHex)</span>
<span class="term-fg32">+	blockSenderAddress := common.HexToAddress(*blockSenderHex)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	matchBidIdBytes := [16]byte{}</span>
<span class="term-fg32">+	copy(matchBidIdBytes[:], []byte(*matchBidId)[:16])</span>
<span class="term-fg32">+	log.Debug(&quot;converted matchBidId to bytes&quot;, &quot;matchBidIdBytes&quot;, matchBidIdBytes)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	suaveClient, err := rpc.DialContext(context.TODO(), *suaveRpc)</span>
<span class="term-fg32">+	RequireNoErrorf(err, &quot;could not connect to suave rpc: %v&quot;, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	goerliClient, err := rpc.DialContext(context.TODO(), *goerliRpc)</span>
<span class="term-fg32">+	RequireNoErrorf(err, &quot;could not connect to goerli rpc: %v&quot;, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	genesis := core.DefaultSuaveGenesisBlock()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	goerliSigner := types.LatestSigner(core.DefaultGoerliGenesisBlock().Config)</span>
<span class="term-fg32">+	suaveSigner := types.NewOffchainSigner(genesis.Config.ChainID)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	log.Root().SetHandler(log.LvlFilterHandler(log.LvlInfo, log.StreamHandler(os.Stdout, log.TerminalFormat(true))))</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	_, err = sendMevShareMatchTx(</span>
<span class="term-fg32">+		suaveClient,</span>
<span class="term-fg32">+		goerliClient,</span>
<span class="term-fg32">+		suaveSigner,</span>
<span class="term-fg32">+		goerliSigner,</span>
<span class="term-fg32">+		26,</span>
<span class="term-fg32">+		mevshareAddresss,</span>
<span class="term-fg32">+		blockSenderAddress,</span>
<span class="term-fg32">+		executionNodeAddress,</span>
<span class="term-fg32">+		matchBidIdBytes,</span>
<span class="term-fg32">+		privKey,</span>
<span class="term-fg32">+	)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		log.Info(&quot;err&quot;, &quot;error&quot;, err.Error())</span>
<span class="term-fg32">+		panic(err.Error())</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func sendMevShareMatchTx(</span>
<span class="term-fg32">+	&#47;&#47; clients</span>
<span class="term-fg32">+	suaveClient *rpc.Client,</span>
<span class="term-fg32">+	goerliClient *rpc.Client,</span>
<span class="term-fg32">+	&#47;&#47; signers</span>
<span class="term-fg32">+	suaveSigner types.Signer,</span>
<span class="term-fg32">+	goerliSigner types.Signer,</span>
<span class="term-fg32">+	&#47;&#47; tx specific</span>
<span class="term-fg32">+	targetBlock uint64,</span>
<span class="term-fg32">+	mevShareAddr common.Address,</span>
<span class="term-fg32">+	blockSenderAddr common.Address,</span>
<span class="term-fg32">+	executionNodeAddr common.Address,</span>
<span class="term-fg32">+	matchBidId [16]byte,</span>
<span class="term-fg32">+	&#47;&#47; account specific</span>
<span class="term-fg32">+	privKey *ecdsa.PrivateKey,</span>
<span class="term-fg32">+) (*common.Hash, error) {</span>
<span class="term-fg32">+	_, backrunBundleBytes, err := prepareEthBackrunBundle(goerliClient, goerliSigner, privKey, matchBidId)</span>
<span class="term-fg32">+	RequireNoErrorf(err, &quot;could not prepare backrun bundle: %v&quot;, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; Send a bundle bid</span>
<span class="term-fg32">+	allowedPeekers := []common.Address{newBlockBidAddress, extractHintAddress, buildEthBlockAddress, mevShareAddr, blockSenderAddr}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	matchCalldata, err := mevShareABI.Pack(&quot;newMatch&quot;, targetBlock, allowedPeekers, matchBidId)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return &amp;common.Hash{}, fmt.Errorf(&quot;could not pack newMatch inputs: %w&quot;, err)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	var suaveAccNonce hexutil.Uint64</span>
<span class="term-fg32">+	err = suaveClient.Call(&amp;suaveAccNonce, &quot;eth_getTransactionCount&quot;, crypto.PubkeyToAddress(privKey.PublicKey), &quot;pending&quot;)</span>
<span class="term-fg32">+	RequireNoErrorf(err, &quot;could not call eth_getTransactionCount on suave: %v&quot;, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	_, backrunBidTxBytes, err := prepareMevBackrunBidTx(suaveSigner, privKey, executionNodeAddr, uint64(suaveAccNonce), matchCalldata, mevShareAddr)</span>
<span class="term-fg32">+	RequireNoErrorf(err, &quot;could not prepare backrun bid: %v&quot;, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; TODO : reusing this function selector from bid contract to avoid creating another ABI</span>
<span class="term-fg32">+	confidentialDataBytes, err := bundleBidAbi.Methods[&quot;fetchBidConfidentialBundleData&quot;].Outputs.Pack(backrunBundleBytes)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return &amp;common.Hash{}, fmt.Errorf(&quot;could not pack bundle data: %w&quot;, err)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	var offchainTxHash common.Hash</span>
<span class="term-fg32">+	err = suaveClient.Call(&amp;offchainTxHash, &quot;eth_sendRawTransaction&quot;, hexutil.Encode(backrunBidTxBytes), hexutil.Encode(confidentialDataBytes))</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return &amp;common.Hash{}, fmt.Errorf(&quot;offchain tx failed: %w&quot;, err)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	return &amp;offchainTxHash, nil</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func prepareEthBackrunBundle(</span>
<span class="term-fg32">+	goerliClient *rpc.Client,</span>
<span class="term-fg32">+	goerliSigner types.Signer,</span>
<span class="term-fg32">+	privKey *ecdsa.PrivateKey,</span>
<span class="term-fg32">+	matchBidId [16]byte,</span>
<span class="term-fg32">+) (types.SBundle, []byte, error) {</span>
<span class="term-fg32">+	var goerliAccNonce hexutil.Uint64</span>
<span class="term-fg32">+	err := goerliClient.Call(&amp;goerliAccNonce, &quot;eth_getTransactionCount&quot;, crypto.PubkeyToAddress(privKey.PublicKey), &quot;latest&quot;)</span>
<span class="term-fg32">+	RequireNoErrorf(err, &quot;could not call eth_getTransactionCount on suave: %v&quot;, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	ethTx, err := types.SignTx(types.NewTx(&amp;types.DynamicFeeTx{</span>
<span class="term-fg32">+		Nonce:     uint64(goerliAccNonce) + 1, &#47;&#47; wont work with same sender as original tx</span>
<span class="term-fg32">+		To:        &amp;common.Address{},</span>
<span class="term-fg32">+		Value:     big.NewInt(1000),</span>
<span class="term-fg32">+		Gas:       21000,</span>
<span class="term-fg32">+		GasTipCap: big.NewInt(30821813599),</span>
<span class="term-fg32">+		GasFeeCap: big.NewInt(100821813599),</span>
<span class="term-fg32">+		Data:      []byte{},</span>
<span class="term-fg32">+	}), goerliSigner, privKey)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return types.SBundle{}, nil, err</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	bundle := types.SBundle{</span>
<span class="term-fg32">+		Txs:             types.Transactions{ethTx},</span>
<span class="term-fg32">+		RevertingHashes: []common.Hash{},</span>
<span class="term-fg32">+		MatchId:         matchBidId,</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	bundleBytes, err := json.Marshal(bundle)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return types.SBundle{}, nil, err</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	return bundle, bundleBytes, nil</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func prepareMevBackrunBidTx(suaveSigner types.Signer, privKey *ecdsa.PrivateKey, executionNodeAddr common.Address, suaveAccNonce uint64, calldata []byte, mevShareAddr common.Address) (*types.Transaction, hexutil.Bytes, error) {</span>
<span class="term-fg32">+	wrappedTxData := &amp;types.DynamicFeeTx{</span>
<span class="term-fg32">+		Nonce:     suaveAccNonce,</span>
<span class="term-fg32">+		To:        &amp;mevShareAddr,</span>
<span class="term-fg32">+		Value:     nil,</span>
<span class="term-fg32">+		Gas:       10000000,</span>
<span class="term-fg32">+		GasTipCap: big.NewInt(10),</span>
<span class="term-fg32">+		GasFeeCap: big.NewInt(33000000000),</span>
<span class="term-fg32">+		Data:      calldata,</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	offchainTx, err := types.SignTx(types.NewTx(&amp;types.OffchainTx{</span>
<span class="term-fg32">+		ExecutionNode: executionNodeAddr,</span>
<span class="term-fg32">+		Wrapped:       *types.NewTx(wrappedTxData),</span>
<span class="term-fg32">+	}), suaveSigner, privKey)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return nil, nil, err</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	offchainTxBytes, err := offchainTx.MarshalBinary()</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return nil, nil, err</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	return offchainTx, offchainTxBytes, nil</span>
<span class="term-fg32">+}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-1604f9201e478c6e12da2c1c" role="button"
                   aria-expanded="false" aria-controls="id-1604f9201e478c6e12da2c1c">
                    <code>suave/cmd/suavecli/startRelayListener.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/suave/cmd/suavecli/startRelayListener.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+175</span></div>
                        <div class="text-start"><span class="text-danger">-0</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-1604f9201e478c6e12da2c1c"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;suave&#47;cmd&#47;suavecli&#47;startRelayListener.go flashbots&#47;suave-geth&#47;suave&#47;cmd&#47;suavecli&#47;startRelayListener.go</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..c587a0df1ad217482b8c97713f49dd7405c3d01b</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;suave&#47;cmd&#47;suavecli&#47;startRelayListener.go</span>
<span class="term-fg36">@@ -0,0 +1,175 @@</span>
<span class="term-fg32">+package main</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+import (</span>
<span class="term-fg32">+	&quot;context&quot;</span>
<span class="term-fg32">+	&quot;flag&quot;</span>
<span class="term-fg32">+	&quot;fmt&quot;</span>
<span class="term-fg32">+	&quot;io&quot;</span>
<span class="term-fg32">+	&quot;net&#47;http&quot;</span>
<span class="term-fg32">+	&quot;os&quot;</span>
<span class="term-fg32">+	&quot;strings&quot;</span>
<span class="term-fg32">+	&quot;time&quot;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;core&#47;types&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;ethclient&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;log&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;rpc&quot;</span>
<span class="term-fg32">+)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+const hyperCube = `</span>
<span class="term-fg32">+	SUAVE CENTAURI!</span>
<span class="term-fg32">+				         ()</span>
<span class="term-fg32">+	     __________     &#47;&#47; </span>
<span class="term-fg32">+	()  |\          \  &#47;&#47;</span>
<span class="term-fg32">+     \\__ \ _________\&#47;&#47;</span>
<span class="term-fg32">+	  \__) |          |</span>
<span class="term-fg32">+		|  |  goerli  |</span>
<span class="term-fg32">+		 \ |  block   |</span>
<span class="term-fg32">+		  \|__________|</span>
<span class="term-fg32">+		  &#47;&#47;    \\</span>
<span class="term-fg32">+		 ((     ||</span>
<span class="term-fg32">+		  \\    ||</span>
<span class="term-fg32">+		( ()    ||</span>
<span class="term-fg32">+		        () )</span>
<span class="term-fg32">+`</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func cmdRelayListener() {</span>
<span class="term-fg32">+	flagset := flag.NewFlagSet(&quot;startRelayListener&quot;, flag.ExitOnError)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	var (</span>
<span class="term-fg32">+		suaveWs            = flagset.String(&quot;suave_ws&quot;, &quot;ws:&#47;&#47;127.0.0.1:8546&quot;, &quot;address of suave ws&quot;)</span>
<span class="term-fg32">+		verbosity          = flagset.Int(&quot;verbosity&quot;, int(log.LvlInfo), &quot;log verbosity (0-5)&quot;)</span>
<span class="term-fg32">+		blockSenderAddrHex = flagset.String(&quot;block_sender_addr&quot;, &quot;0x42042042028AE1CDE26d5BcF17Ba83f447068E5B&quot;, &quot;address of mev share contract&quot;)</span>
<span class="term-fg32">+		boostRelayUrl      = flagset.String(&quot;relay_url&quot;, &quot;https:&#47;&#47;boost-relay.flashbots.net&#47;&quot;, &quot;address of boost relay that the contract will send blocks to&quot;)</span>
<span class="term-fg32">+	)</span>
<span class="term-fg32">+	flagset.Parse(os.Args[2:])</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	blockHashChan := make(chan string)</span>
<span class="term-fg32">+	nextBlockHashChan := make(chan string)</span>
<span class="term-fg32">+	payloadDeliveredChan := make(chan bool)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	glogger := log.NewGlogHandler(log.StreamHandler(os.Stderr, log.TerminalFormat(false)))</span>
<span class="term-fg32">+	log.Root().SetHandler(glogger)</span>
<span class="term-fg32">+	glogger.Verbosity(log.Lvl(*verbosity))</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	targetAddress := common.HexToAddress(*blockSenderAddrHex)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	go blockHashListener(blockHashChan, *suaveWs, targetAddress)</span>
<span class="term-fg32">+	go blockHashChecker(blockHashChan, nextBlockHashChan, *boostRelayUrl)</span>
<span class="term-fg32">+	go payloadDeliveryChecker(nextBlockHashChan, payloadDeliveredChan, *boostRelayUrl)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; Run until success</span>
<span class="term-fg32">+	&lt;-payloadDeliveredChan</span>
<span class="term-fg32">+	log.Info(&quot;Success!&quot;)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; blockHashListener listens for blocks and when it detects one, sifts through the transactions looking for block bid event</span>
<span class="term-fg32">+func blockHashListener(blockHashChan chan&lt;- string, suaveWs string, targetAddress common.Address) {</span>
<span class="term-fg32">+	client, err := rpc.Dial(suaveWs)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		log.Error(&quot;Failed to connect to the Ethereum client&quot;, &quot;err&quot;, err)</span>
<span class="term-fg32">+		return</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	ethClient := ethclient.NewClient(client)</span>
<span class="term-fg32">+	if ethClient == nil {</span>
<span class="term-fg32">+		log.Error(&quot;Failed to create new ethclient instance&quot;)</span>
<span class="term-fg32">+		return</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	log.Info(&quot;started hint listener&quot;)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	headers := make(chan *types.Header)</span>
<span class="term-fg32">+	sub, err := ethClient.SubscribeNewHead(context.Background(), headers)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		log.Error(&quot;Failed to subscribe to new heads: %v&quot;, err)</span>
<span class="term-fg32">+		return</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	log.Info(&quot;Subscribed to NewHead events&quot;)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	for {</span>
<span class="term-fg32">+		select {</span>
<span class="term-fg32">+		case err := &lt;-sub.Err():</span>
<span class="term-fg32">+			log.Error(&quot;Subscription error: %v&quot;, err)</span>
<span class="term-fg32">+		case header := &lt;-headers:</span>
<span class="term-fg32">+			block, err := ethClient.BlockByHash(context.Background(), header.Hash())</span>
<span class="term-fg32">+			if err != nil {</span>
<span class="term-fg32">+				log.Error(&quot;Failed to get block by hash: %v&quot;, err)</span>
<span class="term-fg32">+				return</span>
<span class="term-fg32">+			} else {</span>
<span class="term-fg32">+				for _, tx := range block.Transactions() {</span>
<span class="term-fg32">+					if tx.To().Hex() == targetAddress.Hex() {</span>
<span class="term-fg32">+						receipt, err := ethClient.TransactionReceipt(context.Background(), tx.Hash())</span>
<span class="term-fg32">+						if err != nil {</span>
<span class="term-fg32">+							log.Error(&quot;Failed to get transaction receipt: %v&quot;, err)</span>
<span class="term-fg32">+							return</span>
<span class="term-fg32">+						} else {</span>
<span class="term-fg32">+							for _, log := range receipt.Logs {</span>
<span class="term-fg32">+								fmt.Println(log) &#47;&#47; For now, simply print out the logs</span>
<span class="term-fg32">+							}</span>
<span class="term-fg32">+						}</span>
<span class="term-fg32">+						blockHashChan &lt;- block.Hash().Hex()</span>
<span class="term-fg32">+						log.Info(hyperCube) &#47;&#47; Handle one block for now</span>
<span class="term-fg32">+					}</span>
<span class="term-fg32">+				}</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; blockHashChecker is a goroutine that takes the block hash that was emitted and checks the specific endpoint</span>
<span class="term-fg32">+func blockHashChecker(blockHashChan &lt;-chan string, nextBlockHashChan chan&lt;- string, boostRelayUrl string) {</span>
<span class="term-fg32">+	for blockHash := range blockHashChan {</span>
<span class="term-fg32">+		url := fmt.Sprintf(&quot;%s&#47;relay&#47;v1&#47;data&#47;bidtraces&#47;builder_blocks_received?block_hash=%s&quot;, boostRelayUrl, blockHash)</span>
<span class="term-fg32">+		for i := 0; i &lt; 12; i++ {</span>
<span class="term-fg32">+			time.Sleep(time.Second)</span>
<span class="term-fg32">+			resp, err := http.Get(url)</span>
<span class="term-fg32">+			if err != nil {</span>
<span class="term-fg32">+				log.Error(&quot;Failed to send GET request: %v&quot;, err)</span>
<span class="term-fg32">+				continue</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+			body, err := io.ReadAll(resp.Body)</span>
<span class="term-fg32">+			if err != nil {</span>
<span class="term-fg32">+				log.Error(&quot;Failed to read response body: %v&quot;, err)</span>
<span class="term-fg32">+				continue</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+			if strings.Contains(string(body), blockHash) {</span>
<span class="term-fg32">+				nextBlockHashChan &lt;- blockHash</span>
<span class="term-fg32">+				break</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; payloadDeliveryChecker is a goroutine that checks if the proposer payload was delivered using the block hash</span>
<span class="term-fg32">+func payloadDeliveryChecker(nextBlockHashChan &lt;-chan string, payloadDeliveredChan chan&lt;- bool, boostRelayUrl string) {</span>
<span class="term-fg32">+	for blockHash := range nextBlockHashChan {</span>
<span class="term-fg32">+		if blockHash == &quot;&quot; {</span>
<span class="term-fg32">+			continue</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		url := fmt.Sprintf(&quot;%s&#47;relay&#47;v1&#47;data&#47;bidtraces&#47;proposer_payload_delivered?block_hash=%s&quot;, boostRelayUrl, blockHash)</span>
<span class="term-fg32">+		for i := 0; i &lt; 10; i++ {</span>
<span class="term-fg32">+			time.Sleep(time.Second)</span>
<span class="term-fg32">+			resp, err := http.Get(url)</span>
<span class="term-fg32">+			if err != nil {</span>
<span class="term-fg32">+				log.Error(&quot;Failed to send GET request: %v&quot;, err)</span>
<span class="term-fg32">+				continue</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+			body, err := io.ReadAll(resp.Body)</span>
<span class="term-fg32">+			if err != nil {</span>
<span class="term-fg32">+				log.Error(&quot;Failed to read response body: %v&quot;, err)</span>
<span class="term-fg32">+				continue</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+			if strings.Contains(string(body), blockHash) {</span>
<span class="term-fg32">+				payloadDeliveredChan &lt;- true</span>
<span class="term-fg32">+				return</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		payloadDeliveredChan &lt;- false</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-392ab6bc34d1bad35c227182" role="button"
                   aria-expanded="false" aria-controls="id-392ab6bc34d1bad35c227182">
                    <code>suave/cmd/suavecli/sendBundle.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/suave/cmd/suavecli/sendBundle.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+266</span></div>
                        <div class="text-start"><span class="text-danger">-0</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-392ab6bc34d1bad35c227182"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;suave&#47;cmd&#47;suavecli&#47;sendBundle.go flashbots&#47;suave-geth&#47;suave&#47;cmd&#47;suavecli&#47;sendBundle.go</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..8cb11aa94490a2a7db15ccc733d23db1582ad1a1</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;suave&#47;cmd&#47;suavecli&#47;sendBundle.go</span>
<span class="term-fg36">@@ -0,0 +1,266 @@</span>
<span class="term-fg32">+package main</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+import (</span>
<span class="term-fg32">+	&quot;context&quot;</span>
<span class="term-fg32">+	&quot;crypto&#47;ecdsa&quot;</span>
<span class="term-fg32">+	&quot;encoding&#47;json&quot;</span>
<span class="term-fg32">+	&quot;flag&quot;</span>
<span class="term-fg32">+	&quot;math&#47;big&quot;</span>
<span class="term-fg32">+	&quot;os&quot;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;cmd&#47;utils&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&#47;hexutil&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;core&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;core&#47;types&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;crypto&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;internal&#47;ethapi&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;log&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;rpc&quot;</span>
<span class="term-fg32">+)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func cmdSendBundle() {</span>
<span class="term-fg32">+	flagset := flag.NewFlagSet(&quot;sendBundle&quot;, flag.ExitOnError)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	var (</span>
<span class="term-fg32">+		suaveRpc                = flagset.String(&quot;suave_rpc&quot;, &quot;http:&#47;&#47;127.0.0.1:8545&quot;, &quot;address of suave rpc&quot;)</span>
<span class="term-fg32">+		executionNodeAddressHex = flagset.String(&quot;ex_node_addr&quot;, &quot;0x4E2B0c0e428AE1CDE26d5BcF17Ba83f447068E5B&quot;, &quot;wallet address of execution node&quot;)</span>
<span class="term-fg32">+		goerliRpc               = flagset.String(&quot;goerli_rpc&quot;, &quot;http:&#47;&#47;127.0.0.1:8545&quot;, &quot;address of goerli rpc&quot;)</span>
<span class="term-fg32">+		privKeyHex              = flagset.String(&quot;privkey&quot;, &quot;&quot;, &quot;private key as hex (for testing)&quot;)</span>
<span class="term-fg32">+		verbosity               = flagset.Int(&quot;verbosity&quot;, int(log.LvlInfo), &quot;log verbosity (0-5)&quot;)</span>
<span class="term-fg32">+		privKey                 *ecdsa.PrivateKey</span>
<span class="term-fg32">+	)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	flagset.Parse(os.Args[2:])</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	glogger := log.NewGlogHandler(log.StreamHandler(os.Stderr, log.TerminalFormat(false)))</span>
<span class="term-fg32">+	log.Root().SetHandler(glogger)</span>
<span class="term-fg32">+	glogger.Verbosity(log.Lvl(*verbosity))</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	privKey, err := crypto.HexToECDSA(*privKeyHex)</span>
<span class="term-fg32">+	RequireNoErrorf(err, &quot;-nodekeyhex: %v&quot;, err)</span>
<span class="term-fg32">+	&#47;* shush linter *&#47; privKey.Public()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	if executionNodeAddressHex == nil || *executionNodeAddressHex == &quot;&quot; {</span>
<span class="term-fg32">+		utils.Fatalf(&quot;please provide ex_node_addr&quot;)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	executionNodeAddress := common.HexToAddress(*executionNodeAddressHex)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	suaveClient, err := rpc.DialContext(context.TODO(), *suaveRpc)</span>
<span class="term-fg32">+	RequireNoErrorf(err, &quot;could not connect to suave rpc: %v&quot;, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	goerliClient, err := rpc.DialContext(context.TODO(), *goerliRpc)</span>
<span class="term-fg32">+	RequireNoErrorf(err, &quot;could not connect to goerli rpc: %v&quot;, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	genesis := core.DefaultSuaveGenesisBlock()</span>
<span class="term-fg32">+	chainId := hexutil.Big(*genesis.Config.ChainID)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	goerliSigner := types.LatestSigner(core.DefaultGoerliGenesisBlock().Config)</span>
<span class="term-fg32">+	suaveSigner := types.NewOffchainSigner(genesis.Config.ChainID)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	gas := hexutil.Uint64(1000000)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	{ &#47;&#47; Sanity check</span>
<span class="term-fg32">+		var result string</span>
<span class="term-fg32">+		rpcErr := suaveClient.Call(&amp;result, &quot;eth_call&quot;, ethapi.TransactionArgs{</span>
<span class="term-fg32">+			To:         &amp;isOffchainAddress,</span>
<span class="term-fg32">+			Gas:        &amp;gas,</span>
<span class="term-fg32">+			IsOffchain: true,</span>
<span class="term-fg32">+			ChainID:    &amp;chainId,</span>
<span class="term-fg32">+		}, &quot;latest&quot;)</span>
<span class="term-fg32">+		RequireNoErrorf(rpcErr, &quot;could not call isOffchain precompile: %v&quot;, unwrapPeekerError(rpcErr))</span>
<span class="term-fg32">+		if result != &quot;0x01&quot; {</span>
<span class="term-fg32">+			utils.Fatalf(&quot;unexpected result from offchain call %s, expected 0x01&quot;, result)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		log.Info(&quot;Suave node seems sane, continuing&quot;)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	addr := crypto.PubkeyToAddress(privKey.PublicKey)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	var goerliAccNonceBytes hexutil.Uint64</span>
<span class="term-fg32">+	err = goerliClient.Call(&amp;goerliAccNonceBytes, &quot;eth_getTransactionCount&quot;, addr, &quot;latest&quot;)</span>
<span class="term-fg32">+	RequireNoErrorf(err, &quot;could not call eth_getTransactionCount on goerli: %v&quot;, err)</span>
<span class="term-fg32">+	goerliAccNonce := uint64(goerliAccNonceBytes)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; Prepare the bundle to land</span>
<span class="term-fg32">+	ethTx, err := types.SignTx(types.NewTx(&amp;types.DynamicFeeTx{</span>
<span class="term-fg32">+		To:        &amp;addr,</span>
<span class="term-fg32">+		Nonce:     goerliAccNonce,</span>
<span class="term-fg32">+		GasTipCap: big.NewInt(10),</span>
<span class="term-fg32">+		GasFeeCap: big.NewInt(500),</span>
<span class="term-fg32">+		Gas:       21000,</span>
<span class="term-fg32">+		Value:     big.NewInt(10000), &#47;&#47; in wei</span>
<span class="term-fg32">+		Data:      []byte{},</span>
<span class="term-fg32">+	}), goerliSigner, privKey)</span>
<span class="term-fg32">+	RequireNoErrorf(err, &quot;could not sign eth tx: %v&quot;, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	ethBundle := struct {</span>
<span class="term-fg32">+		Txs             types.Transactions `json:&quot;txs&quot;`</span>
<span class="term-fg32">+		RevertingHashes []common.Hash      `json:&quot;revertingHashes&quot;`</span>
<span class="term-fg32">+	}{</span>
<span class="term-fg32">+		Txs:             types.Transactions{ethTx},</span>
<span class="term-fg32">+		RevertingHashes: []common.Hash{},</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	ethBundleBytes, err := json.Marshal(ethBundle)</span>
<span class="term-fg32">+	RequireNoErrorf(err, &quot;could not marshal bundle: %v&quot;, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	{</span>
<span class="term-fg32">+		txs := []string{}</span>
<span class="term-fg32">+		for _, tx := range ethBundle.Txs {</span>
<span class="term-fg32">+			txJson, _ := tx.MarshalJSON()</span>
<span class="term-fg32">+			txs = append(txs, string(txJson))</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		log.Info(&quot;Prepared eth bundle&quot;, &quot;txs&quot;, txs)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	var suaveAccNonceBytes hexutil.Uint64</span>
<span class="term-fg32">+	err = suaveClient.Call(&amp;suaveAccNonceBytes, &quot;eth_getTransactionCount&quot;, addr, &quot;latest&quot;)</span>
<span class="term-fg32">+	RequireNoErrorf(err, &quot;could not call eth_getTransactionCount on suave: %v&quot;, err)</span>
<span class="term-fg32">+	suaveAccNonce := uint64(suaveAccNonceBytes)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	var suaveGp hexutil.Big</span>
<span class="term-fg32">+	err = suaveClient.Call(&amp;suaveGp, &quot;eth_gasPrice&quot;)</span>
<span class="term-fg32">+	RequireNoErrorf(err, &quot;could not call eth_gasPrice on suave: %v&quot;, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	offchainInnerTxTemplate := &amp;types.LegacyTx{</span>
<span class="term-fg32">+		Nonce:    suaveAccNonce, &#47;&#47; will be incremented later on</span>
<span class="term-fg32">+		To:       &amp;newBundleBidAddress,</span>
<span class="term-fg32">+		Value:    nil,</span>
<span class="term-fg32">+		Gas:      1000000,</span>
<span class="term-fg32">+		GasPrice: (*big.Int)(&amp;suaveGp),</span>
<span class="term-fg32">+		Data:     nil, &#47;&#47; FillMe!</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	executedOffchainTxHashes := []common.Hash{}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	var currentGoerliBlockNumber hexutil.Uint64</span>
<span class="term-fg32">+	err = goerliClient.Call(&amp;currentGoerliBlockNumber, &quot;eth_blockNumber&quot;)</span>
<span class="term-fg32">+	RequireNoErrorf(err, &quot;could not call eth_blockNumber on goerli: %v&quot;, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	minTargetBlock := uint64(currentGoerliBlockNumber) + uint64(1)</span>
<span class="term-fg32">+	maxTargetBlock := minTargetBlock + uint64(1) &#47;&#47; TODO: 25</span>
<span class="term-fg32">+	for cTargetBlock := minTargetBlock; cTargetBlock &lt;= maxTargetBlock; cTargetBlock++ {</span>
<span class="term-fg32">+		&#47;&#47; Send a bundle bid</span>
<span class="term-fg32">+		allowedPeekers := []common.Address{newBlockBidAddress, newBundleBidAddress, buildEthBlockAddress}</span>
<span class="term-fg32">+		calldata, err := bundleBidAbi.Pack(&quot;newBid&quot;, cTargetBlock, allowedPeekers)</span>
<span class="term-fg32">+		RequireNoErrorf(err, &quot;could not pack newBid args: %v&quot;, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		offchainInnerTx := *offchainInnerTxTemplate</span>
<span class="term-fg32">+		offchainInnerTx.Data = calldata</span>
<span class="term-fg32">+		offchainInnerTxTemplate.Nonce += 1</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		offchainTx, err := types.SignTx(types.NewTx(&amp;types.OffchainTx{</span>
<span class="term-fg32">+			ExecutionNode: executionNodeAddress,</span>
<span class="term-fg32">+			Wrapped:       *types.NewTx(&amp;offchainInnerTx),</span>
<span class="term-fg32">+		}), suaveSigner, privKey)</span>
<span class="term-fg32">+		RequireNoErrorf(err, &quot;could not sign offchainTx: %v&quot;, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		offchainTxBytes, err := offchainTx.MarshalBinary()</span>
<span class="term-fg32">+		RequireNoErrorf(err, &quot;could not marshal offchainTx: %v&quot;, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		confidentialDataBytes, err := bundleBidAbi.Methods[&quot;fetchBidConfidentialBundleData&quot;].Outputs.Pack(ethBundleBytes)</span>
<span class="term-fg32">+		RequireNoErrorf(err, &quot;could not pack bundle confidential data: %v&quot;, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		var offchainTxHash common.Hash</span>
<span class="term-fg32">+		rpcErr := suaveClient.Call(&amp;offchainTxHash, &quot;eth_sendRawTransaction&quot;, hexutil.Encode(offchainTxBytes), hexutil.Encode(confidentialDataBytes))</span>
<span class="term-fg32">+		RequireNoErrorf(rpcErr, &quot;could not send bundle bid: %v&quot;, unwrapPeekerError(rpcErr))</span>
<span class="term-fg32">+		executedOffchainTxHashes = append(executedOffchainTxHashes, offchainTxHash)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	log.Info(&quot;Submitted bundle to suave&quot;, &quot;executedOffchainTxHashes&quot;, executedOffchainTxHashes)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	{ &#47;&#47; Bid mempool sanity check</span>
<span class="term-fg32">+		packedCondBytes, err := suaveLibAbi.Methods[&quot;fetchBids&quot;].Inputs.Pack(minTargetBlock)</span>
<span class="term-fg32">+		RequireNoErrorf(err, &quot;could not pack fetchBids: %v&quot;, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		var result hexutil.Bytes</span>
<span class="term-fg32">+		rpcErr := suaveClient.Call(&amp;result, &quot;eth_call&quot;, ethapi.TransactionArgs{</span>
<span class="term-fg32">+			To:         &amp;fetchBidsAddress,</span>
<span class="term-fg32">+			Gas:        &amp;gas,</span>
<span class="term-fg32">+			IsOffchain: true,</span>
<span class="term-fg32">+			ChainID:    &amp;chainId,</span>
<span class="term-fg32">+			Data:       (*hexutil.Bytes)(&amp;packedCondBytes),</span>
<span class="term-fg32">+		}, &quot;latest&quot;)</span>
<span class="term-fg32">+		RequireNoErrorf(rpcErr, &quot;could not pack fetchBids: %v&quot;, unwrapPeekerError(rpcErr))</span>
<span class="term-fg32">+		unpackedBids, err := suaveLibAbi.Methods[&quot;fetchBids&quot;].Outputs.Unpack(result)</span>
<span class="term-fg32">+		RequireNoErrorf(err, &quot;could not unpack fetchBids response %v: %v&quot;, result, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		bids := unpackedBids[0].([]struct {</span>
<span class="term-fg32">+			Id                  [16]uint8        &quot;json:\&quot;id\&quot;&quot;</span>
<span class="term-fg32">+			DecryptionCondition uint64           &quot;json:\&quot;decryptionCondition\&quot;&quot;</span>
<span class="term-fg32">+			AllowedPeekers      []common.Address &quot;json:\&quot;allowedPeekers\&quot;&quot;</span>
<span class="term-fg32">+		})</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		if len(bids) == 0 {</span>
<span class="term-fg32">+			utils.Fatalf(&quot;no bids fetched, expected at least one. result: %v&quot;, result)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		log.Info(&quot;Mempool seems sane, fetched&quot;, &quot;bids&quot;, bids, &quot;targetBlock&quot;, minTargetBlock)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; TODO: confirm (maybe in background) that the transactions all landed in blocks</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; TODO: do this for every goerli block until success</span>
<span class="term-fg32">+	{ &#47;&#47; Request a goerli block</span>
<span class="term-fg32">+		var currentGoerliHeader map[string]interface{}</span>
<span class="term-fg32">+		err = goerliClient.Call(&amp;currentGoerliHeader, &quot;eth_getHeaderByNumber&quot;, &quot;latest&quot;)</span>
<span class="term-fg32">+		RequireNoErrorf(err, &quot;could not call eth_getHeaderByNumber on goerli: %v&quot;, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		timestamp, err := hexutil.DecodeUint64(currentGoerliHeader[&quot;timestamp&quot;].(string))</span>
<span class="term-fg32">+		RequireNoErrorf(err, &quot;could not decode timestamp from %v: %v&quot;, currentGoerliHeader[&quot;timestamp&quot;], err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		payloadArgsTuple := struct {</span>
<span class="term-fg32">+			Parent       common.Hash</span>
<span class="term-fg32">+			Timestamp    uint64</span>
<span class="term-fg32">+			FeeRecipient common.Address</span>
<span class="term-fg32">+			GasLimit     uint64</span>
<span class="term-fg32">+			Random       common.Hash</span>
<span class="term-fg32">+			Withdrawals  []struct {</span>
<span class="term-fg32">+				Index     uint64</span>
<span class="term-fg32">+				Validator uint64</span>
<span class="term-fg32">+				Address   common.Address</span>
<span class="term-fg32">+				Amount    uint64</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+		}{</span>
<span class="term-fg32">+			Parent:       common.HexToHash(currentGoerliHeader[&quot;hash&quot;].(string)),</span>
<span class="term-fg32">+			Timestamp:    timestamp + uint64(12),</span>
<span class="term-fg32">+			FeeRecipient: common.Address{0x42},</span>
<span class="term-fg32">+			GasLimit:     30000000,</span>
<span class="term-fg32">+			Random:       common.Hash{0x44}, &#47;&#47; TODO! Should be taken from goerli beacon chain</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		log.Info(&quot;Prepared payload request&quot;, &quot;args&quot;, payloadArgsTuple)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		calldata, err := buildEthBlockAbi.Pack(&quot;buildFromPool&quot;, payloadArgsTuple, minTargetBlock+1)</span>
<span class="term-fg32">+		RequireNoErrorf(err, &quot;could not pack arguments for block building request: %v&quot;, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		err = suaveClient.Call(&amp;suaveAccNonceBytes, &quot;eth_getTransactionCount&quot;, addr, &quot;pending&quot;)</span>
<span class="term-fg32">+		RequireNoErrorf(err, &quot;could not call eth_getTransactionCount on suave: %v&quot;, err)</span>
<span class="term-fg32">+		suaveAccNonce = uint64(suaveAccNonceBytes)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		wrappedTxData := &amp;types.LegacyTx{</span>
<span class="term-fg32">+			Nonce:    suaveAccNonce,</span>
<span class="term-fg32">+			To:       &amp;newBlockBidAddress,</span>
<span class="term-fg32">+			Value:    nil,</span>
<span class="term-fg32">+			Gas:      1000000,</span>
<span class="term-fg32">+			GasPrice: (*big.Int)(&amp;suaveGp),</span>
<span class="term-fg32">+			Data:     calldata,</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		offchainTx, err := types.SignTx(types.NewTx(&amp;types.OffchainTx{</span>
<span class="term-fg32">+			ExecutionNode: executionNodeAddress,</span>
<span class="term-fg32">+			Wrapped:       *types.NewTx(wrappedTxData),</span>
<span class="term-fg32">+		}), suaveSigner, privKey)</span>
<span class="term-fg32">+		RequireNoErrorf(err, &quot;could not sign block build request: %v&quot;, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		offchainTxBytes, err := offchainTx.MarshalBinary()</span>
<span class="term-fg32">+		RequireNoErrorf(err, &quot;could not marshal block build request: %v&quot;, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		var offchainTxHash common.Hash</span>
<span class="term-fg32">+		rpcErr := suaveClient.Call(&amp;offchainTxHash, &quot;eth_sendRawTransaction&quot;, hexutil.Encode(offchainTxBytes))</span>
<span class="term-fg32">+		RequireNoErrorf(rpcErr, &quot;block building peeker failed: %v&quot;, unwrapPeekerError(rpcErr))</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	log.Info(&quot;All is good!&quot;)</span>
<span class="term-fg32">+}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-b26d8339cdc4c6e215cbf416" role="button"
                   aria-expanded="false" aria-controls="id-b26d8339cdc4c6e215cbf416">
                    <code>suave/cmd/suavecli/README.md</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/suave/cmd/suavecli/README.md" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+333</span></div>
                        <div class="text-start"><span class="text-danger">-0</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-b26d8339cdc4c6e215cbf416"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;suave&#47;cmd&#47;suavecli&#47;README.md flashbots&#47;suave-geth&#47;suave&#47;cmd&#47;suavecli&#47;README.md</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..d381c4d335efec97219c07c78f0df1c31b9c2a6e</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;suave&#47;cmd&#47;suavecli&#47;README.md</span>
<span class="term-fg36">@@ -0,0 +1,333 @@</span>
<span class="term-fg32">+# Suave CLI</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+This repository contains the Command Line Interface (CLI) for interacting with a Suave Geth node for live testing and demo&#39;ing purposes. The Suave CLI allows users to deploy contracts, send bids, and perform various actions related to MEV-Share and Block Building.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+As this repository is under development these commands may not always be up to date but they should be a good starting point for interacting with a SUAVE node.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+## Getting Started</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+Before running the Suave CLI, ensure you have the following:</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+- Golang (Go) installed</span>
<span class="term-fg32">+- Ethereum account with private key (for testing)</span>
<span class="term-fg32">+- Suave RPC endpoint (local or remote)</span>
<span class="term-fg32">+- Goerli RPC endpoint (local or remote)</span>
<span class="term-fg32">+- Goerli Beacon RPC endpoint (local or remote)</span>
<span class="term-fg32">+- Boost Relay URL</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+To get started with the Suave CLI, follow these steps:</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+1. Clone this repository to your local machine.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+2. Install the necessary dependencies by running `go mod tidy`.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+3. Build the CLI using `go build -o suavecli .&#47;suave-geth&#47;cmd&#47;suavecli`.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+4. Run the Suave CLI with the desired command and subcommand.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+For example:</span>
<span class="term-fg32">+```</span>
<span class="term-fg32">+.&#47;suavecli deployBlockSenderContract</span>
<span class="term-fg32">+```</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+## Commands</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+### Deploy Commands:</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+1. `deployBlockSenderContract`: Deploys the BlockSender contract to the Suave network. This contract is used to send constructed blocks for execution via the Boost Relay.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+2. `deployMevShareContract`: Deploys the MevShare contract to the Suave network. This contract is used for sharing Maximum Extractable Value (MEV) profits with the MevExtractor contract.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+### Send Commands:</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+1. `sendBundle`: Sends a bundle of transactions to specified MEVM contract.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+2. `sendMevShareBundle`: Sends a MEVShare bundle to specified MEVM contract.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+3. `sendMevShareMatch`: Sends a MEV share match transaction to the Suave network via the Boost Relay for matching MEV share recipients with their corresponding transactions.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+4. `sendBuildShareBlock`: Sends a transaction to build a Goerli block using MEV-Share orderflow and sends to specified Goerli relay.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+### Demo Helper Commands:</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+1. `startHintListener`: Starts a hint listener for demo purposes. This command listens for hints emmited from MEV-Share on the Suave Chain.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+2. `subscribeBeaconAndBoost`: Subscribes to events from the Beacon Chain and Boost for demo purposes.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+3. `startRelayListener`: Starts a relay listener for demo purposes. This command listens for block submisisons and deliveries from the Boost Relay.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+### End-to-End (e2e) Test Commands:</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+1. `testDeployAndShare`: Performs an end-to-end test scenario that includes contract deployment and block sharing.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+2. `buildGoerliBlocks`: Performs an end-to-end test scenario for building and sharing blocks on the Goerli network.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+## Simple MEV-Share Walkthrough</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+To get a better understanding of how the MEVM works, let&#39;s delve into the deployment of a simple version of `[mev-share](https:&#47;&#47;github.com&#47;flashbots&#47;mev-share)`, a protocol for orderflow auctions, defined via smart contract on SUAVE. Our journey below will guide you through the steps of deploying simple mev-share and block builder contracts, interacting with them, and ultimately seeing a block land onchain.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+- [Intro](https:&#47;&#47;hackmd.io&#47;5BMLvHO8RnaUUN8Tv165XA#Intro)</span>
<span class="term-fg32">+- [Prerequisites 🛠](https:&#47;&#47;hackmd.io&#47;5BMLvHO8RnaUUN8Tv165XA#Prerequisites-%F0%9F%9B%A0)</span>
<span class="term-fg32">+- [Walkthrough Overview 🚀](https:&#47;&#47;hackmd.io&#47;5BMLvHO8RnaUUN8Tv165XA#Walkthrough-Overview-%F0%9F%9A%80)</span>
<span class="term-fg32">+    - [1. Deploy Simple MEV-Share Contract 📜](https:&#47;&#47;hackmd.io&#47;5BMLvHO8RnaUUN8Tv165XA#1-Deploy-Simple-MEV-Share-Contract-%F0%9F%93%9C)</span>
<span class="term-fg32">+    - [2. Deploy Block Builder Contract 📜](https:&#47;&#47;hackmd.io&#47;5BMLvHO8RnaUUN8Tv165XA#2-Deploy-Block-Builder-Contract-%F0%9F%93%9C)</span>
<span class="term-fg32">+    - [3. Send Mevshare Bundles 📨](https:&#47;&#47;hackmd.io&#47;5BMLvHO8RnaUUN8Tv165XA#3-Send-Mevshare-Bundles-%F0%9F%93%A8)</span>
<span class="term-fg32">+    - [4. Send Mevshare Matches 🎯](https:&#47;&#47;hackmd.io&#47;5BMLvHO8RnaUUN8Tv165XA#4-Send-Mevshare-Matches-%F0%9F%8E%AF)</span>
<span class="term-fg32">+    - [5. Build Block and Relay 🧱](https:&#47;&#47;hackmd.io&#47;5BMLvHO8RnaUUN8Tv165XA#5-Build-Block-and-Relay-%F0%9F%A7%B1)</span>
<span class="term-fg32">+- [Conclusion 🎓](https:&#47;&#47;hackmd.io&#47;5BMLvHO8RnaUUN8Tv165XA#Conclusion-%F0%9F%8E%93)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+## Prerequisites 🛠</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+In this walkthrough we will go through a script located inside the [suave cli tool](https:&#47;&#47;github.com&#47;flashbots&#47;suave-geth&#47;blob&#47;suave-poc&#47;cmd&#47;suavecli&#47;testDeployAndShare.go), so don&#39;t worry about running the below code, it’s mainly for conceptual purposes. To follow along and use the tool you will need:</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+- [SUAVE chain node and SUAVE execution node setup](https:&#47;&#47;github.com&#47;flashbots&#47;suave-geth&#47;tree&#47;main&#47;suave).</span>
<span class="term-fg32">+- Basic knowledge of the Ethereum&#39;s Golang libraries and the [Ethereum RPC methods](https:&#47;&#47;github.com&#47;flashbots&#47;suave-geth&#47;tree&#47;main&#47;suave).</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+Ensure these details for the command line tool are on hand:</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+- `suave_rpc` : address of suave rpc</span>
<span class="term-fg32">+- `goerli_rpc` : address of goerli execution node rpc</span>
<span class="term-fg32">+- `goerli_beacon_rpc` : address of goerli beacon rpc</span>
<span class="term-fg32">+- `ex_node_addr` : wallet address of execution node</span>
<span class="term-fg32">+- `privKeyHex` : private key as hex (for testing)</span>
<span class="term-fg32">+- `relay_url` : address of boost relay that the contract will send blocks to</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+## Walktrhough</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+### 1. Deploy Simple MEV-Share Contract 📜</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+Our first step is to deploy the [compiled byte code](https:&#47;&#47;github.com&#47;flashbots&#47;suave-geth&#47;blob&#47;suave-poc&#47;cmd&#47;suavecli&#47;deployMevShareByteCode.go) from our `mev-share` contract. As you will see, deploying on SUAVE feels just like deploying on any other EVM chain. First we gather our transaction details, nounce and gas price, sign the transaction, and then send using the normal `eth_sendRawTransaction` using your `suaveClient`</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+```go</span>
<span class="term-fg32">+	mevShareAddrPtr, txHash, err := sendMevShareCreationTx(suaveClient, suaveSigner, privKey)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		panic(err.Error())</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	waitForTransactionToBeConfirmed(suaveClient, txHash)</span>
<span class="term-fg32">+	mevShareAddr := *mevShareAddrPtr</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+```</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+Now we take a look under the hood of `sendMevShareCreationTx`.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+```go</span>
<span class="term-fg32">+func sendMevShareCreationTx(suaveClient *rpc.Client, suaveSigner types.Signer, privKey *ecdsa.PrivateKey) (*common.Address, *common.Hash, error) {</span>
<span class="term-fg32">+	var suaveAccNonceBytes hexutil.Uint64</span>
<span class="term-fg32">+	err := suaveClient.Call(</span>
<span class="term-fg32">+            &amp;suaveAccNonceBytes,</span>
<span class="term-fg32">+            &quot;eth_getTransactionCount&quot;,</span>
<span class="term-fg32">+            crypto.PubkeyToAddress(privKey.PublicKey),</span>
<span class="term-fg32">+            &quot;latest&quot;</span>
<span class="term-fg32">+        )</span>
<span class="term-fg32">+	suaveAccNonce := uint64(suaveAccNonceBytes)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	var suaveGp hexutil.Big</span>
<span class="term-fg32">+	err = suaveClient.Call(&amp;suaveGp, &quot;eth_gasPrice&quot;)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	calldata := hexutil.MustDecode(mevshareContractBytecode)</span>
<span class="term-fg32">+	mevshareContractBytecode)</span>
<span class="term-fg32">+	ccTxData := &amp;types.LegacyTx{</span>
<span class="term-fg32">+		Nonce:    suaveAccNonce,</span>
<span class="term-fg32">+		To:       nil, &#47;&#47; contract creation</span>
<span class="term-fg32">+		Value:    big.NewInt(0),</span>
<span class="term-fg32">+		Gas:      10000000,</span>
<span class="term-fg32">+		GasPrice: (*big.Int)(&amp;suaveGp),</span>
<span class="term-fg32">+		Data:     calldata,</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	tx, err := types.SignTx(types.NewTx(ccTxData), suaveSigner, privKey)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	from, _ := types.Sender(suaveSigner, tx)</span>
<span class="term-fg32">+	mevshareAddr := crypto.CreateAddress(from, tx.Nonce())</span>
<span class="term-fg32">+	log.Info(&quot;contract address will be&quot;, &quot;addr&quot;, mevshareAddr)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	txBytes, err := tx.MarshalBinary()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	var txHash common.Hash</span>
<span class="term-fg32">+	err = suaveClient.Call(</span>
<span class="term-fg32">+            &amp;txHash,</span>
<span class="term-fg32">+            &quot;eth_sendRawTransaction&quot;,</span>
<span class="term-fg32">+            hexutil.Encode(txBytes)</span>
<span class="term-fg32">+        )</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	return &amp;mevshareAddr, &amp;txHash, nil</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+```</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+Later, we&#39;ll incorporate the `mevshareAddr` into our transaction&#39;s allowed contracts, granting access for the contract to compute over our confidential data.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+### 2. Deploy Block Builder Contract 📜</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+Next we deploy a [simple block builder contract](https:&#47;&#47;github.com&#47;flashbots&#47;suave-geth&#47;blob&#47;4ad40edc58d8374c24a2e88c0b6fe2a7d8363ae3&#47;suave&#47;sol&#47;standard_peekers&#47;bids.sol#L140) which we will also store to later grant access to. The block builder takes in a `boostRelayUrl` which is where it will send blocks to when finished building.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+```go</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	blockSenderAddrPtr, txHash, err := sendBlockSenderCreationTx(</span>
<span class="term-fg32">+            suaveClient,</span>
<span class="term-fg32">+            suaveSigner,</span>
<span class="term-fg32">+            privKey,</span>
<span class="term-fg32">+            boostRelayUrl</span>
<span class="term-fg32">+    )</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		panic(err.Error())</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	waitForTransactionToBeConfirmed(suaveClient, txHash)</span>
<span class="term-fg32">+	blockSenderAddr := *blockSenderAddrPtr</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+```</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+Similar as above, `sendBlockSenderCreationTx` operates like any other contract deployment on an EVM chain.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+### 3. Send Mevshare Bundles 📨</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+Once our contracts have been succesfully deployed we will craft a goerli bundle and send it to our newly deployed mev-share contract.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+```go</span>
<span class="term-fg32">+	mevShareTx, err := sendMevShareBidTx(suaveClient, goerliClient, suaveSigner, goerliSigner, 5, mevShareAddr, blockSenderAddr, executionNodeAddress, privKey)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		err = errors.Wrap(err, unwrapPeekerError(err).Error())</span>
<span class="term-fg32">+		panic(err.Error())</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	waitForTransactionToBeConfirmed(suaveClient, &amp;mevShareTx.txHash)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+```</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+Let&#39;s take a deeper look at `sendMevShareBidTx` which looks similar to a normal Ethereum transaction but has a couple key differences. We explore those below the following code snippet.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+```go</span>
<span class="term-fg32">+func sendMevShareBidTx(</span>
<span class="term-fg32">+    &#47;&#47; function inputs removed for brevity</span>
<span class="term-fg32">+) (mevShareBidData, error) {</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	var startingGoerliBlockNum uint64</span>
<span class="term-fg32">+	err = goerliClient.Call(</span>
<span class="term-fg32">+            (*hexutil.Uint64)(&amp;startingGoerliBlockNum),</span>
<span class="term-fg32">+            &quot;eth_blockNumber&quot;</span>
<span class="term-fg32">+        )</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		utils.Fatalf(&quot;could not get goerli block: %v&quot;, err)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	_, ethBundleBytes, err := prepareEthBundle(</span>
<span class="term-fg32">+            goerliClient,</span>
<span class="term-fg32">+            goerliSigner,</span>
<span class="term-fg32">+            privKey</span>
<span class="term-fg32">+        )</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; Prepare bundle bid</span>
<span class="term-fg32">+	var suaveAccNonce hexutil.Uint64</span>
<span class="term-fg32">+	err = suaveClient.Call(</span>
<span class="term-fg32">+            &amp;suaveAccNonce,</span>
<span class="term-fg32">+            &quot;eth_getTransactionCount&quot;,</span>
<span class="term-fg32">+            crypto.PubkeyToAddress(privKey.PublicKey),</span>
<span class="term-fg32">+            &quot;pending&quot;</span>
<span class="term-fg32">+        )</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	confidentialDataBytes, err := mevShareABI.Methods[&quot;fetchBidConfidentialBundleData&quot;].Outputs.Pack(ethBundleBytes)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	allowedPeekers := []common.Address{</span>
<span class="term-fg32">+            newBlockBidAddress,</span>
<span class="term-fg32">+            extractHintAddress,</span>
<span class="term-fg32">+            buildEthBlockAddress,</span>
<span class="term-fg32">+            mevShareAddr,</span>
<span class="term-fg32">+            blockBuilderAddr</span>
<span class="term-fg32">+        }</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	calldata, err := mevShareABI.Pack(&quot;newBid&quot;, blockNum, allowedPeekers)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return mevShareBidData{}, err</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+        wrappedTxData := &amp;types.DynamicFeeTx{</span>
<span class="term-fg32">+		Nonce:     suaveAccNonce,</span>
<span class="term-fg32">+		To:        &amp;mevShareAddr,</span>
<span class="term-fg32">+		Value:     nil,</span>
<span class="term-fg32">+		Gas:       10000000,</span>
<span class="term-fg32">+		GasTipCap: big.NewInt(10),</span>
<span class="term-fg32">+		GasFeeCap: big.NewInt(33000000000),</span>
<span class="term-fg32">+		Data:      calldata,</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	mevShareTx, err := types.SignTx(types.NewTx(&amp;types.OffchainTx{</span>
<span class="term-fg32">+		ExecutionNode: executionNodeAddr,</span>
<span class="term-fg32">+		Wrapped:       *types.NewTx(wrappedTxData),</span>
<span class="term-fg32">+	}), suaveSigner, privKey)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return nil, nil, err</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	mevShareTxBytes, err := mevShareTx.MarshalBinary()</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return nil, nil, err</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	var offchainTxHash common.Hash</span>
<span class="term-fg32">+	err = suaveClient.Call(</span>
<span class="term-fg32">+            &amp;offchainTxHash,</span>
<span class="term-fg32">+            &quot;eth_sendRawTransaction&quot;,</span>
<span class="term-fg32">+            hexutil.Encode(mevShareTxBytes),</span>
<span class="term-fg32">+            hexutil.Encode(confidentialDataBytes)</span>
<span class="term-fg32">+        )</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return mevShareBidData{}, err</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	mevShareTxHash= mevShareBidData{blockNumber: blockNum, txHash: offchainTxHash}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	return mevShareTxHash, nil</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+```</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+A SUAVE transaction, referred to as a mevshare bid in the code, takes in two extra arguments: `allowedPeekers` and `executionNodeAddr`. These arguement are to utilize a new transaction primitive `types.OffchainTx`, which you can read more about [here](https:&#47;&#47;github.com&#47;flashbots&#47;suave-geth&#47;tree&#47;suave-poc&#47;suave#off-chain-transactions).  The role of `allowedPeekers` is to dictate which contracts can view the confidential data, in our scenario, the goerli bundle being submitted. Meanwhile, `executionNodeAddr` points to the intended execution node for the transaction. Lastly, Suave nodes have a modified `ethSendRawTransaction` to support this new transaction type.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+### 4. Send Mevshare Matches 🎯</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+Now that a MEV-share bid has been sent in we can simulate sending in a match. Once live on a testnet, searchers can monitor the SUAVE chain looking for hints emitted as logs for protocols they specialize in. In our example you could monitor the `mevShareAddr` for emitted events. Using these hints they can get a `BidId` to reference in their match. Below we see the code.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+```go</span>
<span class="term-fg32">+    bidIdBytes, err := extractBidId(suaveClient, mevShareTx.txHash)</span>
<span class="term-fg32">+    if err != nil {</span>
<span class="term-fg32">+        panic(err.Error())</span>
<span class="term-fg32">+    }</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+    _, err = sendMevShareMatchTx(</span>
<span class="term-fg32">+        suaveClient,</span>
<span class="term-fg32">+        goerliClient,</span>
<span class="term-fg32">+        suaveSigner,</span>
<span class="term-fg32">+        goerliSigner,</span>
<span class="term-fg32">+        mevShareTx.blockNumber,</span>
<span class="term-fg32">+        mevShareAddr,</span>
<span class="term-fg32">+        blockSenderAddr,</span>
<span class="term-fg32">+        executionNodeAddress,</span>
<span class="term-fg32">+        bidIdBytes,</span>
<span class="term-fg32">+        privKey,</span>
<span class="term-fg32">+    )</span>
<span class="term-fg32">+    if err != nil {</span>
<span class="term-fg32">+        err = errors.Wrap(err, unwrapPeekerError(err).Error())</span>
<span class="term-fg32">+        panic(err.Error())</span>
<span class="term-fg32">+    }</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+```</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+### 5. Build Block and Relay 🧱</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+Now that our SUAVE node&#39;s bidpool has a mevshare bid and match, we can trigger block building to combine these transactions, simulate for validity, and insert the refund transaction.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+```go</span>
<span class="term-fg32">+    _, err = sendBuildShareBlockTx(suaveClient, suaveSigner, privKey, executionNodeAddress, blockSenderAddr, payloadArgsTuple, uint64(goerliBlockNum)+1)</span>
<span class="term-fg32">+    if err != nil {</span>
<span class="term-fg32">+        err = errors.Wrap(err, unwrapPeekerError(err).Error())</span>
<span class="term-fg32">+        if strings.Contains(err.Error(), &quot;no bids&quot;) {</span>
<span class="term-fg32">+            log.Error(&quot;Failed to build a block, no bids&quot;)</span>
<span class="term-fg32">+        }</span>
<span class="term-fg32">+        log.Error(&quot;Failed to send BuildShareBlockTx&quot;, &quot;err&quot;, err)</span>
<span class="term-fg32">+    }</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+```</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+Once the execution node has received this transaction it will build your block and send it off to a relay. If you used the flashbots goerli relay you should be able to check it out using the [builder blocks received endpoint](https:&#47;&#47;boost-relay-goerli.flashbots.net&#47;).</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-e8145233a9f39d84c4ad0496" role="button"
                   aria-expanded="false" aria-controls="id-e8145233a9f39d84c4ad0496">
                    <code>suave/cmd/suavecli/main.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/suave/cmd/suavecli/main.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+161</span></div>
                        <div class="text-start"><span class="text-danger">-0</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-e8145233a9f39d84c4ad0496"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;suave&#47;cmd&#47;suavecli&#47;main.go flashbots&#47;suave-geth&#47;suave&#47;cmd&#47;suavecli&#47;main.go</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..07421c661bddd8aa46ce8b3bff89ef28b48885f9</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;suave&#47;cmd&#47;suavecli&#47;main.go</span>
<span class="term-fg36">@@ -0,0 +1,161 @@</span>
<span class="term-fg32">+package main</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+import (</span>
<span class="term-fg32">+	&quot;context&quot;</span>
<span class="term-fg32">+	&quot;crypto&#47;ecdsa&quot;</span>
<span class="term-fg32">+	&quot;errors&quot;</span>
<span class="term-fg32">+	&quot;fmt&quot;</span>
<span class="term-fg32">+	&quot;os&quot;</span>
<span class="term-fg32">+	&quot;strings&quot;</span>
<span class="term-fg32">+	&quot;time&quot;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;cmd&#47;utils&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&#47;hexutil&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;core&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;core&#47;types&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;crypto&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;log&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;rpc&quot;</span>
<span class="term-fg32">+)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+var commands = map[string]func(){</span>
<span class="term-fg32">+	&#47;&#47; deploy</span>
<span class="term-fg32">+	&quot;deployBlockSenderContract&quot;: cmdDeployBlockSenderContract,</span>
<span class="term-fg32">+	&quot;deployMevShareContract&quot;:    cmdDeployMevShareContract,</span>
<span class="term-fg32">+	&#47;&#47; send</span>
<span class="term-fg32">+	&quot;sendBundle&quot;:          cmdSendBundle,</span>
<span class="term-fg32">+	&quot;sendMevShareBundle&quot;:  cmdSendMevShareBundle,</span>
<span class="term-fg32">+	&quot;sendMevShareMatch&quot;:   cmdSendMevShareMatch,</span>
<span class="term-fg32">+	&quot;sendBuildShareBlock&quot;: cmdSendBuildShareBlock,</span>
<span class="term-fg32">+	&#47;&#47; listeners</span>
<span class="term-fg32">+	&quot;startHintListener&quot;:       cmdHintListener,</span>
<span class="term-fg32">+	&quot;subscribeBeaconAndBoost&quot;: cmdSubscribeBeaconAndBoost,</span>
<span class="term-fg32">+	&quot;startRelayListener&quot;:      cmdRelayListener,</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; e2e test</span>
<span class="term-fg32">+	&quot;testDeployAndShare&quot;: cmdTestDeployAndShare,</span>
<span class="term-fg32">+	&quot;buildGoerliBlocks&quot;:  cmdBuildGoerliBlocks,</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func getAllowedCommands() string {</span>
<span class="term-fg32">+	allowedCommands := []string{}</span>
<span class="term-fg32">+	for cmd := range commands {</span>
<span class="term-fg32">+		allowedCommands = append(allowedCommands, cmd)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	return strings.Join(allowedCommands, &quot;, &quot;)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func main() {</span>
<span class="term-fg32">+	glogger := log.NewGlogHandler(log.StreamHandler(os.Stderr, log.TerminalFormat(false)))</span>
<span class="term-fg32">+	log.Root().SetHandler(glogger)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; First, get the command to run</span>
<span class="term-fg32">+	if len(os.Args) &lt; 2 {</span>
<span class="term-fg32">+		utils.Fatalf(&quot;please specify the command. Possible commands: %s&quot;, getAllowedCommands())</span>
<span class="term-fg32">+		return</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	cmd, found := commands[os.Args[1]]</span>
<span class="term-fg32">+	if !found {</span>
<span class="term-fg32">+		utils.Fatalf(&quot;invalid command %s. please specify the command. Possible commands: %s&quot;, os.Args[1], getAllowedCommands())</span>
<span class="term-fg32">+		return</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	cmd()</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+var (</span>
<span class="term-fg32">+	isOffchainAddress = common.HexToAddress(&quot;0x42010000&quot;)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	fetchBidsAddress    = common.HexToAddress(&quot;0x42030001&quot;)</span>
<span class="term-fg32">+	newBundleBidAddress = common.HexToAddress(&quot;0x42200000&quot;)</span>
<span class="term-fg32">+	newBlockBidAddress  = common.HexToAddress(&quot;0x42200001&quot;)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	buildEthBlockAddress = common.HexToAddress(&quot;0x42100001&quot;)</span>
<span class="term-fg32">+	extractHintAddress   = common.HexToAddress(&quot;0x42100037&quot;)</span>
<span class="term-fg32">+)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func RequireNoError(err error) {</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		utils.Fatalf(&quot;%v&quot;, err)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func RequireNoErrorf(err error, format string, args ...interface{}) {</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		utils.Fatalf(format, args...)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func unwrapPeekerError(rpcErr error) error {</span>
<span class="term-fg32">+	if rpcErr == nil {</span>
<span class="term-fg32">+		return nil</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	if len(rpcErr.Error()) &lt; 26 {</span>
<span class="term-fg32">+		return rpcErr</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	decodedError, err := hexutil.Decode(rpcErr.Error()[20:])</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return errors.Join(rpcErr, err)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	unpacked, err := suaveLibAbi.Errors[&quot;PeekerReverted&quot;].Inputs.Unpack(decodedError[4:])</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return errors.Join(rpcErr, err)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	revertReason := string(unpacked[1].([]byte))</span>
<span class="term-fg32">+	return errors.Join(rpcErr, fmt.Errorf(&quot;revert reason: %s&quot;, revertReason))</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func waitForTransactionToBeConfirmed(suaveClient *rpc.Client, txHash *common.Hash) {</span>
<span class="term-fg32">+	for i := 0; i &lt; 10; i++ {</span>
<span class="term-fg32">+		time.Sleep(time.Duration(1+i&#47;2) * time.Second)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		var r *types.Receipt</span>
<span class="term-fg32">+		err := suaveClient.Call(&amp;r, &quot;eth_getTransactionReceipt&quot;, txHash)</span>
<span class="term-fg32">+		if err == nil &amp;&amp; r != nil {</span>
<span class="term-fg32">+			log.Info(&quot;All is good!&quot;, &quot;receipt&quot;, r, &quot;block_num&quot;, r.BlockNumber)</span>
<span class="term-fg32">+			return</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	utils.Fatalf(&quot;did not see the receipt succeed in time. hash: %s&quot;, txHash.String())</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func extractBidId(suaveClient *rpc.Client, txHash common.Hash) ([16]byte, error) {</span>
<span class="term-fg32">+	var r *types.Receipt</span>
<span class="term-fg32">+	err := suaveClient.Call(&amp;r, &quot;eth_getTransactionReceipt&quot;, &amp;txHash)</span>
<span class="term-fg32">+	if err == nil &amp;&amp; r != nil {</span>
<span class="term-fg32">+		unpacked, err := mevShareABI.Events[&quot;HintEvent&quot;].Inputs.Unpack(r.Logs[1].Data) &#47;&#47; index = 1 because second hint is bid event</span>
<span class="term-fg32">+		if err != nil {</span>
<span class="term-fg32">+			return [16]byte{0}, err</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		shareBidId := unpacked[0].([16]byte)</span>
<span class="term-fg32">+		return shareBidId, nil</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	return [16]byte{0}, err</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func setUpSuaveAndGoerli(privKeyHex *string, executionNodeAddressHex *string, suaveRpc *string, goerliRpc *string) (*ecdsa.PrivateKey, common.Address, *rpc.Client, *rpc.Client, types.Signer, types.Signer) {</span>
<span class="term-fg32">+	privKey, err := crypto.HexToECDSA(*privKeyHex)</span>
<span class="term-fg32">+	RequireNoErrorf(err, &quot;-nodekeyhex: %v&quot;, err)</span>
<span class="term-fg32">+	&#47;* shush linter *&#47; privKey.Public()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	executionNodeAddress := common.HexToAddress(*executionNodeAddressHex)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	suaveClient, err := rpc.DialContext(context.TODO(), *suaveRpc)</span>
<span class="term-fg32">+	RequireNoErrorf(err, &quot;could not connect to suave rpc: %v&quot;, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	goerliClient, err := rpc.DialContext(context.TODO(), *goerliRpc)</span>
<span class="term-fg32">+	RequireNoErrorf(err, &quot;could not connect to goerli rpc: %v&quot;, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	genesis := core.DefaultSuaveGenesisBlock()</span>
<span class="term-fg32">+	suaveSigner := types.NewOffchainSigner(genesis.Config.ChainID)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	goerliSigner := types.LatestSigner(core.DefaultGoerliGenesisBlock().Config)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	return privKey, executionNodeAddress, suaveClient, goerliClient, suaveSigner, goerliSigner</span>
<span class="term-fg32">+}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-af3dadc4c24dc73d0e5604d5" role="button"
                   aria-expanded="false" aria-controls="id-af3dadc4c24dc73d0e5604d5">
                    <code>suave/cmd/suavecli/deployBlockSender.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/suave/cmd/suavecli/deployBlockSender.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+105</span></div>
                        <div class="text-start"><span class="text-danger">-0</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-af3dadc4c24dc73d0e5604d5"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;suave&#47;cmd&#47;suavecli&#47;deployBlockSender.go flashbots&#47;suave-geth&#47;suave&#47;cmd&#47;suavecli&#47;deployBlockSender.go</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..6b06ee80325d54a883b9c91865c86377bd0bc6a3</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;suave&#47;cmd&#47;suavecli&#47;deployBlockSender.go</span>
<span class="term-fg36">@@ -0,0 +1,105 @@</span>
<span class="term-fg32">+package main</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+import (</span>
<span class="term-fg32">+	&quot;context&quot;</span>
<span class="term-fg32">+	&quot;crypto&#47;ecdsa&quot;</span>
<span class="term-fg32">+	&quot;flag&quot;</span>
<span class="term-fg32">+	&quot;math&#47;big&quot;</span>
<span class="term-fg32">+	&quot;os&quot;</span>
<span class="term-fg32">+	&quot;time&quot;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;cmd&#47;utils&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&#47;hexutil&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;core&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;core&#47;types&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;crypto&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;log&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;rpc&quot;</span>
<span class="term-fg32">+)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func cmdDeployBlockSenderContract() {</span>
<span class="term-fg32">+	flagset := flag.NewFlagSet(&quot;deployBlockSenderContract&quot;, flag.ExitOnError)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	var (</span>
<span class="term-fg32">+		suaveRpc      = flagset.String(&quot;suave_rpc&quot;, &quot;http:&#47;&#47;127.0.0.1:8545&quot;, &quot;address of suave rpc&quot;)</span>
<span class="term-fg32">+		privKeyHex    = flagset.String(&quot;privkey&quot;, &quot;&quot;, &quot;private key as hex (for testing)&quot;)</span>
<span class="term-fg32">+		boostRelayUrl = flagset.String(&quot;relay_url&quot;, &quot;http:&#47;&#47;127.0.0.1:8091&quot;, &quot;address of boost relay that the contract will send blocks to&quot;)</span>
<span class="term-fg32">+		verbosity     = flagset.Int(&quot;verbosity&quot;, int(log.LvlInfo), &quot;log verbosity (0-5)&quot;)</span>
<span class="term-fg32">+		privKey       *ecdsa.PrivateKey</span>
<span class="term-fg32">+	)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	flagset.Parse(os.Args[2:])</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	glogger := log.NewGlogHandler(log.StreamHandler(os.Stderr, log.TerminalFormat(false)))</span>
<span class="term-fg32">+	log.Root().SetHandler(glogger)</span>
<span class="term-fg32">+	glogger.Verbosity(log.Lvl(*verbosity))</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	privKey, err := crypto.HexToECDSA(*privKeyHex)</span>
<span class="term-fg32">+	RequireNoErrorf(err, &quot;-nodekeyhex: %v&quot;, err)</span>
<span class="term-fg32">+	&#47;* shush linter *&#47; privKey.Public()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	suaveClient, err := rpc.DialContext(context.TODO(), *suaveRpc)</span>
<span class="term-fg32">+	RequireNoErrorf(err, &quot;could not connect to suave rpc: %v&quot;, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	genesis := core.DefaultSuaveGenesisBlock()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	suaveSigner := types.NewOffchainSigner(genesis.Config.ChainID)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	ethBlockBidSenderAddr, txHash, _ := sendBlockSenderCreationTx(suaveClient, suaveSigner, privKey, boostRelayUrl)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; TODO: wait until tx is included and check receipt</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	for i := 0; i &lt; 10; i++ {</span>
<span class="term-fg32">+		time.Sleep(time.Duration(1+i&#47;2) * time.Second)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		var receipt = make(map[string]interface{})</span>
<span class="term-fg32">+		err = suaveClient.Call(&amp;receipt, &quot;eth_getTransactionReceipt&quot;, txHash)</span>
<span class="term-fg32">+		if err == nil &amp;&amp; receipt != nil {</span>
<span class="term-fg32">+			log.Info(&quot;All is good!&quot;, &quot;receipt&quot;, receipt, &quot;address&quot;, ethBlockBidSenderAddr)</span>
<span class="term-fg32">+			return</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	utils.Fatalf(&quot;did not see the receipt succeed in time. hash: %s&quot;, txHash.String())</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func sendBlockSenderCreationTx(suaveClient *rpc.Client, suaveSigner types.Signer, privKey *ecdsa.PrivateKey, boostRelayUrl *string) (*common.Address, *common.Hash, error) {</span>
<span class="term-fg32">+	var suaveAccNonceBytes hexutil.Uint64</span>
<span class="term-fg32">+	err := suaveClient.Call(&amp;suaveAccNonceBytes, &quot;eth_getTransactionCount&quot;, crypto.PubkeyToAddress(privKey.PublicKey), &quot;latest&quot;)</span>
<span class="term-fg32">+	RequireNoErrorf(err, &quot;could not call eth_getTransactionCount on suave: %v&quot;, err)</span>
<span class="term-fg32">+	suaveAccNonce := uint64(suaveAccNonceBytes)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	var suaveGp hexutil.Big</span>
<span class="term-fg32">+	err = suaveClient.Call(&amp;suaveGp, &quot;eth_gasPrice&quot;)</span>
<span class="term-fg32">+	RequireNoErrorf(err, &quot;could not call eth_gasPrice on suave: %v&quot;, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	abiEncodedRelayUrl, err := ethBlockBidSenderAbi.Pack(&quot;&quot;, boostRelayUrl)</span>
<span class="term-fg32">+	RequireNoErrorf(err, &quot;could not pack inputs to the constructor: %v&quot;, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	calldata := append(hexutil.MustDecode(blockSenderContractBytecode), abiEncodedRelayUrl...)</span>
<span class="term-fg32">+	ccTxData := &amp;types.LegacyTx{</span>
<span class="term-fg32">+		Nonce:    suaveAccNonce,</span>
<span class="term-fg32">+		To:       nil, &#47;&#47; contract creation</span>
<span class="term-fg32">+		Value:    big.NewInt(0),</span>
<span class="term-fg32">+		Gas:      10000000,</span>
<span class="term-fg32">+		GasPrice: (*big.Int)(&amp;suaveGp),</span>
<span class="term-fg32">+		Data:     calldata,</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	tx, err := types.SignTx(types.NewTx(ccTxData), suaveSigner, privKey)</span>
<span class="term-fg32">+	RequireNoErrorf(err, &quot;could not sign the deployment transaction: %v&quot;, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	from, _ := types.Sender(suaveSigner, tx)</span>
<span class="term-fg32">+	ethBlockBidSenderAddr := crypto.CreateAddress(from, tx.Nonce())</span>
<span class="term-fg32">+	log.Info(&quot;contract address will be&quot;, &quot;addr&quot;, ethBlockBidSenderAddr)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	txBytes, err := tx.MarshalBinary()</span>
<span class="term-fg32">+	RequireNoErrorf(err, &quot;could not marshal the deployment transaction: %v&quot;, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	var txHash common.Hash</span>
<span class="term-fg32">+	err = suaveClient.Call(&amp;txHash, &quot;eth_sendRawTransaction&quot;, hexutil.Encode(txBytes))</span>
<span class="term-fg32">+	RequireNoErrorf(err, &quot;could not send the deployment transaction to suave node: %v&quot;, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	return &amp;ethBlockBidSenderAddr, &amp;txHash, nil</span>
<span class="term-fg32">+}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-9d5f68b973b7cb76fd839b66" role="button"
                   aria-expanded="false" aria-controls="id-9d5f68b973b7cb76fd839b66">
                    <code>suave/cmd/suavecli/boost_utils.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/suave/cmd/suavecli/boost_utils.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+133</span></div>
                        <div class="text-start"><span class="text-danger">-0</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-9d5f68b973b7cb76fd839b66"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;suave&#47;cmd&#47;suavecli&#47;boost_utils.go flashbots&#47;suave-geth&#47;suave&#47;cmd&#47;suavecli&#47;boost_utils.go</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..9ceb0978f88bd4163222cecd1a49ce623d8f6567</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;suave&#47;cmd&#47;suavecli&#47;boost_utils.go</span>
<span class="term-fg36">@@ -0,0 +1,133 @@</span>
<span class="term-fg32">+package main</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+import (</span>
<span class="term-fg32">+	&quot;context&quot;</span>
<span class="term-fg32">+	&quot;encoding&#47;json&quot;</span>
<span class="term-fg32">+	&quot;errors&quot;</span>
<span class="term-fg32">+	&quot;fmt&quot;</span>
<span class="term-fg32">+	&quot;io&quot;</span>
<span class="term-fg32">+	&quot;net&#47;http&quot;</span>
<span class="term-fg32">+	&quot;strings&quot;</span>
<span class="term-fg32">+	&quot;time&quot;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&quot;github.com&#47;attestantio&#47;go-eth2-client&#47;spec&#47;capella&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;log&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;r3labs&#47;sse&quot;</span>
<span class="term-fg32">+)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func SubscribeToPayloadAttributesEvents(ctx context.Context, endpoint string, payloadAttrC chan PayloadAttributesEvent) {</span>
<span class="term-fg32">+	eventsURL := fmt.Sprintf(&quot;%s&#47;eth&#47;v1&#47;events?topics=payload_attributes&quot;, endpoint)</span>
<span class="term-fg32">+	log.Info(&quot;subscribing to payload_attributes events&quot;)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	for {</span>
<span class="term-fg32">+		client := sse.NewClient(eventsURL)</span>
<span class="term-fg32">+		err := client.SubscribeRawWithContext(ctx, func(msg *sse.Event) {</span>
<span class="term-fg32">+			var payloadAttributesResp PayloadAttributesEvent</span>
<span class="term-fg32">+			err := json.Unmarshal(msg.Data, &amp;payloadAttributesResp)</span>
<span class="term-fg32">+			if err != nil {</span>
<span class="term-fg32">+				log.Error(&quot;could not unmarshal payload_attributes event&quot;, &quot;err&quot;, err)</span>
<span class="term-fg32">+				return</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+			payloadAttrC &lt;- payloadAttributesResp</span>
<span class="term-fg32">+		})</span>
<span class="term-fg32">+		if err != nil {</span>
<span class="term-fg32">+			log.Error(&quot;failed to subscribe to payload_attributes events&quot;, &quot;err&quot;, err)</span>
<span class="term-fg32">+			time.Sleep(1 * time.Second)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		log.Warn(&quot;beaconclient SubscribeRaw ended, reconnecting&quot;)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func getValidatorForSlot(relayUrl string, nextSlot uint64) (ValidatorData, error) {</span>
<span class="term-fg32">+	endpoint := relayUrl + &quot;&#47;relay&#47;v1&#47;builder&#47;validators&quot;</span>
<span class="term-fg32">+	req, err := http.NewRequestWithContext(context.TODO(), http.MethodGet, endpoint, nil)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return ValidatorData{}, fmt.Errorf(&quot;could not prepare request: %w&quot;, err)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; Execute request</span>
<span class="term-fg32">+	resp, err := http.DefaultClient.Do(req)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return ValidatorData{}, err</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	defer resp.Body.Close()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	if resp.StatusCode == http.StatusNoContent {</span>
<span class="term-fg32">+		return ValidatorData{}, errors.New(&quot;nothing returned from the boost relay&quot;)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	if resp.StatusCode &gt; 299 {</span>
<span class="term-fg32">+		bodyBytes, err := io.ReadAll(resp.Body)</span>
<span class="term-fg32">+		if err != nil {</span>
<span class="term-fg32">+			return ValidatorData{}, fmt.Errorf(&quot;could not read error response body for status code %d: %w&quot;, resp.StatusCode, err)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		return ValidatorData{}, fmt.Errorf(&quot;http error: %d &#47; %s&quot;, resp.StatusCode, string(bodyBytes))</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	var dst GetValidatorRelayResponse</span>
<span class="term-fg32">+	bodyBytes, err := io.ReadAll(resp.Body)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return ValidatorData{}, fmt.Errorf(&quot;could not read response body: %w&quot;, err)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	if err := json.Unmarshal(bodyBytes, &amp;dst); err != nil {</span>
<span class="term-fg32">+		return ValidatorData{}, fmt.Errorf(&quot;could not unmarshal response %s: %w&quot;, string(bodyBytes), err)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	res := make(map[uint64]ValidatorData)</span>
<span class="term-fg32">+	for _, data := range dst {</span>
<span class="term-fg32">+		feeRecipient := common.HexToAddress(data.Entry.Message.FeeRecipient)</span>
<span class="term-fg32">+		pubkeyHex := strings.ToLower(data.Entry.Message.Pubkey)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		res[data.Slot] = ValidatorData{</span>
<span class="term-fg32">+			Pubkey:       pubkeyHex,</span>
<span class="term-fg32">+			FeeRecipient: feeRecipient,</span>
<span class="term-fg32">+			GasLimit:     data.Entry.Message.GasLimit,</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	v, found := res[nextSlot]</span>
<span class="term-fg32">+	if !found {</span>
<span class="term-fg32">+		return ValidatorData{}, errors.New(&quot;validator not found&quot;)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	return v, nil</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+type PayloadAttributesEvent struct {</span>
<span class="term-fg32">+	Version string                     `json:&quot;version&quot;`</span>
<span class="term-fg32">+	Data    PayloadAttributesEventData `json:&quot;data&quot;`</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+type PayloadAttributesEventData struct {</span>
<span class="term-fg32">+	ProposalSlot      uint64            `json:&quot;proposal_slot,string&quot;`</span>
<span class="term-fg32">+	ParentBlockHash   common.Hash       `json:&quot;parent_block_hash&quot;`</span>
<span class="term-fg32">+	PayloadAttributes PayloadAttributes `json:&quot;payload_attributes&quot;`</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+type PayloadAttributes struct {</span>
<span class="term-fg32">+	Timestamp             uint64                `json:&quot;timestamp,string&quot;`</span>
<span class="term-fg32">+	PrevRandao            common.Hash           `json:&quot;prev_randao&quot;`</span>
<span class="term-fg32">+	SuggestedFeeRecipient common.Address        `json:&quot;suggested_fee_recipient&quot;`</span>
<span class="term-fg32">+	Withdrawals           []*capella.Withdrawal `json:&quot;withdrawals&quot;`</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+type ValidatorData struct {</span>
<span class="term-fg32">+	Pubkey       string</span>
<span class="term-fg32">+	FeeRecipient common.Address</span>
<span class="term-fg32">+	GasLimit     uint64</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+type GetValidatorRelayResponse []struct {</span>
<span class="term-fg32">+	Slot  uint64 `json:&quot;slot,string&quot;`</span>
<span class="term-fg32">+	Entry struct {</span>
<span class="term-fg32">+		Message struct {</span>
<span class="term-fg32">+			FeeRecipient string `json:&quot;fee_recipient&quot;`</span>
<span class="term-fg32">+			GasLimit     uint64 `json:&quot;gas_limit,string&quot;`</span>
<span class="term-fg32">+			Timestamp    uint64 `json:&quot;timestamp,string&quot;`</span>
<span class="term-fg32">+			Pubkey       string `json:&quot;pubkey&quot;`</span>
<span class="term-fg32">+		} `json:&quot;message&quot;`</span>
<span class="term-fg32">+		Signature string `json:&quot;signature&quot;`</span>
<span class="term-fg32">+	} `json:&quot;entry&quot;`</span>
<span class="term-fg32">+}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-a4ddbd67a37bf881263901b7" role="button"
                   aria-expanded="false" aria-controls="id-a4ddbd67a37bf881263901b7">
                    <code>suave/cmd/suavecli/startHintListener.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/suave/cmd/suavecli/startHintListener.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+155</span></div>
                        <div class="text-start"><span class="text-danger">-0</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-a4ddbd67a37bf881263901b7"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;suave&#47;cmd&#47;suavecli&#47;startHintListener.go flashbots&#47;suave-geth&#47;suave&#47;cmd&#47;suavecli&#47;startHintListener.go</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..e5f4416dd2a2ca59002396515729ed5f779be808</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;suave&#47;cmd&#47;suavecli&#47;startHintListener.go</span>
<span class="term-fg36">@@ -0,0 +1,155 @@</span>
<span class="term-fg32">+package main</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+import (</span>
<span class="term-fg32">+	&quot;context&quot;</span>
<span class="term-fg32">+	&quot;flag&quot;</span>
<span class="term-fg32">+	&quot;os&quot;</span>
<span class="term-fg32">+	&quot;time&quot;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;core&#47;types&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;ethclient&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;log&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;rpc&quot;</span>
<span class="term-fg32">+)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+const cube = `</span>
<span class="term-fg32">+          +------------+,</span>
<span class="term-fg32">+         &#47;            &#47;|,</span>
<span class="term-fg32">+        &#47;            &#47; |,</span>
<span class="term-fg32">+       +------------+  |,</span>
<span class="term-fg32">+       |            |  |,</span>
<span class="term-fg32">+       |   Suave    |  +,</span>
<span class="term-fg32">+       |   Block    | &#47;,</span>
<span class="term-fg32">+       |            |&#47;,</span>
<span class="term-fg32">+       +------------+</span>
<span class="term-fg32">+	   `</span>
<span class="term-fg32">+const hint = `</span>
<span class="term-fg32">+            ______              </span>
<span class="term-fg32">+         .-&#39;      &#39;-.           </span>
<span class="term-fg32">+       .&#39;            &#39;.         </span>
<span class="term-fg32">+      &#47;                \        </span>
<span class="term-fg32">+     |      Hint       |;       </span>
<span class="term-fg32">+     &#39;\               &#47; ;       </span>
<span class="term-fg32">+      \&#39;.           .&#39; &#47;        </span>
<span class="term-fg32">+       &#39;.&#39;-._____.-&#39; .&#39;         </span>
<span class="term-fg32">+         &#47; &#47;&#39;_____.-&#39;           </span>
<span class="term-fg32">+        &#47; &#47; &#47;                   </span>
<span class="term-fg32">+       &#47; &#47; &#47;</span>
<span class="term-fg32">+      &#47; &#47; &#47;</span>
<span class="term-fg32">+     &#47; &#47; &#47;</span>
<span class="term-fg32">+     \&#47;_&#47;</span>
<span class="term-fg32">+`</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func cmdHintListener() {</span>
<span class="term-fg32">+	flagset := flag.NewFlagSet(&quot;sendBundle&quot;, flag.ExitOnError)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	var (</span>
<span class="term-fg32">+		suaveWs   = flagset.String(&quot;suave_ws&quot;, &quot;ws:&#47;&#47;127.0.0.1:8546&quot;, &quot;address of suave ws&quot;)</span>
<span class="term-fg32">+		verbosity = flagset.Int(&quot;verbosity&quot;, int(log.LvlInfo), &quot;log verbosity (0-5)&quot;)</span>
<span class="term-fg32">+	)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	flagset.Parse(os.Args[2:])</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	glogger := log.NewGlogHandler(log.StreamHandler(os.Stderr, log.TerminalFormat(false)))</span>
<span class="term-fg32">+	log.Root().SetHandler(glogger)</span>
<span class="term-fg32">+	glogger.Verbosity(log.Lvl(*verbosity))</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	go subscribeToWs(*suaveWs)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	select {}</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func subscribeToWs(suaveWs string) {</span>
<span class="term-fg32">+	log.Info(&quot;started hint listener&quot;)</span>
<span class="term-fg32">+	for {</span>
<span class="term-fg32">+		client, err := rpc.Dial(suaveWs)</span>
<span class="term-fg32">+		if err != nil {</span>
<span class="term-fg32">+			log.Error(&quot;Failed to connect to the Ethereum client&quot;, &quot;err&quot;, err)</span>
<span class="term-fg32">+			time.Sleep(2 * time.Second)</span>
<span class="term-fg32">+			continue</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		ethClient := ethclient.NewClient(client)</span>
<span class="term-fg32">+		if ethClient == nil {</span>
<span class="term-fg32">+			log.Error(&quot;Failed to create new ethclient instance&quot;)</span>
<span class="term-fg32">+			time.Sleep(2 * time.Second)</span>
<span class="term-fg32">+			continue</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		httpClient, err := rpc.Dial(&quot;http:&#47;&#47;127.0.0.1:8545&quot;)</span>
<span class="term-fg32">+		if err != nil {</span>
<span class="term-fg32">+			log.Error(&quot;Failed to connect to the Ethereum client&quot;, &quot;err&quot;, err)</span>
<span class="term-fg32">+			time.Sleep(2 * time.Second)</span>
<span class="term-fg32">+			continue</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		httpEthClient := ethclient.NewClient(httpClient)</span>
<span class="term-fg32">+		if ethClient == nil {</span>
<span class="term-fg32">+			log.Error(&quot;Failed to create new ethclient instance&quot;)</span>
<span class="term-fg32">+			time.Sleep(2 * time.Second)</span>
<span class="term-fg32">+			continue</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		headers := make(chan *types.Header)</span>
<span class="term-fg32">+		sub, err := ethClient.SubscribeNewHead(context.Background(), headers)</span>
<span class="term-fg32">+		if err != nil {</span>
<span class="term-fg32">+			log.Error(&quot;Failed to subscribe to new heads&quot;, &quot;err&quot;, err)</span>
<span class="term-fg32">+			time.Sleep(2 * time.Second)</span>
<span class="term-fg32">+			subscribeToWs(suaveWs)</span>
<span class="term-fg32">+			continue</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		log.Info(&quot;Subscribed to NewHead events&quot;)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		for {</span>
<span class="term-fg32">+			select {</span>
<span class="term-fg32">+			case err := &lt;-sub.Err():</span>
<span class="term-fg32">+				log.Error(&quot;Subscription error&quot;, &quot;err&quot;, err)</span>
<span class="term-fg32">+				log.Info(&quot;Attempting to resubscribe in 2 seconds&quot;)</span>
<span class="term-fg32">+				time.Sleep(2 * time.Second)</span>
<span class="term-fg32">+				continue</span>
<span class="term-fg32">+			case header := &lt;-headers:</span>
<span class="term-fg32">+				headerHashString := header.Hash().String()</span>
<span class="term-fg32">+				log.Info(headerHashString)</span>
<span class="term-fg32">+				log.Info(cube)</span>
<span class="term-fg32">+				block, err := httpEthClient.BlockByHash(context.Background(), header.Hash())</span>
<span class="term-fg32">+				if err != nil {</span>
<span class="term-fg32">+					log.Error(&quot;Failed to get block&quot;, &quot;err&quot;, err)</span>
<span class="term-fg32">+					continue</span>
<span class="term-fg32">+				}</span>
<span class="term-fg32">+				log.Info(cube)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+				for _, tx := range block.Transactions() {</span>
<span class="term-fg32">+					r, err := ethClient.TransactionReceipt(context.Background(), tx.Hash())</span>
<span class="term-fg32">+					if err != nil {</span>
<span class="term-fg32">+						log.Error(&quot;Failed to get transaction receipt&quot;, &quot;err&quot;, err)</span>
<span class="term-fg32">+						continue</span>
<span class="term-fg32">+					}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+					&#47;&#47; Check for contract creation</span>
<span class="term-fg32">+					if tx.To() == nil {</span>
<span class="term-fg32">+						log.Info(&quot;Contract created&quot;, &quot;Contract Address&quot;, r.ContractAddress)</span>
<span class="term-fg32">+					}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+					&#47;&#47; we know mevshare will emit 2 events and dont want to break on other txns</span>
<span class="term-fg32">+					&#47;&#47; as well may not know mevshare addr at demo time</span>
<span class="term-fg32">+					if len(r.Logs) == 2 {</span>
<span class="term-fg32">+						log.Info(hint)</span>
<span class="term-fg32">+						log.Info(&quot;Detected event in tx&quot;, &quot;tx_hash&quot;, tx.Hash().Hex(), &quot;to_addr&quot;, tx.To())</span>
<span class="term-fg32">+						&#47;&#47; extract first hint</span>
<span class="term-fg32">+						hint1, err := mevShareABI.Events[&quot;HintEvent&quot;].Inputs.Unpack(r.Logs[0].Data)</span>
<span class="term-fg32">+						if err != nil {</span>
<span class="term-fg32">+							log.Error(&quot;Failed to unpack log&quot;, &quot;err&quot;, err)</span>
<span class="term-fg32">+						}</span>
<span class="term-fg32">+						&#47;&#47; extract second hint</span>
<span class="term-fg32">+						hint2, err := mevShareABI.Events[&quot;BidEvent&quot;].Inputs.Unpack(r.Logs[1].Data)</span>
<span class="term-fg32">+						if err != nil {</span>
<span class="term-fg32">+							log.Error(&quot;Failed to unpack log&quot;, &quot;err&quot;, err)</span>
<span class="term-fg32">+						}</span>
<span class="term-fg32">+						bidId := hint2[0].([16]byte)</span>
<span class="term-fg32">+						log.Info(&quot;Hint event&quot;, &quot;hint1&quot;, hint1, &quot;hint2&quot;, hint2, &quot;bidId&quot;, bidId)</span>
<span class="term-fg32">+					}</span>
<span class="term-fg32">+				}</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-a83281ebd4784e6189468585" role="button"
                   aria-expanded="false" aria-controls="id-a83281ebd4784e6189468585">
                    <code>suave/cmd/suavecli/deployBlockSenderBytecode.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/suave/cmd/suavecli/deployBlockSenderBytecode.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+3</span></div>
                        <div class="text-start"><span class="text-danger">-0</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-a83281ebd4784e6189468585"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;suave&#47;cmd&#47;suavecli&#47;deployBlockSenderBytecode.go flashbots&#47;suave-geth&#47;suave&#47;cmd&#47;suavecli&#47;deployBlockSenderBytecode.go</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..537c12e171b07a38da7e8c8bf75a39fe838c511a</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;suave&#47;cmd&#47;suavecli&#47;deployBlockSenderBytecode.go</span>
<span class="term-fg36">@@ -0,0 +1,3 @@</span>
<span class="term-fg32">+package main</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+var blockSenderContractBytecode string = &quot;0x60806040523480156200001157600080fd5b50604051620027a3380380620027a3833981016040819052620000349162000060565b6000620000428282620001c4565b505062000290565b634e487b7160e01b600052604160045260246000fd5b600060208083850312156200007457600080fd5b82516001600160401b03808211156200008c57600080fd5b818501915085601f830112620000a157600080fd5b815181811115620000b657620000b66200004a565b604051601f8201601f19908116603f01168101908382118183101715620000e157620000e16200004a565b816040528281528886848701011115620000fa57600080fd5b600093505b828410156200011e5784840186015181850187015292850192620000ff565b600086848301015280965050505050505092915050565b600181811c908216806200014a57607f821691505b6020821081036200016b57634e487b7160e01b600052602260045260246000fd5b50919050565b601f821115620001bf57600081815260208120601f850160051c810160208610156200019a5750805b601f850160051c820191505b81811015620001bb57828155600101620001a6565b5050505b505050565b81516001600160401b03811115620001e057620001e06200004a565b620001f881620001f1845462000135565b8462000171565b602080601f831160018114620002305760008415620002175750858301515b600019600386901b1c1916600185901b178555620001bb565b600085815260208120601f198616915b82811015620002615788860151825594840194600190910190840162000240565b5085821015620002805787850151600019600388901b60f8161c191681555b5050505050600190811b01905550565b61250380620002a06000396000f3fe608060405234801561001057600080fd5b506004361061007d5760003560e01c80637df1cde21161005b5780637df1cde2146100d3578063c2eceb11146100e6578063e884734414610107578063ebb89de41461011a57600080fd5b80633c34db65146100825780634c8820f81461009757806354dfbd39146100c0575b600080fd5b610095610090366004611588565b61012d565b005b6100aa6100a5366004611903565b610193565b6040516100b79190611a4a565b60405180910390f35b6100aa6100ce366004611a5d565b61037f565b6100aa6100e1366004611aae565b61095a565b6100f96100f4366004611903565b6109b2565b6040516100b7929190611b7d565b6100f9610115366004611bab565b610b5d565b6100aa610128366004611a5d565b610c0c565b7f83481d5b04dea534715acad673a8177a46fc93882760f36bdc16ccac439d504e61015b6020830183611cb5565b61016b6040840160208501611cd2565b6101786040850185611cef565b6040516101889493929190611d38565b60405180910390a150565b606061019d610fd0565b6101a657600080fd5b60405163c2eceb1160e01b81526000908190309063c2eceb11906101d4908a908a908a908a90600401611ee0565b600060405180830381865afa1580156101f1573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f191682016040526102199190810190612037565b915091506000806102b46000805461023090612090565b80601f016020809104026020016040519081016040528092919081815260200182805461025c90612090565b80156102a95780601f1061027e576101008083540402835291602001916102a9565b820191906000526020600020905b81548152906001019060200180831161028c57829003601f168201915b505050505084611050565b91509150816102e35730816040516375fff46760e01b81526004016102da9291906120ca565b60405180910390fd5b7f83481d5b04dea534715acad673a8177a46fc93882760f36bdc16ccac439d504e846000015185602001518660400151604051610322939291906120ee565b60405180910390a1604051633c34db6560e01b90610344908690602001612120565b60408051601f19818403018152908290526103629291602001612133565b604051602081830303815290604052945050505050949350505050565b6060610389610fd0565b61039257600080fd5b60006103cb83604051806040016040528060158152602001746d657673686172653a76303a6d617463684269647360581b8152506110f1565b9050600061040e846040518060400160405280601c81526020017f6d657673686172653a76303a756e6d61746368656442756e646c6573000000008152506110f1565b9050805160000361043457306040516375fff46760e01b81526004016102da9190612164565b600081516001600160401b0381111561044f5761044f6115c9565b60405190808252806020026020018201604052801561049c57816020015b6040805160608082018352600080835260208301529181019190915281526020019060019003908161046d5790505b50905060005b82518110156105ef5760008382815181106104bf576104bf612197565b6020026020010151905060005b85518110156105bc57600061052c8783815181106104ec576104ec612197565b602002602001015160000151604051806040016040528060168152602001756d657673686172653a76303a6d65726765644269647360501b8152506111bc565b80602001905181019061053f91906121ad565b90506105828160008151811061055757610557612197565b602002602001015187868151811061057157610571612197565b602002602001015160000151611267565b156105a95786828151811061059957610599612197565b60200260200101519250506105bc565b50806105b481612251565b9150506104cc565b50808383815181106105d0576105d0612197565b60200260200101819052505080806105e790612251565b9150506104a2565b50600081516001600160401b0381111561060b5761060b6115c9565b60405190808252806020026020018201604052801561065057816020015b60408051808201909152600080825260208201528152602001906001900390816106295790505b50905060005b825181101561074e5760006106bd84838151811061067657610676612197565b6020026020010151600001516040518060400160405280601f81526020017f6d657673686172653a76303a65746842756e646c6553696d526573756c7473008152506111bc565b90506000818060200190518101906106d5919061226a565b90506040518060400160405280826001600160401b0316815260200186858151811061070357610703612197565b6020026020010151600001516001600160801b03191681525084848151811061072e5761072e612197565b60200260200101819052505050808061074690612251565b915050610656565b50805160005b61075f600183612287565b81101561086c57600061077382600161229a565b90505b828110156108595783818151811061079057610790612197565b6020026020010151600001516001600160401b03168483815181106107b7576107b7612197565b6020026020010151600001516001600160401b031610156108475760008483815181106107e6576107e6612197565b6020026020010151905084828151811061080257610802612197565b602002602001015185848151811061081c5761081c612197565b60200260200101819052508085838151811061083a5761083a612197565b6020026020010181905250505b8061085181612251565b915050610776565b508061086481612251565b915050610754565b50600083516001600160401b03811115610888576108886115c9565b6040519080825280602002602001820160405280156108b1578160200160208202803683370190505b50905060005b835181101561091b578381815181106108d2576108d2612197565b6020026020010151602001518282815181106108f0576108f0612197565b6001600160801b0319909216602092830291909101909101528061091381612251565b9150506108b7565b5061094b8989836040518060400160405280600b81526020016a06d657673686172653a76360ac1b815250610193565b96505050505050505b92915050565b6060610964610fd0565b61096d57600080fd5b60006109aa8460405180604001604052806019815260200178191959985d5b1d0e9d8c0e989d5a5b19195c94185e5b1bd859603a1b8152506111bc565b949350505050565b604080516060808201835260008083526020830152918101919091526040805160028082526060828101909352600091908160200160208202803683370190505090503081600081518110610a0957610a09612197565b60200260200101906001600160a01b031690816001600160a01b031681525050634210000181600181518110610a4157610a41612197565b60200260200101906001600160a01b031690816001600160a01b0316815250506000610a9b87836040518060400160405280601581526020017464656661756c743a76303a6d65726765644269647360581b81525061132b565b9050610af881600001516040518060400160405280601581526020017464656661756c743a76303a6d65726765644269647360581b81525088604051602001610ae491906122ad565b604051602081830303815290604052611406565b600080610b0a8a8460000151896114b8565b91509150610b4e836000015160405180604001604052806019815260200178191959985d5b1d0e9d8c0e989d5a5b19195c94185e5b1bd859603a1b81525083611406565b50909890975095505050505050565b6040805160608082018352600080835260208301529181019190915260607f67fa9c16cd72410c4cc1d47205b31852a81ec5e92d1c8cebc3ecbe98ed67fe3f846000015184604051610bb09291906122c0565b60405180910390a17f83481d5b04dea534715acad673a8177a46fc93882760f36bdc16ccac439d504e846000015185602001518660400151604051610bf7939291906120ee565b60405180910390a150829050815b9250929050565b6060610c16610fd0565b610c1f57600080fd5b6000610c58836040518060400160405280601581526020017464656661756c743a76303a65746842756e646c657360581b8152506110f1565b90508051600003610c7e57306040516375fff46760e01b81526004016102da9190612164565b600081516001600160401b03811115610c9957610c996115c9565b604051908082528060200260200182016040528015610cde57816020015b6040805180820190915260008082526020820152815260200190600190039081610cb75790505b50905060005b8251811015610ddc576000610d4b848381518110610d0457610d04612197565b6020026020010151600001516040518060400160405280601e81526020017f64656661756c743a76303a65746842756e646c6553696d526573756c747300008152506111bc565b9050600081806020019051810190610d63919061226a565b90506040518060400160405280826001600160401b03168152602001868581518110610d9157610d91612197565b6020026020010151600001516001600160801b031916815250848481518110610dbc57610dbc612197565b602002602001018190525050508080610dd490612251565b915050610ce4565b50805160005b610ded600183612287565b811015610efa576000610e0182600161229a565b90505b82811015610ee757838181518110610e1e57610e1e612197565b6020026020010151600001516001600160401b0316848381518110610e4557610e45612197565b6020026020010151600001516001600160401b03161015610ed5576000848381518110610e7457610e74612197565b60200260200101519050848281518110610e9057610e90612197565b6020026020010151858481518110610eaa57610eaa612197565b602002602001018190525080858381518110610ec857610ec8612197565b6020026020010181905250505b80610edf81612251565b915050610e04565b5080610ef281612251565b915050610de2565b50600083516001600160401b03811115610f1657610f166115c9565b604051908082528060200260200182016040528015610f3f578160200160208202803683370190505b50905060005b8351811015610fa957838181518110610f6057610f60612197565b602002602001015160200151828281518110610f7e57610f7e612197565b6001600160801b03199092166020928302919091019091015280610fa181612251565b915050610f45565b50610fc587878360405180602001604052806000815250610193565b979650505050505050565b6040516000908190819063420100009082818181855afa9150503d8060008114611016576040519150601f19603f3d011682016040523d82523d6000602084013e61101b565b606091505b509150915081611046576342010000816040516375fff46760e01b81526004016102da9291906120ca565b6020015192915050565b6000606061105c610fd0565b61106557600080fd5b60008063421000026001600160a01b031686866040516020016110899291906122e3565b60408051601f19818403018152908290526110a3916122f6565b600060405180830381855afa9150503d80600081146110de576040519150601f19603f3d011682016040523d82523d6000602084013e6110e3565b606091505b509097909650945050505050565b606060008063420300016001600160a01b03168585604051602001611117929190612312565b60408051601f1981840301815290829052611131916122f6565b600060405180830381855afa9150503d806000811461116c576040519150601f19603f3d011682016040523d82523d6000602084013e611171565b606091505b50915091508161119c576342030001816040516375fff46760e01b81526004016102da9291906120ca565b6000818060200190518101906111b29190612334565b9695505050505050565b606060008063420200016001600160a01b031685856040516020016111e29291906122c0565b60408051601f19818403018152908290526111fc916122f6565b600060405180830381855afa9150503d8060008114611237576040519150601f19603f3d011682016040523d82523d6000602084013e61123c565b606091505b5091509150816109aa576342020001816040516375fff46760e01b81526004016102da9291906120ca565b604080516001600160801b03198481166020830152825160108184030181526030830184529084166050830152825180830384018152606090920190925260009190825b825181101561131f578181815181106112c6576112c6612197565b602001015160f81c60f81b6001600160f81b0319168382815181106112ed576112ed612197565b01602001516001600160f81b0319161461130d5760009350505050610954565b8061131781612251565b9150506112ab565b50600195945050505050565b6040805160608082018352600080835260208301529181019190915260008063420300006001600160a01b031686868660405160200161136d939291906123d7565b60408051601f1981840301815290829052611387916122f6565b600060405180830381855afa9150503d80600081146113c2576040519150601f19603f3d011682016040523d82523d6000602084013e6113c7565b606091505b5091509150816113f2576342030000816040516375fff46760e01b81526004016102da9291906120ca565b808060200190518101906111b2919061240b565b60008063420200006001600160a01b031685858560405160200161142c9392919061243f565b60408051601f1981840301815290829052611446916122f6565b600060405180830381855afa9150503d8060008114611481576040519150601f19603f3d011682016040523d82523d6000602084013e611486565b606091505b5091509150816114b1576342020000816040516375fff46760e01b81526004016102da9291906120ca565b5050505050565b60608060008063421000016001600160a01b03168787876040516020016114e193929190612462565b60408051601f19818403018152908290526114fb916122f6565b600060405180830381855afa9150503d8060008114611536576040519150601f19603f3d011682016040523d82523d6000602084013e61153b565b606091505b509150915081611566576342100001816040516375fff46760e01b81526004016102da9291906120ca565b8080602001905181019061157a9190612497565b935093505050935093915050565b60006020828403121561159a57600080fd5b81356001600160401b038111156115b057600080fd5b8201606081850312156115c257600080fd5b9392505050565b634e487b7160e01b600052604160045260246000fd5b604051608081016001600160401b0381118282101715611601576116016115c9565b60405290565b60405161010081016001600160401b0381118282101715611601576116016115c9565b604051606081016001600160401b0381118282101715611601576116016115c9565b604051601f8201601f191681016001600160401b0381118282101715611674576116746115c9565b604052919050565b6001600160401b038116811461169157600080fd5b50565b803561169f8161167c565b919050565b60006001600160401b038211156116bd576116bd6115c9565b50601f01601f191660200190565b600082601f8301126116dc57600080fd5b81356116ef6116ea826116a4565b61164c565b81815284602083860101111561170457600080fd5b816020850160208301376000918101602001919091529392505050565b6001600160a01b038116811461169157600080fd5b803561169f81611721565b60006001600160401b0382111561175a5761175a6115c9565b5060051b60200190565b600082601f83011261177557600080fd5b813560206117856116ea83611741565b82815260079290921b840181019181810190868411156117a457600080fd5b8286015b8481101561181b57608081890312156117c15760008081fd5b6117c96115df565b81356117d48161167c565b8152818501356117e38161167c565b818601526040828101356117f681611721565b908201526060828101356118098161167c565b908201528352918301916080016117a8565b509695505050505050565b6000610100828403121561183957600080fd5b611841611607565b905061184c82611694565b815260208201356001600160401b038082111561186857600080fd5b611874858386016116cb565b60208401526040840135604084015261188f60608501611694565b60608401526118a060808501611736565b60808401526118b160a08501611694565b60a084015260c084013560c084015260e08401359150808211156118d457600080fd5b506118e184828501611764565b60e08301525092915050565b6001600160801b03198116811461169157600080fd5b6000806000806080858703121561191957600080fd5b84356001600160401b038082111561193057600080fd5b61193c88838901611826565b9550602091508187013561194f8161167c565b945060408701358181111561196357600080fd5b8701601f8101891361197457600080fd5b80356119826116ea82611741565b81815260059190911b8201840190848101908b8311156119a157600080fd5b928501925b828410156119c85783356119b9816118ed565b825292850192908501906119a6565b965050505060608701359150808211156119e157600080fd5b506119ee878288016116cb565b91505092959194509250565b60005b83811015611a155781810151838201526020016119fd565b50506000910152565b60008151808452611a368160208601602086016119fa565b601f01601f19169290920160200192915050565b6020815260006115c26020830184611a1e565b60008060408385031215611a7057600080fd5b82356001600160401b03811115611a8657600080fd5b611a9285828601611826565b9250506020830135611aa38161167c565b809150509250929050565b60008060408385031215611ac157600080fd5b8235611acc816118ed565b915060208301356001600160401b03811115611ae757600080fd5b611af3858286016116cb565b9150509250929050565b600081518084526020808501945080840160005b83811015611b365781516001600160a01b031687529582019590820190600101611b11565b509495945050505050565b6001600160801b031981511682526001600160401b03602082015116602083015260006040820151606060408501526109aa6060850182611afd565b604081526000611b906040830185611b41565b8281036020840152611ba28185611a1e565b95945050505050565b60008060408385031215611bbe57600080fd5b82356001600160401b0380821115611bd557600080fd5b9084019060608287031215611be957600080fd5b611bf161162a565b8235611bfc816118ed565b8152602083810135611c0d8161167c565b82820152604084013583811115611c2357600080fd5b80850194505087601f850112611c3857600080fd5b8335611c466116ea82611741565b81815260059190911b8501820190828101908a831115611c6557600080fd5b958301955b82871015611c8c578635611c7d81611721565b82529583019590830190611c6a565b60408501525091955086013592505080821115611ca857600080fd5b50611af3858286016116cb565b600060208284031215611cc757600080fd5b81356115c2816118ed565b600060208284031215611ce457600080fd5b81356115c28161167c565b6000808335601e19843603018112611d0657600080fd5b8301803591506001600160401b03821115611d2057600080fd5b6020019150600581901b3603821315610c0557600080fd5b6000606082016001600160801b03198716835260206001600160401b03871681850152606060408501528185835260808501905086925060005b86811015611da0578335611d8581611721565b6001600160a01b031682529282019290820190600101611d72565b5098975050505050505050565b600081518084526020808501945080840160005b83811015611b3657815180516001600160401b039081168952848201518116858a01526040808301516001600160a01b0316908a0152606091820151169088015260809096019590820190600101611dc1565b60006101006001600160401b038084511685526020840151826020870152611e3e83870182611a1e565b925050604084015160408601528060608501511660608601525060018060a01b03608084015116608085015260a0830151611e8460a08601826001600160401b03169052565b5060c083015160c085015260e083015184820360e0860152611ba28282611dad565b600081518084526020808501945080840160005b83811015611b365781516001600160801b03191687529582019590820190600101611eba565b608081526000611ef36080830187611e14565b6001600160401b03861660208401528281036040840152611f148186611ea6565b90508281036060840152610fc58185611a1e565b600060608284031215611f3a57600080fd5b611f4261162a565b90508151611f4f816118ed565b8152602082810151611f608161167c565b8282015260408301516001600160401b03811115611f7d57600080fd5b8301601f81018513611f8e57600080fd5b8051611f9c6116ea82611741565b81815260059190911b82018301908381019087831115611fbb57600080fd5b928401925b82841015611fe2578351611fd381611721565b82529284019290840190611fc0565b6040860152509295945050505050565b600082601f83011261200357600080fd5b81516120116116ea826116a4565b81815284602083860101111561202657600080fd5b6109aa8260208301602087016119fa565b6000806040838503121561204a57600080fd5b82516001600160401b038082111561206157600080fd5b61206d86838701611f28565b9350602085015191508082111561208357600080fd5b50611af385828601611ff2565b600181811c908216806120a457607f821691505b6020821081036120c457634e487b7160e01b600052602260045260246000fd5b50919050565b6001600160a01b03831681526040602082018190526000906109aa90830184611a1e565b6001600160801b0319841681526001600160401b0383166020820152606060408201526000611ba26060830184611afd565b6020815260006115c26020830184611b41565b6001600160e01b03198316815281516000906121568160048501602087016119fa565b919091016004019392505050565b6001600160a01b03919091168152604060208201819052600790820152666e6f206269647360c81b606082015260800190565b634e487b7160e01b600052603260045260246000fd5b600060208083850312156121c057600080fd5b82516001600160401b038111156121d657600080fd5b8301601f810185136121e757600080fd5b80516121f56116ea82611741565b81815260059190911b8201830190838101908783111561221457600080fd5b928401925b82841015610fc557835161222c816118ed565b82529284019290840190612219565b634e487b7160e01b600052601160045260246000fd5b6000600182016122635761226361223b565b5060010190565b60006020828403121561227c57600080fd5b81516115c28161167c565b818103818111156109545761095461223b565b808201808211156109545761095461223b565b6020815260006115c26020830184611ea6565b6001600160801b0319831681526040602082015260006109aa6040830184611a1e565b604081526000611b906040830185611a1e565b600082516123088184602087016119fa565b9190910192915050565b6001600160401b03831681526040602082015260006109aa6040830184611a1e565b6000602080838503121561234757600080fd5b82516001600160401b038082111561235e57600080fd5b818501915085601f83011261237257600080fd5b81516123806116ea82611741565b81815260059190911b8301840190848101908883111561239f57600080fd5b8585015b83811015611da0578051858111156123bb5760008081fd5b6123c98b89838a0101611f28565b8452509186019186016123a3565b6001600160401b03841681526060602082015260006123f96060830185611afd565b82810360408401526111b28185611a1e565b60006020828403121561241d57600080fd5b81516001600160401b0381111561243357600080fd5b6109aa84828501611f28565b6001600160801b0319841681526060602082015260006123f96060830185611a1e565b6060815260006124756060830186611e14565b6001600160801b03198516602084015282810360408401526111b28185611a1e565b600080604083850312156124aa57600080fd5b82516001600160401b03808211156124c157600080fd5b61206d86838701611ff256fea264697066735822122076e3f4ec81afd8028b2fdc226aa6a72913298545ae3065d1dd95c2c0f12d482064736f6c63430008130033&quot;</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-9d6252b729e24615d1c76433" role="button"
                   aria-expanded="false" aria-controls="id-9d6252b729e24615d1c76433">
                    <code>suave/cmd/suavecli/buildGoerliBlocks.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/suave/cmd/suavecli/buildGoerliBlocks.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+132</span></div>
                        <div class="text-start"><span class="text-danger">-0</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-9d6252b729e24615d1c76433"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;suave&#47;cmd&#47;suavecli&#47;buildGoerliBlocks.go flashbots&#47;suave-geth&#47;suave&#47;cmd&#47;suavecli&#47;buildGoerliBlocks.go</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..b70c44e0f9b833ca5fead0fdc77e3bc1899700a6</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;suave&#47;cmd&#47;suavecli&#47;buildGoerliBlocks.go</span>
<span class="term-fg36">@@ -0,0 +1,132 @@</span>
<span class="term-fg32">+package main</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+import (</span>
<span class="term-fg32">+	&quot;context&quot;</span>
<span class="term-fg32">+	&quot;crypto&#47;ecdsa&quot;</span>
<span class="term-fg32">+	&quot;flag&quot;</span>
<span class="term-fg32">+	&quot;os&quot;</span>
<span class="term-fg32">+	&quot;strings&quot;</span>
<span class="term-fg32">+	&quot;time&quot;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&#47;hexutil&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;log&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;pkg&#47;errors&quot;</span>
<span class="term-fg32">+)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func cmdBuildGoerliBlocks() {</span>
<span class="term-fg32">+	flagset := flag.NewFlagSet(&quot;deployBlockSenderContract&quot;, flag.ExitOnError)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	var (</span>
<span class="term-fg32">+		suaveRpc                = flagset.String(&quot;suave_rpc&quot;, &quot;http:&#47;&#47;127.0.0.1:8545&quot;, &quot;address of suave rpc&quot;)</span>
<span class="term-fg32">+		goerliRpc               = flagset.String(&quot;goerli_rpc&quot;, &quot;http:&#47;&#47;127.0.0.1:8545&quot;, &quot;address of goerli rpc&quot;)</span>
<span class="term-fg32">+		goerliBeaconRpc         = flagset.String(&quot;goerli_beacon_rpc&quot;, &quot;http:&#47;&#47;127.0.0.1:5052&quot;, &quot;address of goerli beacon rpc&quot;)</span>
<span class="term-fg32">+		executionNodeAddressHex = flagset.String(&quot;ex_node_addr&quot;, &quot;0x4E2B0c0e428AE1CDE26d5BcF17Ba83f447068E5B&quot;, &quot;wallet address of execution node&quot;)</span>
<span class="term-fg32">+		privKeyHex              = flagset.String(&quot;privkey&quot;, &quot;&quot;, &quot;private key as hex (for testing)&quot;)</span>
<span class="term-fg32">+		boostRelayUrl           = flagset.String(&quot;relay_url&quot;, &quot;http:&#47;&#47;127.0.0.1:8091&quot;, &quot;address of boost relay that the contract will send blocks to&quot;)</span>
<span class="term-fg32">+		verbosity               = flagset.Int(&quot;verbosity&quot;, int(log.LvlInfo), &quot;log verbosity (0-5)&quot;)</span>
<span class="term-fg32">+		privKey                 *ecdsa.PrivateKey</span>
<span class="term-fg32">+	)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	flagset.Parse(os.Args[2:])</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	glogger := log.NewGlogHandler(log.StreamHandler(os.Stderr, log.TerminalFormat(false)))</span>
<span class="term-fg32">+	log.Root().SetHandler(glogger)</span>
<span class="term-fg32">+	glogger.Verbosity(log.Lvl(*verbosity))</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	privKey, executionNodeAddress, suaveClient, goerliClient, suaveSigner, _ := setUpSuaveAndGoerli(privKeyHex, executionNodeAddressHex, suaveRpc, goerliRpc)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; ********** Deploy Builder Contract **********</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	blockSenderAddrPtr, txHash, err := sendBlockSenderCreationTx(suaveClient, suaveSigner, privKey, boostRelayUrl)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		panic(err.Error())</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	waitForTransactionToBeConfirmed(suaveClient, txHash)</span>
<span class="term-fg32">+	blockSenderAddr := *blockSenderAddrPtr</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;*</span>
<span class="term-fg32">+		&#47;&#47; To avoid redeploying the contract, use this instead of the above</span>
<span class="term-fg32">+		blockSenderAddr := common.HexToAddress(&quot;0xFcF6C8bBa8507E494D2aDf4F5C3CE11D8B749E4C&quot;)</span>
<span class="term-fg32">+	*&#47;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	payloadAttrC := make(chan PayloadAttributesEvent)</span>
<span class="term-fg32">+	ctx, cancel := context.WithCancel(context.TODO())</span>
<span class="term-fg32">+	defer cancel()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	go SubscribeToPayloadAttributesEvents(ctx, *goerliBeaconRpc, payloadAttrC)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; subscribe to payload attribute events from beacon chain to build blocks</span>
<span class="term-fg32">+	for paEvent := range payloadAttrC {</span>
<span class="term-fg32">+		validatorData, err := getValidatorForSlot(*boostRelayUrl, paEvent.Data.ProposalSlot)</span>
<span class="term-fg32">+		if err != nil || len(validatorData.Pubkey) == 0 {</span>
<span class="term-fg32">+			log.Error(&quot;could not get validator&quot;, &quot;slot&quot;, paEvent.Data.ProposalSlot, &quot;err&quot;, err)</span>
<span class="term-fg32">+			continue</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		var goerliBlockNum hexutil.Uint64</span>
<span class="term-fg32">+		err = goerliClient.Call(&amp;goerliBlockNum, &quot;eth_blockNumber&quot;)</span>
<span class="term-fg32">+		if err != nil {</span>
<span class="term-fg32">+			log.Error(&quot;could not get goerli block&quot;, &quot;err&quot;, err)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		log.Info(&quot;got validator&quot;, &quot;vd&quot;, validatorData)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		payloadArgsTuple := struct {</span>
<span class="term-fg32">+			Slot           uint64</span>
<span class="term-fg32">+			ProposerPubkey []byte</span>
<span class="term-fg32">+			Parent         common.Hash</span>
<span class="term-fg32">+			Timestamp      uint64</span>
<span class="term-fg32">+			FeeRecipient   common.Address</span>
<span class="term-fg32">+			GasLimit       uint64</span>
<span class="term-fg32">+			Random         common.Hash</span>
<span class="term-fg32">+			Withdrawals    []struct {</span>
<span class="term-fg32">+				Index     uint64</span>
<span class="term-fg32">+				Validator uint64</span>
<span class="term-fg32">+				Address   common.Address</span>
<span class="term-fg32">+				Amount    uint64</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+		}{</span>
<span class="term-fg32">+			Slot:           paEvent.Data.ProposalSlot,</span>
<span class="term-fg32">+			Parent:         paEvent.Data.ParentBlockHash,</span>
<span class="term-fg32">+			Timestamp:      paEvent.Data.PayloadAttributes.Timestamp,</span>
<span class="term-fg32">+			Random:         paEvent.Data.PayloadAttributes.PrevRandao,</span>
<span class="term-fg32">+			ProposerPubkey: hexutil.MustDecode(validatorData.Pubkey),</span>
<span class="term-fg32">+			FeeRecipient:   validatorData.FeeRecipient,</span>
<span class="term-fg32">+			GasLimit:       validatorData.GasLimit,</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		for _, w := range paEvent.Data.PayloadAttributes.Withdrawals {</span>
<span class="term-fg32">+			payloadArgsTuple.Withdrawals = append(payloadArgsTuple.Withdrawals, struct {</span>
<span class="term-fg32">+				Index     uint64</span>
<span class="term-fg32">+				Validator uint64</span>
<span class="term-fg32">+				Address   common.Address</span>
<span class="term-fg32">+				Amount    uint64</span>
<span class="term-fg32">+			}{</span>
<span class="term-fg32">+				Index:     uint64(w.Index),</span>
<span class="term-fg32">+				Validator: uint64(w.ValidatorIndex),</span>
<span class="term-fg32">+				Address:   common.Address(w.Address),</span>
<span class="term-fg32">+				Amount:    uint64(w.Amount),</span>
<span class="term-fg32">+			})</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		for i := 0; i &lt; 3; i++ {</span>
<span class="term-fg32">+			_, err = sendBuildShareBlockTx(suaveClient, suaveSigner, privKey, executionNodeAddress, blockSenderAddr, payloadArgsTuple, uint64(goerliBlockNum)+1)</span>
<span class="term-fg32">+			if err != nil {</span>
<span class="term-fg32">+				err = errors.Wrap(err, unwrapPeekerError(err).Error())</span>
<span class="term-fg32">+				if strings.Contains(err.Error(), &quot;no bids&quot;) {</span>
<span class="term-fg32">+					log.Error(&quot;Failed to build a block, no bids&quot;)</span>
<span class="term-fg32">+					time.Sleep(2 * time.Second)</span>
<span class="term-fg32">+					continue</span>
<span class="term-fg32">+				}</span>
<span class="term-fg32">+				log.Error(&quot;Failed to send BuildShareBlockTx&quot;, &quot;err&quot;, err)</span>
<span class="term-fg32">+				time.Sleep(2 * time.Second)</span>
<span class="term-fg32">+				continue</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+			log.Info(&quot;Sent block to relay&quot;, &quot;payload args&quot;, payloadArgsTuple, &quot;blockNum&quot;, uint64(goerliBlockNum)+1)</span>
<span class="term-fg32">+			break</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-ea1228d6e2a02c3d7441d254" role="button"
                   aria-expanded="false" aria-controls="id-ea1228d6e2a02c3d7441d254">
                    <code>suave/cmd/suavecli/deployMevShareByteCode.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/suave/cmd/suavecli/deployMevShareByteCode.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+3</span></div>
                        <div class="text-start"><span class="text-danger">-0</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-ea1228d6e2a02c3d7441d254"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;suave&#47;cmd&#47;suavecli&#47;deployMevShareByteCode.go flashbots&#47;suave-geth&#47;suave&#47;cmd&#47;suavecli&#47;deployMevShareByteCode.go</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..a671396184cff74cbe3bac9008fcfa83ca8c4857</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;suave&#47;cmd&#47;suavecli&#47;deployMevShareByteCode.go</span>
<span class="term-fg36">@@ -0,0 +1,3 @@</span>
<span class="term-fg32">+package main</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+var mevshareContractBytecode string = &quot;0x608060405234801561001057600080fd5b506114dc806100206000396000f3fe6080604052600436106100555760003560e01c8063274e3b041461005a5780633c34db651461008357806367d7d785146100a557806392f07a58146100c55780639b0a882e146100da578063e2a1d069146100fa575b600080fd5b61006d610068366004610cf3565b61010d565b60405161007a9190610d92565b60405180910390f35b34801561008f57600080fd5b506100a361009e366004610dbd565b6103bc565b005b3480156100b157600080fd5b506100a36100c0366004610e71565b610410565b3480156100d157600080fd5b5061006d6104ad565b3480156100e657600080fd5b506100a36100f5366004610ef8565b6104d5565b61006d610108366004610f67565b61056f565b60606101176107d3565b61012057600080fd5b6000306001600160a01b03166392f07a586040518163ffffffff1660e01b81526004016000604051808303816000875af1158015610162573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f1916820160405261018a9190810190610fca565b905060008061019883610853565b915091508161020257604080516375fff46760e01b81523060048201526024810191909152602260448201527f62756e646c6520646f6573206e6f742073696d756c61746520636f72726563746064820152616c7960f01b608482015260a4015b60405180910390fd5b600061020d846108ec565b9050600061025188886040518060400160405280601c81526020017f6d657673686172653a76303a756e6d61746368656442756e646c6573000000008152506109ad565b90506102908160000151604051806040016040528060168152602001756d657673686172653a76303a65746842756e646c657360501b81525087610a92565b8051604080518082018252601f81527f6d657673686172653a76303a65746842756e646c6553696d526573756c74730060208083019190915282516001600160401b038816918101919091526102f79392015b604051602081830303815290604052610a92565b60008051602061148783398151915281600001518260200151836040015160405161032493929190611084565b60405180910390a180516040517fdab8306bad2ca820d05b9eff8da2e3016d372c15f00bb032f758718b9cda39509161035e9185906110b6565b60405180910390a1604051634d85441760e11b906103829083908590602001611115565b60408051601f19818403018152908290526103a0929160200161113a565b6040516020818303038152906040529550505050505092915050565b6000805160206114878339815191526103d8602083018361116b565b6103e86040840160208501611188565b6103f560408501856111a5565b60405161040594939291906111f5565b60405180910390a150565b60008051602061148783398151915261042c602085018561116b565b61043c6040860160208701611188565b61044960408701876111a5565b60405161045994939291906111f5565b60405180910390a17f417b0c16c40ca502ef10ae6921892668f006f527e3f4599cb95b9de965d4133461048f602085018561116b565b83836040516104a09392919061126a565b60405180910390a1505050565b606060006104b9610b44565b9050808060200190518101906104cf9190610fca565b91505090565b6000805160206114878339815191526104f1602084018461116b565b6105016040850160208601611188565b61050e60408601866111a5565b60405161051e94939291906111f5565b60405180910390a17fdab8306bad2ca820d05b9eff8da2e3016d372c15f00bb032f758718b9cda3950610554602084018461116b565b826040516105639291906110b6565b60405180910390a15050565b60606105796107d3565b61058257600080fd5b6000306001600160a01b03166392f07a586040518163ffffffff1660e01b81526004016000604051808303816000875af11580156105c4573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f191682016040526105ec9190810190610fca565b905060006105f9826108ec565b905060006106358787604051806040016040528060158152602001746d657673686172653a76303a6d617463684269647360581b8152506109ad565b90506106748160000151604051806040016040528060168152602001756d657673686172653a76303a65746842756e646c657360501b81525085610a92565b8051604080518082018252601f81527f6d657673686172653a76303a65746842756e646c6553696d526573756c74730060208083019190915282516000918101919091526106c39392016102e3565b60408051600280825260608201835260009260208301908036833701905050905085816000815181106106f8576106f861129f565b6001600160801b03199092166020928302919091019091015281518151829060019081106107285761072861129f565b6001600160801b0319909216602092830291909101820152825160408051808201825260168152756d657673686172653a76303a6d65726765644269647360501b81850152905161077f936102e3918691016112b5565b604051633c34db6560e01b90610799908490602001611303565b60408051601f19818403018152908290526107b7929160200161113a565b6040516020818303038152906040529450505050509392505050565b6040516000908190819063420100009082818181855afa9150503d8060008114610819576040519150601f19603f3d011682016040523d82523d6000602084013e61081e565b606091505b509150915081610849576342010000816040516375fff46760e01b81526004016101f9929190611316565b6020015192915050565b60008060008063421000006001600160a01b031685604051610875919061133a565b600060405180830381855afa9150503d80600081146108b0576040519150601f19603f3d011682016040523d82523d6000602084013e6108b5565b606091505b5091509150816108cc575060009485945092505050565b81818060200190518101906108e19190611356565b935093505050915091565b60606108f66107d3565b6108ff57600080fd5b60008063421000376001600160a01b0316846040516020016109219190610d92565b60408051601f198184030181529082905261093b9161133a565b600060405180830381855afa9150503d8060008114610976576040519150601f19603f3d011682016040523d82523d6000602084013e61097b565b606091505b5091509150816109a6576342100037816040516375fff46760e01b81526004016101f9929190611316565b9392505050565b6040805160608082018352600080835260208301529181019190915260008063420300006001600160a01b03168686866040516020016109ef93929190611373565b60408051601f1981840301815290829052610a099161133a565b600060405180830381855afa9150503d8060008114610a44576040519150601f19603f3d011682016040523d82523d6000602084013e610a49565b606091505b509150915081610a74576342030000816040516375fff46760e01b81526004016101f9929190611316565b80806020019051810190610a889190611395565b9695505050505050565b60008063420200006001600160a01b0316858585604051602001610ab89392919061126a565b60408051601f1981840301815290829052610ad29161133a565b600060405180830381855afa9150503d8060008114610b0d576040519150601f19603f3d011682016040523d82523d6000602084013e610b12565b606091505b509150915081610b3d576342020000816040516375fff46760e01b81526004016101f9929190611316565b5050505050565b604051606090600090819063420100019082818181855afa9150503d8060008114610b8b576040519150601f19603f3d011682016040523d82523d6000602084013e610b90565b606091505b509150915081610bbb576342010001816040516375fff46760e01b81526004016101f9929190611316565b92915050565b6001600160401b0381168114610bd657600080fd5b50565b634e487b7160e01b600052604160045260246000fd5b604051606081016001600160401b0381118282101715610c1157610c11610bd9565b60405290565b604051601f8201601f191681016001600160401b0381118282101715610c3f57610c3f610bd9565b604052919050565b60006001600160401b03821115610c6057610c60610bd9565b5060051b60200190565b6001600160a01b0381168114610bd657600080fd5b600082601f830112610c9057600080fd5b81356020610ca5610ca083610c47565b610c17565b82815260059290921b84018101918181019086841115610cc457600080fd5b8286015b84811015610ce8578035610cdb81610c6a565b8352918301918301610cc8565b509695505050505050565b60008060408385031215610d0657600080fd5b8235610d1181610bc1565b915060208301356001600160401b03811115610d2c57600080fd5b610d3885828601610c7f565b9150509250929050565b60005b83811015610d5d578181015183820152602001610d45565b50506000910152565b60008151808452610d7e816020860160208601610d42565b601f01601f19169290920160200192915050565b6020815260006109a66020830184610d66565b600060608284031215610db757600080fd5b50919050565b600060208284031215610dcf57600080fd5b81356001600160401b03811115610de557600080fd5b610df184828501610da5565b949350505050565b60006001600160401b03821115610e1257610e12610bd9565b50601f01601f191660200190565b600082601f830112610e3157600080fd5b8135610e3f610ca082610df9565b818152846020838601011115610e5457600080fd5b816020850160208301376000918101602001919091529392505050565b600080600060608486031215610e8657600080fd5b83356001600160401b0380821115610e9d57600080fd5b610ea987838801610da5565b94506020860135915080821115610ebf57600080fd5b610ecb87838801610e20565b93506040860135915080821115610ee157600080fd5b50610eee86828701610e20565b9150509250925092565b60008060408385031215610f0b57600080fd5b82356001600160401b0380821115610f2257600080fd5b610f2e86838701610da5565b93506020850135915080821115610f4457600080fd5b50610d3885828601610e20565b6001600160801b031981168114610bd657600080fd5b600080600060608486031215610f7c57600080fd5b8335610f8781610bc1565b925060208401356001600160401b03811115610fa257600080fd5b610fae86828701610c7f565b9250506040840135610fbf81610f51565b809150509250925092565b600060208284031215610fdc57600080fd5b81516001600160401b03811115610ff257600080fd5b8201601f8101841361100357600080fd5b8051611011610ca082610df9565b81815285602083850101111561102657600080fd5b611037826020830160208601610d42565b95945050505050565b600081518084526020808501945080840160005b838110156110795781516001600160a01b031687529582019590820190600101611054565b509495945050505050565b6001600160801b0319841681526001600160401b03831660208201526060604082015260006110376060830184611040565b6001600160801b031983168152604060208201526000610df16040830184610d66565b6001600160801b031981511682526001600160401b0360208201511660208301526000604082015160606040850152610df16060850182611040565b60408152600061112860408301856110d9565b82810360208401526110378185610d66565b6001600160e01b031983168152815160009061115d816004850160208701610d42565b919091016004019392505050565b60006020828403121561117d57600080fd5b81356109a681610f51565b60006020828403121561119a57600080fd5b81356109a681610bc1565b6000808335601e198436030181126111bc57600080fd5b8301803591506001600160401b038211156111d657600080fd5b6020019150600581901b36038213156111ee57600080fd5b9250929050565b6000606082016001600160801b03198716835260206001600160401b03871681850152606060408501528185835260808501905086925060005b8681101561125d57833561124281610c6a565b6001600160a01b03168252928201929082019060010161122f565b5098975050505050505050565b6001600160801b03198416815260606020820152600061128d6060830185610d66565b8281036040840152610a888185610d66565b634e487b7160e01b600052603260045260246000fd5b6020808252825182820181905260009190848201906040850190845b818110156112f75783516001600160801b031916835292840192918401916001016112d1565b50909695505050505050565b6020815260006109a660208301846110d9565b6001600160a01b0383168152604060208201819052600090610df190830184610d66565b6000825161134c818460208701610d42565b9190910192915050565b60006020828403121561136857600080fd5b81516109a681610bc1565b6001600160401b038416815260606020820152600061128d6060830185611040565b600060208083850312156113a857600080fd5b82516001600160401b03808211156113bf57600080fd5b90840190606082870312156113d357600080fd5b6113db610bef565b82516113e681610f51565b8152828401516113f581610bc1565b8185015260408301518281111561140b57600080fd5b80840193505086601f84011261142057600080fd5b82519150611430610ca083610c47565b82815260059290921b8301840191848101908884111561144f57600080fd5b938501935b8385101561147657845161146781610c6a565b82529385019390850190611454565b604083015250969550505050505056fe83481d5b04dea534715acad673a8177a46fc93882760f36bdc16ccac439d504ea264697066735822122099081ac1fd8c30cb019eca27b6c1a3a59a63ba89a5f3ca61db3777cc8300844464736f6c63430008130033&quot;</span></div>
    </div>

            
        </div>
        <div>
            
        </div>
    </div>
</div>

            
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-cb749ae2ffe0aa552d884e60"role="button" aria-expanded="false" aria-controls="id-cb749ae2ffe0aa552d884e60">
        
            <div class="col-12 col-sm-9 text-start"><h3>Testing</h3></div>
        
        <div class="col-12 col-sm-3 ms-auto mt-2">
            <div class="row line-stat">
                <div class="text-end"><span class="text-success">+1215</span></div>
                <div class="text-start"><span class="text-danger">-0</span></div>
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-cb749ae2ffe0aa552d884e60">
        <div></div>
        <div>
            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-3fb35778f0b64d394d366aa4" role="button"
                   aria-expanded="false" aria-controls="id-3fb35778f0b64d394d366aa4">
                    <code>suave/e2e/workflow_test.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/suave/e2e/workflow_test.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+1180</span></div>
                        <div class="text-start"><span class="text-danger">-0</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-3fb35778f0b64d394d366aa4"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;suave&#47;e2e&#47;workflow_test.go flashbots&#47;suave-geth&#47;suave&#47;e2e&#47;workflow_test.go</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..34a13e451cf9260d5b7591c61f4511626d8b730a</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;suave&#47;e2e&#47;workflow_test.go</span>
<span class="term-fg36">@@ -0,0 +1,1180 @@</span>
<span class="term-fg32">+package main</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+import (</span>
<span class="term-fg32">+	&quot;context&quot;</span>
<span class="term-fg32">+	&quot;encoding&#47;json&quot;</span>
<span class="term-fg32">+	&quot;io&quot;</span>
<span class="term-fg32">+	&quot;math&#47;big&quot;</span>
<span class="term-fg32">+	&quot;net&#47;http&quot;</span>
<span class="term-fg32">+	&quot;net&#47;http&#47;httptest&quot;</span>
<span class="term-fg32">+	&quot;strings&quot;</span>
<span class="term-fg32">+	&quot;testing&quot;</span>
<span class="term-fg32">+	&quot;time&quot;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	builderCapella &quot;github.com&#47;attestantio&#47;go-builder-client&#47;api&#47;capella&quot;</span>
<span class="term-fg32">+	bellatrixSpec &quot;github.com&#47;attestantio&#47;go-eth2-client&#47;spec&#47;bellatrix&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;attestantio&#47;go-eth2-client&#47;spec&#47;phase0&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;accounts&#47;abi&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;accounts&#47;keystore&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;beacon&#47;engine&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&#47;hexutil&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;core&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;core&#47;types&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;crypto&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;eth&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;eth&#47;downloader&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;eth&#47;ethconfig&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;internal&#47;ethapi&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;miner&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;node&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;p2p&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;params&quot;</span>
<span class="term-fg32">+	suave &quot;github.com&#47;ethereum&#47;go-ethereum&#47;suave&#47;core&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;flashbots&#47;go-boost-utils&#47;ssz&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;google&#47;uuid&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;stretchr&#47;testify&#47;require&quot;</span>
<span class="term-fg32">+)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func TestIsOffchain(t *testing.T) {</span>
<span class="term-fg32">+	&#47;&#47; t.Fatal(&quot;not implemented&quot;)</span>
<span class="term-fg32">+	node, ethservice := startSuethService(t, testSuaveGenesis, nil, suave.Config{})</span>
<span class="term-fg32">+	defer node.Close()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	rpc, err := node.Attach()</span>
<span class="term-fg32">+	require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	gas := hexutil.Uint64(1000000)</span>
<span class="term-fg32">+	chainId := hexutil.Big(*testSuaveGenesis.Config.ChainID)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	{</span>
<span class="term-fg32">+		&#47;&#47; Verify eth_call of isOffchainAddress returns 1&#47;0 depending on offchain setting</span>
<span class="term-fg32">+		var result string</span>
<span class="term-fg32">+		requireNoRpcError(t, rpc.Call(&amp;result, &quot;eth_call&quot;, ethapi.TransactionArgs{</span>
<span class="term-fg32">+			To:         &amp;isOffchainAddress,</span>
<span class="term-fg32">+			Gas:        &amp;gas,</span>
<span class="term-fg32">+			IsOffchain: true,</span>
<span class="term-fg32">+			ChainID:    &amp;chainId,</span>
<span class="term-fg32">+		}, &quot;latest&quot;))</span>
<span class="term-fg32">+		require.Equal(t, []byte{1}, hexutil.MustDecode(result))</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		requireNoRpcError(t, rpc.Call(&amp;result, &quot;eth_call&quot;, ethapi.TransactionArgs{</span>
<span class="term-fg32">+			To:         &amp;isOffchainAddress,</span>
<span class="term-fg32">+			Gas:        &amp;gas,</span>
<span class="term-fg32">+			IsOffchain: false,</span>
<span class="term-fg32">+			ChainID:    &amp;chainId,</span>
<span class="term-fg32">+		}, &quot;latest&quot;))</span>
<span class="term-fg32">+		require.Equal(t, []byte{0}, hexutil.MustDecode(result))</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	{</span>
<span class="term-fg32">+		&#47;&#47; Verify sending offchain and onchain transactions to isOffchainAddress</span>
<span class="term-fg32">+		wrappedTxData := &amp;types.LegacyTx{</span>
<span class="term-fg32">+			Nonce:    0,</span>
<span class="term-fg32">+			To:       &amp;isOffchainAddress,</span>
<span class="term-fg32">+			Value:    nil,</span>
<span class="term-fg32">+			Gas:      1000000,</span>
<span class="term-fg32">+			GasPrice: big.NewInt(10),</span>
<span class="term-fg32">+			Data:     []byte{},</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		offchainTx, err := types.SignTx(types.NewTx(&amp;types.OffchainTx{</span>
<span class="term-fg32">+			ExecutionNode: ethservice.AccountManager().Accounts()[0],</span>
<span class="term-fg32">+			Wrapped:       *types.NewTx(wrappedTxData),</span>
<span class="term-fg32">+		}), signer, testKey)</span>
<span class="term-fg32">+		require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		offchainTxBytes, err := offchainTx.MarshalBinary()</span>
<span class="term-fg32">+		require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		var offchainTxHash common.Hash</span>
<span class="term-fg32">+		requireNoRpcError(t, rpc.Call(&amp;offchainTxHash, &quot;eth_sendRawTransaction&quot;, hexutil.Encode(offchainTxBytes)))</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		onchainTx, err := types.SignTx(types.NewTx(&amp;types.LegacyTx{</span>
<span class="term-fg32">+			Nonce:    1,</span>
<span class="term-fg32">+			To:       &amp;isOffchainAddress,</span>
<span class="term-fg32">+			Value:    nil,</span>
<span class="term-fg32">+			Gas:      1000000,</span>
<span class="term-fg32">+			GasPrice: big.NewInt(10),</span>
<span class="term-fg32">+			Data:     []byte{},</span>
<span class="term-fg32">+		}), signer, testKey)</span>
<span class="term-fg32">+		require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		onchainTxBytes, err := onchainTx.MarshalBinary()</span>
<span class="term-fg32">+		require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		var onchainTxHash common.Hash</span>
<span class="term-fg32">+		requireNoRpcError(t, rpc.Call(&amp;onchainTxHash, &quot;eth_sendRawTransaction&quot;, hexutil.Encode(onchainTxBytes)))</span>
<span class="term-fg32">+		require.Equal(t, common.HexToHash(&quot;0x031415a9010d25f2a882758cf7b8dbb3750678828e9973f32f0c73ef49a038b4&quot;), onchainTxHash)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		block := progressChain(t, ethservice, ethservice.BlockChain().CurrentBlock())</span>
<span class="term-fg32">+		require.Equal(t, 2, len(block.Transactions()))</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		receipts := ethservice.BlockChain().GetReceiptsByHash(block.Hash())</span>
<span class="term-fg32">+		require.Equal(t, 2, len(receipts))</span>
<span class="term-fg32">+		require.Equal(t, uint8(types.OffchainExecutedTxType), receipts[0].Type)</span>
<span class="term-fg32">+		require.Equal(t, uint64(1), receipts[0].Status)</span>
<span class="term-fg32">+		require.Equal(t, uint8(types.LegacyTxType), receipts[1].Type)</span>
<span class="term-fg32">+		require.Equal(t, uint64(1), receipts[1].Status)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		require.Equal(t, 2, len(block.Transactions()))</span>
<span class="term-fg32">+		require.Equal(t, []byte{1}, block.Transactions()[0].Data()) &#47;&#47; offchain execution relays the offchain result</span>
<span class="term-fg32">+		require.Equal(t, []byte{}, block.Transactions()[1].Data())</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func TestMempool(t *testing.T) {</span>
<span class="term-fg32">+	&#47;&#47; t.Fatal(&quot;not implemented&quot;)</span>
<span class="term-fg32">+	node, ethservice := startSuethService(t, testSuaveGenesis, nil, suave.Config{})</span>
<span class="term-fg32">+	defer node.Close()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	rpc, err := node.Attach()</span>
<span class="term-fg32">+	require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	gas := hexutil.Uint64(1000000)</span>
<span class="term-fg32">+	chainId := hexutil.Big(*testSuaveGenesis.Config.ChainID)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	{</span>
<span class="term-fg32">+		targetBlock := uint64(16103213)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		bid1 := suave.Bid{</span>
<span class="term-fg32">+			Id:                  suave.BidId(uuid.New()),</span>
<span class="term-fg32">+			DecryptionCondition: targetBlock,</span>
<span class="term-fg32">+			AllowedPeekers:      []common.Address{common.HexToAddress(&quot;0x424344&quot;)},</span>
<span class="term-fg32">+			Version:             &quot;default:v0:ethBundles&quot;,</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		bid2 := suave.Bid{</span>
<span class="term-fg32">+			Id:                  suave.BidId(uuid.New()),</span>
<span class="term-fg32">+			DecryptionCondition: targetBlock,</span>
<span class="term-fg32">+			AllowedPeekers:      []common.Address{common.HexToAddress(&quot;0x424344&quot;)},</span>
<span class="term-fg32">+			Version:             &quot;default:v0:ethBundles&quot;,</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		ethservice.APIBackend.OffchainBackend().MempoolBackend.SubmitBid(bid1)</span>
<span class="term-fg32">+		ethservice.APIBackend.OffchainBackend().MempoolBackend.SubmitBid(bid2)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		inoutAbi := mustParseMethodAbi(`[ { &quot;inputs&quot;: [ { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;cond&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;string&quot;, &quot;name&quot;: &quot;namespace&quot;, &quot;type&quot;: &quot;string&quot; } ], &quot;name&quot;: &quot;fetchBids&quot;, &quot;outputs&quot;: [ { &quot;components&quot;: [ { &quot;internalType&quot;: &quot;Suave.BidId&quot;, &quot;name&quot;: &quot;id&quot;, &quot;type&quot;: &quot;bytes16&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;decryptionCondition&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address[]&quot;, &quot;name&quot;: &quot;allowedPeekers&quot;, &quot;type&quot;: &quot;address[]&quot; }, { &quot;internalType&quot;: &quot;string&quot;, &quot;name&quot;: &quot;version&quot;, &quot;type&quot;: &quot;string&quot; } ], &quot;internalType&quot;: &quot;struct Suave.Bid[]&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;tuple[]&quot; } ], &quot;stateMutability&quot;: &quot;view&quot;, &quot;type&quot;: &quot;function&quot; } ]`, &quot;fetchBids&quot;)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		calldata, err := inoutAbi.Inputs.Pack(targetBlock, &quot;default:v0:ethBundles&quot;)</span>
<span class="term-fg32">+		require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		var simResult hexutil.Bytes</span>
<span class="term-fg32">+		requireNoRpcError(t, rpc.Call(&amp;simResult, &quot;eth_call&quot;, ethapi.TransactionArgs{</span>
<span class="term-fg32">+			To:         &amp;fetchBidsAddress,</span>
<span class="term-fg32">+			Gas:        &amp;gas,</span>
<span class="term-fg32">+			IsOffchain: true,</span>
<span class="term-fg32">+			ChainID:    &amp;chainId,</span>
<span class="term-fg32">+			Data:       (*hexutil.Bytes)(&amp;calldata),</span>
<span class="term-fg32">+		}, &quot;latest&quot;))</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		unpacked, err := inoutAbi.Outputs.Unpack(simResult)</span>
<span class="term-fg32">+		require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		bids := unpacked[0].([]struct {</span>
<span class="term-fg32">+			Id                  [16]uint8        &quot;json:\&quot;id\&quot;&quot;</span>
<span class="term-fg32">+			DecryptionCondition uint64           &quot;json:\&quot;decryptionCondition\&quot;&quot;</span>
<span class="term-fg32">+			AllowedPeekers      []common.Address &quot;json:\&quot;allowedPeekers\&quot;&quot;</span>
<span class="term-fg32">+			Version             string           `json:&quot;version&quot;`</span>
<span class="term-fg32">+		})</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		require.Equal(t, bid1, suave.Bid{</span>
<span class="term-fg32">+			Id:                  bids[0].Id,</span>
<span class="term-fg32">+			DecryptionCondition: bids[0].DecryptionCondition,</span>
<span class="term-fg32">+			AllowedPeekers:      bids[0].AllowedPeekers,</span>
<span class="term-fg32">+			Version:             bids[0].Version,</span>
<span class="term-fg32">+		})</span>
<span class="term-fg32">+		require.Equal(t, bid2, suave.Bid{</span>
<span class="term-fg32">+			Id:                  bids[1].Id,</span>
<span class="term-fg32">+			DecryptionCondition: bids[1].DecryptionCondition,</span>
<span class="term-fg32">+			AllowedPeekers:      bids[1].AllowedPeekers,</span>
<span class="term-fg32">+			Version:             bids[1].Version,</span>
<span class="term-fg32">+		})</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		&#47;&#47; Verify via transaction</span>
<span class="term-fg32">+		wrappedTxData := &amp;types.LegacyTx{</span>
<span class="term-fg32">+			Nonce:    0,</span>
<span class="term-fg32">+			To:       &amp;fetchBidsAddress,</span>
<span class="term-fg32">+			Value:    nil,</span>
<span class="term-fg32">+			Gas:      1000000,</span>
<span class="term-fg32">+			GasPrice: big.NewInt(10),</span>
<span class="term-fg32">+			Data:     calldata,</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		offchainTx, err := types.SignTx(types.NewTx(&amp;types.OffchainTx{</span>
<span class="term-fg32">+			ExecutionNode: ethservice.AccountManager().Accounts()[0],</span>
<span class="term-fg32">+			Wrapped:       *types.NewTx(wrappedTxData),</span>
<span class="term-fg32">+		}), signer, testKey)</span>
<span class="term-fg32">+		require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		offchainTxBytes, err := offchainTx.MarshalBinary()</span>
<span class="term-fg32">+		require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		var offchainTxHash common.Hash</span>
<span class="term-fg32">+		requireNoRpcError(t, rpc.Call(&amp;offchainTxHash, &quot;eth_sendRawTransaction&quot;, hexutil.Encode(offchainTxBytes)))</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		block := progressChain(t, ethservice, ethservice.BlockChain().CurrentBlock())</span>
<span class="term-fg32">+		require.Equal(t, 1, len(block.Transactions()))</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		receipts := ethservice.BlockChain().GetReceiptsByHash(block.Hash())</span>
<span class="term-fg32">+		require.Equal(t, 1, len(receipts))</span>
<span class="term-fg32">+		require.Equal(t, uint8(types.OffchainExecutedTxType), receipts[0].Type)</span>
<span class="term-fg32">+		require.Equal(t, uint64(1), receipts[0].Status)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		require.Equal(t, 1, len(block.Transactions()))</span>
<span class="term-fg32">+		require.Equal(t, []byte(simResult), block.Transactions()[0].Data())</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func TestBundleBid(t *testing.T) {</span>
<span class="term-fg32">+	&#47;&#47; t.Fatal(&quot;not implemented&quot;)</span>
<span class="term-fg32">+	node, ethservice := startSuethService(t, testSuaveGenesis, nil, suave.Config{})</span>
<span class="term-fg32">+	defer node.Close()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	rpc, err := node.Attach()</span>
<span class="term-fg32">+	require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	{</span>
<span class="term-fg32">+		targetBlock := uint64(16103213)</span>
<span class="term-fg32">+		allowedPeekers := []common.Address{{0x41, 0x42, 0x43}, newBundleBidAddress}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		bundle := struct {</span>
<span class="term-fg32">+			Txs             types.Transactions `json:&quot;txs&quot;`</span>
<span class="term-fg32">+			RevertingHashes []common.Hash      `json:&quot;revertingHashes&quot;`</span>
<span class="term-fg32">+		}{</span>
<span class="term-fg32">+			Txs:             types.Transactions{types.NewTx(&amp;types.LegacyTx{})},</span>
<span class="term-fg32">+			RevertingHashes: []common.Hash{},</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		bundleBytes, err := json.Marshal(bundle)</span>
<span class="term-fg32">+		require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		calldata, err := bundleBidAbi.Pack(&quot;newBid&quot;, targetBlock, allowedPeekers)</span>
<span class="term-fg32">+		require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		&#47;&#47; Verify via transaction</span>
<span class="term-fg32">+		wrappedTxData := &amp;types.LegacyTx{</span>
<span class="term-fg32">+			Nonce:    0,</span>
<span class="term-fg32">+			To:       &amp;newBundleBidAddress,</span>
<span class="term-fg32">+			Value:    nil,</span>
<span class="term-fg32">+			Gas:      1000000,</span>
<span class="term-fg32">+			GasPrice: big.NewInt(10),</span>
<span class="term-fg32">+			Data:     calldata,</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		offchainTx, err := types.SignTx(types.NewTx(&amp;types.OffchainTx{</span>
<span class="term-fg32">+			ExecutionNode: ethservice.AccountManager().Accounts()[0],</span>
<span class="term-fg32">+			Wrapped:       *types.NewTx(wrappedTxData),</span>
<span class="term-fg32">+		}), signer, testKey)</span>
<span class="term-fg32">+		require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		offchainTxBytes, err := offchainTx.MarshalBinary()</span>
<span class="term-fg32">+		require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		confidentialDataBytes, err := bundleBidAbi.Methods[&quot;fetchBidConfidentialBundleData&quot;].Outputs.Pack(bundleBytes)</span>
<span class="term-fg32">+		require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		var offchainTxHash common.Hash</span>
<span class="term-fg32">+		requireNoRpcError(t, rpc.Call(&amp;offchainTxHash, &quot;eth_sendRawTransaction&quot;, hexutil.Encode(offchainTxBytes), hexutil.Encode(confidentialDataBytes)))</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		block := progressChain(t, ethservice, ethservice.BlockChain().CurrentBlock())</span>
<span class="term-fg32">+		require.Equal(t, 1, len(block.Transactions()))</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		receipts := ethservice.BlockChain().GetReceiptsByHash(block.Hash())</span>
<span class="term-fg32">+		require.Equal(t, 1, len(receipts))</span>
<span class="term-fg32">+		require.Equal(t, uint8(types.OffchainExecutedTxType), receipts[0].Type)</span>
<span class="term-fg32">+		require.Equal(t, uint64(1), receipts[0].Status)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		require.Equal(t, 1, len(block.Transactions()))</span>
<span class="term-fg32">+		unpacked, err := bundleBidAbi.Methods[&quot;emitBid&quot;].Inputs.Unpack(block.Transactions()[0].Data()[4:])</span>
<span class="term-fg32">+		require.NoError(t, err)</span>
<span class="term-fg32">+		bid := unpacked[0].(struct {</span>
<span class="term-fg32">+			Id                  [16]uint8        &quot;json:\&quot;id\&quot;&quot;</span>
<span class="term-fg32">+			DecryptionCondition uint64           &quot;json:\&quot;decryptionCondition\&quot;&quot;</span>
<span class="term-fg32">+			AllowedPeekers      []common.Address &quot;json:\&quot;allowedPeekers\&quot;&quot;</span>
<span class="term-fg32">+		})</span>
<span class="term-fg32">+		require.Equal(t, targetBlock, bid.DecryptionCondition)</span>
<span class="term-fg32">+		require.Equal(t, allowedPeekers, bid.AllowedPeekers)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		require.NotNil(t, receipts[0].Logs[0])</span>
<span class="term-fg32">+		require.Equal(t, newBundleBidAddress, receipts[0].Logs[0].Address)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		unpacked, err = bundleBidAbi.Events[&quot;BidEvent&quot;].Inputs.Unpack(receipts[0].Logs[0].Data)</span>
<span class="term-fg32">+		require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		require.Equal(t, bid.Id, unpacked[0].([16]byte))</span>
<span class="term-fg32">+		require.Equal(t, bid.DecryptionCondition, unpacked[1].(uint64))</span>
<span class="term-fg32">+		require.Equal(t, bid.AllowedPeekers, unpacked[2].([]common.Address))</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		_, err = ethservice.APIBackend.OffchainBackend().ConfiendialStoreBackend.Retrieve(bid.Id, common.Address{0x41, 0x42, 0x43}, &quot;default:v0:ethBundleSimResults&quot;)</span>
<span class="term-fg32">+		require.NoError(t, err)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func TestMevShare(t *testing.T) {</span>
<span class="term-fg32">+	&#47;&#47; 1. craft mevshare transaction</span>
<span class="term-fg32">+	&#47;&#47;   1a. confirm submission</span>
<span class="term-fg32">+	&#47;&#47; 2. send backrun txn</span>
<span class="term-fg32">+	&#47;&#47;	 2a. confirm submission</span>
<span class="term-fg32">+	&#47;&#47; 3. build share block</span>
<span class="term-fg32">+	&#47;&#47;   3a. confirm share bundle</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	ethNode, ethEthService := startEthService(t, testEthGenesis, nil)</span>
<span class="term-fg32">+	defer ethNode.Close()</span>
<span class="term-fg32">+	ethEthService.APIs()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	node, ethservice := startSuethService(t, testSuaveGenesis, nil, suave.Config{SuaveEthRemoteBackendEndpoint: &quot;http:&#47;&#47;127.0.0.1:8596&quot;})</span>
<span class="term-fg32">+	defer node.Close()</span>
<span class="term-fg32">+	ethservice.APIs()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	rpc, err := node.Attach()</span>
<span class="term-fg32">+	require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; ************ 1. Initial mevshare transaction Portion ************</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	ethTx, err := types.SignTx(types.NewTx(&amp;types.LegacyTx{</span>
<span class="term-fg32">+		Nonce:    0,</span>
<span class="term-fg32">+		To:       &amp;testAddr,</span>
<span class="term-fg32">+		Value:    big.NewInt(1000),</span>
<span class="term-fg32">+		Gas:      21000,</span>
<span class="term-fg32">+		GasPrice: big.NewInt(13),</span>
<span class="term-fg32">+		Data:     []byte{},</span>
<span class="term-fg32">+	}), signer, testKey)</span>
<span class="term-fg32">+	require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	bundle := types.SBundle{</span>
<span class="term-fg32">+		Txs:             types.Transactions{ethTx},</span>
<span class="term-fg32">+		RevertingHashes: []common.Hash{},</span>
<span class="term-fg32">+		RefundPercent:   10,</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	bundleBytes, err := json.Marshal(bundle)</span>
<span class="term-fg32">+	t.Log(&quot;extractHint&quot;, &quot;bundleBytes&quot;, bundleBytes)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	targetBlock := uint64(1)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; Send a bundle bid</span>
<span class="term-fg32">+	allowedPeekers := []common.Address{{0x41, 0x42, 0x43}, newBlockBidAddress, extractHintAddress, buildEthBlockAddress, mevShareAddress}</span>
<span class="term-fg32">+	calldata, err := bundleBidAbi.Pack(&quot;newBid&quot;, targetBlock+1, allowedPeekers)</span>
<span class="term-fg32">+	require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	wrappedTxData := &amp;types.LegacyTx{</span>
<span class="term-fg32">+		Nonce:    0,</span>
<span class="term-fg32">+		To:       &amp;mevShareAddress,</span>
<span class="term-fg32">+		Value:    nil,</span>
<span class="term-fg32">+		Gas:      1000069,</span>
<span class="term-fg32">+		GasPrice: big.NewInt(10),</span>
<span class="term-fg32">+		Data:     calldata,</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	offchainTx, err := types.SignTx(types.NewTx(&amp;types.OffchainTx{</span>
<span class="term-fg32">+		ExecutionNode: ethservice.AccountManager().Accounts()[0],</span>
<span class="term-fg32">+		Wrapped:       *types.NewTx(wrappedTxData),</span>
<span class="term-fg32">+	}), signer, testKey)</span>
<span class="term-fg32">+	require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	offchainTxBytes, err := offchainTx.MarshalBinary()</span>
<span class="term-fg32">+	require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; TODO : reusing this function selector from bid contract to avoid creating another ABI</span>
<span class="term-fg32">+	confidentialDataBytes, err := bundleBidAbi.Methods[&quot;fetchBidConfidentialBundleData&quot;].Outputs.Pack(bundleBytes)</span>
<span class="term-fg32">+	require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	var offchainTxHash common.Hash</span>
<span class="term-fg32">+	requireNoRpcError(t, rpc.Call(&amp;offchainTxHash, &quot;eth_sendRawTransaction&quot;, hexutil.Encode(offchainTxBytes), hexutil.Encode(confidentialDataBytes)))</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47;   1a. confirm submission</span>
<span class="term-fg32">+	block := progressChain(t, ethservice, ethservice.BlockChain().CurrentBlock())</span>
<span class="term-fg32">+	require.Equal(t, 1, len(block.Transactions()))</span>
<span class="term-fg32">+	&#47;&#47; check txn in block went to mev share</span>
<span class="term-fg32">+	require.Equal(t, block.Transactions()[0].To(), &amp;mevShareAddress)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; 2b. check logs emitted in the transaction</span>
<span class="term-fg32">+	var r *types.Receipt</span>
<span class="term-fg32">+	rpc.Call(&amp;r, &quot;eth_getTransactionReceipt&quot;, block.Transactions()[0].Hash())</span>
<span class="term-fg32">+	require.NotEmpty(t, r)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	t.Log(&quot;logs&quot;, r.Logs)</span>
<span class="term-fg32">+	require.NoError(t, err)</span>
<span class="term-fg32">+	require.NotEmpty(t, r.Logs)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; extract share BidId</span>
<span class="term-fg32">+	unpacked, err := matchBidAbi.Events[&quot;HintEvent&quot;].Inputs.Unpack(r.Logs[1].Data)</span>
<span class="term-fg32">+	require.NoError(t, err)</span>
<span class="term-fg32">+	shareBidId := unpacked[0].([16]byte)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; ************ 2. Match Portion ************</span>
<span class="term-fg32">+	backrunTx, err := types.SignTx(types.NewTx(&amp;types.LegacyTx{</span>
<span class="term-fg32">+		Nonce:    0,</span>
<span class="term-fg32">+		To:       &amp;testAddr,</span>
<span class="term-fg32">+		Value:    big.NewInt(1000),</span>
<span class="term-fg32">+		Gas:      21420,</span>
<span class="term-fg32">+		GasPrice: big.NewInt(13),</span>
<span class="term-fg32">+		Data:     []byte{},</span>
<span class="term-fg32">+	}), signer, testKey2)</span>
<span class="term-fg32">+	require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	backRunBundle := types.SBundle{</span>
<span class="term-fg32">+		Txs:             types.Transactions{backrunTx},</span>
<span class="term-fg32">+		RevertingHashes: []common.Hash{},</span>
<span class="term-fg32">+		MatchId:         shareBidId,</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	backRunBundleBytes, err := json.Marshal(backRunBundle)</span>
<span class="term-fg32">+	require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; decryption conditions are assumed to be eth blocks right now</span>
<span class="term-fg32">+	backRunCalldata, err := matchBidAbi.Pack(&quot;newMatch&quot;, targetBlock+1, allowedPeekers, shareBidId)</span>
<span class="term-fg32">+	require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	wrappedMatchTxData := &amp;types.LegacyTx{</span>
<span class="term-fg32">+		Nonce:    1,</span>
<span class="term-fg32">+		To:       &amp;mevShareAddress,</span>
<span class="term-fg32">+		Value:    nil,</span>
<span class="term-fg32">+		Gas:      1000069,</span>
<span class="term-fg32">+		GasPrice: big.NewInt(10),</span>
<span class="term-fg32">+		Data:     backRunCalldata,</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	offchainMatchTx, err := types.SignTx(types.NewTx(&amp;types.OffchainTx{</span>
<span class="term-fg32">+		ExecutionNode: ethservice.AccountManager().Accounts()[0],</span>
<span class="term-fg32">+		Wrapped:       *types.NewTx(wrappedMatchTxData),</span>
<span class="term-fg32">+	}), signer, testKey)</span>
<span class="term-fg32">+	require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	offchainMatchTxBytes, err := offchainMatchTx.MarshalBinary()</span>
<span class="term-fg32">+	require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; TODO : reusing this function selector from bid contract to avoid creating another ABI</span>
<span class="term-fg32">+	confidentialDataMatchBytes, err := bundleBidAbi.Methods[&quot;fetchBidConfidentialBundleData&quot;].Outputs.Pack(backRunBundleBytes)</span>
<span class="term-fg32">+	require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	var offchainMatchTxHash common.Hash</span>
<span class="term-fg32">+	requireNoRpcError(t, rpc.Call(&amp;offchainMatchTxHash, &quot;eth_sendRawTransaction&quot;, hexutil.Encode(offchainMatchTxBytes), hexutil.Encode(confidentialDataMatchBytes)))</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	block = progressChain(t, ethservice, ethservice.BlockChain().CurrentBlock())</span>
<span class="term-fg32">+	require.Equal(t, 1, len(block.Transactions()))</span>
<span class="term-fg32">+	&#47;&#47; check txn in block went to mev share</span>
<span class="term-fg32">+	require.Equal(t, block.Transactions()[0].To(), &amp;mevShareAddress)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	var r2 *types.Receipt</span>
<span class="term-fg32">+	rpc.Call(&amp;r2, &quot;eth_getTransactionReceipt&quot;, block.Transactions()[0].Hash())</span>
<span class="term-fg32">+	require.NotEmpty(t, r2)</span>
<span class="term-fg32">+	require.NotEmpty(t, r.Logs)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	t.Log(&quot;logs&quot;, r2.Logs)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; ************ 3. Build Share Block ************</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	ethHead := ethEthService.BlockChain().CurrentBlock()</span>
<span class="term-fg32">+	payloadArgsTuple := struct {</span>
<span class="term-fg32">+		Slot           uint64</span>
<span class="term-fg32">+		ProposerPubkey []byte</span>
<span class="term-fg32">+		Parent         common.Hash</span>
<span class="term-fg32">+		Timestamp      uint64</span>
<span class="term-fg32">+		FeeRecipient   common.Address</span>
<span class="term-fg32">+		GasLimit       uint64</span>
<span class="term-fg32">+		Random         common.Hash</span>
<span class="term-fg32">+		Withdrawals    []struct {</span>
<span class="term-fg32">+			Index     uint64</span>
<span class="term-fg32">+			Validator uint64</span>
<span class="term-fg32">+			Address   common.Address</span>
<span class="term-fg32">+			Amount    uint64</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}{</span>
<span class="term-fg32">+		Timestamp:    ethHead.Time + uint64(12),</span>
<span class="term-fg32">+		FeeRecipient: common.Address{0x42},</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	calldata, err = buildEthBlockAbi.Pack(&quot;buildMevShare&quot;, payloadArgsTuple, targetBlock+1)</span>
<span class="term-fg32">+	require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	wrappedTxDataBB := &amp;types.LegacyTx{</span>
<span class="term-fg32">+		Nonce:    2,</span>
<span class="term-fg32">+		To:       &amp;newBlockBidAddress,</span>
<span class="term-fg32">+		Value:    nil,</span>
<span class="term-fg32">+		Gas:      1000000,</span>
<span class="term-fg32">+		GasPrice: big.NewInt(10),</span>
<span class="term-fg32">+		Data:     calldata,</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	offchainTxBB, err := types.SignTx(types.NewTx(&amp;types.OffchainTx{</span>
<span class="term-fg32">+		ExecutionNode: ethservice.AccountManager().Accounts()[0],</span>
<span class="term-fg32">+		Wrapped:       *types.NewTx(wrappedTxDataBB),</span>
<span class="term-fg32">+	}), signer, testKey)</span>
<span class="term-fg32">+	require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	offchainTxBytesBB, err := offchainTxBB.MarshalBinary()</span>
<span class="term-fg32">+	require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	var offchainTxHashBB common.Hash</span>
<span class="term-fg32">+	requireNoRpcError(t, rpc.Call(&amp;offchainTxHashBB, &quot;eth_sendRawTransaction&quot;, hexutil.Encode(offchainTxBytesBB)))</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	block = progressChain(t, ethservice, block.Header())</span>
<span class="term-fg32">+	require.Equal(t, 1, len(block.Transactions()))</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	var r3 *types.Receipt</span>
<span class="term-fg32">+	requireNoRpcError(t, rpc.Call(&amp;r3, &quot;eth_getTransactionReceipt&quot;, block.Transactions()[0].Hash()))</span>
<span class="term-fg32">+	require.NotEmpty(t, r3.Logs)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	{ &#47;&#47; Fetch the built block id and check that the payload contains mev share trasnactions!</span>
<span class="term-fg32">+		receipts := ethservice.BlockChain().GetReceiptsByHash(block.Hash())</span>
<span class="term-fg32">+		require.Equal(t, 1, len(receipts))</span>
<span class="term-fg32">+		require.Equal(t, uint8(types.OffchainExecutedTxType), receipts[0].Type)</span>
<span class="term-fg32">+		require.Equal(t, uint64(1), receipts[0].Status)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		require.Equal(t, 2, len(receipts[0].Logs))</span>
<span class="term-fg32">+		require.NotNil(t, receipts[0].Logs[1])</span>
<span class="term-fg32">+		unpacked, err := bundleBidAbi.Events[&quot;BidEvent&quot;].Inputs.Unpack(receipts[0].Logs[1].Data)</span>
<span class="term-fg32">+		require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		bidId := unpacked[0].([16]byte)</span>
<span class="term-fg32">+		payloadData, err := ethservice.APIBackend.OffchainBackend().ConfiendialStoreBackend.Retrieve(bidId, newBlockBidAddress, &quot;default:v0:builderPayload&quot;)</span>
<span class="term-fg32">+		require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		var payloadEnvelope engine.ExecutionPayloadEnvelope</span>
<span class="term-fg32">+		require.NoError(t, json.Unmarshal(payloadData, &amp;payloadEnvelope))</span>
<span class="term-fg32">+		require.Equal(t, 4, len(payloadEnvelope.ExecutionPayload.Transactions)) &#47;&#47; users tx, backrun, user refund, proposer payment</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		ethBlock, err := engine.ExecutableDataToBlock(*payloadEnvelope.ExecutionPayload)</span>
<span class="term-fg32">+		require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		require.Equal(t, ethTx.Hash(), ethBlock.Transactions()[0].Hash())</span>
<span class="term-fg32">+		require.Equal(t, backrunTx.Hash(), ethBlock.Transactions()[1].Hash())</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		userAddr, err := signer.Sender(ethTx)</span>
<span class="term-fg32">+		require.NoError(t, err)</span>
<span class="term-fg32">+		require.Equal(t, userAddr, *ethBlock.Transactions()[2].To())</span>
<span class="term-fg32">+		require.Equal(t, common.Address{0x42}, *ethBlock.Transactions()[3].To())</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func TestBlockBuildingPrecompiles(t *testing.T) {</span>
<span class="term-fg32">+	ethNode, ethEthService := startEthService(t, testEthGenesis, nil)</span>
<span class="term-fg32">+	defer ethNode.Close()</span>
<span class="term-fg32">+	ethEthService.APIs()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	node, ethservice := startSuethService(t, testSuaveGenesis, nil, suave.Config{SuaveEthRemoteBackendEndpoint: &quot;http:&#47;&#47;127.0.0.1:8596&quot;})</span>
<span class="term-fg32">+	defer node.Close()</span>
<span class="term-fg32">+	ethservice.APIs()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	rpc, err := node.Attach()</span>
<span class="term-fg32">+	require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	gas := hexutil.Uint64(1000000)</span>
<span class="term-fg32">+	chainId := hexutil.Big(*testSuaveGenesis.Config.ChainID)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	ctx, cancel := context.WithDeadline(context.Background(), time.Now().Add(time.Second))</span>
<span class="term-fg32">+	defer cancel()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	ethTx, err := types.SignTx(types.NewTx(&amp;types.LegacyTx{</span>
<span class="term-fg32">+		Nonce:    0,</span>
<span class="term-fg32">+		To:       &amp;testAddr,</span>
<span class="term-fg32">+		Value:    big.NewInt(1000),</span>
<span class="term-fg32">+		Gas:      21000,</span>
<span class="term-fg32">+		GasPrice: big.NewInt(13),</span>
<span class="term-fg32">+		Data:     []byte{},</span>
<span class="term-fg32">+	}), signer, testKey)</span>
<span class="term-fg32">+	require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	bundle := struct {</span>
<span class="term-fg32">+		Txs             types.Transactions `json:&quot;txs&quot;`</span>
<span class="term-fg32">+		RevertingHashes []common.Hash      `json:&quot;revertingHashes&quot;`</span>
<span class="term-fg32">+	}{</span>
<span class="term-fg32">+		Txs:             types.Transactions{ethTx},</span>
<span class="term-fg32">+		RevertingHashes: []common.Hash{},</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	bundleBytes, err := json.Marshal(bundle)</span>
<span class="term-fg32">+	require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	{ &#47;&#47; Test the bundle simulation precompile through eth_call</span>
<span class="term-fg32">+		var simResult hexutil.Bytes</span>
<span class="term-fg32">+		requireNoRpcError(t, rpc.CallContext(ctx, &amp;simResult, &quot;eth_call&quot;, ethapi.TransactionArgs{</span>
<span class="term-fg32">+			To:         &amp;simulateBundleAddress,</span>
<span class="term-fg32">+			Gas:        &amp;gas,</span>
<span class="term-fg32">+			IsOffchain: true,</span>
<span class="term-fg32">+			ChainID:    &amp;chainId,</span>
<span class="term-fg32">+			Data:       (*hexutil.Bytes)(&amp;bundleBytes),</span>
<span class="term-fg32">+		}, &quot;latest&quot;))</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		require.Equal(t, 32, len(simResult))</span>
<span class="term-fg32">+		require.Equal(t, 13, int(simResult[31]))</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	{ &#47;&#47; Test the block building precompile through eth_call</span>
<span class="term-fg32">+		&#47;&#47; function buildEthBlock(BuildBlockArgs memory blockArgs, BidId bid) internal view returns (bytes memory, bytes memory) {</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		bid := suave.Bid{</span>
<span class="term-fg32">+			Id:                  suave.BidId(uuid.New()),</span>
<span class="term-fg32">+			DecryptionCondition: uint64(1),</span>
<span class="term-fg32">+			AllowedPeekers:      []common.Address{{0x41, 0x42, 0x43}, buildEthBlockAddress},</span>
<span class="term-fg32">+			Version:             &quot;default:v0:ethBundles&quot;,</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		ethservice.APIBackend.OffchainBackend().MempoolBackend.SubmitBid(bid)</span>
<span class="term-fg32">+		ethservice.APIBackend.OffchainBackend().ConfiendialStoreBackend.Initialize(bid, &quot;default:v0:ethBundles&quot;, bundleBytes)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		ethHead := ethEthService.BlockChain().CurrentBlock()</span>
<span class="term-fg32">+		payloadArgsTuple := struct {</span>
<span class="term-fg32">+			Slot           uint64</span>
<span class="term-fg32">+			ProposerPubkey []byte</span>
<span class="term-fg32">+			Parent         common.Hash</span>
<span class="term-fg32">+			Timestamp      uint64</span>
<span class="term-fg32">+			FeeRecipient   common.Address</span>
<span class="term-fg32">+			GasLimit       uint64</span>
<span class="term-fg32">+			Random         common.Hash</span>
<span class="term-fg32">+			Withdrawals    []struct {</span>
<span class="term-fg32">+				Index     uint64</span>
<span class="term-fg32">+				Validator uint64</span>
<span class="term-fg32">+				Address   common.Address</span>
<span class="term-fg32">+				Amount    uint64</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+		}{</span>
<span class="term-fg32">+			Timestamp:    ethHead.Time + uint64(12),</span>
<span class="term-fg32">+			FeeRecipient: common.Address{0x42},</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		packed, err := suaveLibAbi.Methods[&quot;buildEthBlock&quot;].Inputs.Pack(payloadArgsTuple, bid.Id, &quot;&quot;)</span>
<span class="term-fg32">+		require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		var simResult hexutil.Bytes</span>
<span class="term-fg32">+		requireNoRpcError(t, rpc.CallContext(ctx, &amp;simResult, &quot;eth_call&quot;, ethapi.TransactionArgs{</span>
<span class="term-fg32">+			To:         &amp;buildEthBlockAddress,</span>
<span class="term-fg32">+			Gas:        &amp;gas,</span>
<span class="term-fg32">+			IsOffchain: true,</span>
<span class="term-fg32">+			ChainID:    &amp;chainId,</span>
<span class="term-fg32">+			Data:       (*hexutil.Bytes)(&amp;packed),</span>
<span class="term-fg32">+		}, &quot;latest&quot;))</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		require.NotNil(t, simResult)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		unpacked, err := suaveLibAbi.Methods[&quot;buildEthBlock&quot;].Outputs.Unpack(simResult)</span>
<span class="term-fg32">+		require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		&#47;&#47; TODO: test builder bid</span>
<span class="term-fg32">+		var envelope *engine.ExecutionPayloadEnvelope</span>
<span class="term-fg32">+		require.NoError(t, json.Unmarshal(unpacked[1].([]byte), &amp;envelope))</span>
<span class="term-fg32">+		require.Equal(t, 2, len(envelope.ExecutionPayload.Transactions))</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		var tx types.Transaction</span>
<span class="term-fg32">+		require.NoError(t, tx.UnmarshalBinary(envelope.ExecutionPayload.Transactions[0]))</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		require.Equal(t, ethTx.Data(), tx.Data())</span>
<span class="term-fg32">+		require.Equal(t, ethTx.Hash(), tx.Hash())</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func TestBlockBuildingContract(t *testing.T) {</span>
<span class="term-fg32">+	ethNode, ethEthService := startEthService(t, testEthGenesis, nil)</span>
<span class="term-fg32">+	defer ethNode.Close()</span>
<span class="term-fg32">+	ethEthService.APIs()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	node, ethservice := startSuethService(t, testSuaveGenesis, nil, suave.Config{SuaveEthRemoteBackendEndpoint: &quot;http:&#47;&#47;127.0.0.1:8596&quot;})</span>
<span class="term-fg32">+	defer node.Close()</span>
<span class="term-fg32">+	ethservice.APIs()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	rpc, err := node.Attach()</span>
<span class="term-fg32">+	require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; ctx, cancel := context.WithDeadline(context.Background(), time.Now().Add(time.Second))</span>
<span class="term-fg32">+	&#47;&#47; defer cancel()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	ethTx, err := types.SignTx(types.NewTx(&amp;types.LegacyTx{</span>
<span class="term-fg32">+		Nonce:    0,</span>
<span class="term-fg32">+		To:       &amp;testAddr,</span>
<span class="term-fg32">+		Value:    big.NewInt(1000),</span>
<span class="term-fg32">+		Gas:      21000,</span>
<span class="term-fg32">+		GasPrice: big.NewInt(13),</span>
<span class="term-fg32">+		Data:     []byte{},</span>
<span class="term-fg32">+	}), signer, testKey)</span>
<span class="term-fg32">+	require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	bundle := struct {</span>
<span class="term-fg32">+		Txs             types.Transactions `json:&quot;txs&quot;`</span>
<span class="term-fg32">+		RevertingHashes []common.Hash      `json:&quot;revertingHashes&quot;`</span>
<span class="term-fg32">+	}{</span>
<span class="term-fg32">+		Txs:             types.Transactions{ethTx},</span>
<span class="term-fg32">+		RevertingHashes: []common.Hash{},</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	bundleBytes, err := json.Marshal(bundle)</span>
<span class="term-fg32">+	require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	targetBlock := uint64(1)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	{ &#47;&#47; Send a bundle bid</span>
<span class="term-fg32">+		allowedPeekers := []common.Address{newBlockBidAddress, newBundleBidAddress, buildEthBlockAddress}</span>
<span class="term-fg32">+		calldata, err := bundleBidAbi.Pack(&quot;newBid&quot;, targetBlock+1, allowedPeekers)</span>
<span class="term-fg32">+		require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		wrappedTxData := &amp;types.LegacyTx{</span>
<span class="term-fg32">+			Nonce:    0,</span>
<span class="term-fg32">+			To:       &amp;newBundleBidAddress,</span>
<span class="term-fg32">+			Value:    nil,</span>
<span class="term-fg32">+			Gas:      1000000,</span>
<span class="term-fg32">+			GasPrice: big.NewInt(10),</span>
<span class="term-fg32">+			Data:     calldata,</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		offchainTx, err := types.SignTx(types.NewTx(&amp;types.OffchainTx{</span>
<span class="term-fg32">+			ExecutionNode: ethservice.AccountManager().Accounts()[0],</span>
<span class="term-fg32">+			Wrapped:       *types.NewTx(wrappedTxData),</span>
<span class="term-fg32">+		}), signer, testKey)</span>
<span class="term-fg32">+		require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		offchainTxBytes, err := offchainTx.MarshalBinary()</span>
<span class="term-fg32">+		require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		confidentialDataBytes, err := bundleBidAbi.Methods[&quot;fetchBidConfidentialBundleData&quot;].Outputs.Pack(bundleBytes)</span>
<span class="term-fg32">+		require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		var offchainTxHash common.Hash</span>
<span class="term-fg32">+		requireNoRpcError(t, rpc.Call(&amp;offchainTxHash, &quot;eth_sendRawTransaction&quot;, hexutil.Encode(offchainTxBytes), hexutil.Encode(confidentialDataBytes)))</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	block := progressChain(t, ethservice, ethservice.BlockChain().CurrentBlock())</span>
<span class="term-fg32">+	require.Equal(t, 1, len(block.Transactions()))</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	{</span>
<span class="term-fg32">+		ethHead := ethEthService.BlockChain().CurrentBlock()</span>
<span class="term-fg32">+		payloadArgsTuple := struct {</span>
<span class="term-fg32">+			Slot           uint64</span>
<span class="term-fg32">+			ProposerPubkey []byte</span>
<span class="term-fg32">+			Parent         common.Hash</span>
<span class="term-fg32">+			Timestamp      uint64</span>
<span class="term-fg32">+			FeeRecipient   common.Address</span>
<span class="term-fg32">+			GasLimit       uint64</span>
<span class="term-fg32">+			Random         common.Hash</span>
<span class="term-fg32">+			Withdrawals    []struct {</span>
<span class="term-fg32">+				Index     uint64</span>
<span class="term-fg32">+				Validator uint64</span>
<span class="term-fg32">+				Address   common.Address</span>
<span class="term-fg32">+				Amount    uint64</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+		}{</span>
<span class="term-fg32">+			ProposerPubkey: []byte{0x42},</span>
<span class="term-fg32">+			Timestamp:      ethHead.Time + uint64(12),</span>
<span class="term-fg32">+			FeeRecipient:   common.Address{0x42},</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		calldata, err := buildEthBlockAbi.Pack(&quot;buildFromPool&quot;, payloadArgsTuple, targetBlock+1)</span>
<span class="term-fg32">+		require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		wrappedTxData := &amp;types.LegacyTx{</span>
<span class="term-fg32">+			Nonce:    1,</span>
<span class="term-fg32">+			To:       &amp;newBlockBidAddress,</span>
<span class="term-fg32">+			Value:    nil,</span>
<span class="term-fg32">+			Gas:      1000000,</span>
<span class="term-fg32">+			GasPrice: big.NewInt(10),</span>
<span class="term-fg32">+			Data:     calldata,</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		offchainTx, err := types.SignTx(types.NewTx(&amp;types.OffchainTx{</span>
<span class="term-fg32">+			ExecutionNode: ethservice.AccountManager().Accounts()[0],</span>
<span class="term-fg32">+			Wrapped:       *types.NewTx(wrappedTxData),</span>
<span class="term-fg32">+		}), signer, testKey)</span>
<span class="term-fg32">+		require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		offchainTxBytes, err := offchainTx.MarshalBinary()</span>
<span class="term-fg32">+		require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		var offchainTxHash common.Hash</span>
<span class="term-fg32">+		requireNoRpcError(t, rpc.Call(&amp;offchainTxHash, &quot;eth_sendRawTransaction&quot;, hexutil.Encode(offchainTxBytes)))</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		block = progressChain(t, ethservice, block.Header())</span>
<span class="term-fg32">+		require.Equal(t, 1, len(block.Transactions()))</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func TestRelayBlockSubmissionContract(t *testing.T) {</span>
<span class="term-fg32">+	ethNode, ethEthService := startEthService(t, testEthGenesis, nil)</span>
<span class="term-fg32">+	defer ethNode.Close()</span>
<span class="term-fg32">+	ethEthService.APIs()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	node, ethservice := startSuethService(t, testSuaveGenesis, nil, suave.Config{SuaveEthRemoteBackendEndpoint: &quot;http:&#47;&#47;127.0.0.1:8596&quot;})</span>
<span class="term-fg32">+	defer node.Close()</span>
<span class="term-fg32">+	ethservice.APIs()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	rpc, err := node.Attach()</span>
<span class="term-fg32">+	require.NoError(t, err)</span>
<span class="term-fg32">+	var block *types.Block</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	var ethBlockBidSenderAddr common.Address</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	var blockPayloadSentToRelay *builderCapella.SubmitBlockRequest = &amp;builderCapella.SubmitBlockRequest{}</span>
<span class="term-fg32">+	serveHttp := func(t *testing.T, w http.ResponseWriter, r *http.Request) {</span>
<span class="term-fg32">+		bodyBytes, err := io.ReadAll(r.Body)</span>
<span class="term-fg32">+		require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		err = json.Unmarshal(bodyBytes, blockPayloadSentToRelay)</span>
<span class="term-fg32">+		if err != nil {</span>
<span class="term-fg32">+			blockPayloadSentToRelay = nil</span>
<span class="term-fg32">+			require.NoError(t, err)</span>
<span class="term-fg32">+			w.WriteHeader(http.StatusBadRequest)</span>
<span class="term-fg32">+			return</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		w.WriteHeader(http.StatusOK)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	testHandler := &amp;fakeRelayHandler{t, serveHttp}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	fakeRelayServer := httptest.NewServer(testHandler)</span>
<span class="term-fg32">+	defer fakeRelayServer.Close()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	{ &#47;&#47; Deploy the contract</span>
<span class="term-fg32">+		abiEncodedRelayUrl, err := ethBlockBidSenderAbi.Pack(&quot;&quot;, fakeRelayServer.URL)</span>
<span class="term-fg32">+		require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		calldata := append(hexutil.MustDecode(blockBidSenderContractCode), abiEncodedRelayUrl...)</span>
<span class="term-fg32">+		ccTxData := &amp;types.LegacyTx{</span>
<span class="term-fg32">+			Nonce:    0,</span>
<span class="term-fg32">+			To:       nil, &#47;&#47; contract creation</span>
<span class="term-fg32">+			Value:    big.NewInt(0),</span>
<span class="term-fg32">+			Gas:      10000000,</span>
<span class="term-fg32">+			GasPrice: big.NewInt(10),</span>
<span class="term-fg32">+			Data:     calldata,</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		tx, err := types.SignTx(types.NewTx(ccTxData), signer, testKey)</span>
<span class="term-fg32">+		require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		from, _ := types.Sender(signer, tx)</span>
<span class="term-fg32">+		ethBlockBidSenderAddr = crypto.CreateAddress(from, tx.Nonce())</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		txBytes, err := tx.MarshalBinary()</span>
<span class="term-fg32">+		require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		var txHash common.Hash</span>
<span class="term-fg32">+		requireNoRpcError(t, rpc.Call(&amp;txHash, &quot;eth_sendRawTransaction&quot;, hexutil.Encode(txBytes)))</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		block = progressChain(t, ethservice, ethservice.BlockChain().CurrentBlock())</span>
<span class="term-fg32">+		require.Equal(t, 1, len(block.Transactions()))</span>
<span class="term-fg32">+		receipts := ethservice.BlockChain().GetReceiptsByHash(block.Hash())</span>
<span class="term-fg32">+		require.Equal(t, uint64(1), receipts[0].Status)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	ethTx, err := types.SignTx(types.NewTx(&amp;types.LegacyTx{</span>
<span class="term-fg32">+		Nonce:    0,</span>
<span class="term-fg32">+		To:       &amp;testAddr,</span>
<span class="term-fg32">+		Value:    big.NewInt(1000),</span>
<span class="term-fg32">+		Gas:      21000,</span>
<span class="term-fg32">+		GasPrice: big.NewInt(13),</span>
<span class="term-fg32">+		Data:     []byte{},</span>
<span class="term-fg32">+	}), signer, testKey)</span>
<span class="term-fg32">+	require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	bundle := struct {</span>
<span class="term-fg32">+		Txs             types.Transactions `json:&quot;txs&quot;`</span>
<span class="term-fg32">+		RevertingHashes []common.Hash      `json:&quot;revertingHashes&quot;`</span>
<span class="term-fg32">+	}{</span>
<span class="term-fg32">+		Txs:             types.Transactions{ethTx},</span>
<span class="term-fg32">+		RevertingHashes: []common.Hash{},</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	bundleBytes, err := json.Marshal(bundle)</span>
<span class="term-fg32">+	require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	targetBlock := uint64(1)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	{ &#47;&#47; Send a bundle bid</span>
<span class="term-fg32">+		allowedPeekers := []common.Address{ethBlockBidSenderAddr, newBundleBidAddress, buildEthBlockAddress}</span>
<span class="term-fg32">+		calldata, err := bundleBidAbi.Pack(&quot;newBid&quot;, targetBlock+1, allowedPeekers)</span>
<span class="term-fg32">+		require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		wrappedTxData := &amp;types.LegacyTx{</span>
<span class="term-fg32">+			Nonce:    1,</span>
<span class="term-fg32">+			To:       &amp;newBundleBidAddress,</span>
<span class="term-fg32">+			Value:    nil,</span>
<span class="term-fg32">+			Gas:      1000000,</span>
<span class="term-fg32">+			GasPrice: big.NewInt(10),</span>
<span class="term-fg32">+			Data:     calldata,</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		offchainTx, err := types.SignTx(types.NewTx(&amp;types.OffchainTx{</span>
<span class="term-fg32">+			ExecutionNode: ethservice.AccountManager().Accounts()[0],</span>
<span class="term-fg32">+			Wrapped:       *types.NewTx(wrappedTxData),</span>
<span class="term-fg32">+		}), signer, testKey)</span>
<span class="term-fg32">+		require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		offchainTxBytes, err := offchainTx.MarshalBinary()</span>
<span class="term-fg32">+		require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		confidentialDataBytes, err := bundleBidAbi.Methods[&quot;fetchBidConfidentialBundleData&quot;].Outputs.Pack(bundleBytes)</span>
<span class="term-fg32">+		require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		var offchainTxHash common.Hash</span>
<span class="term-fg32">+		requireNoRpcError(t, rpc.Call(&amp;offchainTxHash, &quot;eth_sendRawTransaction&quot;, hexutil.Encode(offchainTxBytes), hexutil.Encode(confidentialDataBytes)))</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	block = progressChain(t, ethservice, ethservice.BlockChain().CurrentBlock())</span>
<span class="term-fg32">+	require.Equal(t, 1, len(block.Transactions()))</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	{</span>
<span class="term-fg32">+		ethHead := ethEthService.BlockChain().CurrentBlock()</span>
<span class="term-fg32">+		payloadArgsTuple := struct {</span>
<span class="term-fg32">+			Slot           uint64</span>
<span class="term-fg32">+			ProposerPubkey []byte</span>
<span class="term-fg32">+			Parent         common.Hash</span>
<span class="term-fg32">+			Timestamp      uint64</span>
<span class="term-fg32">+			FeeRecipient   common.Address</span>
<span class="term-fg32">+			GasLimit       uint64</span>
<span class="term-fg32">+			Random         common.Hash</span>
<span class="term-fg32">+			Withdrawals    []struct {</span>
<span class="term-fg32">+				Index     uint64</span>
<span class="term-fg32">+				Validator uint64</span>
<span class="term-fg32">+				Address   common.Address</span>
<span class="term-fg32">+				Amount    uint64</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+		}{</span>
<span class="term-fg32">+			ProposerPubkey: []byte{0x42},</span>
<span class="term-fg32">+			Timestamp:      ethHead.Time + uint64(12),</span>
<span class="term-fg32">+			FeeRecipient:   common.Address{0x42},</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		calldata, err := ethBlockBidSenderAbi.Pack(&quot;buildFromPool&quot;, payloadArgsTuple, targetBlock+1)</span>
<span class="term-fg32">+		require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		wrappedTxData := &amp;types.LegacyTx{</span>
<span class="term-fg32">+			Nonce:    2,</span>
<span class="term-fg32">+			To:       &amp;ethBlockBidSenderAddr,</span>
<span class="term-fg32">+			Value:    nil,</span>
<span class="term-fg32">+			Gas:      1000000,</span>
<span class="term-fg32">+			GasPrice: big.NewInt(10),</span>
<span class="term-fg32">+			Data:     calldata,</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		offchainTx, err := types.SignTx(types.NewTx(&amp;types.OffchainTx{</span>
<span class="term-fg32">+			ExecutionNode: ethservice.AccountManager().Accounts()[0],</span>
<span class="term-fg32">+			Wrapped:       *types.NewTx(wrappedTxData),</span>
<span class="term-fg32">+		}), signer, testKey)</span>
<span class="term-fg32">+		require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		offchainTxBytes, err := offchainTx.MarshalBinary()</span>
<span class="term-fg32">+		require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		var offchainTxHash common.Hash</span>
<span class="term-fg32">+		requireNoRpcError(t, rpc.Call(&amp;offchainTxHash, &quot;eth_sendRawTransaction&quot;, hexutil.Encode(offchainTxBytes)))</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		block = progressChain(t, ethservice, block.Header())</span>
<span class="term-fg32">+		require.Equal(t, 1, len(block.Transactions()))</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	require.NotNil(t, blockPayloadSentToRelay)</span>
<span class="term-fg32">+	require.NotNil(t, blockPayloadSentToRelay.ExecutionPayload)</span>
<span class="term-fg32">+	require.Equal(t, 2, len(blockPayloadSentToRelay.ExecutionPayload.Transactions)) &#47;&#47; Should be 2, including the proposer payment tx - todo</span>
<span class="term-fg32">+	ethTxBytes, _ := ethTx.MarshalBinary()</span>
<span class="term-fg32">+	require.Equal(t, bellatrixSpec.Transaction(ethTxBytes), blockPayloadSentToRelay.ExecutionPayload.Transactions[0])</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	require.Equal(t, bellatrixSpec.ExecutionAddress(common.Address{0x42}), blockPayloadSentToRelay.Message.ProposerFeeRecipient)</span>
<span class="term-fg32">+	require.Equal(t, phase0.BLSPubKey{0x42}, blockPayloadSentToRelay.Message.ProposerPubkey)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	builderPubkey := blockPayloadSentToRelay.Message.BuilderPubkey</span>
<span class="term-fg32">+	signature := blockPayloadSentToRelay.Signature</span>
<span class="term-fg32">+	builderSigningDomain := ssz.ComputeDomain(ssz.DomainTypeAppBuilder, phase0.Version{0x00, 0x00, 0x10, 0x20}, phase0.Root{})</span>
<span class="term-fg32">+	ok, err := ssz.VerifySignature(blockPayloadSentToRelay.Message, builderSigningDomain, builderPubkey[:], signature[:])</span>
<span class="term-fg32">+	require.NoError(t, err)</span>
<span class="term-fg32">+	require.True(t, ok)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; Utilities</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+var (</span>
<span class="term-fg32">+	&#47;&#47; testKey is a private key to use for funding a tester account.</span>
<span class="term-fg32">+	testKey, _ = crypto.HexToECDSA(&quot;b71c71a67e1177ad4e901695e1b4b9ee17ae16c6668d313eac2f96dbcda3f291&quot;)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; testAddr is the Ethereum address of the tester account.</span>
<span class="term-fg32">+	testAddr = crypto.PubkeyToAddress(testKey.PublicKey)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	testKey2, _ = crypto.HexToECDSA(&quot;a71c71a67e1177ad4e901695e1b4b9ee17ae16c6668d313eac2f96dbcda3f291&quot;)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; testAddr is the Ethereum address of the tester account.</span>
<span class="term-fg32">+	testAddr2 = crypto.PubkeyToAddress(testKey2.PublicKey)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	testBalance = big.NewInt(2e18)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	isOffchainAddress = common.HexToAddress(&quot;0x42010000&quot;)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; confidentialStoreAddress = common.HexToAddress(&quot;0x42020000&quot;)</span>
<span class="term-fg32">+	&#47;&#47; confStoreRetrieveAddress = common.HexToAddress(&quot;0x42020001&quot;)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	fetchBidsAddress    = common.HexToAddress(&quot;0x42030001&quot;)</span>
<span class="term-fg32">+	newBundleBidAddress = common.HexToAddress(&quot;0x42300000&quot;)</span>
<span class="term-fg32">+	newBlockBidAddress  = common.HexToAddress(&quot;0x42300001&quot;)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	simulateBundleAddress = common.HexToAddress(&quot;0x42100000&quot;)</span>
<span class="term-fg32">+	extractHintAddress    = common.HexToAddress(&quot;0x42100037&quot;)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	buildEthBlockAddress  = common.HexToAddress(&quot;0x42100001&quot;)</span>
<span class="term-fg32">+	blockBidSenderAddress = common.HexToAddress(&quot;0x42300002&quot;)</span>
<span class="term-fg32">+	mevShareAddress       = common.HexToAddress(&quot;0x42100073&quot;)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	testSuaveGenesis *core.Genesis = &amp;core.Genesis{</span>
<span class="term-fg32">+		Timestamp:  1680000000,</span>
<span class="term-fg32">+		ExtraData:  nil,</span>
<span class="term-fg32">+		GasLimit:   30000000,</span>
<span class="term-fg32">+		BaseFee:    big.NewInt(0),</span>
<span class="term-fg32">+		Difficulty: big.NewInt(0),</span>
<span class="term-fg32">+		Alloc: core.GenesisAlloc{</span>
<span class="term-fg32">+			testAddr:              {Balance: testBalance},</span>
<span class="term-fg32">+			testAddr2:             {Balance: testBalance},</span>
<span class="term-fg32">+			newBundleBidAddress:   {Balance: big.NewInt(0), Code: hexutil.MustDecode(bidsContractCode)},</span>
<span class="term-fg32">+			newBlockBidAddress:    {Balance: big.NewInt(0), Code: hexutil.MustDecode(blockBidContractCode)},</span>
<span class="term-fg32">+			blockBidSenderAddress: {Balance: big.NewInt(0), Code: hexutil.MustDecode(blockBidSenderContractCode)},</span>
<span class="term-fg32">+			mevShareAddress:       {Balance: big.NewInt(0), Code: hexutil.MustDecode(mevShareBidContractCode)},</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	testEthGenesis *core.Genesis = &amp;core.Genesis{</span>
<span class="term-fg32">+		Timestamp:  1680000000,</span>
<span class="term-fg32">+		ExtraData:  nil,</span>
<span class="term-fg32">+		GasLimit:   30000000,</span>
<span class="term-fg32">+		BaseFee:    big.NewInt(0),</span>
<span class="term-fg32">+		Difficulty: big.NewInt(0),</span>
<span class="term-fg32">+		Alloc: core.GenesisAlloc{</span>
<span class="term-fg32">+			testAddr:  {Balance: testBalance},</span>
<span class="term-fg32">+			testAddr2: {Balance: testBalance},</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	signer = types.NewOffchainSigner(params.AllEthashProtocolChanges.ChainID)</span>
<span class="term-fg32">+)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func init() {</span>
<span class="term-fg32">+	suaveConfig := *params.AllEthashProtocolChanges</span>
<span class="term-fg32">+	suaveConfig.TerminalTotalDifficulty = new(big.Int)</span>
<span class="term-fg32">+	testSuaveGenesis.Config = &amp;suaveConfig</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	ethConfig := *params.AllEthashProtocolChanges</span>
<span class="term-fg32">+	ethConfig.TerminalTotalDifficulty = new(big.Int)</span>
<span class="term-fg32">+	ethConfig.SuaveBlock = nil</span>
<span class="term-fg32">+	testEthGenesis.Config = &amp;ethConfig</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; startSuethService creates a full node instance for testing.</span>
<span class="term-fg32">+func startSuethService(t *testing.T, genesis *core.Genesis, blocks []*types.Block, suaveConfig suave.Config) (*node.Node, *eth.Ethereum) {</span>
<span class="term-fg32">+	t.Helper()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	n, err := node.New(&amp;node.Config{</span>
<span class="term-fg32">+		P2P: p2p.Config{</span>
<span class="term-fg32">+			ListenAddr:  &quot;0.0.0.0:0&quot;,</span>
<span class="term-fg32">+			NoDiscovery: true,</span>
<span class="term-fg32">+			MaxPeers:    25,</span>
<span class="term-fg32">+		}})</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		t.Fatal(&quot;can&#39;t create node:&quot;, err)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	ethcfg := &amp;ethconfig.Config{Genesis: genesis, SyncMode: downloader.FullSync, TrieTimeout: time.Minute, TrieDirtyCache: 256, TrieCleanCache: 256, Suave: suaveConfig}</span>
<span class="term-fg32">+	ethservice, err := eth.New(n, ethcfg)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		t.Fatal(&quot;can&#39;t create eth service:&quot;, err)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if err := n.Start(); err != nil {</span>
<span class="term-fg32">+		t.Fatal(&quot;can&#39;t start node:&quot;, err)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if _, err := ethservice.BlockChain().InsertChain(blocks); err != nil {</span>
<span class="term-fg32">+		n.Close()</span>
<span class="term-fg32">+		t.Fatal(&quot;can&#39;t import test blocks:&quot;, err)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	ethservice.SetEtherbase(testAddr)</span>
<span class="term-fg32">+	ethservice.SetSynced()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	keydir := t.TempDir()</span>
<span class="term-fg32">+	keystore := keystore.NewPlaintextKeyStore(keydir)</span>
<span class="term-fg32">+	acc, err := keystore.NewAccount(&quot;&quot;)</span>
<span class="term-fg32">+	require.NoError(t, err)</span>
<span class="term-fg32">+	require.NoError(t, keystore.TimedUnlock(acc, &quot;&quot;, time.Hour))</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	ethservice.AccountManager().AddBackend(keystore)</span>
<span class="term-fg32">+	return n, ethservice</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func startEthService(t *testing.T, genesis *core.Genesis, blocks []*types.Block) (*node.Node, *eth.Ethereum) {</span>
<span class="term-fg32">+	t.Helper()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	n, err := node.New(&amp;node.Config{</span>
<span class="term-fg32">+		HTTPHost: &quot;127.0.0.1&quot;,</span>
<span class="term-fg32">+		HTTPPort: 8596,</span>
<span class="term-fg32">+		P2P: p2p.Config{</span>
<span class="term-fg32">+			ListenAddr:  &quot;0.0.0.0:0&quot;,</span>
<span class="term-fg32">+			NoDiscovery: true,</span>
<span class="term-fg32">+			MaxPeers:    25,</span>
<span class="term-fg32">+		}})</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		t.Fatal(&quot;can&#39;t create node:&quot;, err)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	ethcfg := &amp;ethconfig.Config{Genesis: genesis, SyncMode: downloader.FullSync, TrieTimeout: time.Minute, TrieDirtyCache: 256, TrieCleanCache: 256}</span>
<span class="term-fg32">+	ethservice, err := eth.New(n, ethcfg)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		t.Fatal(&quot;can&#39;t create eth service:&quot;, err)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if err := n.Start(); err != nil {</span>
<span class="term-fg32">+		t.Fatal(&quot;can&#39;t start node:&quot;, err)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if _, err := ethservice.BlockChain().InsertChain(blocks); err != nil {</span>
<span class="term-fg32">+		n.Close()</span>
<span class="term-fg32">+		t.Fatal(&quot;can&#39;t import test blocks:&quot;, err)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	ethservice.SetEtherbase(testAddr)</span>
<span class="term-fg32">+	ethservice.SetSynced()</span>
<span class="term-fg32">+	return n, ethservice</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func progressChain(t *testing.T, ethservice *eth.Ethereum, parent *types.Header) *types.Block {</span>
<span class="term-fg32">+	payload, err := ethservice.Miner().BuildPayload(&amp;miner.BuildPayloadArgs{</span>
<span class="term-fg32">+		Parent:       parent.Hash(),</span>
<span class="term-fg32">+		Timestamp:    parent.Time + 12,</span>
<span class="term-fg32">+		FeeRecipient: testAddr,</span>
<span class="term-fg32">+	})</span>
<span class="term-fg32">+	require.NoError(t, err)</span>
<span class="term-fg32">+	envelope := payload.ResolveFull()</span>
<span class="term-fg32">+	block, err := engine.ExecutableDataToBlock(*envelope.ExecutionPayload)</span>
<span class="term-fg32">+	require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	n, err := ethservice.BlockChain().InsertChain(types.Blocks{block})</span>
<span class="term-fg32">+	require.NoError(t, err)</span>
<span class="term-fg32">+	require.Equal(t, 1, n)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	return block</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func requireNoRpcError(t *testing.T, rpcErr error) {</span>
<span class="term-fg32">+	if rpcErr != nil {</span>
<span class="term-fg32">+		if len(rpcErr.Error()) &lt; len(&quot;execution reverted: 0x&quot;) {</span>
<span class="term-fg32">+			require.NoError(t, rpcErr)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		decodedError, err := hexutil.Decode(rpcErr.Error()[len(&quot;execution reverted: &quot;):])</span>
<span class="term-fg32">+		if err != nil {</span>
<span class="term-fg32">+			require.NoError(t, rpcErr, err.Error())</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		if len(decodedError) &lt; 4 {</span>
<span class="term-fg32">+			require.NoError(t, rpcErr, decodedError)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		unpacked, err := suaveLibAbi.Errors[&quot;PeekerReverted&quot;].Inputs.Unpack(decodedError[4:])</span>
<span class="term-fg32">+		if err != nil {</span>
<span class="term-fg32">+			require.NoError(t, err, rpcErr.Error())</span>
<span class="term-fg32">+		} else {</span>
<span class="term-fg32">+			require.NoError(t, rpcErr, string(unpacked[1].([]byte)))</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+type fakeRelayHandler struct {</span>
<span class="term-fg32">+	t         *testing.T</span>
<span class="term-fg32">+	serveHttp func(t *testing.T, w http.ResponseWriter, r *http.Request)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (h *fakeRelayHandler) ServeHTTP(w http.ResponseWriter, r *http.Request) {</span>
<span class="term-fg32">+	h.serveHttp(h.t, w, r)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func mustParseMethodAbi(data string, method string) abi.Method {</span>
<span class="term-fg32">+	inoutAbi, err := abi.JSON(strings.NewReader(data))</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		panic(err.Error())</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	return inoutAbi.Methods[method]</span>
<span class="term-fg32">+}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-90bcec7659500cfecbf3749a" role="button"
                   aria-expanded="false" aria-controls="id-90bcec7659500cfecbf3749a">
                    <code>suave/e2e/contracts.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/suave/e2e/contracts.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+35</span></div>
                        <div class="text-start"><span class="text-danger">-0</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-90bcec7659500cfecbf3749a"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;suave&#47;e2e&#47;contracts.go flashbots&#47;suave-geth&#47;suave&#47;e2e&#47;contracts.go</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..f079a10d0f088f98c0fc16a5daf09f0da1430bc4</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;suave&#47;e2e&#47;contracts.go</span>
<span class="term-fg36">@@ -0,0 +1,35 @@</span>
<span class="term-fg32">+package main</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+import (</span>
<span class="term-fg32">+	&quot;strings&quot;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;accounts&#47;abi&quot;</span>
<span class="term-fg32">+)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func mustParseAbi(data string) abi.ABI {</span>
<span class="term-fg32">+	inoutAbi, err := abi.JSON(strings.NewReader(data))</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		panic(err.Error())</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	return inoutAbi</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+var (</span>
<span class="term-fg32">+	suaveLibAbi = mustParseAbi(`[ { &quot;inputs&quot;: [ { &quot;internalType&quot;: &quot;address&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;address&quot; }, { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;name&quot;: &quot;PeekerReverted&quot;, &quot;type&quot;: &quot;error&quot; }, { &quot;inputs&quot;: [ { &quot;components&quot;: [ { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;slot&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;proposerPubkey&quot;, &quot;type&quot;: &quot;bytes&quot; }, { &quot;internalType&quot;: &quot;bytes32&quot;, &quot;name&quot;: &quot;parent&quot;, &quot;type&quot;: &quot;bytes32&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;timestamp&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address&quot;, &quot;name&quot;: &quot;feeRecipient&quot;, &quot;type&quot;: &quot;address&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;gasLimit&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;bytes32&quot;, &quot;name&quot;: &quot;random&quot;, &quot;type&quot;: &quot;bytes32&quot; }, { &quot;components&quot;: [ { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;index&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;validator&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address&quot;, &quot;name&quot;: &quot;Address&quot;, &quot;type&quot;: &quot;address&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;amount&quot;, &quot;type&quot;: &quot;uint64&quot; } ], &quot;internalType&quot;: &quot;struct Suave.Withdrawal[]&quot;, &quot;name&quot;: &quot;withdrawals&quot;, &quot;type&quot;: &quot;tuple[]&quot; } ], &quot;internalType&quot;: &quot;struct Suave.BuildBlockArgs&quot;, &quot;name&quot;: &quot;blockArgs&quot;, &quot;type&quot;: &quot;tuple&quot; }, { &quot;internalType&quot;: &quot;Suave.BidId&quot;, &quot;name&quot;: &quot;bid&quot;, &quot;type&quot;: &quot;bytes16&quot; }, { &quot;internalType&quot;: &quot;string&quot;, &quot;name&quot;: &quot;namespace&quot;, &quot;type&quot;: &quot;string&quot; } ], &quot;name&quot;: &quot;buildEthBlock&quot;, &quot;outputs&quot;: [ { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;bytes&quot; }, { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;stateMutability&quot;: &quot;view&quot;, &quot;type&quot;: &quot;function&quot; }, { &quot;inputs&quot;: [ { &quot;internalType&quot;: &quot;Suave.BidId&quot;, &quot;name&quot;: &quot;bidId&quot;, &quot;type&quot;: &quot;bytes16&quot; }, { &quot;internalType&quot;: &quot;string&quot;, &quot;name&quot;: &quot;key&quot;, &quot;type&quot;: &quot;string&quot; } ], &quot;name&quot;: &quot;confidentialStoreRetrieve&quot;, &quot;outputs&quot;: [ { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;stateMutability&quot;: &quot;view&quot;, &quot;type&quot;: &quot;function&quot; }, { &quot;inputs&quot;: [ { &quot;internalType&quot;: &quot;Suave.BidId&quot;, &quot;name&quot;: &quot;bidId&quot;, &quot;type&quot;: &quot;bytes16&quot; }, { &quot;internalType&quot;: &quot;string&quot;, &quot;name&quot;: &quot;key&quot;, &quot;type&quot;: &quot;string&quot; }, { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;data&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;name&quot;: &quot;confidentialStoreStore&quot;, &quot;outputs&quot;: [], &quot;stateMutability&quot;: &quot;view&quot;, &quot;type&quot;: &quot;function&quot; }, { &quot;inputs&quot;: [ { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;bundleData&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;name&quot;: &quot;extractHint&quot;, &quot;outputs&quot;: [ { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;stateMutability&quot;: &quot;view&quot;, &quot;type&quot;: &quot;function&quot; }, { &quot;inputs&quot;: [ { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;cond&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;string&quot;, &quot;name&quot;: &quot;namespace&quot;, &quot;type&quot;: &quot;string&quot; } ], &quot;name&quot;: &quot;fetchBids&quot;, &quot;outputs&quot;: [ { &quot;components&quot;: [ { &quot;internalType&quot;: &quot;Suave.BidId&quot;, &quot;name&quot;: &quot;id&quot;, &quot;type&quot;: &quot;bytes16&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;decryptionCondition&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address[]&quot;, &quot;name&quot;: &quot;allowedPeekers&quot;, &quot;type&quot;: &quot;address[]&quot; } ], &quot;internalType&quot;: &quot;struct Suave.Bid[]&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;tuple[]&quot; } ], &quot;stateMutability&quot;: &quot;view&quot;, &quot;type&quot;: &quot;function&quot; }, { &quot;inputs&quot;: [ { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;decryptionCondition&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address[]&quot;, &quot;name&quot;: &quot;allowedPeekers&quot;, &quot;type&quot;: &quot;address[]&quot; }, { &quot;internalType&quot;: &quot;string&quot;, &quot;name&quot;: &quot;BidType&quot;, &quot;type&quot;: &quot;string&quot; } ], &quot;name&quot;: &quot;newBid&quot;, &quot;outputs&quot;: [ { &quot;components&quot;: [ { &quot;internalType&quot;: &quot;Suave.BidId&quot;, &quot;name&quot;: &quot;id&quot;, &quot;type&quot;: &quot;bytes16&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;decryptionCondition&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address[]&quot;, &quot;name&quot;: &quot;allowedPeekers&quot;, &quot;type&quot;: &quot;address[]&quot; } ], &quot;internalType&quot;: &quot;struct Suave.Bid&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;tuple&quot; } ], &quot;stateMutability&quot;: &quot;view&quot;, &quot;type&quot;: &quot;function&quot; }, { &quot;inputs&quot;: [ { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;bundleData&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;name&quot;: &quot;simulateBundle&quot;, &quot;outputs&quot;: [ { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;uint64&quot; } ], &quot;stateMutability&quot;: &quot;view&quot;, &quot;type&quot;: &quot;function&quot; }, { &quot;inputs&quot;: [ { &quot;internalType&quot;: &quot;string&quot;, &quot;name&quot;: &quot;relayUrl&quot;, &quot;type&quot;: &quot;string&quot; }, { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;builderBid&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;name&quot;: &quot;submitEthBlockBidToRelay&quot;, &quot;outputs&quot;: [ { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;stateMutability&quot;: &quot;view&quot;, &quot;type&quot;: &quot;function&quot; } ]`)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	bundleBidAbi = mustParseAbi(`[ { &quot;inputs&quot;: [ { &quot;internalType&quot;: &quot;address&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;address&quot; }, { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;name&quot;: &quot;PeekerReverted&quot;, &quot;type&quot;: &quot;error&quot; }, { &quot;anonymous&quot;: false, &quot;inputs&quot;: [ { &quot;indexed&quot;: false, &quot;internalType&quot;: &quot;Suave.BidId&quot;, &quot;name&quot;: &quot;bidId&quot;, &quot;type&quot;: &quot;bytes16&quot; }, { &quot;indexed&quot;: false, &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;decryptionCondition&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;indexed&quot;: false, &quot;internalType&quot;: &quot;address[]&quot;, &quot;name&quot;: &quot;allowedPeekers&quot;, &quot;type&quot;: &quot;address[]&quot; } ], &quot;name&quot;: &quot;BidEvent&quot;, &quot;type&quot;: &quot;event&quot; }, { &quot;inputs&quot;: [ { &quot;components&quot;: [ { &quot;internalType&quot;: &quot;Suave.BidId&quot;, &quot;name&quot;: &quot;id&quot;, &quot;type&quot;: &quot;bytes16&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;decryptionCondition&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address[]&quot;, &quot;name&quot;: &quot;allowedPeekers&quot;, &quot;type&quot;: &quot;address[]&quot; } ], &quot;internalType&quot;: &quot;struct Suave.Bid&quot;, &quot;name&quot;: &quot;bid&quot;, &quot;type&quot;: &quot;tuple&quot; } ], &quot;name&quot;: &quot;emitBid&quot;, &quot;outputs&quot;: [], &quot;stateMutability&quot;: &quot;nonpayable&quot;, &quot;type&quot;: &quot;function&quot; }, { &quot;inputs&quot;: [], &quot;name&quot;: &quot;fetchBidConfidentialBundleData&quot;, &quot;outputs&quot;: [ { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;stateMutability&quot;: &quot;view&quot;, &quot;type&quot;: &quot;function&quot; }, { &quot;inputs&quot;: [ { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;decryptionCondition&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address[]&quot;, &quot;name&quot;: &quot;bidAllowedPeekers&quot;, &quot;type&quot;: &quot;address[]&quot; } ], &quot;name&quot;: &quot;newBid&quot;, &quot;outputs&quot;: [ { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;stateMutability&quot;: &quot;payable&quot;, &quot;type&quot;: &quot;function&quot; } ]`)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	matchBidAbi = mustParseAbi(`[ { &quot;inputs&quot;: [ { &quot;internalType&quot;: &quot;address&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;address&quot; }, { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;name&quot;: &quot;PeekerReverted&quot;, &quot;type&quot;: &quot;error&quot; }, { &quot;anonymous&quot;: false, &quot;inputs&quot;: [ { &quot;indexed&quot;: false, &quot;internalType&quot;: &quot;Suave.BidId&quot;, &quot;name&quot;: &quot;bidId&quot;, &quot;type&quot;: &quot;bytes16&quot; }, { &quot;indexed&quot;: false, &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;decryptionCondition&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;indexed&quot;: false, &quot;internalType&quot;: &quot;address[]&quot;, &quot;name&quot;: &quot;allowedPeekers&quot;, &quot;type&quot;: &quot;address[]&quot; } ], &quot;name&quot;: &quot;BidEvent&quot;, &quot;type&quot;: &quot;event&quot; }, { &quot;anonymous&quot;: false, &quot;inputs&quot;: [ { &quot;indexed&quot;: false, &quot;internalType&quot;: &quot;Suave.BidId&quot;, &quot;name&quot;: &quot;bidId&quot;, &quot;type&quot;: &quot;bytes16&quot; }, { &quot;indexed&quot;: false, &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;hint&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;name&quot;: &quot;HintEvent&quot;, &quot;type&quot;: &quot;event&quot; }, { &quot;anonymous&quot;: false, &quot;inputs&quot;: [ { &quot;indexed&quot;: false, &quot;internalType&quot;: &quot;Suave.BidId&quot;, &quot;name&quot;: &quot;matchBidId&quot;, &quot;type&quot;: &quot;bytes16&quot; }, { &quot;indexed&quot;: false, &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;bidhint&quot;, &quot;type&quot;: &quot;bytes&quot; }, { &quot;indexed&quot;: false, &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;matchHint&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;name&quot;: &quot;MatchEvent&quot;, &quot;type&quot;: &quot;event&quot; }, { &quot;inputs&quot;: [ { &quot;components&quot;: [ { &quot;internalType&quot;: &quot;Suave.BidId&quot;, &quot;name&quot;: &quot;id&quot;, &quot;type&quot;: &quot;bytes16&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;decryptionCondition&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address[]&quot;, &quot;name&quot;: &quot;allowedPeekers&quot;, &quot;type&quot;: &quot;address[]&quot; } ], &quot;internalType&quot;: &quot;struct Suave.Bid&quot;, &quot;name&quot;: &quot;bid&quot;, &quot;type&quot;: &quot;tuple&quot; } ], &quot;name&quot;: &quot;emitBid&quot;, &quot;outputs&quot;: [], &quot;stateMutability&quot;: &quot;nonpayable&quot;, &quot;type&quot;: &quot;function&quot; }, { &quot;inputs&quot;: [ { &quot;components&quot;: [ { &quot;internalType&quot;: &quot;Suave.BidId&quot;, &quot;name&quot;: &quot;id&quot;, &quot;type&quot;: &quot;bytes16&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;decryptionCondition&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address[]&quot;, &quot;name&quot;: &quot;allowedPeekers&quot;, &quot;type&quot;: &quot;address[]&quot; } ], &quot;internalType&quot;: &quot;struct Suave.Bid&quot;, &quot;name&quot;: &quot;bid&quot;, &quot;type&quot;: &quot;tuple&quot; }, { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;hint&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;name&quot;: &quot;emitBidAndHint&quot;, &quot;outputs&quot;: [], &quot;stateMutability&quot;: &quot;nonpayable&quot;, &quot;type&quot;: &quot;function&quot; }, { &quot;inputs&quot;: [ { &quot;components&quot;: [ { &quot;internalType&quot;: &quot;Suave.BidId&quot;, &quot;name&quot;: &quot;id&quot;, &quot;type&quot;: &quot;bytes16&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;decryptionCondition&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address[]&quot;, &quot;name&quot;: &quot;allowedPeekers&quot;, &quot;type&quot;: &quot;address[]&quot; } ], &quot;internalType&quot;: &quot;struct Suave.Bid&quot;, &quot;name&quot;: &quot;bid&quot;, &quot;type&quot;: &quot;tuple&quot; }, { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;bidHint&quot;, &quot;type&quot;: &quot;bytes&quot; }, { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;matchHint&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;name&quot;: &quot;emitMatchBidAndHint&quot;, &quot;outputs&quot;: [], &quot;stateMutability&quot;: &quot;nonpayable&quot;, &quot;type&quot;: &quot;function&quot; }, { &quot;inputs&quot;: [], &quot;name&quot;: &quot;fetchBidConfidentialBundleData&quot;, &quot;outputs&quot;: [ { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;stateMutability&quot;: &quot;nonpayable&quot;, &quot;type&quot;: &quot;function&quot; }, { &quot;inputs&quot;: [ { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;decryptionCondition&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address[]&quot;, &quot;name&quot;: &quot;bidAllowedPeekers&quot;, &quot;type&quot;: &quot;address[]&quot; } ], &quot;name&quot;: &quot;newBid&quot;, &quot;outputs&quot;: [ { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;stateMutability&quot;: &quot;payable&quot;, &quot;type&quot;: &quot;function&quot; }, { &quot;inputs&quot;: [ { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;decryptionCondition&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address[]&quot;, &quot;name&quot;: &quot;bidAllowedPeekers&quot;, &quot;type&quot;: &quot;address[]&quot; }, { &quot;internalType&quot;: &quot;Suave.BidId&quot;, &quot;name&quot;: &quot;shareBidId&quot;, &quot;type&quot;: &quot;bytes16&quot; } ], &quot;name&quot;: &quot;newMatch&quot;, &quot;outputs&quot;: [ { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;stateMutability&quot;: &quot;payable&quot;, &quot;type&quot;: &quot;function&quot; } ]`)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	buildEthBlockAbi = mustParseAbi(`[ { &quot;inputs&quot;: [ { &quot;internalType&quot;: &quot;address&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;address&quot; }, { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;name&quot;: &quot;PeekerReverted&quot;, &quot;type&quot;: &quot;error&quot; }, { &quot;anonymous&quot;: false, &quot;inputs&quot;: [ { &quot;indexed&quot;: false, &quot;internalType&quot;: &quot;Suave.BidId&quot;, &quot;name&quot;: &quot;bidId&quot;, &quot;type&quot;: &quot;bytes16&quot; }, { &quot;indexed&quot;: false, &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;decryptionCondition&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;indexed&quot;: false, &quot;internalType&quot;: &quot;address[]&quot;, &quot;name&quot;: &quot;allowedPeekers&quot;, &quot;type&quot;: &quot;address[]&quot; } ], &quot;name&quot;: &quot;BidEvent&quot;, &quot;type&quot;: &quot;event&quot; }, { &quot;anonymous&quot;: false, &quot;inputs&quot;: [ { &quot;indexed&quot;: false, &quot;internalType&quot;: &quot;Suave.BidId&quot;, &quot;name&quot;: &quot;bidId&quot;, &quot;type&quot;: &quot;bytes16&quot; }, { &quot;indexed&quot;: false, &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;builderBid&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;name&quot;: &quot;BuilderBoostBidEvent&quot;, &quot;type&quot;: &quot;event&quot; }, { &quot;inputs&quot;: [ { &quot;components&quot;: [ { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;slot&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;proposerPubkey&quot;, &quot;type&quot;: &quot;bytes&quot; }, { &quot;internalType&quot;: &quot;bytes32&quot;, &quot;name&quot;: &quot;parent&quot;, &quot;type&quot;: &quot;bytes32&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;timestamp&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address&quot;, &quot;name&quot;: &quot;feeRecipient&quot;, &quot;type&quot;: &quot;address&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;gasLimit&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;bytes32&quot;, &quot;name&quot;: &quot;random&quot;, &quot;type&quot;: &quot;bytes32&quot; }, { &quot;components&quot;: [ { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;index&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;validator&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address&quot;, &quot;name&quot;: &quot;Address&quot;, &quot;type&quot;: &quot;address&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;amount&quot;, &quot;type&quot;: &quot;uint64&quot; } ], &quot;internalType&quot;: &quot;struct Suave.Withdrawal[]&quot;, &quot;name&quot;: &quot;withdrawals&quot;, &quot;type&quot;: &quot;tuple[]&quot; } ], &quot;internalType&quot;: &quot;struct Suave.BuildBlockArgs&quot;, &quot;name&quot;: &quot;blockArgs&quot;, &quot;type&quot;: &quot;tuple&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;blockHeight&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;Suave.BidId[]&quot;, &quot;name&quot;: &quot;bids&quot;, &quot;type&quot;: &quot;bytes16[]&quot; }, { &quot;internalType&quot;: &quot;string&quot;, &quot;name&quot;: &quot;namespace&quot;, &quot;type&quot;: &quot;string&quot; } ], &quot;name&quot;: &quot;buildAndEmit&quot;, &quot;outputs&quot;: [ { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;stateMutability&quot;: &quot;nonpayable&quot;, &quot;type&quot;: &quot;function&quot; }, { &quot;inputs&quot;: [ { &quot;components&quot;: [ { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;slot&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;proposerPubkey&quot;, &quot;type&quot;: &quot;bytes&quot; }, { &quot;internalType&quot;: &quot;bytes32&quot;, &quot;name&quot;: &quot;parent&quot;, &quot;type&quot;: &quot;bytes32&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;timestamp&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address&quot;, &quot;name&quot;: &quot;feeRecipient&quot;, &quot;type&quot;: &quot;address&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;gasLimit&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;bytes32&quot;, &quot;name&quot;: &quot;random&quot;, &quot;type&quot;: &quot;bytes32&quot; }, { &quot;components&quot;: [ { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;index&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;validator&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address&quot;, &quot;name&quot;: &quot;Address&quot;, &quot;type&quot;: &quot;address&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;amount&quot;, &quot;type&quot;: &quot;uint64&quot; } ], &quot;internalType&quot;: &quot;struct Suave.Withdrawal[]&quot;, &quot;name&quot;: &quot;withdrawals&quot;, &quot;type&quot;: &quot;tuple[]&quot; } ], &quot;internalType&quot;: &quot;struct Suave.BuildBlockArgs&quot;, &quot;name&quot;: &quot;blockArgs&quot;, &quot;type&quot;: &quot;tuple&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;blockHeight&quot;, &quot;type&quot;: &quot;uint64&quot; } ], &quot;name&quot;: &quot;buildFromPool&quot;, &quot;outputs&quot;: [ { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;stateMutability&quot;: &quot;nonpayable&quot;, &quot;type&quot;: &quot;function&quot; }, { &quot;inputs&quot;: [ { &quot;components&quot;: [ { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;slot&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;proposerPubkey&quot;, &quot;type&quot;: &quot;bytes&quot; }, { &quot;internalType&quot;: &quot;bytes32&quot;, &quot;name&quot;: &quot;parent&quot;, &quot;type&quot;: &quot;bytes32&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;timestamp&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address&quot;, &quot;name&quot;: &quot;feeRecipient&quot;, &quot;type&quot;: &quot;address&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;gasLimit&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;bytes32&quot;, &quot;name&quot;: &quot;random&quot;, &quot;type&quot;: &quot;bytes32&quot; }, { &quot;components&quot;: [ { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;index&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;validator&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address&quot;, &quot;name&quot;: &quot;Address&quot;, &quot;type&quot;: &quot;address&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;amount&quot;, &quot;type&quot;: &quot;uint64&quot; } ], &quot;internalType&quot;: &quot;struct Suave.Withdrawal[]&quot;, &quot;name&quot;: &quot;withdrawals&quot;, &quot;type&quot;: &quot;tuple[]&quot; } ], &quot;internalType&quot;: &quot;struct Suave.BuildBlockArgs&quot;, &quot;name&quot;: &quot;blockArgs&quot;, &quot;type&quot;: &quot;tuple&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;blockHeight&quot;, &quot;type&quot;: &quot;uint64&quot; } ], &quot;name&quot;: &quot;buildMevShare&quot;, &quot;outputs&quot;: [ { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;stateMutability&quot;: &quot;nonpayable&quot;, &quot;type&quot;: &quot;function&quot; }, { &quot;inputs&quot;: [ { &quot;components&quot;: [ { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;slot&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;proposerPubkey&quot;, &quot;type&quot;: &quot;bytes&quot; }, { &quot;internalType&quot;: &quot;bytes32&quot;, &quot;name&quot;: &quot;parent&quot;, &quot;type&quot;: &quot;bytes32&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;timestamp&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address&quot;, &quot;name&quot;: &quot;feeRecipient&quot;, &quot;type&quot;: &quot;address&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;gasLimit&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;bytes32&quot;, &quot;name&quot;: &quot;random&quot;, &quot;type&quot;: &quot;bytes32&quot; }, { &quot;components&quot;: [ { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;index&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;validator&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address&quot;, &quot;name&quot;: &quot;Address&quot;, &quot;type&quot;: &quot;address&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;amount&quot;, &quot;type&quot;: &quot;uint64&quot; } ], &quot;internalType&quot;: &quot;struct Suave.Withdrawal[]&quot;, &quot;name&quot;: &quot;withdrawals&quot;, &quot;type&quot;: &quot;tuple[]&quot; } ], &quot;internalType&quot;: &quot;struct Suave.BuildBlockArgs&quot;, &quot;name&quot;: &quot;blockArgs&quot;, &quot;type&quot;: &quot;tuple&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;blockHeight&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;Suave.BidId[]&quot;, &quot;name&quot;: &quot;bids&quot;, &quot;type&quot;: &quot;bytes16[]&quot; }, { &quot;internalType&quot;: &quot;string&quot;, &quot;name&quot;: &quot;namespace&quot;, &quot;type&quot;: &quot;string&quot; } ], &quot;name&quot;: &quot;doBuild&quot;, &quot;outputs&quot;: [ { &quot;components&quot;: [ { &quot;internalType&quot;: &quot;Suave.BidId&quot;, &quot;name&quot;: &quot;id&quot;, &quot;type&quot;: &quot;bytes16&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;decryptionCondition&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address[]&quot;, &quot;name&quot;: &quot;allowedPeekers&quot;, &quot;type&quot;: &quot;address[]&quot; } ], &quot;internalType&quot;: &quot;struct Suave.Bid&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;tuple&quot; }, { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;stateMutability&quot;: &quot;view&quot;, &quot;type&quot;: &quot;function&quot; }, { &quot;inputs&quot;: [ { &quot;components&quot;: [ { &quot;internalType&quot;: &quot;Suave.BidId&quot;, &quot;name&quot;: &quot;id&quot;, &quot;type&quot;: &quot;bytes16&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;decryptionCondition&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address[]&quot;, &quot;name&quot;: &quot;allowedPeekers&quot;, &quot;type&quot;: &quot;address[]&quot; } ], &quot;internalType&quot;: &quot;struct Suave.Bid&quot;, &quot;name&quot;: &quot;bid&quot;, &quot;type&quot;: &quot;tuple&quot; } ], &quot;name&quot;: &quot;emitBid&quot;, &quot;outputs&quot;: [], &quot;stateMutability&quot;: &quot;nonpayable&quot;, &quot;type&quot;: &quot;function&quot; }, { &quot;inputs&quot;: [ { &quot;components&quot;: [ { &quot;internalType&quot;: &quot;Suave.BidId&quot;, &quot;name&quot;: &quot;id&quot;, &quot;type&quot;: &quot;bytes16&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;decryptionCondition&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address[]&quot;, &quot;name&quot;: &quot;allowedPeekers&quot;, &quot;type&quot;: &quot;address[]&quot; } ], &quot;internalType&quot;: &quot;struct Suave.Bid&quot;, &quot;name&quot;: &quot;bid&quot;, &quot;type&quot;: &quot;tuple&quot; }, { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;builderBid&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;name&quot;: &quot;emitBuilderBidAndBid&quot;, &quot;outputs&quot;: [ { &quot;components&quot;: [ { &quot;internalType&quot;: &quot;Suave.BidId&quot;, &quot;name&quot;: &quot;id&quot;, &quot;type&quot;: &quot;bytes16&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;decryptionCondition&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address[]&quot;, &quot;name&quot;: &quot;allowedPeekers&quot;, &quot;type&quot;: &quot;address[]&quot; } ], &quot;internalType&quot;: &quot;struct Suave.Bid&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;tuple&quot; }, { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;stateMutability&quot;: &quot;nonpayable&quot;, &quot;type&quot;: &quot;function&quot; }, { &quot;inputs&quot;: [ { &quot;internalType&quot;: &quot;Suave.BidId&quot;, &quot;name&quot;: &quot;bidId&quot;, &quot;type&quot;: &quot;bytes16&quot; }, { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;signedBlindedHeader&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;name&quot;: &quot;unlock&quot;, &quot;outputs&quot;: [ { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;stateMutability&quot;: &quot;view&quot;, &quot;type&quot;: &quot;function&quot; } ]`)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	ethBlockBidSenderAbi = mustParseAbi(`[ { &quot;inputs&quot;: [ { &quot;internalType&quot;: &quot;string&quot;, &quot;name&quot;: &quot;boostRelayUrl_&quot;, &quot;type&quot;: &quot;string&quot; } ], &quot;stateMutability&quot;: &quot;nonpayable&quot;, &quot;type&quot;: &quot;constructor&quot; }, { &quot;inputs&quot;: [ { &quot;internalType&quot;: &quot;address&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;address&quot; }, { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;name&quot;: &quot;PeekerReverted&quot;, &quot;type&quot;: &quot;error&quot; }, { &quot;anonymous&quot;: false, &quot;inputs&quot;: [ { &quot;indexed&quot;: false, &quot;internalType&quot;: &quot;Suave.BidId&quot;, &quot;name&quot;: &quot;bidId&quot;, &quot;type&quot;: &quot;bytes16&quot; }, { &quot;indexed&quot;: false, &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;decryptionCondition&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;indexed&quot;: false, &quot;internalType&quot;: &quot;address[]&quot;, &quot;name&quot;: &quot;allowedPeekers&quot;, &quot;type&quot;: &quot;address[]&quot; } ], &quot;name&quot;: &quot;BidEvent&quot;, &quot;type&quot;: &quot;event&quot; }, { &quot;anonymous&quot;: false, &quot;inputs&quot;: [ { &quot;indexed&quot;: false, &quot;internalType&quot;: &quot;Suave.BidId&quot;, &quot;name&quot;: &quot;bidId&quot;, &quot;type&quot;: &quot;bytes16&quot; }, { &quot;indexed&quot;: false, &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;builderBid&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;name&quot;: &quot;BuilderBoostBidEvent&quot;, &quot;type&quot;: &quot;event&quot; }, { &quot;inputs&quot;: [ { &quot;components&quot;: [ { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;slot&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;proposerPubkey&quot;, &quot;type&quot;: &quot;bytes&quot; }, { &quot;internalType&quot;: &quot;bytes32&quot;, &quot;name&quot;: &quot;parent&quot;, &quot;type&quot;: &quot;bytes32&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;timestamp&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address&quot;, &quot;name&quot;: &quot;feeRecipient&quot;, &quot;type&quot;: &quot;address&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;gasLimit&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;bytes32&quot;, &quot;name&quot;: &quot;random&quot;, &quot;type&quot;: &quot;bytes32&quot; }, { &quot;components&quot;: [ { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;index&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;validator&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address&quot;, &quot;name&quot;: &quot;Address&quot;, &quot;type&quot;: &quot;address&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;amount&quot;, &quot;type&quot;: &quot;uint64&quot; } ], &quot;internalType&quot;: &quot;struct Suave.Withdrawal[]&quot;, &quot;name&quot;: &quot;withdrawals&quot;, &quot;type&quot;: &quot;tuple[]&quot; } ], &quot;internalType&quot;: &quot;struct Suave.BuildBlockArgs&quot;, &quot;name&quot;: &quot;blockArgs&quot;, &quot;type&quot;: &quot;tuple&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;blockHeight&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;Suave.BidId[]&quot;, &quot;name&quot;: &quot;bids&quot;, &quot;type&quot;: &quot;bytes16[]&quot; }, { &quot;internalType&quot;: &quot;string&quot;, &quot;name&quot;: &quot;namespace&quot;, &quot;type&quot;: &quot;string&quot; } ], &quot;name&quot;: &quot;buildAndEmit&quot;, &quot;outputs&quot;: [ { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;stateMutability&quot;: &quot;nonpayable&quot;, &quot;type&quot;: &quot;function&quot; }, { &quot;inputs&quot;: [ { &quot;components&quot;: [ { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;slot&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;proposerPubkey&quot;, &quot;type&quot;: &quot;bytes&quot; }, { &quot;internalType&quot;: &quot;bytes32&quot;, &quot;name&quot;: &quot;parent&quot;, &quot;type&quot;: &quot;bytes32&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;timestamp&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address&quot;, &quot;name&quot;: &quot;feeRecipient&quot;, &quot;type&quot;: &quot;address&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;gasLimit&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;bytes32&quot;, &quot;name&quot;: &quot;random&quot;, &quot;type&quot;: &quot;bytes32&quot; }, { &quot;components&quot;: [ { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;index&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;validator&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address&quot;, &quot;name&quot;: &quot;Address&quot;, &quot;type&quot;: &quot;address&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;amount&quot;, &quot;type&quot;: &quot;uint64&quot; } ], &quot;internalType&quot;: &quot;struct Suave.Withdrawal[]&quot;, &quot;name&quot;: &quot;withdrawals&quot;, &quot;type&quot;: &quot;tuple[]&quot; } ], &quot;internalType&quot;: &quot;struct Suave.BuildBlockArgs&quot;, &quot;name&quot;: &quot;blockArgs&quot;, &quot;type&quot;: &quot;tuple&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;blockHeight&quot;, &quot;type&quot;: &quot;uint64&quot; } ], &quot;name&quot;: &quot;buildFromPool&quot;, &quot;outputs&quot;: [ { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;stateMutability&quot;: &quot;nonpayable&quot;, &quot;type&quot;: &quot;function&quot; }, { &quot;inputs&quot;: [ { &quot;components&quot;: [ { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;slot&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;proposerPubkey&quot;, &quot;type&quot;: &quot;bytes&quot; }, { &quot;internalType&quot;: &quot;bytes32&quot;, &quot;name&quot;: &quot;parent&quot;, &quot;type&quot;: &quot;bytes32&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;timestamp&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address&quot;, &quot;name&quot;: &quot;feeRecipient&quot;, &quot;type&quot;: &quot;address&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;gasLimit&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;bytes32&quot;, &quot;name&quot;: &quot;random&quot;, &quot;type&quot;: &quot;bytes32&quot; }, { &quot;components&quot;: [ { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;index&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;validator&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address&quot;, &quot;name&quot;: &quot;Address&quot;, &quot;type&quot;: &quot;address&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;amount&quot;, &quot;type&quot;: &quot;uint64&quot; } ], &quot;internalType&quot;: &quot;struct Suave.Withdrawal[]&quot;, &quot;name&quot;: &quot;withdrawals&quot;, &quot;type&quot;: &quot;tuple[]&quot; } ], &quot;internalType&quot;: &quot;struct Suave.BuildBlockArgs&quot;, &quot;name&quot;: &quot;blockArgs&quot;, &quot;type&quot;: &quot;tuple&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;blockHeight&quot;, &quot;type&quot;: &quot;uint64&quot; } ], &quot;name&quot;: &quot;buildMevShare&quot;, &quot;outputs&quot;: [ { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;stateMutability&quot;: &quot;nonpayable&quot;, &quot;type&quot;: &quot;function&quot; }, { &quot;inputs&quot;: [ { &quot;components&quot;: [ { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;slot&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;proposerPubkey&quot;, &quot;type&quot;: &quot;bytes&quot; }, { &quot;internalType&quot;: &quot;bytes32&quot;, &quot;name&quot;: &quot;parent&quot;, &quot;type&quot;: &quot;bytes32&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;timestamp&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address&quot;, &quot;name&quot;: &quot;feeRecipient&quot;, &quot;type&quot;: &quot;address&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;gasLimit&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;bytes32&quot;, &quot;name&quot;: &quot;random&quot;, &quot;type&quot;: &quot;bytes32&quot; }, { &quot;components&quot;: [ { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;index&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;validator&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address&quot;, &quot;name&quot;: &quot;Address&quot;, &quot;type&quot;: &quot;address&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;amount&quot;, &quot;type&quot;: &quot;uint64&quot; } ], &quot;internalType&quot;: &quot;struct Suave.Withdrawal[]&quot;, &quot;name&quot;: &quot;withdrawals&quot;, &quot;type&quot;: &quot;tuple[]&quot; } ], &quot;internalType&quot;: &quot;struct Suave.BuildBlockArgs&quot;, &quot;name&quot;: &quot;blockArgs&quot;, &quot;type&quot;: &quot;tuple&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;blockHeight&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;Suave.BidId[]&quot;, &quot;name&quot;: &quot;bids&quot;, &quot;type&quot;: &quot;bytes16[]&quot; }, { &quot;internalType&quot;: &quot;string&quot;, &quot;name&quot;: &quot;namespace&quot;, &quot;type&quot;: &quot;string&quot; } ], &quot;name&quot;: &quot;doBuild&quot;, &quot;outputs&quot;: [ { &quot;components&quot;: [ { &quot;internalType&quot;: &quot;Suave.BidId&quot;, &quot;name&quot;: &quot;id&quot;, &quot;type&quot;: &quot;bytes16&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;decryptionCondition&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address[]&quot;, &quot;name&quot;: &quot;allowedPeekers&quot;, &quot;type&quot;: &quot;address[]&quot; } ], &quot;internalType&quot;: &quot;struct Suave.Bid&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;tuple&quot; }, { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;stateMutability&quot;: &quot;view&quot;, &quot;type&quot;: &quot;function&quot; }, { &quot;inputs&quot;: [ { &quot;components&quot;: [ { &quot;internalType&quot;: &quot;Suave.BidId&quot;, &quot;name&quot;: &quot;id&quot;, &quot;type&quot;: &quot;bytes16&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;decryptionCondition&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address[]&quot;, &quot;name&quot;: &quot;allowedPeekers&quot;, &quot;type&quot;: &quot;address[]&quot; } ], &quot;internalType&quot;: &quot;struct Suave.Bid&quot;, &quot;name&quot;: &quot;bid&quot;, &quot;type&quot;: &quot;tuple&quot; } ], &quot;name&quot;: &quot;emitBid&quot;, &quot;outputs&quot;: [], &quot;stateMutability&quot;: &quot;nonpayable&quot;, &quot;type&quot;: &quot;function&quot; }, { &quot;inputs&quot;: [ { &quot;components&quot;: [ { &quot;internalType&quot;: &quot;Suave.BidId&quot;, &quot;name&quot;: &quot;id&quot;, &quot;type&quot;: &quot;bytes16&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;decryptionCondition&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address[]&quot;, &quot;name&quot;: &quot;allowedPeekers&quot;, &quot;type&quot;: &quot;address[]&quot; } ], &quot;internalType&quot;: &quot;struct Suave.Bid&quot;, &quot;name&quot;: &quot;bid&quot;, &quot;type&quot;: &quot;tuple&quot; }, { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;builderBid&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;name&quot;: &quot;emitBuilderBidAndBid&quot;, &quot;outputs&quot;: [ { &quot;components&quot;: [ { &quot;internalType&quot;: &quot;Suave.BidId&quot;, &quot;name&quot;: &quot;id&quot;, &quot;type&quot;: &quot;bytes16&quot; }, { &quot;internalType&quot;: &quot;uint64&quot;, &quot;name&quot;: &quot;decryptionCondition&quot;, &quot;type&quot;: &quot;uint64&quot; }, { &quot;internalType&quot;: &quot;address[]&quot;, &quot;name&quot;: &quot;allowedPeekers&quot;, &quot;type&quot;: &quot;address[]&quot; } ], &quot;internalType&quot;: &quot;struct Suave.Bid&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;tuple&quot; }, { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;stateMutability&quot;: &quot;nonpayable&quot;, &quot;type&quot;: &quot;function&quot; }, { &quot;inputs&quot;: [ { &quot;internalType&quot;: &quot;Suave.BidId&quot;, &quot;name&quot;: &quot;bidId&quot;, &quot;type&quot;: &quot;bytes16&quot; }, { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;signedBlindedHeader&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;name&quot;: &quot;unlock&quot;, &quot;outputs&quot;: [ { &quot;internalType&quot;: &quot;bytes&quot;, &quot;name&quot;: &quot;&quot;, &quot;type&quot;: &quot;bytes&quot; } ], &quot;stateMutability&quot;: &quot;view&quot;, &quot;type&quot;: &quot;function&quot; } ]`)</span>
<span class="term-fg32">+)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+const bidsContractCode string = &quot;0x6080604052600436106100345760003560e01c8063274e3b04146100395780633c34db651461006257806392f07a5814610084575b600080fd5b61004c610047366004610789565b610099565b604051610059919061088c565b60405180910390f35b34801561006e57600080fd5b5061008261007d3660046108a6565b6102ff565b005b34801561009057600080fd5b5061004c610365565b60606100a361039e565b6100ac57600080fd5b6000306001600160a01b03166392f07a586040518163ffffffff1660e01b8152600401600060405180830381865afa1580156100ec573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f1916820160405261011491908101906108e0565b90506000806101228361041e565b915091508161018b57604080516375fff46760e01b81523060048201526024810191909152602160448201527f62756e646c6520646964206e6f742073696d756c61746520636f72726563746c6064820152607960f81b608482015260a4015b60405180910390fd5b60006101c587876040518060400160405280601581526020017464656661756c743a76303a65746842756e646c657360581b8152506104b7565b905061020381600001516040518060400160405280601581526020017464656661756c743a76303a65746842756e646c657360581b8152508661059c565b8051604080518082018252601e81527f64656661756c743a76303a65746842756e646c6553696d526573756c7473000060208083019190915282516001600160401b03871681830152835180820390920182528301909252610265929161059c565b7f83481d5b04dea534715acad673a8177a46fc93882760f36bdc16ccac439d504e8160000151826020015183604001516040516102a4939291906109b7565b60405180910390a1604051633c34db6560e01b906102c69083906020016109f2565b60408051601f19818403018152908290526102e49291602001610a72565b60405160208183030381529060405294505050505092915050565b7f83481d5b04dea534715acad673a8177a46fc93882760f36bdc16ccac439d504e61032d6020830183610ab9565b61033d6040840160208501610ad6565b61034a6040850185610af3565b60405161035a9493929190610b43565b60405180910390a150565b606061036f61039e565b61037857600080fd5b600061038261064e565b90508080602001905181019061039891906108e0565b91505090565b6040516000908190819063420100009082818181855afa9150503d80600081146103e4576040519150601f19603f3d011682016040523d82523d6000602084013e6103e9565b606091505b509150915081610414576342010000816040516375fff46760e01b8152600401610182929190610bb8565b6020015192915050565b60008060008063421000006001600160a01b0316856040516104409190610be4565b600060405180830381855afa9150503d806000811461047b576040519150601f19603f3d011682016040523d82523d6000602084013e610480565b606091505b509150915081610497575060009485945092505050565b81818060200190518101906104ac9190610c00565b935093505050915091565b6040805160608082018352600080835260208301529181019190915260008063420300006001600160a01b03168686866040516020016104f993929190610c1d565b60408051601f198184030181529082905261051391610be4565b600060405180830381855afa9150503d806000811461054e576040519150601f19603f3d011682016040523d82523d6000602084013e610553565b606091505b50915091508161057e576342030000816040516375fff46760e01b8152600401610182929190610bb8565b808060200190518101906105929190610c51565b9695505050505050565b60008063420200006001600160a01b03168585856040516020016105c293929190610d42565b60408051601f19818403018152908290526105dc91610be4565b600060405180830381855afa9150503d8060008114610617576040519150601f19603f3d011682016040523d82523d6000602084013e61061c565b606091505b509150915081610647576342020000816040516375fff46760e01b8152600401610182929190610bb8565b5050505050565b604051606090600090819063420100019082818181855afa9150503d8060008114610695576040519150601f19603f3d011682016040523d82523d6000602084013e61069a565b606091505b5091509150816106c5576342010001816040516375fff46760e01b8152600401610182929190610bb8565b92915050565b6001600160401b03811681146106e057600080fd5b50565b634e487b7160e01b600052604160045260246000fd5b604051606081016001600160401b038111828210171561071b5761071b6106e3565b60405290565b604051601f8201601f191681016001600160401b0381118282101715610749576107496106e3565b604052919050565b60006001600160401b0382111561076a5761076a6106e3565b5060051b60200190565b6001600160a01b03811681146106e057600080fd5b6000806040838503121561079c57600080fd5b82356107a7816106cb565b91506020838101356001600160401b038111156107c357600080fd5b8401601f810186136107d457600080fd5b80356107e76107e282610751565b610721565b81815260059190911b8201830190838101908883111561080657600080fd5b928401925b8284101561082d57833561081e81610774565b8252928401929084019061080b565b80955050505050509250929050565b60005b8381101561085757818101518382015260200161083f565b50506000910152565b6000815180845261087881602086016020860161083c565b601f01601f19169290920160200192915050565b60208152600061089f6020830184610860565b9392505050565b6000602082840312156108b857600080fd5b81356001600160401b038111156108ce57600080fd5b82016060818503121561089f57600080fd5b6000602082840312156108f257600080fd5b81516001600160401b038082111561090957600080fd5b818401915084601f83011261091d57600080fd5b81518181111561092f5761092f6106e3565b610942601f8201601f1916602001610721565b915080825285602082850101111561095957600080fd5b61096a81602084016020860161083c565b50949350505050565b600081518084526020808501945080840160005b838110156109ac5781516001600160a01b031687529582019590820190600101610987565b509495945050505050565b6001600160801b0319841681526001600160401b03831660208201526060604082015260006109e96060830184610973565b95945050505050565b602080825282516001600160801b03191682820152828101516001600160401b031660408084019190915283015160608084015280516080840181905260009291820190839060a08601905b80831015610a675783516001600160a01b03168252928401926001929092019190840190610a3e565b509695505050505050565b6001600160e01b0319831681528151600090610a9581600485016020870161083c565b919091016004019392505050565b6001600160801b0319811681146106e057600080fd5b600060208284031215610acb57600080fd5b813561089f81610aa3565b600060208284031215610ae857600080fd5b813561089f816106cb565b6000808335601e19843603018112610b0a57600080fd5b8301803591506001600160401b03821115610b2457600080fd5b6020019150600581901b3603821315610b3c57600080fd5b9250929050565b6000606082016001600160801b03198716835260206001600160401b03871681850152606060408501528185835260808501905086925060005b86811015610bab578335610b9081610774565b6001600160a01b031682529282019290820190600101610b7d565b5098975050505050505050565b6001600160a01b0383168152604060208201819052600090610bdc90830184610860565b949350505050565b60008251610bf681846020870161083c565b9190910192915050565b600060208284031215610c1257600080fd5b815161089f816106cb565b6001600160401b0384168152606060208201526000610c3f6060830185610973565b82810360408401526105928185610860565b60006020808385031215610c6457600080fd5b82516001600160401b0380821115610c7b57600080fd5b9084019060608287031215610c8f57600080fd5b610c976106f9565b8251610ca281610aa3565b815282840151610cb1816106cb565b81850152604083015182811115610cc757600080fd5b80840193505086601f840112610cdc57600080fd5b82519150610cec6107e283610751565b82815260059290921b83018401918481019088841115610d0b57600080fd5b938501935b83851015610d32578451610d2381610774565b82529385019390850190610d10565b6040830152509695505050505050565b6001600160801b031984168152606060208201526000610c3f606083018561086056fea26469706673582212204356e8aa18239545884593d2be44ef49906b3bcbbfc34a88399d8f16c4c53af164736f6c63430008130033&quot;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+const blockBidContractCode string = &quot;0x608060405234801561001057600080fd5b506004361061007d5760003560e01c80637df1cde21161005b5780637df1cde2146100d3578063c2eceb11146100e6578063e884734414610107578063ebb89de41461011a57600080fd5b80633c34db65146100825780634c8820f81461009757806354dfbd39146100c0575b600080fd5b610095610090366004611467565b61012d565b005b6100aa6100a53660046117e2565b610193565b6040516100b79190611929565b60405180910390f35b6100aa6100ce36600461193c565b6102f6565b6100aa6100e136600461198d565b6108da565b6100f96100f43660046117e2565b610932565b6040516100b7929190611a20565b6100f9610115366004611a80565b610add565b6100aa61012836600461193c565b610b8c565b7f83481d5b04dea534715acad673a8177a46fc93882760f36bdc16ccac439d504e61015b6020830183611b8a565b61016b6040840160208501611ba7565b6101786040850185611bc4565b6040516101889493929190611c0d565b60405180910390a150565b606061019d610f50565b6101a657600080fd5b60405163c2eceb1160e01b81526000908190309063c2eceb11906101d4908a908a908a908a90600401611db5565b600060405180830381865afa1580156101f1573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f191682016040526102199190810190611f0c565b915091507f67fa9c16cd72410c4cc1d47205b31852a81ec5e92d1c8cebc3ecbe98ed67fe3f826000015182604051610252929190611f65565b60405180910390a17f83481d5b04dea534715acad673a8177a46fc93882760f36bdc16ccac439d504e82600001518360200151846040015160405161029993929190611f88565b60405180910390a1604051633a211cd160e21b906102bd9084908490602001611a20565b60408051601f19818403018152908290526102db9291602001611fba565b60405160208183030381529060405292505050949350505050565b6060610300610f50565b61030957600080fd5b600061034283604051806040016040528060158152602001746d657673686172653a76303a6d617463684269647360581b815250610fd0565b90506000610385846040518060400160405280601c81526020017f6d657673686172653a76303a756e6d61746368656442756e646c657300000000815250610fd0565b905080516000036103b457306040516375fff46760e01b81526004016103ab9190611feb565b60405180910390fd5b600081516001600160401b038111156103cf576103cf6114a8565b60405190808252806020026020018201604052801561041c57816020015b604080516060808201835260008083526020830152918101919091528152602001906001900390816103ed5790505b50905060005b825181101561056f57600083828151811061043f5761043f61201e565b6020026020010151905060005b855181101561053c5760006104ac87838151811061046c5761046c61201e565b602002602001015160000151604051806040016040528060168152602001756d657673686172653a76303a6d65726765644269647360501b81525061109b565b8060200190518101906104bf9190612034565b9050610502816000815181106104d7576104d761201e565b60200260200101518786815181106104f1576104f161201e565b602002602001015160000151611146565b15610529578682815181106105195761051961201e565b602002602001015192505061053c565b5080610534816120d8565b91505061044c565b50808383815181106105505761055061201e565b6020026020010181905250508080610567906120d8565b915050610422565b50600081516001600160401b0381111561058b5761058b6114a8565b6040519080825280602002602001820160405280156105d057816020015b60408051808201909152600080825260208201528152602001906001900390816105a95790505b50905060005b82518110156106ce57600061063d8483815181106105f6576105f661201e565b6020026020010151600001516040518060400160405280601f81526020017f6d657673686172653a76303a65746842756e646c6553696d526573756c74730081525061109b565b905060008180602001905181019061065591906120f1565b90506040518060400160405280826001600160401b031681526020018685815181106106835761068361201e565b6020026020010151600001516001600160801b0319168152508484815181106106ae576106ae61201e565b6020026020010181905250505080806106c6906120d8565b9150506105d6565b50805160005b6106df60018361210e565b8110156107ec5760006106f3826001612121565b90505b828110156107d9578381815181106107105761071061201e565b6020026020010151600001516001600160401b03168483815181106107375761073761201e565b6020026020010151600001516001600160401b031610156107c75760008483815181106107665761076661201e565b602002602001015190508482815181106107825761078261201e565b602002602001015185848151811061079c5761079c61201e565b6020026020010181905250808583815181106107ba576107ba61201e565b6020026020010181905250505b806107d1816120d8565b9150506106f6565b50806107e4816120d8565b9150506106d4565b50600083516001600160401b03811115610808576108086114a8565b604051908082528060200260200182016040528015610831578160200160208202803683370190505b50905060005b835181101561089b578381815181106108525761085261201e565b6020026020010151602001518282815181106108705761087061201e565b6001600160801b03199092166020928302919091019091015280610893816120d8565b915050610837565b506108cb8989836040518060400160405280600b81526020016a06d657673686172653a76360ac1b815250610193565b96505050505050505b92915050565b60606108e4610f50565b6108ed57600080fd5b600061092a8460405180604001604052806019815260200178191959985d5b1d0e9d8c0e989d5a5b19195c94185e5b1bd859603a1b81525061109b565b949350505050565b6040805160608082018352600080835260208301529181019190915260408051600280825260608281019093526000919081602001602082028036833701905050905030816000815181106109895761098961201e565b60200260200101906001600160a01b031690816001600160a01b0316815250506342100001816001815181106109c1576109c161201e565b60200260200101906001600160a01b031690816001600160a01b0316815250506000610a1b87836040518060400160405280601581526020017464656661756c743a76303a6d65726765644269647360581b81525061120a565b9050610a7881600001516040518060400160405280601581526020017464656661756c743a76303a6d65726765644269647360581b81525088604051602001610a649190612134565b6040516020818303038152906040526112e5565b600080610a8a8a846000015189611397565b91509150610ace836000015160405180604001604052806019815260200178191959985d5b1d0e9d8c0e989d5a5b19195c94185e5b1bd859603a1b815250836112e5565b50909890975095505050505050565b6040805160608082018352600080835260208301529181019190915260607f67fa9c16cd72410c4cc1d47205b31852a81ec5e92d1c8cebc3ecbe98ed67fe3f846000015184604051610b30929190611f65565b60405180910390a17f83481d5b04dea534715acad673a8177a46fc93882760f36bdc16ccac439d504e846000015185602001518660400151604051610b7793929190611f88565b60405180910390a150829050815b9250929050565b6060610b96610f50565b610b9f57600080fd5b6000610bd8836040518060400160405280601581526020017464656661756c743a76303a65746842756e646c657360581b815250610fd0565b90508051600003610bfe57306040516375fff46760e01b81526004016103ab9190611feb565b600081516001600160401b03811115610c1957610c196114a8565b604051908082528060200260200182016040528015610c5e57816020015b6040805180820190915260008082526020820152815260200190600190039081610c375790505b50905060005b8251811015610d5c576000610ccb848381518110610c8457610c8461201e565b6020026020010151600001516040518060400160405280601e81526020017f64656661756c743a76303a65746842756e646c6553696d526573756c7473000081525061109b565b9050600081806020019051810190610ce391906120f1565b90506040518060400160405280826001600160401b03168152602001868581518110610d1157610d1161201e565b6020026020010151600001516001600160801b031916815250848481518110610d3c57610d3c61201e565b602002602001018190525050508080610d54906120d8565b915050610c64565b50805160005b610d6d60018361210e565b811015610e7a576000610d81826001612121565b90505b82811015610e6757838181518110610d9e57610d9e61201e565b6020026020010151600001516001600160401b0316848381518110610dc557610dc561201e565b6020026020010151600001516001600160401b03161015610e55576000848381518110610df457610df461201e565b60200260200101519050848281518110610e1057610e1061201e565b6020026020010151858481518110610e2a57610e2a61201e565b602002602001018190525080858381518110610e4857610e4861201e565b6020026020010181905250505b80610e5f816120d8565b915050610d84565b5080610e72816120d8565b915050610d62565b50600083516001600160401b03811115610e9657610e966114a8565b604051908082528060200260200182016040528015610ebf578160200160208202803683370190505b50905060005b8351811015610f2957838181518110610ee057610ee061201e565b602002602001015160200151828281518110610efe57610efe61201e565b6001600160801b03199092166020928302919091019091015280610f21816120d8565b915050610ec5565b50610f4587878360405180602001604052806000815250610193565b979650505050505050565b6040516000908190819063420100009082818181855afa9150503d8060008114610f96576040519150601f19603f3d011682016040523d82523d6000602084013e610f9b565b606091505b509150915081610fc6576342010000816040516375fff46760e01b81526004016103ab929190612147565b6020015192915050565b606060008063420300016001600160a01b03168585604051602001610ff692919061216b565b60408051601f19818403018152908290526110109161218d565b600060405180830381855afa9150503d806000811461104b576040519150601f19603f3d011682016040523d82523d6000602084013e611050565b606091505b50915091508161107b576342030001816040516375fff46760e01b81526004016103ab929190612147565b60008180602001905181019061109191906121a9565b9695505050505050565b606060008063420200016001600160a01b031685856040516020016110c1929190611f65565b60408051601f19818403018152908290526110db9161218d565b600060405180830381855afa9150503d8060008114611116576040519150601f19603f3d011682016040523d82523d6000602084013e61111b565b606091505b50915091508161092a576342020001816040516375fff46760e01b81526004016103ab929190612147565b604080516001600160801b03198481166020830152825160108184030181526030830184529084166050830152825180830384018152606090920190925260009190825b82518110156111fe578181815181106111a5576111a561201e565b602001015160f81c60f81b6001600160f81b0319168382815181106111cc576111cc61201e565b01602001516001600160f81b031916146111ec57600093505050506108d4565b806111f6816120d8565b91505061118a565b50600195945050505050565b6040805160608082018352600080835260208301529181019190915260008063420300006001600160a01b031686868660405160200161124c9392919061224c565b60408051601f19818403018152908290526112669161218d565b600060405180830381855afa9150503d80600081146112a1576040519150601f19603f3d011682016040523d82523d6000602084013e6112a6565b606091505b5091509150816112d1576342030000816040516375fff46760e01b81526004016103ab929190612147565b808060200190518101906110919190612280565b60008063420200006001600160a01b031685858560405160200161130b939291906122b4565b60408051601f19818403018152908290526113259161218d565b600060405180830381855afa9150503d8060008114611360576040519150601f19603f3d011682016040523d82523d6000602084013e611365565b606091505b509150915081611390576342020000816040516375fff46760e01b81526004016103ab929190612147565b5050505050565b60608060008063421000016001600160a01b03168787876040516020016113c0939291906122d7565b60408051601f19818403018152908290526113da9161218d565b600060405180830381855afa9150503d8060008114611415576040519150601f19603f3d011682016040523d82523d6000602084013e61141a565b606091505b509150915081611445576342100001816040516375fff46760e01b81526004016103ab929190612147565b80806020019051810190611459919061230c565b935093505050935093915050565b60006020828403121561147957600080fd5b81356001600160401b0381111561148f57600080fd5b8201606081850312156114a157600080fd5b9392505050565b634e487b7160e01b600052604160045260246000fd5b604051608081016001600160401b03811182821017156114e0576114e06114a8565b60405290565b60405161010081016001600160401b03811182821017156114e0576114e06114a8565b604051606081016001600160401b03811182821017156114e0576114e06114a8565b604051601f8201601f191681016001600160401b0381118282101715611553576115536114a8565b604052919050565b6001600160401b038116811461157057600080fd5b50565b803561157e8161155b565b919050565b60006001600160401b0382111561159c5761159c6114a8565b50601f01601f191660200190565b600082601f8301126115bb57600080fd5b81356115ce6115c982611583565b61152b565b8181528460208386010111156115e357600080fd5b816020850160208301376000918101602001919091529392505050565b6001600160a01b038116811461157057600080fd5b803561157e81611600565b60006001600160401b03821115611639576116396114a8565b5060051b60200190565b600082601f83011261165457600080fd5b813560206116646115c983611620565b82815260079290921b8401810191818101908684111561168357600080fd5b8286015b848110156116fa57608081890312156116a05760008081fd5b6116a86114be565b81356116b38161155b565b8152818501356116c28161155b565b818601526040828101356116d581611600565b908201526060828101356116e88161155b565b90820152835291830191608001611687565b509695505050505050565b6000610100828403121561171857600080fd5b6117206114e6565b905061172b82611573565b815260208201356001600160401b038082111561174757600080fd5b611753858386016115aa565b60208401526040840135604084015261176e60608501611573565b606084015261177f60808501611615565b608084015261179060a08501611573565b60a084015260c084013560c084015260e08401359150808211156117b357600080fd5b506117c084828501611643565b60e08301525092915050565b6001600160801b03198116811461157057600080fd5b600080600080608085870312156117f857600080fd5b84356001600160401b038082111561180f57600080fd5b61181b88838901611705565b9550602091508187013561182e8161155b565b945060408701358181111561184257600080fd5b8701601f8101891361185357600080fd5b80356118616115c982611620565b81815260059190911b8201840190848101908b83111561188057600080fd5b928501925b828410156118a7578335611898816117cc565b82529285019290850190611885565b965050505060608701359150808211156118c057600080fd5b506118cd878288016115aa565b91505092959194509250565b60005b838110156118f45781810151838201526020016118dc565b50506000910152565b600081518084526119158160208601602086016118d9565b601f01601f19169290920160200192915050565b6020815260006114a160208301846118fd565b6000806040838503121561194f57600080fd5b82356001600160401b0381111561196557600080fd5b61197185828601611705565b92505060208301356119828161155b565b809150509250929050565b600080604083850312156119a057600080fd5b82356119ab816117cc565b915060208301356001600160401b038111156119c657600080fd5b6119d2858286016115aa565b9150509250929050565b600081518084526020808501945080840160005b83811015611a155781516001600160a01b0316875295820195908201906001016119f0565b509495945050505050565b604081526001600160801b031983511660408201526001600160401b0360208401511660608201526000604084015160606080840152611a6360a08401826119dc565b90508281036020840152611a7781856118fd565b95945050505050565b60008060408385031215611a9357600080fd5b82356001600160401b0380821115611aaa57600080fd5b9084019060608287031215611abe57600080fd5b611ac6611509565b8235611ad1816117cc565b8152602083810135611ae28161155b565b82820152604084013583811115611af857600080fd5b80850194505087601f850112611b0d57600080fd5b8335611b1b6115c982611620565b81815260059190911b8501820190828101908a831115611b3a57600080fd5b958301955b82871015611b61578635611b5281611600565b82529583019590830190611b3f565b60408501525091955086013592505080821115611b7d57600080fd5b506119d2858286016115aa565b600060208284031215611b9c57600080fd5b81356114a1816117cc565b600060208284031215611bb957600080fd5b81356114a18161155b565b6000808335601e19843603018112611bdb57600080fd5b8301803591506001600160401b03821115611bf557600080fd5b6020019150600581901b3603821315610b8557600080fd5b6000606082016001600160801b03198716835260206001600160401b03871681850152606060408501528185835260808501905086925060005b86811015611c75578335611c5a81611600565b6001600160a01b031682529282019290820190600101611c47565b5098975050505050505050565b600081518084526020808501945080840160005b83811015611a1557815180516001600160401b039081168952848201518116858a01526040808301516001600160a01b0316908a0152606091820151169088015260809096019590820190600101611c96565b60006101006001600160401b038084511685526020840151826020870152611d13838701826118fd565b925050604084015160408601528060608501511660608601525060018060a01b03608084015116608085015260a0830151611d5960a08601826001600160401b03169052565b5060c083015160c085015260e083015184820360e0860152611a778282611c82565b600081518084526020808501945080840160005b83811015611a155781516001600160801b03191687529582019590820190600101611d8f565b608081526000611dc86080830187611ce9565b6001600160401b03861660208401528281036040840152611de98186611d7b565b90508281036060840152610f4581856118fd565b600060608284031215611e0f57600080fd5b611e17611509565b90508151611e24816117cc565b8152602082810151611e358161155b565b8282015260408301516001600160401b03811115611e5257600080fd5b8301601f81018513611e6357600080fd5b8051611e716115c982611620565b81815260059190911b82018301908381019087831115611e9057600080fd5b928401925b82841015611eb7578351611ea881611600565b82529284019290840190611e95565b6040860152509295945050505050565b600082601f830112611ed857600080fd5b8151611ee66115c982611583565b818152846020838601011115611efb57600080fd5b61092a8260208301602087016118d9565b60008060408385031215611f1f57600080fd5b82516001600160401b0380821115611f3657600080fd5b611f4286838701611dfd565b93506020850151915080821115611f5857600080fd5b506119d285828601611ec7565b6001600160801b03198316815260406020820152600061092a60408301846118fd565b6001600160801b0319841681526001600160401b0383166020820152606060408201526000611a7760608301846119dc565b6001600160e01b0319831681528151600090611fdd8160048501602087016118d9565b919091016004019392505050565b6001600160a01b03919091168152604060208201819052600790820152666e6f206269647360c81b606082015260800190565b634e487b7160e01b600052603260045260246000fd5b6000602080838503121561204757600080fd5b82516001600160401b0381111561205d57600080fd5b8301601f8101851361206e57600080fd5b805161207c6115c982611620565b81815260059190911b8201830190838101908783111561209b57600080fd5b928401925b82841015610f455783516120b3816117cc565b825292840192908401906120a0565b634e487b7160e01b600052601160045260246000fd5b6000600182016120ea576120ea6120c2565b5060010190565b60006020828403121561210357600080fd5b81516114a18161155b565b818103818111156108d4576108d46120c2565b808201808211156108d4576108d46120c2565b6020815260006114a16020830184611d7b565b6001600160a01b038316815260406020820181905260009061092a908301846118fd565b6001600160401b038316815260406020820152600061092a60408301846118fd565b6000825161219f8184602087016118d9565b9190910192915050565b600060208083850312156121bc57600080fd5b82516001600160401b03808211156121d357600080fd5b818501915085601f8301126121e757600080fd5b81516121f56115c982611620565b81815260059190911b8301840190848101908883111561221457600080fd5b8585015b83811015611c75578051858111156122305760008081fd5b61223e8b89838a0101611dfd565b845250918601918601612218565b6001600160401b038416815260606020820152600061226e60608301856119dc565b828103604084015261109181856118fd565b60006020828403121561229257600080fd5b81516001600160401b038111156122a857600080fd5b61092a84828501611dfd565b6001600160801b03198416815260606020820152600061226e60608301856118fd565b6060815260006122ea6060830186611ce9565b6001600160801b031985166020840152828103604084015261109181856118fd565b6000806040838503121561231f57600080fd5b82516001600160401b038082111561233657600080fd5b611f4286838701611ec756fea2646970667358221220ade6feba9f6e5719ab1453e0d056bdc2c01a6d3c4e0bd63fb847f4c18080554964736f6c63430008130033&quot;</span>
<span class="term-fg32">+const blockBidSenderContractCode string = &quot;0x60806040523480156200001157600080fd5b506040516200281b3803806200281b833981016040819052620000349162000060565b6000620000428282620001c4565b505062000290565b634e487b7160e01b600052604160045260246000fd5b600060208083850312156200007457600080fd5b82516001600160401b03808211156200008c57600080fd5b818501915085601f830112620000a157600080fd5b815181811115620000b657620000b66200004a565b604051601f8201601f19908116603f01168101908382118183101715620000e157620000e16200004a565b816040528281528886848701011115620000fa57600080fd5b600093505b828410156200011e5784840186015181850187015292850192620000ff565b600086848301015280965050505050505092915050565b600181811c908216806200014a57607f821691505b6020821081036200016b57634e487b7160e01b600052602260045260246000fd5b50919050565b601f821115620001bf57600081815260208120601f850160051c810160208610156200019a5750805b601f850160051c820191505b81811015620001bb57828155600101620001a6565b5050505b505050565b81516001600160401b03811115620001e057620001e06200004a565b620001f881620001f1845462000135565b8462000171565b602080601f831160018114620002305760008415620002175750858301515b600019600386901b1c1916600185901b178555620001bb565b600085815260208120601f198616915b82811015620002615788860151825594840194600190910190840162000240565b5085821015620002805787850151600019600388901b60f8161c191681555b5050505050600190811b01905550565b61257b80620002a06000396000f3fe608060405234801561001057600080fd5b506004361061007d5760003560e01c80637df1cde21161005b5780637df1cde2146100d3578063c2eceb11146100e6578063e884734414610107578063ebb89de41461011a57600080fd5b80633c34db65146100825780634c8820f81461009757806354dfbd39146100c0575b600080fd5b61009561009036600461159f565b61012d565b005b6100aa6100a536600461193c565b610193565b6040516100b79190611a83565b60405180910390f35b6100aa6100ce366004611a96565b61037f565b6100aa6100e1366004611ae7565b61095e565b6100f96100f436600461193c565b6109b6565b6040516100b7929190611bb6565b6100f9610115366004611be4565b610b61565b6100aa610128366004611a96565b610c10565b7f83481d5b04dea534715acad673a8177a46fc93882760f36bdc16ccac439d504e61015b6020830183611cee565b61016b6040840160208501611d0b565b6101786040850185611d28565b6040516101889493929190611d71565b60405180910390a150565b606061019d610fe7565b6101a657600080fd5b60405163c2eceb1160e01b81526000908190309063c2eceb11906101d4908a908a908a908a90600401611f19565b600060405180830381865afa1580156101f1573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f191682016040526102199190810190612070565b915091506000806102b460008054610230906120c9565b80601f016020809104026020016040519081016040528092919081815260200182805461025c906120c9565b80156102a95780601f1061027e576101008083540402835291602001916102a9565b820191906000526020600020905b81548152906001019060200180831161028c57829003601f168201915b505050505084611067565b91509150816102e35730816040516375fff46760e01b81526004016102da929190612103565b60405180910390fd5b7f83481d5b04dea534715acad673a8177a46fc93882760f36bdc16ccac439d504e84600001518560200151866040015160405161032293929190612127565b60405180910390a1604051633c34db6560e01b90610344908690602001612159565b60408051601f1981840301815290829052610362929160200161216c565b604051602081830303815290604052945050505050949350505050565b6060610389610fe7565b61039257600080fd5b60006103cb83604051806040016040528060158152602001746d657673686172653a76303a6d617463684269647360581b815250611108565b9050600061040e846040518060400160405280601c81526020017f6d657673686172653a76303a756e6d61746368656442756e646c657300000000815250611108565b9050805160000361043457306040516375fff46760e01b81526004016102da919061219d565b600081516001600160401b0381111561044f5761044f6115e0565b60405190808252806020026020018201604052801561049c57816020015b6040805160608082018352600080835260208301529181019190915281526020019060019003908161046d5790505b50905060005b82518110156105f35760008382815181106104bf576104bf6121d0565b6020026020010151905060005b85518110156105c057600061052c8783815181106104ec576104ec6121d0565b602002602001015160000151604051806040016040528060168152602001756d657673686172653a76303a6d65726765644269647360501b8152506111d3565b80602001905181019061053f91906121e6565b9050610586816000015160008151811061055b5761055b6121d0565b6020026020010151878681518110610575576105756121d0565b60200260200101516000015161127e565b156105ad5786828151811061059d5761059d6121d0565b60200260200101519250506105c0565b50806105b8816122c9565b9150506104cc565b50808383815181106105d4576105d46121d0565b60200260200101819052505080806105eb906122c9565b9150506104a2565b50600081516001600160401b0381111561060f5761060f6115e0565b60405190808252806020026020018201604052801561065457816020015b604080518082019091526000808252602082015281526020019060019003908161062d5790505b50905060005b82518110156107525760006106c184838151811061067a5761067a6121d0565b6020026020010151600001516040518060400160405280601f81526020017f6d657673686172653a76303a65746842756e646c6553696d526573756c7473008152506111d3565b90506000818060200190518101906106d991906122e2565b90506040518060400160405280826001600160401b03168152602001868581518110610707576107076121d0565b6020026020010151600001516001600160801b031916815250848481518110610732576107326121d0565b60200260200101819052505050808061074a906122c9565b91505061065a565b50805160005b6107636001836122ff565b811015610870576000610777826001612312565b90505b8281101561085d57838181518110610794576107946121d0565b6020026020010151600001516001600160401b03168483815181106107bb576107bb6121d0565b6020026020010151600001516001600160401b0316101561084b5760008483815181106107ea576107ea6121d0565b60200260200101519050848281518110610806576108066121d0565b6020026020010151858481518110610820576108206121d0565b60200260200101819052508085838151811061083e5761083e6121d0565b6020026020010181905250505b80610855816122c9565b91505061077a565b5080610868816122c9565b915050610758565b50600083516001600160401b0381111561088c5761088c6115e0565b6040519080825280602002602001820160405280156108b5578160200160208202803683370190505b50905060005b835181101561091f578381815181106108d6576108d66121d0565b6020026020010151602001518282815181106108f4576108f46121d0565b6001600160801b03199092166020928302919091019091015280610917816122c9565b9150506108bb565b5061094f8989836040518060400160405280600b81526020016a06d657673686172653a76360ac1b815250610193565b96505050505050505b92915050565b6060610968610fe7565b61097157600080fd5b60006109ae8460405180604001604052806019815260200178191959985d5b1d0e9d8c0e989d5a5b19195c94185e5b1bd859603a1b8152506111d3565b949350505050565b604080516060808201835260008083526020830152918101919091526040805160028082526060828101909352600091908160200160208202803683370190505090503081600081518110610a0d57610a0d6121d0565b60200260200101906001600160a01b031690816001600160a01b031681525050634210000181600181518110610a4557610a456121d0565b60200260200101906001600160a01b031690816001600160a01b0316815250506000610a9f87836040518060400160405280601581526020017464656661756c743a76303a6d65726765644269647360581b815250611342565b9050610afc81600001516040518060400160405280601581526020017464656661756c743a76303a6d65726765644269647360581b81525088604051602001610ae89190612325565b60405160208183030381529060405261141d565b600080610b0e8a8460000151896114cf565b91509150610b52836000015160405180604001604052806019815260200178191959985d5b1d0e9d8c0e989d5a5b19195c94185e5b1bd859603a1b8152508361141d565b50909890975095505050505050565b6040805160608082018352600080835260208301529181019190915260607f67fa9c16cd72410c4cc1d47205b31852a81ec5e92d1c8cebc3ecbe98ed67fe3f846000015184604051610bb4929190612338565b60405180910390a17f83481d5b04dea534715acad673a8177a46fc93882760f36bdc16ccac439d504e846000015185602001518660400151604051610bfb93929190612127565b60405180910390a150829050815b9250929050565b6060610c1a610fe7565b610c2357600080fd5b6000610c5c836040518060400160405280601581526020017464656661756c743a76303a65746842756e646c657360581b815250611108565b90508051600003610c8257306040516375fff46760e01b81526004016102da919061219d565b600081516001600160401b03811115610c9d57610c9d6115e0565b604051908082528060200260200182016040528015610ce257816020015b6040805180820190915260008082526020820152815260200190600190039081610cbb5790505b50905060005b8251811015610de0576000610d4f848381518110610d0857610d086121d0565b6020026020010151600001516040518060400160405280601e81526020017f64656661756c743a76303a65746842756e646c6553696d526573756c747300008152506111d3565b9050600081806020019051810190610d6791906122e2565b90506040518060400160405280826001600160401b03168152602001868581518110610d9557610d956121d0565b6020026020010151600001516001600160801b031916815250848481518110610dc057610dc06121d0565b602002602001018190525050508080610dd8906122c9565b915050610ce8565b50805160005b610df16001836122ff565b811015610efe576000610e05826001612312565b90505b82811015610eeb57838181518110610e2257610e226121d0565b6020026020010151600001516001600160401b0316848381518110610e4957610e496121d0565b6020026020010151600001516001600160401b03161015610ed9576000848381518110610e7857610e786121d0565b60200260200101519050848281518110610e9457610e946121d0565b6020026020010151858481518110610eae57610eae6121d0565b602002602001018190525080858381518110610ecc57610ecc6121d0565b6020026020010181905250505b80610ee3816122c9565b915050610e08565b5080610ef6816122c9565b915050610de6565b50600083516001600160401b03811115610f1a57610f1a6115e0565b604051908082528060200260200182016040528015610f43578160200160208202803683370190505b50905060005b8351811015610fad57838181518110610f6457610f646121d0565b602002602001015160200151828281518110610f8257610f826121d0565b6001600160801b03199092166020928302919091019091015280610fa5816122c9565b915050610f49565b50610fdc8787836040518060400160405280600a815260200169064656661756c743a76360b41b815250610193565b979650505050505050565b6040516000908190819063420100009082818181855afa9150503d806000811461102d576040519150601f19603f3d011682016040523d82523d6000602084013e611032565b606091505b50915091508161105d576342010000816040516375fff46760e01b81526004016102da929190612103565b6020015192915050565b60006060611073610fe7565b61107c57600080fd5b60008063421000026001600160a01b031686866040516020016110a092919061235b565b60408051601f19818403018152908290526110ba9161236e565b600060405180830381855afa9150503d80600081146110f5576040519150601f19603f3d011682016040523d82523d6000602084013e6110fa565b606091505b509097909650945050505050565b606060008063420300016001600160a01b0316858560405160200161112e92919061238a565b60408051601f19818403018152908290526111489161236e565b600060405180830381855afa9150503d8060008114611183576040519150601f19603f3d011682016040523d82523d6000602084013e611188565b606091505b5091509150816111b3576342030001816040516375fff46760e01b81526004016102da929190612103565b6000818060200190518101906111c991906123ac565b9695505050505050565b606060008063420200016001600160a01b031685856040516020016111f9929190612338565b60408051601f19818403018152908290526112139161236e565b600060405180830381855afa9150503d806000811461124e576040519150601f19603f3d011682016040523d82523d6000602084013e611253565b606091505b5091509150816109ae576342020001816040516375fff46760e01b81526004016102da929190612103565b604080516001600160801b03198481166020830152825160108184030181526030830184529084166050830152825180830384018152606090920190925260009190825b8251811015611336578181815181106112dd576112dd6121d0565b602001015160f81c60f81b6001600160f81b031916838281518110611304576113046121d0565b01602001516001600160f81b031916146113245760009350505050610958565b8061132e816122c9565b9150506112c2565b50600195945050505050565b6040805160608082018352600080835260208301529181019190915260008063420300006001600160a01b03168686866040516020016113849392919061244f565b60408051601f198184030181529082905261139e9161236e565b600060405180830381855afa9150503d80600081146113d9576040519150601f19603f3d011682016040523d82523d6000602084013e6113de565b606091505b509150915081611409576342030000816040516375fff46760e01b81526004016102da929190612103565b808060200190518101906111c99190612483565b60008063420200006001600160a01b0316858585604051602001611443939291906124b7565b60408051601f198184030181529082905261145d9161236e565b600060405180830381855afa9150503d8060008114611498576040519150601f19603f3d011682016040523d82523d6000602084013e61149d565b606091505b5091509150816114c8576342020000816040516375fff46760e01b81526004016102da929190612103565b5050505050565b60608060008063421000016001600160a01b03168787876040516020016114f8939291906124da565b60408051601f19818403018152908290526115129161236e565b600060405180830381855afa9150503d806000811461154d576040519150601f19603f3d011682016040523d82523d6000602084013e611552565b606091505b50915091508161157d576342100001816040516375fff46760e01b81526004016102da929190612103565b80806020019051810190611591919061250f565b935093505050935093915050565b6000602082840312156115b157600080fd5b81356001600160401b038111156115c757600080fd5b8201606081850312156115d957600080fd5b9392505050565b634e487b7160e01b600052604160045260246000fd5b604051608081016001600160401b0381118282101715611618576116186115e0565b60405290565b60405161010081016001600160401b0381118282101715611618576116186115e0565b604051606081016001600160401b0381118282101715611618576116186115e0565b604051602081016001600160401b0381118282101715611618576116186115e0565b604051601f8201601f191681016001600160401b03811182821017156116ad576116ad6115e0565b604052919050565b6001600160401b03811681146116ca57600080fd5b50565b80356116d8816116b5565b919050565b60006001600160401b038211156116f6576116f66115e0565b50601f01601f191660200190565b600082601f83011261171557600080fd5b8135611728611723826116dd565b611685565b81815284602083860101111561173d57600080fd5b816020850160208301376000918101602001919091529392505050565b6001600160a01b03811681146116ca57600080fd5b80356116d88161175a565b60006001600160401b03821115611793576117936115e0565b5060051b60200190565b600082601f8301126117ae57600080fd5b813560206117be6117238361177a565b82815260079290921b840181019181810190868411156117dd57600080fd5b8286015b8481101561185457608081890312156117fa5760008081fd5b6118026115f6565b813561180d816116b5565b81528185013561181c816116b5565b8186015260408281013561182f8161175a565b90820152606082810135611842816116b5565b908201528352918301916080016117e1565b509695505050505050565b6000610100828403121561187257600080fd5b61187a61161e565b9050611885826116cd565b815260208201356001600160401b03808211156118a157600080fd5b6118ad85838601611704565b6020840152604084013560408401526118c8606085016116cd565b60608401526118d96080850161176f565b60808401526118ea60a085016116cd565b60a084015260c084013560c084015260e084013591508082111561190d57600080fd5b5061191a8482850161179d565b60e08301525092915050565b6001600160801b0319811681146116ca57600080fd5b6000806000806080858703121561195257600080fd5b84356001600160401b038082111561196957600080fd5b6119758883890161185f565b95506020915081870135611988816116b5565b945060408701358181111561199c57600080fd5b8701601f810189136119ad57600080fd5b80356119bb6117238261177a565b81815260059190911b8201840190848101908b8311156119da57600080fd5b928501925b82841015611a015783356119f281611926565b825292850192908501906119df565b96505050506060870135915080821115611a1a57600080fd5b50611a2787828801611704565b91505092959194509250565b60005b83811015611a4e578181015183820152602001611a36565b50506000910152565b60008151808452611a6f816020860160208601611a33565b601f01601f19169290920160200192915050565b6020815260006115d96020830184611a57565b60008060408385031215611aa957600080fd5b82356001600160401b03811115611abf57600080fd5b611acb8582860161185f565b9250506020830135611adc816116b5565b809150509250929050565b60008060408385031215611afa57600080fd5b8235611b0581611926565b915060208301356001600160401b03811115611b2057600080fd5b611b2c85828601611704565b9150509250929050565b600081518084526020808501945080840160005b83811015611b6f5781516001600160a01b031687529582019590820190600101611b4a565b509495945050505050565b6001600160801b031981511682526001600160401b03602082015116602083015260006040820151606060408501526109ae6060850182611b36565b604081526000611bc96040830185611b7a565b8281036020840152611bdb8185611a57565b95945050505050565b60008060408385031215611bf757600080fd5b82356001600160401b0380821115611c0e57600080fd5b9084019060608287031215611c2257600080fd5b611c2a611641565b8235611c3581611926565b8152602083810135611c46816116b5565b82820152604084013583811115611c5c57600080fd5b80850194505087601f850112611c7157600080fd5b8335611c7f6117238261177a565b81815260059190911b8501820190828101908a831115611c9e57600080fd5b958301955b82871015611cc5578635611cb68161175a565b82529583019590830190611ca3565b60408501525091955086013592505080821115611ce157600080fd5b50611b2c85828601611704565b600060208284031215611d0057600080fd5b81356115d981611926565b600060208284031215611d1d57600080fd5b81356115d9816116b5565b6000808335601e19843603018112611d3f57600080fd5b8301803591506001600160401b03821115611d5957600080fd5b6020019150600581901b3603821315610c0957600080fd5b6000606082016001600160801b03198716835260206001600160401b03871681850152606060408501528185835260808501905086925060005b86811015611dd9578335611dbe8161175a565b6001600160a01b031682529282019290820190600101611dab565b5098975050505050505050565b600081518084526020808501945080840160005b83811015611b6f57815180516001600160401b039081168952848201518116858a01526040808301516001600160a01b0316908a0152606091820151169088015260809096019590820190600101611dfa565b60006101006001600160401b038084511685526020840151826020870152611e7783870182611a57565b925050604084015160408601528060608501511660608601525060018060a01b03608084015116608085015260a0830151611ebd60a08601826001600160401b03169052565b5060c083015160c085015260e083015184820360e0860152611bdb8282611de6565b600081518084526020808501945080840160005b83811015611b6f5781516001600160801b03191687529582019590820190600101611ef3565b608081526000611f2c6080830187611e4d565b6001600160401b03861660208401528281036040840152611f4d8186611edf565b90508281036060840152610fdc8185611a57565b600060608284031215611f7357600080fd5b611f7b611641565b90508151611f8881611926565b8152602082810151611f99816116b5565b8282015260408301516001600160401b03811115611fb657600080fd5b8301601f81018513611fc757600080fd5b8051611fd56117238261177a565b81815260059190911b82018301908381019087831115611ff457600080fd5b928401925b8284101561201b57835161200c8161175a565b82529284019290840190611ff9565b6040860152509295945050505050565b600082601f83011261203c57600080fd5b815161204a611723826116dd565b81815284602083860101111561205f57600080fd5b6109ae826020830160208701611a33565b6000806040838503121561208357600080fd5b82516001600160401b038082111561209a57600080fd5b6120a686838701611f61565b935060208501519150808211156120bc57600080fd5b50611b2c8582860161202b565b600181811c908216806120dd57607f821691505b6020821081036120fd57634e487b7160e01b600052602260045260246000fd5b50919050565b6001600160a01b03831681526040602082018190526000906109ae90830184611a57565b6001600160801b0319841681526001600160401b0383166020820152606060408201526000611bdb6060830184611b36565b6020815260006115d96020830184611b7a565b6001600160e01b031983168152815160009061218f816004850160208701611a33565b919091016004019392505050565b6001600160a01b03919091168152604060208201819052600790820152666e6f206269647360c81b606082015260800190565b634e487b7160e01b600052603260045260246000fd5b600060208083850312156121f957600080fd5b82516001600160401b038082111561221057600080fd5b818501915082828703121561222457600080fd5b61222c611663565b82518281111561223b57600080fd5b80840193505086601f84011261225057600080fd5b825191506122606117238361177a565b82815260059290921b8301840191848101908884111561227f57600080fd5b938501935b838510156122a657845161229781611926565b82529385019390850190612284565b8252509695505050505050565b634e487b7160e01b600052601160045260246000fd5b6000600182016122db576122db6122b3565b5060010190565b6000602082840312156122f457600080fd5b81516115d9816116b5565b81810381811115610958576109586122b3565b80820180821115610958576109586122b3565b6020815260006115d96020830184611edf565b6001600160801b0319831681526040602082015260006109ae6040830184611a57565b604081526000611bc96040830185611a57565b60008251612380818460208701611a33565b9190910192915050565b6001600160401b03831681526040602082015260006109ae6040830184611a57565b600060208083850312156123bf57600080fd5b82516001600160401b03808211156123d657600080fd5b818501915085601f8301126123ea57600080fd5b81516123f86117238261177a565b81815260059190911b8301840190848101908883111561241757600080fd5b8585015b83811015611dd9578051858111156124335760008081fd5b6124418b89838a0101611f61565b84525091860191860161241b565b6001600160401b03841681526060602082015260006124716060830185611b36565b82810360408401526111c98185611a57565b60006020828403121561249557600080fd5b81516001600160401b038111156124ab57600080fd5b6109ae84828501611f61565b6001600160801b0319841681526060602082015260006124716060830185611a57565b6060815260006124ed6060830186611e4d565b6001600160801b03198516602084015282810360408401526111c98185611a57565b6000806040838503121561252257600080fd5b82516001600160401b038082111561253957600080fd5b6120a68683870161202b56fea264697066735822122098f9228c6237f8d55ed510f8e65ee9ec903595c404e72fb336734750747059ea64736f6c63430008130033&quot;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+const mevShareBidContractCode string = &quot;0x6080604052600436106100555760003560e01c8063274e3b041461005a5780633c34db651461008357806367d7d785146100a557806392f07a58146100c55780639b0a882e146100da578063e2a1d069146100fa575b600080fd5b61006d610068366004610cf3565b61010d565b60405161007a9190610d92565b60405180910390f35b34801561008f57600080fd5b506100a361009e366004610dbd565b6103bc565b005b3480156100b157600080fd5b506100a36100c0366004610e71565b610410565b3480156100d157600080fd5b5061006d6104ad565b3480156100e657600080fd5b506100a36100f5366004610ef8565b6104d5565b61006d610108366004610f67565b61056f565b60606101176107d3565b61012057600080fd5b6000306001600160a01b03166392f07a586040518163ffffffff1660e01b81526004016000604051808303816000875af1158015610162573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f1916820160405261018a9190810190610fca565b905060008061019883610853565b915091508161020257604080516375fff46760e01b81523060048201526024810191909152602260448201527f62756e646c6520646f6573206e6f742073696d756c61746520636f72726563746064820152616c7960f01b608482015260a4015b60405180910390fd5b600061020d846108ec565b9050600061025188886040518060400160405280601c81526020017f6d657673686172653a76303a756e6d61746368656442756e646c6573000000008152506109ad565b90506102908160000151604051806040016040528060168152602001756d657673686172653a76303a65746842756e646c657360501b81525087610a92565b8051604080518082018252601f81527f6d657673686172653a76303a65746842756e646c6553696d526573756c74730060208083019190915282516001600160401b038816918101919091526102f79392015b604051602081830303815290604052610a92565b60008051602061148783398151915281600001518260200151836040015160405161032493929190611084565b60405180910390a180516040517fdab8306bad2ca820d05b9eff8da2e3016d372c15f00bb032f758718b9cda39509161035e9185906110b6565b60405180910390a1604051634d85441760e11b906103829083908590602001611115565b60408051601f19818403018152908290526103a0929160200161113a565b6040516020818303038152906040529550505050505092915050565b6000805160206114878339815191526103d8602083018361116b565b6103e86040840160208501611188565b6103f560408501856111a5565b60405161040594939291906111f5565b60405180910390a150565b60008051602061148783398151915261042c602085018561116b565b61043c6040860160208701611188565b61044960408701876111a5565b60405161045994939291906111f5565b60405180910390a17f417b0c16c40ca502ef10ae6921892668f006f527e3f4599cb95b9de965d4133461048f602085018561116b565b83836040516104a09392919061126a565b60405180910390a1505050565b606060006104b9610b44565b9050808060200190518101906104cf9190610fca565b91505090565b6000805160206114878339815191526104f1602084018461116b565b6105016040850160208601611188565b61050e60408601866111a5565b60405161051e94939291906111f5565b60405180910390a17fdab8306bad2ca820d05b9eff8da2e3016d372c15f00bb032f758718b9cda3950610554602084018461116b565b826040516105639291906110b6565b60405180910390a15050565b60606105796107d3565b61058257600080fd5b6000306001600160a01b03166392f07a586040518163ffffffff1660e01b81526004016000604051808303816000875af11580156105c4573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f191682016040526105ec9190810190610fca565b905060006105f9826108ec565b905060006106358787604051806040016040528060158152602001746d657673686172653a76303a6d617463684269647360581b8152506109ad565b90506106748160000151604051806040016040528060168152602001756d657673686172653a76303a65746842756e646c657360501b81525085610a92565b8051604080518082018252601f81527f6d657673686172653a76303a65746842756e646c6553696d526573756c74730060208083019190915282516000918101919091526106c39392016102e3565b60408051600280825260608201835260009260208301908036833701905050905085816000815181106106f8576106f861129f565b6001600160801b03199092166020928302919091019091015281518151829060019081106107285761072861129f565b6001600160801b0319909216602092830291909101820152825160408051808201825260168152756d657673686172653a76303a6d65726765644269647360501b81850152905161077f936102e3918691016112b5565b604051633c34db6560e01b90610799908490602001611303565b60408051601f19818403018152908290526107b7929160200161113a565b6040516020818303038152906040529450505050509392505050565b6040516000908190819063420100009082818181855afa9150503d8060008114610819576040519150601f19603f3d011682016040523d82523d6000602084013e61081e565b606091505b509150915081610849576342010000816040516375fff46760e01b81526004016101f9929190611316565b6020015192915050565b60008060008063421000006001600160a01b031685604051610875919061133a565b600060405180830381855afa9150503d80600081146108b0576040519150601f19603f3d011682016040523d82523d6000602084013e6108b5565b606091505b5091509150816108cc575060009485945092505050565b81818060200190518101906108e19190611356565b935093505050915091565b60606108f66107d3565b6108ff57600080fd5b60008063421000376001600160a01b0316846040516020016109219190610d92565b60408051601f198184030181529082905261093b9161133a565b600060405180830381855afa9150503d8060008114610976576040519150601f19603f3d011682016040523d82523d6000602084013e61097b565b606091505b5091509150816109a6576342100037816040516375fff46760e01b81526004016101f9929190611316565b9392505050565b6040805160608082018352600080835260208301529181019190915260008063420300006001600160a01b03168686866040516020016109ef93929190611373565b60408051601f1981840301815290829052610a099161133a565b600060405180830381855afa9150503d8060008114610a44576040519150601f19603f3d011682016040523d82523d6000602084013e610a49565b606091505b509150915081610a74576342030000816040516375fff46760e01b81526004016101f9929190611316565b80806020019051810190610a889190611395565b9695505050505050565b60008063420200006001600160a01b0316858585604051602001610ab89392919061126a565b60408051601f1981840301815290829052610ad29161133a565b600060405180830381855afa9150503d8060008114610b0d576040519150601f19603f3d011682016040523d82523d6000602084013e610b12565b606091505b509150915081610b3d576342020000816040516375fff46760e01b81526004016101f9929190611316565b5050505050565b604051606090600090819063420100019082818181855afa9150503d8060008114610b8b576040519150601f19603f3d011682016040523d82523d6000602084013e610b90565b606091505b509150915081610bbb576342010001816040516375fff46760e01b81526004016101f9929190611316565b92915050565b6001600160401b0381168114610bd657600080fd5b50565b634e487b7160e01b600052604160045260246000fd5b604051606081016001600160401b0381118282101715610c1157610c11610bd9565b60405290565b604051601f8201601f191681016001600160401b0381118282101715610c3f57610c3f610bd9565b604052919050565b60006001600160401b03821115610c6057610c60610bd9565b5060051b60200190565b6001600160a01b0381168114610bd657600080fd5b600082601f830112610c9057600080fd5b81356020610ca5610ca083610c47565b610c17565b82815260059290921b84018101918181019086841115610cc457600080fd5b8286015b84811015610ce8578035610cdb81610c6a565b8352918301918301610cc8565b509695505050505050565b60008060408385031215610d0657600080fd5b8235610d1181610bc1565b915060208301356001600160401b03811115610d2c57600080fd5b610d3885828601610c7f565b9150509250929050565b60005b83811015610d5d578181015183820152602001610d45565b50506000910152565b60008151808452610d7e816020860160208601610d42565b601f01601f19169290920160200192915050565b6020815260006109a66020830184610d66565b600060608284031215610db757600080fd5b50919050565b600060208284031215610dcf57600080fd5b81356001600160401b03811115610de557600080fd5b610df184828501610da5565b949350505050565b60006001600160401b03821115610e1257610e12610bd9565b50601f01601f191660200190565b600082601f830112610e3157600080fd5b8135610e3f610ca082610df9565b818152846020838601011115610e5457600080fd5b816020850160208301376000918101602001919091529392505050565b600080600060608486031215610e8657600080fd5b83356001600160401b0380821115610e9d57600080fd5b610ea987838801610da5565b94506020860135915080821115610ebf57600080fd5b610ecb87838801610e20565b93506040860135915080821115610ee157600080fd5b50610eee86828701610e20565b9150509250925092565b60008060408385031215610f0b57600080fd5b82356001600160401b0380821115610f2257600080fd5b610f2e86838701610da5565b93506020850135915080821115610f4457600080fd5b50610d3885828601610e20565b6001600160801b031981168114610bd657600080fd5b600080600060608486031215610f7c57600080fd5b8335610f8781610bc1565b925060208401356001600160401b03811115610fa257600080fd5b610fae86828701610c7f565b9250506040840135610fbf81610f51565b809150509250925092565b600060208284031215610fdc57600080fd5b81516001600160401b03811115610ff257600080fd5b8201601f8101841361100357600080fd5b8051611011610ca082610df9565b81815285602083850101111561102657600080fd5b611037826020830160208601610d42565b95945050505050565b600081518084526020808501945080840160005b838110156110795781516001600160a01b031687529582019590820190600101611054565b509495945050505050565b6001600160801b0319841681526001600160401b03831660208201526060604082015260006110376060830184611040565b6001600160801b031983168152604060208201526000610df16040830184610d66565b6001600160801b031981511682526001600160401b0360208201511660208301526000604082015160606040850152610df16060850182611040565b60408152600061112860408301856110d9565b82810360208401526110378185610d66565b6001600160e01b031983168152815160009061115d816004850160208701610d42565b919091016004019392505050565b60006020828403121561117d57600080fd5b81356109a681610f51565b60006020828403121561119a57600080fd5b81356109a681610bc1565b6000808335601e198436030181126111bc57600080fd5b8301803591506001600160401b038211156111d657600080fd5b6020019150600581901b36038213156111ee57600080fd5b9250929050565b6000606082016001600160801b03198716835260206001600160401b03871681850152606060408501528185835260808501905086925060005b8681101561125d57833561124281610c6a565b6001600160a01b03168252928201929082019060010161122f565b5098975050505050505050565b6001600160801b03198416815260606020820152600061128d6060830185610d66565b8281036040840152610a888185610d66565b634e487b7160e01b600052603260045260246000fd5b6020808252825182820181905260009190848201906040850190845b818110156112f75783516001600160801b031916835292840192918401916001016112d1565b50909695505050505050565b6020815260006109a660208301846110d9565b6001600160a01b0383168152604060208201819052600090610df190830184610d66565b6000825161134c818460208701610d42565b9190910192915050565b60006020828403121561136857600080fd5b81516109a681610bc1565b6001600160401b038416815260606020820152600061128d6060830185611040565b600060208083850312156113a857600080fd5b82516001600160401b03808211156113bf57600080fd5b90840190606082870312156113d357600080fd5b6113db610bef565b82516113e681610f51565b8152828401516113f581610bc1565b8185015260408301518281111561140b57600080fd5b80840193505086601f84011261142057600080fd5b82519150611430610ca083610c47565b82815260059290921b8301840191848101908884111561144f57600080fd5b938501935b8385101561147657845161146781610c6a565b82529385019390850190611454565b604083015250969550505050505056fe83481d5b04dea534715acad673a8177a46fc93882760f36bdc16ccac439d504ea26469706673582212201cd282b9ee2f9db0e558d8be285fc7d04b4df596d2fb422dfcaff84c7d9e9bff64736f6c63430008130033&quot;</span></div>
    </div>

            
        </div>
        <div>
            
        </div>
    </div>
</div>

            
        </div>
    </div>
</div>

            
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-2d9351cb1f9f75d9b1d11759"role="button" aria-expanded="false" aria-controls="id-2d9351cb1f9f75d9b1d11759">
        
            <div class="col-12 col-sm-9 text-start"><h2>Other changes</h2></div>
        
        <div class="col-12 col-sm-3 ms-auto mt-2">
            <div class="row line-stat">
                <div class="text-end"><span class="text-success">+9</span></div>
                <div class="text-start"><span class="text-danger">-7</span></div>
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-2d9351cb1f9f75d9b1d11759">
        <div></div>
        <div>
            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-ca1c9feb78fef8f071772dfc" role="button"
                   aria-expanded="false" aria-controls="id-ca1c9feb78fef8f071772dfc">
                    <code>build/ci.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/e501b3b05db8e169f67dc78b7b59bc352b3c638d/build/ci.go" target="_blank">ethereum/go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/build/ci.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+2</span></div>
                        <div class="text-start"><span class="text-danger">-1</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-ca1c9feb78fef8f071772dfc"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;build&#47;ci.go flashbots&#47;suave-geth&#47;build&#47;ci.go</span>
<span class="term-fg1">index 7933724d7416ed28f518eed3a9213984ce0acbd1..45768282131963ca0a794843ae05a8df41f28b1d 100644</span>
<span class="term-fg1">--- ethereum&#47;go-ethereum&#47;build&#47;ci.go</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;build&#47;ci.go</span>
<span class="term-fg36">@@ -228,10 +228,11 @@</span> 	&#47;&#47; Show packages during build.
 	gobuild.Args = append(gobuild.Args, &quot;-v&quot;)
&nbsp;
 	&#47;&#47; Now we choose what we&#39;re even building.
<span class="term-fg31">-	&#47;&#47; Default: collect all &#39;main&#39; packages in cmd&#47; and build those.</span>
<span class="term-fg32">+	&#47;&#47; Default: collect all &#39;main&#39; packages in cmd&#47; and suave&#47;cmd and build those.</span>
 	packages := flag.Args()
 	if len(packages) == 0 {
 		packages = build.FindMainPackages(&quot;.&#47;cmd&quot;)
<span class="term-fg32">+		packages = append(packages, build.FindMainPackages(&quot;.&#47;suave&#47;cmd&quot;)...)</span>
 	}
&nbsp;
 	&#47;&#47; Do the build!</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-7b2c5d912eb0254196af6670" role="button"
                   aria-expanded="false" aria-controls="id-7b2c5d912eb0254196af6670">
                    <code>eth/tracers/internal/tracetest/calltrace_test.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/e501b3b05db8e169f67dc78b7b59bc352b3c638d/eth/tracers/internal/tracetest/calltrace_test.go" target="_blank">ethereum/go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/eth/tracers/internal/tracetest/calltrace_test.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+2</span></div>
                        <div class="text-start"><span class="text-danger">-2</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-7b2c5d912eb0254196af6670"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;eth&#47;tracers&#47;internal&#47;tracetest&#47;calltrace_test.go flashbots&#47;suave-geth&#47;eth&#47;tracers&#47;internal&#47;tracetest&#47;calltrace_test.go</span>
<span class="term-fg1">index bf1c31c08ddbcb213dd34f89999afda548ed84c6..30028326fb5b871fef64630a19dd11fe20f2ffd6 100644</span>
<span class="term-fg1">--- ethereum&#47;go-ethereum&#47;eth&#47;tracers&#47;internal&#47;tracetest&#47;calltrace_test.go</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;eth&#47;tracers&#47;internal&#47;tracetest&#47;calltrace_test.go</span>
<span class="term-fg36">@@ -122,7 +122,7 @@</span> 			}
 			&#47;&#47; Configure a blockchain with the given prestate
 			var (
 				signer    = types.MakeSigner(test.Genesis.Config, new(big.Int).SetUint64(uint64(test.Context.Number)), uint64(test.Context.Time))
<span class="term-fg31">-				origin, _ = signer.Sender(tx)</span>
<span class="term-fg32">+				origin, _ = types.Sender(signer, tx)</span>
 				txContext = vm.TxContext{
 					Origin:   origin,
 					GasPrice: tx.GasPrice(),
<span class="term-fg36">@@ -223,7 +223,7 @@</span> 	msg, err := core.TransactionToMessage(tx, signer, nil)
 	if err != nil {
 		b.Fatalf(&quot;failed to prepare transaction for tracing: %v&quot;, err)
 	}
<span class="term-fg31">-	origin, _ := signer.Sender(tx)</span>
<span class="term-fg32">+	origin, _ := types.Sender(signer, tx)</span>
 	txContext := vm.TxContext{
 		Origin:   origin,
 		GasPrice: tx.GasPrice(),</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-85e103a3a3d49362f235ca5e" role="button"
                   aria-expanded="false" aria-controls="id-85e103a3a3d49362f235ca5e">
                    <code>eth/tracers/internal/tracetest/flat_calltrace_test.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/e501b3b05db8e169f67dc78b7b59bc352b3c638d/eth/tracers/internal/tracetest/flat_calltrace_test.go" target="_blank">ethereum/go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/eth/tracers/internal/tracetest/flat_calltrace_test.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+1</span></div>
                        <div class="text-start"><span class="text-danger">-1</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-85e103a3a3d49362f235ca5e"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;eth&#47;tracers&#47;internal&#47;tracetest&#47;flat_calltrace_test.go flashbots&#47;suave-geth&#47;eth&#47;tracers&#47;internal&#47;tracetest&#47;flat_calltrace_test.go</span>
<span class="term-fg1">index 85e95401a21557a97cffab48f772d7e79ca3db0a..305c745ca9f34d76324de7a1ede44258870cd4d8 100644</span>
<span class="term-fg1">--- ethereum&#47;go-ethereum&#47;eth&#47;tracers&#47;internal&#47;tracetest&#47;flat_calltrace_test.go</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;eth&#47;tracers&#47;internal&#47;tracetest&#47;flat_calltrace_test.go</span>
<span class="term-fg36">@@ -86,7 +86,7 @@</span> 	if err := rlp.DecodeBytes(common.FromHex(test.Input), tx); err != nil {
 		return fmt.Errorf(&quot;failed to parse testcase input: %v&quot;, err)
 	}
 	signer := types.MakeSigner(test.Genesis.Config, new(big.Int).SetUint64(uint64(test.Context.Number)), uint64(test.Context.Time))
<span class="term-fg31">-	origin, _ := signer.Sender(tx)</span>
<span class="term-fg32">+	origin, _ := types.Sender(signer, tx)</span>
 	txContext := vm.TxContext{
 		Origin:   origin,
 		GasPrice: tx.GasPrice(),</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-08f0d72fcefbe19a5ae6bf67" role="button"
                   aria-expanded="false" aria-controls="id-08f0d72fcefbe19a5ae6bf67">
                    <code>eth/tracers/internal/tracetest/prestate_test.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/e501b3b05db8e169f67dc78b7b59bc352b3c638d/eth/tracers/internal/tracetest/prestate_test.go" target="_blank">ethereum/go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/eth/tracers/internal/tracetest/prestate_test.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+1</span></div>
                        <div class="text-start"><span class="text-danger">-1</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-08f0d72fcefbe19a5ae6bf67"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;eth&#47;tracers&#47;internal&#47;tracetest&#47;prestate_test.go flashbots&#47;suave-geth&#47;eth&#47;tracers&#47;internal&#47;tracetest&#47;prestate_test.go</span>
<span class="term-fg1">index 991da10b3ab108077b70a99426270c4f844bd796..27829d4bd0f73dadb7e3b840ccae2b1629e73e70 100644</span>
<span class="term-fg1">--- ethereum&#47;go-ethereum&#47;eth&#47;tracers&#47;internal&#47;tracetest&#47;prestate_test.go</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;eth&#47;tracers&#47;internal&#47;tracetest&#47;prestate_test.go</span>
<span class="term-fg36">@@ -93,7 +93,7 @@</span> 			}
 			&#47;&#47; Configure a blockchain with the given prestate
 			var (
 				signer    = types.MakeSigner(test.Genesis.Config, new(big.Int).SetUint64(uint64(test.Context.Number)), uint64(test.Context.Time))
<span class="term-fg31">-				origin, _ = signer.Sender(tx)</span>
<span class="term-fg32">+				origin, _ = types.Sender(signer, tx)</span>
 				txContext = vm.TxContext{
 					Origin:   origin,
 					GasPrice: tx.GasPrice(),</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-110370df7007e5a4b8b00725" role="button"
                   aria-expanded="false" aria-controls="id-110370df7007e5a4b8b00725">
                    <code>eth/tracers/js/tracer_test.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/e501b3b05db8e169f67dc78b7b59bc352b3c638d/eth/tracers/js/tracer_test.go" target="_blank">ethereum/go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/eth/tracers/js/tracer_test.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+1</span></div>
                        <div class="text-start"><span class="text-danger">-1</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-110370df7007e5a4b8b00725"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;eth&#47;tracers&#47;js&#47;tracer_test.go flashbots&#47;suave-geth&#47;eth&#47;tracers&#47;js&#47;tracer_test.go</span>
<span class="term-fg1">index bf6427faf673ff3e83a1a11f63607186bf9f7604..e3d13356e4902a51b3bed070a84f09aa80394c94 100644</span>
<span class="term-fg1">--- ethereum&#47;go-ethereum&#47;eth&#47;tracers&#47;js&#47;tracer_test.go</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;eth&#47;tracers&#47;js&#47;tracer_test.go</span>
<span class="term-fg36">@@ -75,7 +75,7 @@</span> 	}
&nbsp;
 	tracer.CaptureTxStart(gasLimit)
 	tracer.CaptureStart(env, contract.Caller(), contract.Address(), false, []byte{}, startGas, value)
<span class="term-fg31">-	ret, err := env.Interpreter().Run(contract, []byte{}, false)</span>
<span class="term-fg32">+	ret, err := env.Interpreter().Run(nil, contract, []byte{}, false)</span>
 	tracer.CaptureEnd(ret, startGas-contract.Gas, err)
 	&#47;&#47; Rest gas assumes no refund
 	tracer.CaptureTxEnd(contract.Gas)</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-4aad286bf653223757fa7cb1" role="button"
                   aria-expanded="false" aria-controls="id-4aad286bf653223757fa7cb1">
                    <code>eth/tracers/logger/logger_test.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/e501b3b05db8e169f67dc78b7b59bc352b3c638d/eth/tracers/logger/logger_test.go" target="_blank">ethereum/go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/eth/tracers/logger/logger_test.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+1</span></div>
                        <div class="text-start"><span class="text-danger">-1</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-4aad286bf653223757fa7cb1"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;eth&#47;tracers&#47;logger&#47;logger_test.go flashbots&#47;suave-geth&#47;eth&#47;tracers&#47;logger&#47;logger_test.go</span>
<span class="term-fg1">index 3192a15cbab835e99c512dafbd6adf7de8a83731..ca415017ee51738e01638d616c1b76b4dac92336 100644</span>
<span class="term-fg1">--- ethereum&#47;go-ethereum&#47;eth&#47;tracers&#47;logger&#47;logger_test.go</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;eth&#47;tracers&#47;logger&#47;logger_test.go</span>
<span class="term-fg36">@@ -61,7 +61,7 @@</span> 	)
 	contract.Code = []byte{byte(vm.PUSH1), 0x1, byte(vm.PUSH1), 0x0, byte(vm.SSTORE)}
 	var index common.Hash
 	logger.CaptureStart(env, common.Address{}, contract.Address(), false, nil, 0, nil)
<span class="term-fg31">-	_, err := env.Interpreter().Run(contract, []byte{}, false)</span>
<span class="term-fg32">+	_, err := env.Interpreter().Run(nil, contract, []byte{}, false)</span>
 	if err != nil {
 		t.Fatal(err)
 	}</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-3ecd3136421209d99d7a8e8b" role="button"
                   aria-expanded="false" aria-controls="id-3ecd3136421209d99d7a8e8b">
                    <code>signer/core/apitypes/types.go</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/e501b3b05db8e169f67dc78b7b59bc352b3c638d/signer/core/apitypes/types.go" target="_blank">ethereum/go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/signer/core/apitypes/types.go" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+1</span></div>
                        <div class="text-start"><span class="text-danger">-0</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-3ecd3136421209d99d7a8e8b"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;signer&#47;core&#47;apitypes&#47;types.go flashbots&#47;suave-geth&#47;signer&#47;core&#47;apitypes&#47;types.go</span>
<span class="term-fg1">index 8218e754d36c2a996d070a4a82b274d376c234c5..abe3a5dae237e0cda7061b3aa7b9e631f2f8fad0 100644</span>
<span class="term-fg1">--- ethereum&#47;go-ethereum&#47;signer&#47;core&#47;apitypes&#47;types.go</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;signer&#47;core&#47;apitypes&#47;types.go</span>
<span class="term-fg36">@@ -110,6 +110,7 @@</span> }
&nbsp;
 &#47;&#47; ToTransaction converts the arguments to a transaction.
 func (args *SendTxArgs) ToTransaction() *types.Transaction {
<span class="term-fg32">+	&#47;&#47; TODO: offchain</span>
 	&#47;&#47; Add the To-field, if specified
 	var to *common.Address
 	if args.To != nil {</div>
    </div>

            
        </div>
        <div>
            
        </div>
    </div>
</div>

            
        </div>
    </div>
</div>

                
                    <div class="text-muted">
                        <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-4181bb8a8adbb6d5bbb28d0a"role="button" aria-expanded="false" aria-controls="id-4181bb8a8adbb6d5bbb28d0a">
        
            <div class="col-12 col-sm-9 text-start"><h4>Ignored changes</h4></div>
        
        <div class="col-12 col-sm-3 ms-auto mt-2">
            <div class="row line-stat">
                <div class="text-end"><span class="text-success">+777</span></div>
                <div class="text-start"><span class="text-danger">-314</span></div>
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-4181bb8a8adbb6d5bbb28d0a">
        <div></div>
        <div>
            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-663438d64b6ca3f23eb96045" role="button"
                   aria-expanded="false" aria-controls="id-663438d64b6ca3f23eb96045">
                    <code>.github/pull_request_template.md</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/.github/pull_request_template.md" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+11</span></div>
                        <div class="text-start"><span class="text-danger">-0</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-663438d64b6ca3f23eb96045"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;.github&#47;pull_request_template.md flashbots&#47;suave-geth&#47;.github&#47;pull_request_template.md</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..fa3291d7cc0d30e58726aad64c11bee0ad8cf3b9</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;.github&#47;pull_request_template.md</span>
<span class="term-fg36">@@ -0,0 +1,11 @@</span>
<span class="term-fg32">+## 📝 Summary</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&lt;!--- A general summary of your changes --&gt;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+## 📚 References</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&lt;!-- Any interesting external links to documentation, articles, tweets which add value to the PR --&gt;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+---</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+* [ ] I have seen and agree to CONTRIBUTING.md</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-dc3493b721fd09ca51e065bf" role="button"
                   aria-expanded="false" aria-controls="id-dc3493b721fd09ca51e065bf">
                    <code>.github/workflows/checks.yml</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/.github/workflows/checks.yml" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+57</span></div>
                        <div class="text-start"><span class="text-danger">-0</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-dc3493b721fd09ca51e065bf"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;.github&#47;workflows&#47;checks.yml flashbots&#47;suave-geth&#47;.github&#47;workflows&#47;checks.yml</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..7cbc8aefd1228bed1b997f490dec80f2656e0eef</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;.github&#47;workflows&#47;checks.yml</span>
<span class="term-fg36">@@ -0,0 +1,57 @@</span>
<span class="term-fg32">+name: Checks</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+on:</span>
<span class="term-fg32">+  push:</span>
<span class="term-fg32">+    branches: [ main ]</span>
<span class="term-fg32">+  pull_request:</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+env:</span>
<span class="term-fg32">+  CGO_CFLAGS_ALLOW: &quot;-O -D__BLST_PORTABLE__&quot;</span>
<span class="term-fg32">+  CGO_CFLAGS: &quot;-O -D__BLST_PORTABLE__&quot;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+jobs:</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+  lint:</span>
<span class="term-fg32">+    name: Lint and test</span>
<span class="term-fg32">+    runs-on: ubuntu-latest</span>
<span class="term-fg32">+    steps:</span>
<span class="term-fg32">+      - name: Set up Go</span>
<span class="term-fg32">+        uses: actions&#47;setup-go@v3</span>
<span class="term-fg32">+        with:</span>
<span class="term-fg32">+          go-version: ^1.20</span>
<span class="term-fg32">+        id: go</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+      - name: Check out code into the Go module directory</span>
<span class="term-fg32">+        uses: actions&#47;checkout@v2</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+      - name: Install golangci-lint</span>
<span class="term-fg32">+        run: go install github.com&#47;golangci&#47;golangci-lint&#47;cmd&#47;golangci-lint@v1.51.2</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+      - name: Lint</span>
<span class="term-fg32">+        run: make lint</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+      - name: Test</span>
<span class="term-fg32">+        run: go test .&#47;cmd&#47;geth .&#47;core .&#47;core&#47;types .&#47;core&#47;vm .&#47;eth&#47;... .&#47;internal&#47;ethapi&#47;... .&#47;les&#47;... .&#47;miner .&#47;params .&#47;suave&#47;...</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+      - name: Ensure go mod tidy runs without changes</span>
<span class="term-fg32">+        run: |</span>
<span class="term-fg32">+          go mod tidy</span>
<span class="term-fg32">+          git diff-index HEAD</span>
<span class="term-fg32">+          git diff-index --quiet HEAD</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+  build:</span>
<span class="term-fg32">+    name: Build</span>
<span class="term-fg32">+    runs-on: ubuntu-latest</span>
<span class="term-fg32">+    steps:</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+    - name: Set up Go 1.x</span>
<span class="term-fg32">+      uses: actions&#47;setup-go@v3</span>
<span class="term-fg32">+      with:</span>
<span class="term-fg32">+        go-version: ^1.20</span>
<span class="term-fg32">+      id: go</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+    - name: Check out code into the Go module directory</span>
<span class="term-fg32">+      uses: actions&#47;checkout@v2</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+    - name: Build</span>
<span class="term-fg32">+      run: make geth</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-6296be843b1d5d2bd5dc1e15" role="button"
                   aria-expanded="false" aria-controls="id-6296be843b1d5d2bd5dc1e15">
                    <code>CODE_OF_CONDUCT.md</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/CODE_OF_CONDUCT.md" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+133</span></div>
                        <div class="text-start"><span class="text-danger">-0</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-6296be843b1d5d2bd5dc1e15"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;CODE_OF_CONDUCT.md flashbots&#47;suave-geth&#47;CODE_OF_CONDUCT.md</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..f4f5f9f01f7a174f33c8987e3ce109d6cc1101eb</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;CODE_OF_CONDUCT.md</span>
<span class="term-fg36">@@ -0,0 +1,133 @@</span>
<span class="term-fg32">+# Contributor Covenant Code of Conduct</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+## Our Pledge</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+We as members, contributors, and leaders pledge to make participation in our</span>
<span class="term-fg32">+community a harassment-free experience for everyone, regardless of age, body</span>
<span class="term-fg32">+size, visible or invisible disability, ethnicity, sex characteristics, gender</span>
<span class="term-fg32">+identity and expression, level of experience, education, socio-economic status,</span>
<span class="term-fg32">+nationality, personal appearance, race, caste, color, religion, or sexual</span>
<span class="term-fg32">+identity and orientation.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+We pledge to act and interact in ways that contribute to an open, welcoming,</span>
<span class="term-fg32">+diverse, inclusive, and healthy community.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+## Our Standards</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+Examples of behavior that contributes to a positive environment for our</span>
<span class="term-fg32">+community include:</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+* Demonstrating empathy and kindness toward other people</span>
<span class="term-fg32">+* Being respectful of differing opinions, viewpoints, and experiences</span>
<span class="term-fg32">+* Giving and gracefully accepting constructive feedback</span>
<span class="term-fg32">+* Accepting responsibility and apologizing to those affected by our mistakes,</span>
<span class="term-fg32">+  and learning from the experience</span>
<span class="term-fg32">+* Focusing on what is best not just for us as individuals, but for the overall</span>
<span class="term-fg32">+  community</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+Examples of unacceptable behavior include:</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+* The use of sexualized language or imagery, and sexual attention or advances of</span>
<span class="term-fg32">+  any kind</span>
<span class="term-fg32">+* Trolling, insulting or derogatory comments, and personal or political attacks</span>
<span class="term-fg32">+* Public or private harassment</span>
<span class="term-fg32">+* Publishing others&#39; private information, such as a physical or email address,</span>
<span class="term-fg32">+  without their explicit permission</span>
<span class="term-fg32">+* Other conduct which could reasonably be considered inappropriate in a</span>
<span class="term-fg32">+  professional setting</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+## Enforcement Responsibilities</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+Community leaders are responsible for clarifying and enforcing our standards of</span>
<span class="term-fg32">+acceptable behavior and will take appropriate and fair corrective action in</span>
<span class="term-fg32">+response to any behavior that they deem inappropriate, threatening, offensive,</span>
<span class="term-fg32">+or harmful.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+Community leaders have the right and responsibility to remove, edit, or reject</span>
<span class="term-fg32">+comments, commits, code, wiki edits, issues, and other contributions that are</span>
<span class="term-fg32">+not aligned to this Code of Conduct, and will communicate reasons for moderation</span>
<span class="term-fg32">+decisions when appropriate.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+## Scope</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+This Code of Conduct applies within all community spaces, and also applies when</span>
<span class="term-fg32">+an individual is officially representing the community in public spaces.</span>
<span class="term-fg32">+Examples of representing our community include using an official e-mail address,</span>
<span class="term-fg32">+posting via an official social media account, or acting as an appointed</span>
<span class="term-fg32">+representative at an online or offline event.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+## Enforcement</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+Instances of abusive, harassing, or otherwise unacceptable behavior may be</span>
<span class="term-fg32">+reported to the community leaders responsible for enforcement writing an</span>
<span class="term-fg32">+email to leo@flashbots.net or contacting elopio#8526 in</span>
<span class="term-fg32">+[Discord](https:&#47;&#47;discord.com&#47;invite&#47;7hvTycdNcK).</span>
<span class="term-fg32">+All complaints will be reviewed and investigated promptly and fairly.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+All community leaders are obligated to respect the privacy and security of the</span>
<span class="term-fg32">+reporter of any incident.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+## Enforcement Guidelines</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+Community leaders will follow these Community Impact Guidelines in determining</span>
<span class="term-fg32">+the consequences for any action they deem in violation of this Code of Conduct:</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+### 1. Correction</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+**Community Impact**: Use of inappropriate language or other behavior deemed</span>
<span class="term-fg32">+unprofessional or unwelcome in the community.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+**Consequence**: A private, written warning from community leaders, providing</span>
<span class="term-fg32">+clarity around the nature of the violation and an explanation of why the</span>
<span class="term-fg32">+behavior was inappropriate. A public apology may be requested.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+### 2. Warning</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+**Community Impact**: A violation through a single incident or series of</span>
<span class="term-fg32">+actions.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+**Consequence**: A warning with consequences for continued behavior. No</span>
<span class="term-fg32">+interaction with the people involved, including unsolicited interaction with</span>
<span class="term-fg32">+those enforcing the Code of Conduct, for a specified period of time. This</span>
<span class="term-fg32">+includes avoiding interactions in community spaces as well as external channels</span>
<span class="term-fg32">+like social media. Violating these terms may lead to a temporary or permanent</span>
<span class="term-fg32">+ban.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+### 3. Temporary Ban</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+**Community Impact**: A serious violation of community standards, including</span>
<span class="term-fg32">+sustained inappropriate behavior.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+**Consequence**: A temporary ban from any sort of interaction or public</span>
<span class="term-fg32">+communication with the community for a specified period of time. No public or</span>
<span class="term-fg32">+private interaction with the people involved, including unsolicited interaction</span>
<span class="term-fg32">+with those enforcing the Code of Conduct, is allowed during this period.</span>
<span class="term-fg32">+Violating these terms may lead to a permanent ban.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+### 4. Permanent Ban</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+**Community Impact**: Demonstrating a pattern of violation of community</span>
<span class="term-fg32">+standards, including sustained inappropriate behavior, harassment of an</span>
<span class="term-fg32">+individual, or aggression toward or disparagement of classes of individuals.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+**Consequence**: A permanent ban from any sort of public interaction within the</span>
<span class="term-fg32">+community.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+## Attribution</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+This Code of Conduct is adapted from the [Contributor Covenant][homepage],</span>
<span class="term-fg32">+version 2.1, available at</span>
<span class="term-fg32">+[https:&#47;&#47;www.contributor-covenant.org&#47;version&#47;2&#47;1&#47;code_of_conduct.html][v2.1].</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+Community Impact Guidelines were inspired by</span>
<span class="term-fg32">+[Mozilla&#39;s code of conduct enforcement ladder][Mozilla CoC].</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+For answers to common questions about this code of conduct, see the FAQ at</span>
<span class="term-fg32">+[https:&#47;&#47;www.contributor-covenant.org&#47;faq][FAQ]. Translations are available at</span>
<span class="term-fg32">+[https:&#47;&#47;www.contributor-covenant.org&#47;translations][translations].</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+[homepage]: https:&#47;&#47;www.contributor-covenant.org</span>
<span class="term-fg32">+[v2.1]: https:&#47;&#47;www.contributor-covenant.org&#47;version&#47;2&#47;1&#47;code_of_conduct.html</span>
<span class="term-fg32">+[Mozilla CoC]: https:&#47;&#47;github.com&#47;mozilla&#47;diversity</span>
<span class="term-fg32">+[FAQ]: https:&#47;&#47;www.contributor-covenant.org&#47;faq</span>
<span class="term-fg32">+[translations]: https:&#47;&#47;www.contributor-covenant.org&#47;translations</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-7f7f4b710105c2197cddfe44" role="button"
                   aria-expanded="false" aria-controls="id-7f7f4b710105c2197cddfe44">
                    <code>CONTRIBUTING.md</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/CONTRIBUTING.md" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+39</span></div>
                        <div class="text-start"><span class="text-danger">-0</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-7f7f4b710105c2197cddfe44"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;CONTRIBUTING.md flashbots&#47;suave-geth&#47;CONTRIBUTING.md</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..594097df8a435b646346c2d43869c5a2a501a356</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;CONTRIBUTING.md</span>
<span class="term-fg36">@@ -0,0 +1,39 @@</span>
<span class="term-fg32">+# Contributing guide</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+Welcome to the Flashbots collective!</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+Thanks for your help improving the project! We are so happy to have you! We just ask you to be nice when you play with us.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+Please start by reading our [license agreement](#individual-contributor-license-agreement) below, and our [code of conduct](suave&#47;CODE_OF_CONDUCT.md).</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+## Code style</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+Start by making sure that your code is readable, consistent, and pretty.</span>
<span class="term-fg32">+Follow the [Clean Code](https:&#47;&#47;flashbots.notion.site&#47;Clean-Code-13016c5c7ca649fba31ae19d797d7304) recommendations.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+## Send a pull request</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+- Your proposed changes should be first described and discussed in an issue.</span>
<span class="term-fg32">+- Open the branch in a personal fork, not in the team repository.</span>
<span class="term-fg32">+- Every pull request should be small and represent a single change. If the problem is complicated, split it in multiple issues and pull requests.</span>
<span class="term-fg32">+- Every pull request should be covered by unit tests.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+We appreciate you, friend &lt;3.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+---</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+# Individual Contributor License Agreement</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+This text is adapted from Google&#39;s contributors license agreement: https:&#47;&#47;cla.developers.google.com&#47;about&#47;google-individual</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+You accept and agree to the following terms and conditions for Your present and future Contributions submitted to Flashbots. Except for the license granted herein to Flashbots and recipients of software distributed by Flashbots, You reserve all right, title, and interest in and to Your Contributions.</span>
<span class="term-fg32">+1. Definitions.</span>
<span class="term-fg32">+   * &quot;You&quot; (or &quot;Your&quot;) shall mean the copyright owner or legal entity authorized by the copyright owner that is making this Agreement with Flashbots. For legal entities, the entity making a Contribution and all other entities that control, are controlled by, or are under common control with that entity are considered to be a single Contributor. For the purposes of this definition, &quot;control&quot; means (i) the power, direct or indirect, to cause the direction or management of such entity, whether by contract or otherwise, or (ii) ownership of fifty percent (50%) or more of the outstanding shares, or (iii) beneficial ownership of such entity.</span>
<span class="term-fg32">+   * &quot;Contribution&quot; shall mean any original work of authorship, including any modifications or additions to an existing work, that is intentionally submitted by You to Flashbots for inclusion in, or documentation of, any of the products owned or managed by Flashbots (the &quot;Work&quot;). For the purposes of this definition, &quot;submitted&quot; means any form of electronic, verbal, or written communication sent to Flashbots or its representatives, including but not limited to communication on electronic mailing lists, source code control systems, and issue tracking systems that are managed by, or on behalf of, Flashbots for the purpose of discussing and improving the Work, but excluding communication that is conspicuously marked or otherwise designated in writing by You as &quot;Not a Contribution.&quot;</span>
<span class="term-fg32">+2. Grant of Copyright License. Subject to the terms and conditions of this Agreement, You hereby grant to Flashbots and to recipients of software distributed by Flashbots a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Your Contributions and such derivative works, under the terms of the license which the project is using on the Submission Date.</span>
<span class="term-fg32">+3. Grant of Patent License. Subject to the terms and conditions of this Agreement, You hereby grant to Flashbots and to recipients of software distributed by Flashbots a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable (except as stated in this section) patent license to make, have made, use, offer to sell, sell, import, and otherwise transfer the Work, where such license applies only to those patent claims licensable by You that are necessarily infringed by Your Contribution(s) alone or by combination of Your Contribution(s) with the Work to which such Contribution(s) was submitted. If any entity institutes patent litigation against You or any other entity (including a cross-claim or counterclaim in a lawsuit) alleging that your Contribution, or the Work to which you have contributed, constitutes direct or contributory patent infringement, then any patent licenses granted to that entity under this Agreement for that Contribution or Work shall terminate as of the date such litigation is filed.</span>
<span class="term-fg32">+4. You represent that you are legally entitled to grant the above license. If your employer(s) has rights to intellectual property that you create that includes your Contributions, you represent that you have received permission to make Contributions on behalf of that employer, that your employer has waived such rights for your Contributions to Flashbots, or that your employer has executed a separate Corporate CLA with Flashbots.</span>
<span class="term-fg32">+5. You represent that each of Your Contributions is Your original creation (see section 7 for submissions on behalf of others). You represent that Your Contribution submissions include complete details of any third-party license or other restriction (including, but not limited to, related patents and trademarks) of which you are personally aware and which are associated with any part of Your Contributions.</span>
<span class="term-fg32">+6. You are not expected to provide support for Your Contributions, except to the extent You desire to provide support. You may provide support for free, for a fee, or not at all. Unless required by applicable law or agreed to in writing, You provide Your Contributions on an &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied, including, without limitation, any warranties or conditions of TITLE, NON- INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A PARTICULAR PURPOSE.</span>
<span class="term-fg32">+7. Should You wish to submit work that is not Your original creation, You may submit it to Flashbots separately from any Contribution, identifying the complete details of its source and of any license or other restriction (including, but not limited to, related patents, trademarks, and license agreements) of which you are personally aware, and conspicuously marking the work as &quot;Submitted on behalf of a third-party: [named here]&quot;.</span>
<span class="term-fg32">+8. You agree to notify Flashbots of any facts or circumstances of which you become aware that would make these representations inaccurate in any respect.</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-21d3f488d5daf8108b4d9bbb" role="button"
                   aria-expanded="false" aria-controls="id-21d3f488d5daf8108b4d9bbb">
                    <code>README.md</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/e501b3b05db8e169f67dc78b7b59bc352b3c638d/README.md" target="_blank">ethereum/go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/README.md" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+456</span></div>
                        <div class="text-start"><span class="text-danger">-271</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-21d3f488d5daf8108b4d9bbb"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;README.md flashbots&#47;suave-geth&#47;README.md</span>
<span class="term-fg1">index 34bd8b94c98d5e5ede03bb5395b6ed83b02157ac..0a059814d6bc412c482c2a5d64c64bb803405e00 100644</span>
<span class="term-fg1">--- ethereum&#47;go-ethereum&#47;README.md</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;README.md</span>
<span class="term-fg36">@@ -1,367 +1,552 @@</span>
<span class="term-fg31">-## Go Ethereum</span>
<span class="term-fg32">+# SUAVE</span>
&nbsp;
<span class="term-fg31">-Official Golang execution layer implementation of the Ethereum protocol.</span>
<span class="term-fg32">+[![Goreport status](https:&#47;&#47;goreportcard.com&#47;badge&#47;github.com&#47;flashbots&#47;suave-geth)](https:&#47;&#47;goreportcard.com&#47;report&#47;github.com&#47;flashbots&#47;suave-geth)</span>
<span class="term-fg32">+[![CI status](https:&#47;&#47;github.com&#47;flashbots&#47;suave-geth&#47;workflows&#47;Checks&#47;badge.svg?branch=main)](https:&#47;&#47;github.com&#47;flashbots&#47;suave-geth&#47;actions&#47;workflows&#47;checks.yml)</span>
&nbsp;
<span class="term-fg31">-[![API Reference](</span>
<span class="term-fg31">-https:&#47;&#47;camo.githubusercontent.com&#47;915b7be44ada53c290eb157634330494ebe3e30a&#47;68747470733a2f2f676f646f632e6f72672f6769746875622e636f6d2f676f6c616e672f6764646f3f7374617475732e737667</span>
<span class="term-fg31">-)](https:&#47;&#47;pkg.go.dev&#47;github.com&#47;ethereum&#47;go-ethereum?tab=doc)</span>
<span class="term-fg31">-[![Go Report Card](https:&#47;&#47;goreportcard.com&#47;badge&#47;github.com&#47;ethereum&#47;go-ethereum)](https:&#47;&#47;goreportcard.com&#47;report&#47;github.com&#47;ethereum&#47;go-ethereum)</span>
<span class="term-fg31">-[![Travis](https:&#47;&#47;travis-ci.com&#47;ethereum&#47;go-ethereum.svg?branch=master)](https:&#47;&#47;travis-ci.com&#47;ethereum&#47;go-ethereum)</span>
<span class="term-fg31">-[![Discord](https:&#47;&#47;img.shields.io&#47;badge&#47;discord-join%20chat-blue.svg)](https:&#47;&#47;discord.gg&#47;nthXNEv)</span>
<span class="term-fg32">+[SUAVE](https:&#47;&#47;writings.flashbots.net&#47;mevm-suave-centauri-and-beyond) is designed to decentralize the MEV supply chain by enabling centralized infrastructure (builders, relays, centralized RFQ routing, etc.) to be programmed as smart contracts on a decentralized blockchain.</span>
&nbsp;
<span class="term-fg31">-Automated builds are available for stable releases and the unstable master branch. Binary</span>
<span class="term-fg31">-archives are published at https:&#47;&#47;geth.ethereum.org&#47;downloads&#47;.</span>
<span class="term-fg32">+`suave-geth` is a work-in-progress Golang SUAVE client consisting of two separable components: chain nodes and execution nodes. SUAVE clients offer confidential execution for smart contracts, allowing off-chain processing with extended precompiles for enhanced MEV functionalities, including transaction simulation via geth RPC, block building, and relay boosting, all handled by dedicated execution nodes.</span>
&nbsp;
<span class="term-fg31">-## Building the source</span>
<span class="term-fg32">+For a deeper dive, check out the [technical details section](#suave-geth-technical-details), [simple MEV-share walk through](suave&#47;cmd&#47;suavecli&#47;README.md), and the [demo video from EthCC](https:&#47;&#47;drive.google.com&#47;file&#47;d&#47;1IHuLtxwjRvRpYjMG3oRuAgS5MUZtmAXq&#47;view?usp=sharing).</span>
&nbsp;
<span class="term-fg31">-For prerequisites and detailed build instructions please read the [Installation Instructions](https:&#47;&#47;geth.ethereum.org&#47;docs&#47;getting-started&#47;installing-geth).</span>
<span class="term-fg32">+---</span>
&nbsp;
<span class="term-fg31">-Building `geth` requires both a Go (version 1.19 or later) and a C compiler. You can install</span>
<span class="term-fg31">-them using your favourite package manager. Once the dependencies are installed, run</span>
<span class="term-fg32">+**Table of Contents**</span>
&nbsp;
<span class="term-fg31">-```shell</span>
<span class="term-fg31">-make geth</span>
<span class="term-fg31">-```</span>
<span class="term-fg32">+1. [Getting Started](#getting-started)</span>
<span class="term-fg32">+    1. [How do I use the SUAVE?](#how-do-i-use-suave)</span>
<span class="term-fg32">+    1. [How do I execute a contract confidentially?](#how-do-i-execute-a-contract-confidentially)</span>
<span class="term-fg32">+    1. [How do I run a SUAVE chain node?](#how-do-i-run-a-suave-chain-node)</span>
<span class="term-fg32">+    1. [How do I run a SUAVE execution node?](#how-do-i-run-a-suave-execution-node)</span>
<span class="term-fg32">+1. [suave-geth technical details](#suave-geth-technical-details)</span>
<span class="term-fg32">+    1. [SUAVE Runtime (MEVM)](#suave-runtime-mevm)</span>
<span class="term-fg32">+    1. [Confidential execution of smart contracts](#confidential-execution-of-smart-contracts)</span>
<span class="term-fg32">+    1. [Confidential compute requests](#confidential-compute-requests)</span>
<span class="term-fg32">+    1. [SUAVE Bids](#suave-bids)</span>
<span class="term-fg32">+    1. [SUAVE library](#suave-library)</span>
<span class="term-fg32">+    1. [Offchain APIs](#offchain-apis)</span>
<span class="term-fg32">+    1. [Confidential Store](#confidential-store)</span>
<span class="term-fg32">+    1. [SUAVE Mempool](#suave-mempool)</span>
<span class="term-fg32">+    1. [Notable differences from standard issue go-ethereum](#notable-differences-from-standard-issue-go-ethereum)</span>
<span class="term-fg32">+    1. [Suave precompiles](#suave-precompiles)</span>
&nbsp;
<span class="term-fg31">-or, to build the full suite of utilities:</span>
<span class="term-fg32">+---</span>
&nbsp;
<span class="term-fg31">-```shell</span>
<span class="term-fg31">-make all</span>
<span class="term-fg31">-```</span>
<span class="term-fg32">+## Getting Started</span>
&nbsp;
<span class="term-fg31">-## Executables</span>
<span class="term-fg32">+### How do I use SUAVE?</span>
&nbsp;
<span class="term-fg31">-The go-ethereum project comes with several wrappers&#47;executables found in the `cmd`</span>
<span class="term-fg31">-directory.</span>
<span class="term-fg32">+1. **Deploy confidential smart contracts.**</span>
<span class="term-fg32">+   Smart contracts on SUAVE follow the same rules as on Ethereum with the added advantage of being able to access additional precompiles during confidential execution. Precompiles are available through the [SUAVE library](#SUAVE-library).</span>
&nbsp;
<span class="term-fg31">-|  Command   | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |</span>
<span class="term-fg31">-| :--------: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |</span>
<span class="term-fg31">-| **`geth`** | Our main Ethereum CLI client. It is the entry point into the Ethereum network (main-, test- or private net), capable of running as a full node (default), archive node (retaining all historical state) or a light node (retrieving data live). It can be used by other processes as a gateway into the Ethereum network via JSON RPC endpoints exposed on top of HTTP, WebSocket and&#47;or IPC transports. `geth --help` and the [CLI page](https:&#47;&#47;geth.ethereum.org&#47;docs&#47;fundamentals&#47;command-line-options) for command line options. |</span>
<span class="term-fg31">-|   `clef`   | Stand-alone signing tool, which can be used as a backend signer for `geth`.                                                                                                                                                                                                                                                                                                                                                                                                                                                        |</span>
<span class="term-fg31">-|  `devp2p`  | Utilities to interact with nodes on the networking layer, without running a full blockchain.                                                                                                                                                                                                                                                                                                                                                                                                                                       |</span>
<span class="term-fg31">-|  `abigen`  | Source code generator to convert Ethereum contract definitions into easy-to-use, compile-time type-safe Go packages. It operates on plain [Ethereum contract ABIs](https:&#47;&#47;docs.soliditylang.org&#47;en&#47;develop&#47;abi-spec.html) with expanded functionality if the contract bytecode is also available. However, it also accepts Solidity source files, making development much more streamlined. Please see our [Native DApps](https:&#47;&#47;geth.ethereum.org&#47;docs&#47;developers&#47;dapp-developer&#47;native-bindings) page for details.                                  |</span>
<span class="term-fg31">-| `bootnode` | Stripped down version of our Ethereum client implementation that only takes part in the network node discovery protocol, but does not run any of the higher level application protocols. It can be used as a lightweight bootstrap node to aid in finding peers in private networks.                                                                                                                                                                                                                                               |</span>
<span class="term-fg31">-|   `evm`    | Developer utility version of the EVM (Ethereum Virtual Machine) that is capable of running bytecode snippets within a configurable environment and execution mode. Its purpose is to allow isolated, fine-grained debugging of EVM opcodes (e.g. `evm --code 60ff60ff --debug run`).                                                                                                                                                                                                                                               |</span>
<span class="term-fg31">-| `rlpdump`  | Developer utility tool to convert binary RLP ([Recursive Length Prefix](https:&#47;&#47;ethereum.org&#47;en&#47;developers&#47;docs&#47;data-structures-and-encoding&#47;rlp)) dumps (data encoding used by the Ethereum protocol both network as well as consensus wise) to user-friendlier hierarchical representation (e.g. `rlpdump --hex CE0183FFFFFFC4C304050583616263`).                                                                                                                                                                                |</span>
<span class="term-fg32">+2. **NEW! Request confidential execution using the new confidential computation request.**</span>
<span class="term-fg32">+   Contracts called using confidential compute requests have access to off-chain data and APIs through SUAVE precompiles. Confidential computation is *not* reproducible on-chain, thus, users are required to whitelist a specific execution node trusted to provide the result. Eventually proofs and trusted enclaves will help to verify the results of execution.</span>
<span class="term-fg32">+      After the initial confidential computation, its result replaces the calldata for on-chain execution. This grants different behaviors to confidential, treated as off-chain, and regular on-chain transactions since off-chain APIs are inaccessible during regular chain state transition.</span>
&nbsp;
<span class="term-fg31">-## Running `geth`</span>
&nbsp;
<span class="term-fg31">-Going through all the possible command line flags is out of scope here (please consult our</span>
<span class="term-fg31">-[CLI Wiki page](https:&#47;&#47;geth.ethereum.org&#47;docs&#47;fundamentals&#47;command-line-options)),</span>
<span class="term-fg31">-but we&#39;ve enumerated a few common parameter combos to get you up to speed quickly</span>
<span class="term-fg31">-on how you can run your own `geth` instance.</span>
<span class="term-fg32">+   See [confidential compute requests](#Confidential-compute-requests) for more details.</span>
&nbsp;
<span class="term-fg31">-### Hardware Requirements</span>
<span class="term-fg32">+### How do I execute a contract confidentially?</span>
&nbsp;
<span class="term-fg31">-Minimum:</span>
<span class="term-fg32">+Let’s take a look at how you can request confidential computation through an execution node. In the code sometimes we refer to confidential computation as &quot;off-chain&quot; (expect unification).</span>
&nbsp;
<span class="term-fg31">-* CPU with 2+ cores</span>
<span class="term-fg31">-* 4GB RAM</span>
<span class="term-fg31">-* 1TB free storage space to sync the Mainnet</span>
<span class="term-fg31">-* 8 MBit&#47;sec download Internet service</span>
<span class="term-fg32">+1. Pick your favorite execution node. You’ll need its URL and wallet address. Note that the execution node is fully trusted to provide the result of your off-chain computation.</span>
&nbsp;
<span class="term-fg31">-Recommended:</span>
<span class="term-fg32">+2. Craft your confidential computation request. This is a regular Ethereum transaction, where you specify the desired contract address and it’s (public) calldata. I’m assuming you have found or deployed a smart contract which you intend to call. Don’t sign the transaction quite yet!</span>
&nbsp;
<span class="term-fg31">-* Fast CPU with 4+ cores</span>
<span class="term-fg31">-* 16GB+ RAM</span>
<span class="term-fg31">-* High-performance SSD with at least 1TB of free space</span>
<span class="term-fg31">-* 25+ MBit&#47;sec download Internet service</span>
<span class="term-fg32">+    ```go</span>
<span class="term-fg32">+    allowedPeekers := []common.Address{newBlockBidPeeker, newBundleBidPeeker, buildEthBlockPeeker} &#47;&#47; express which contracts should have access to your data (by their addresses)</span>
<span class="term-fg32">+    offchainInnerTx := &amp;types.LegacyTx{</span>
<span class="term-fg32">+        Nonce:    suaveAccNonce,</span>
<span class="term-fg32">+        To:       &amp;newBundleBidAddress,</span>
<span class="term-fg32">+        Value:    nil,</span>
<span class="term-fg32">+        Gas:      1000000,</span>
<span class="term-fg32">+        GasPrice: 50,</span>
<span class="term-fg32">+        Data:     bundleBidAbi.Pack(&quot;newBid&quot;, targetBlock, allowedPeekers)</span>
<span class="term-fg32">+    }</span>
<span class="term-fg32">+    ```</span>
&nbsp;
<span class="term-fg31">-### Full node on the main Ethereum network</span>
<span class="term-fg32">+3. Wrap your regular transaction into the new `OffchainTx` transaction type, and specify the execution node’s wallet address as the `ExecutionNode` field. Sign the transaction with your wallet.</span>
&nbsp;
<span class="term-fg31">-By far the most common scenario is people wanting to simply interact with the Ethereum</span>
<span class="term-fg31">-network: create accounts; transfer funds; deploy and interact with contracts. For this</span>
<span class="term-fg31">-particular use case, the user doesn&#39;t care about years-old historical data, so we can</span>
<span class="term-fg31">-sync quickly to the current state of the network. To do so:</span>
<span class="term-fg32">+    ```go</span>
<span class="term-fg32">+    offchainTx := types.SignTx(types.NewTx(&amp;types.OffchainTx{</span>
<span class="term-fg32">+        ExecutionNode: &quot;0x4E2B0c0e428AE1CDE26d5BcF17Ba83f447068E5B&quot;,</span>
<span class="term-fg32">+        Wrapped:       *types.NewTx(&amp;offchainInnerTx),</span>
<span class="term-fg32">+    }), suaveSigner, privKey)</span>
<span class="term-fg32">+    ```</span>
&nbsp;
<span class="term-fg31">-```shell</span>
<span class="term-fg31">-$ geth console</span>
<span class="term-fg31">-```</span>
<span class="term-fg32">+4. Request confidential computation by submitting your transaction along with your confidential data to the execution node you chose via `eth_sendRawTransaction`.</span>
&nbsp;
<span class="term-fg31">-This command will:</span>
<span class="term-fg31">- * Start `geth` in snap sync mode (default, can be changed with the `--syncmode` flag),</span>
<span class="term-fg31">-   causing it to download more data in exchange for avoiding processing the entire history</span>
<span class="term-fg31">-   of the Ethereum network, which is very CPU intensive.</span>
<span class="term-fg31">- * Start the built-in interactive [JavaScript console](https:&#47;&#47;geth.ethereum.org&#47;docs&#47;interacting-with-geth&#47;javascript-console),</span>
<span class="term-fg31">-   (via the trailing `console` subcommand) through which you can interact using [`web3` methods](https:&#47;&#47;github.com&#47;ChainSafe&#47;web3.js&#47;blob&#47;0.20.7&#47;DOCUMENTATION.md) </span>
<span class="term-fg31">-   (note: the `web3` version bundled within `geth` is very old, and not up to date with official docs),</span>
<span class="term-fg31">-   as well as `geth`&#39;s own [management APIs](https:&#47;&#47;geth.ethereum.org&#47;docs&#47;interacting-with-geth&#47;rpc).</span>
<span class="term-fg31">-   This tool is optional and if you leave it out you can always attach it to an already running</span>
<span class="term-fg31">-   `geth` instance with `geth attach`.</span>
<span class="term-fg32">+    ```go</span>
<span class="term-fg32">+    confidentialDataBytes := hexutil.Encode(ethBundle)</span>
<span class="term-fg32">+    suaveClient.Call(&quot;eth_sendRawTransaction&quot;, offchainTx, confidentialDataBytes)</span>
<span class="term-fg32">+    ```</span>
&nbsp;
<span class="term-fg31">-### A Full node on the Görli test network</span>
<span class="term-fg32">+5. All done! Once the execution node processes your computation request, the execution node will submit it as `OffchainExecutedTransaction` to the mempool.</span>
&nbsp;
<span class="term-fg31">-Transitioning towards developers, if you&#39;d like to play around with creating Ethereum</span>
<span class="term-fg31">-contracts, you almost certainly would like to do that without any real money involved until</span>
<span class="term-fg31">-you get the hang of the entire system. In other words, instead of attaching to the main</span>
<span class="term-fg31">-network, you want to join the **test** network with your node, which is fully equivalent to</span>
<span class="term-fg31">-the main network, but with play-Ether only.</span>
<span class="term-fg32">+For more on confidential compute requests see [confidential compute requests](#Confidential-compute-requests).</span>
&nbsp;
<span class="term-fg31">-```shell</span>
<span class="term-fg31">-$ geth --goerli console</span>
<span class="term-fg31">-```</span>
<span class="term-fg32">+### How do I run a SUAVE chain node?</span>
&nbsp;
<span class="term-fg31">-The `console` subcommand has the same meaning as above and is equally</span>
<span class="term-fg31">-useful on the testnet too.</span>
<span class="term-fg32">+1. Build the client with `make geth`.</span>
<span class="term-fg32">+2. Run the node. Pass in `--dev` to enable local devnet. Example:</span>
&nbsp;
<span class="term-fg31">-Specifying the `--goerli` flag, however, will reconfigure your `geth` instance a bit:</span>
<span class="term-fg32">+    ```go</span>
<span class="term-fg32">+    .&#47;build&#47;bin&#47;geth --dev --dev.gaslimit 30000000 --datadir suave_dev --http --ws --allow-insecure-unlock --unlock &quot;0xd52d1935D1239ADf94C59fA0F586fE00250694d5&quot;</span>
<span class="term-fg32">+    ```</span>
&nbsp;
<span class="term-fg31">- * Instead of connecting to the main Ethereum network, the client will connect to the Görli</span>
<span class="term-fg31">-   test network, which uses different P2P bootnodes, different network IDs and genesis</span>
<span class="term-fg31">-   states.</span>
<span class="term-fg31">- * Instead of using the default data directory (`~&#47;.ethereum` on Linux for example), `geth`</span>
<span class="term-fg31">-   will nest itself one level deeper into a `goerli` subfolder (`~&#47;.ethereum&#47;goerli` on</span>
<span class="term-fg31">-   Linux). Note, on OSX and Linux this also means that attaching to a running testnet node</span>
<span class="term-fg31">-   requires the use of a custom endpoint since `geth attach` will try to attach to a</span>
<span class="term-fg31">-   production node endpoint by default, e.g.,</span>
<span class="term-fg31">-   `geth attach &lt;datadir&gt;&#47;goerli&#47;geth.ipc`. Windows users are not affected by</span>
<span class="term-fg31">-   this.</span>
<span class="term-fg32">+3. Do your thing!</span>
&nbsp;
<span class="term-fg31">-*Note: Although some internal protective measures prevent transactions from</span>
<span class="term-fg31">-crossing over between the main network and test network, you should always</span>
<span class="term-fg31">-use separate accounts for play and real money. Unless you manually move</span>
<span class="term-fg31">-accounts, `geth` will by default correctly separate the two networks and will not make any</span>
<span class="term-fg31">-accounts available between them.*</span>
<span class="term-fg32">+### How do I run a SUAVE execution node?</span>
&nbsp;
<span class="term-fg31">-### Full node on the Rinkeby test network</span>
<span class="term-fg32">+Not all nodes serve confidential compute requests. You’ll need:</span>
<span class="term-fg32">+- A SUAVE node (see above).</span>
<span class="term-fg32">+- An account. If you are doing this for testing, simply run `geth --suave account new`. Take note of the address.</span>
<span class="term-fg32">+- Access to Ethereum’s RPC. When starting your node, pass in `--suave.eth.remote_endpoint` to point to your Ethereum RPC for off-chain execution.</span>
<span class="term-fg32">+    ```go</span>
<span class="term-fg32">+    .&#47;build&#47;bin&#47;geth --dev --dev.gaslimit 30000000 --datadir suave_dev --http --allow-insecure-unlock --unlock &quot;0x&lt;YOUR_PUBKEY&gt;&quot; --ws --suave.eth.remote_endpoint &quot;http:&#47;&#47;&lt;EXECUTION_NODE_IP&gt;&quot;</span>
<span class="term-fg32">+    ```</span>
<span class="term-fg32">+Note that simply enabling http jsonrpc and allowing direct access might not be the wisest. Look into proxyd and other restricted access solutions.</span>
&nbsp;
<span class="term-fg31">-Go Ethereum also supports connecting to the older proof-of-authority based test network</span>
<span class="term-fg31">-called [*Rinkeby*](https:&#47;&#47;www.rinkeby.io) which is operated by members of the community.</span>
<span class="term-fg32">+## suave-geth technical details</span>
&nbsp;
<span class="term-fg31">-```shell</span>
<span class="term-fg31">-$ geth --rinkeby console</span>
<span class="term-fg31">-```</span>
<span class="term-fg32">+### SUAVE Runtime (MEVM)</span>
&nbsp;
<span class="term-fg31">-### Configuration</span>
<span class="term-fg32">+[`SuaveExecutionBackend`](#SuaveExecutionBackend) 🤝 EVM = MEVM</span>
&nbsp;
<span class="term-fg31">-As an alternative to passing the numerous flags to the `geth` binary, you can also pass a</span>
<span class="term-fg31">-configuration file via:</span>
<span class="term-fg32">+More specifically, `SuaveExecutionBackend` and `Runtime` add functionality to the stock EVM which allows it both confidential computation and interaction with off-chain APIs.</span>
&nbsp;
<span class="term-fg31">-```shell</span>
<span class="term-fg31">-$ geth --config &#47;path&#47;to&#47;your_config.toml</span>
<span class="term-fg32">+```mermaid</span>
<span class="term-fg32">+graph TB</span>
<span class="term-fg32">+    A[EVM]--&gt;|1|B((StateDB))</span>
<span class="term-fg32">+    A--&gt;|2|C((Context))</span>
<span class="term-fg32">+    A--&gt;|3|D((chainConfig))</span>
<span class="term-fg32">+    A--&gt;|4|E((Config))</span>
<span class="term-fg32">+    A--&gt;|5|F((interpreter))</span>
<span class="term-fg32">+    D--&gt;|6|R[ChainRules]</span>
<span class="term-fg32">+    E--&gt;|7|S[Tracer]</span>
<span class="term-fg32">+    A--&gt;|8|T[NewRuntime]</span>
<span class="term-fg32">+    T--&gt;|9|Z((Runtime))</span>
<span class="term-fg32">+    Z--&gt;|10|F</span>
<span class="term-fg32">+    A--&gt;|11|U[NewRuntimeSuaveExecutionBackend]</span>
<span class="term-fg32">+    U--&gt;|12|V((SuaveExecutionBackend))</span>
<span class="term-fg32">+    V--&gt;|13|F</span>
<span class="term-fg32">+    class A,B,C,D,E,F yellow</span>
<span class="term-fg32">+    class G,H,I,J,K,L,M,N,O red</span>
<span class="term-fg32">+    class P,Q green</span>
<span class="term-fg32">+    class R blue</span>
<span class="term-fg32">+    class S orange</span>
<span class="term-fg32">+    class T,U purple</span>
<span class="term-fg32">+    class Z,V lightgreen</span>
<span class="term-fg32">+    classDef yellow fill:#f5cf58,stroke:#444,stroke-width:2px, color:#333;</span>
<span class="term-fg32">+    classDef red fill:#d98686,stroke:#444,stroke-width:2px, color:#333;</span>
<span class="term-fg32">+    classDef green fill:#82a682,stroke:#444,stroke-width:2px, color:#333;</span>
<span class="term-fg32">+    classDef blue fill:#9abedc,stroke:#444,stroke-width:2px, color:#333;</span>
<span class="term-fg32">+    classDef orange fill:#f3b983,stroke:#444,stroke-width:2px, color:#333;</span>
<span class="term-fg32">+    classDef purple fill:#ab92b5,stroke:#444,stroke-width:2px, color:#333;</span>
<span class="term-fg32">+    classDef lightgreen fill:#b3c69f,stroke:#444,stroke-width:2px, color:#333;</span>
 ```
&nbsp;
<span class="term-fg31">-To get an idea of how the file should look like you can use the `dumpconfig` subcommand to</span>
<span class="term-fg31">-export your existing configuration:</span>
<span class="term-fg32">+The capabilities enabled by this modified runtime are exposed via the APIs `ConfiendialStoreBackend` , `MempoolBackend`, `ConfiendialStoreBackend`, as well as access to `confidentialInputs` to confidential compute requests and `callerStack`.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+```go</span>
<span class="term-fg32">+func NewRuntimeSuaveExecutionBackend(evm *EVM, caller common.Address) *SuaveExecutionBackend {</span>
<span class="term-fg32">+	if !evm.Config.IsOffchain {</span>
<span class="term-fg32">+		return nil</span>
<span class="term-fg32">+	}</span>
&nbsp;
<span class="term-fg31">-```shell</span>
<span class="term-fg31">-$ geth --your-favourite-flags dumpconfig</span>
<span class="term-fg32">+	return &amp;SuaveExecutionBackend{</span>
<span class="term-fg32">+		ConfiendialStoreBackend: evm.suaveExecutionBackend.ConfiendialStoreBackend,</span>
<span class="term-fg32">+		MempoolBackned:          evm.suaveExecutionBackend.MempoolBackned,</span>
<span class="term-fg32">+		OffchainEthBackend:      evm.suaveExecutionBackend.OffchainEthBackend,</span>
<span class="term-fg32">+		confidentialInputs:      evm.suaveExecutionBackend.confidentialInputs,</span>
<span class="term-fg32">+		callerStack:             append(evm.suaveExecutionBackend.callerStack, &amp;caller),</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span>
 ```
&nbsp;
<span class="term-fg31">-*Note: This works only with `geth` v1.6.0 and above.*</span>
<span class="term-fg32">+All of these newly offered APIs are available to your solidity smart contract through the use of precompiles! See below for how confidential computation and smart contracts interact.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+### Confidential execution of smart contracts</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+The virtual machine (MEVM) inside SUAVE nodes have two modes of operation: regular and confidential (sometimes called off-chain). Regulal on-chain environment is your usual Ethereum virtual machine environment.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+Confidential environment is available to users through a new type of ransaction - `OffchainTx` via the usual jsonrpc methods `eth_sendRawTransaction`, `eth_sendTransaction` and `eth_call`. Simulations (`eth_call`) requested with a new optional argument `IsOffchain are also executed in the confidential mode`. For more on confidential requests see [confidential compute requests](#Confidential-compute-requests).</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+The confidential execution environment provides additional precompiles, both directly and through a convenient [library](#SUAVE-library). Confidential execution is *not* verifiable during on-chain state transition, instead the result of the confidential execution is cached in the transaction (`OffchainExecutedTx`). Users requesting confidential compute requests specify which execution nodes they trust with execution, and the execution nodes&#39; signature is used for verifying the transaction on-chain.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+The cached result of confidential execution is used as calldata in the transaction that inevitably makes its way onto the SUAVE chain.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+Other than ability to access new precompiles, the contracts aiming to be executed confidentially are written as usual in Solidity (or any other language) and compiled to EVM bytecode.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+### Confidential compute requests</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+We introduce two new transaction types: `OffchainTx`, serving as a request of confidential computation, and `OffchainExecutedTx` which is the result of a confidential computation. The new confidential computation transactions track the usage of gas during confidential computation, and contain (or reference) the result of the computation in a chain-friendly manner.</span>
&nbsp;
<span class="term-fg31">-#### Docker quick start</span>
<span class="term-fg32">+![image](suave&#47;docs&#47;conf_comp_request_flow.png)</span>
&nbsp;
<span class="term-fg31">-One of the quickest ways to get Ethereum up and running on your machine is by using</span>
<span class="term-fg31">-Docker:</span>
<span class="term-fg32">+confidential compute requests (`OffchainTx`) are only intermediary message between the user requesting confidential computation and the execution node, and are not currently propagated through the mempool or included in blocks. The results of those computations (`OffchainExecutedTx`) are treated as regular transactions.</span>
&nbsp;
<span class="term-fg31">-```shell</span>
<span class="term-fg31">-docker run -d --name ethereum-node -v &#47;Users&#47;alice&#47;ethereum:&#47;root \</span>
<span class="term-fg31">-           -p 8545:8545 -p 30303:30303 \</span>
<span class="term-fg31">-           ethereum&#47;client-go</span>
<span class="term-fg32">+```go</span>
<span class="term-fg32">+type OffchainTx struct {</span>
<span class="term-fg32">+    ExecutionNode common.Address</span>
<span class="term-fg32">+    Wrapped  Transaction</span>
<span class="term-fg32">+}</span>
 ```
&nbsp;
<span class="term-fg31">-This will start `geth` in snap-sync mode with a DB memory allowance of 1GB, as the</span>
<span class="term-fg31">-above command does.  It will also create a persistent volume in your home directory for</span>
<span class="term-fg31">-saving your blockchain as well as map the default ports. There is also an `alpine` tag</span>
<span class="term-fg31">-available for a slim version of the image.</span>
<span class="term-fg32">+`OffchainExecutedTx` transactions are propagated through the mempool and inserted into blocks as expected, unifying confidential computation with regular on-chain execution.</span>
&nbsp;
<span class="term-fg31">-Do not forget `--http.addr 0.0.0.0`, if you want to access RPC from other containers</span>
<span class="term-fg31">-and&#47;or hosts. By default, `geth` binds to the local interface and RPC endpoints are not</span>
<span class="term-fg31">-accessible from the outside.</span>
<span class="term-fg32">+```go</span>
<span class="term-fg32">+type OffchainExecutedTx struct {</span>
<span class="term-fg32">+    ExecutionNode  common.Address</span>
<span class="term-fg32">+    Wrapped        Transaction</span>
<span class="term-fg32">+    OffchainResult []byte</span>
<span class="term-fg32">+    &#47;* Execution node&#39;s signature fields *&#47;</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+```</span>
&nbsp;
<span class="term-fg31">-### Programmatically interfacing `geth` nodes</span>
<span class="term-fg32">+The confidential computation result is placed in the `OffchainResult` field, which is further used instead of the original transaction&#39;s calldata for on-chain execution.</span>
&nbsp;
<span class="term-fg31">-As a developer, sooner rather than later you&#39;ll want to start interacting with `geth` and the</span>
<span class="term-fg31">-Ethereum network via your own programs and not manually through the console. To aid</span>
<span class="term-fg31">-this, `geth` has built-in support for a JSON-RPC based APIs ([standard APIs](https:&#47;&#47;ethereum.github.io&#47;execution-apis&#47;api-documentation&#47;)</span>
<span class="term-fg31">-and [`geth` specific APIs](https:&#47;&#47;geth.ethereum.org&#47;docs&#47;interacting-with-geth&#47;rpc)).</span>
<span class="term-fg31">-These can be exposed via HTTP, WebSockets and IPC (UNIX sockets on UNIX based</span>
<span class="term-fg31">-platforms, and named pipes on Windows).</span>
<span class="term-fg32">+The basic flow is as follows:</span>
&nbsp;
<span class="term-fg31">-The IPC interface is enabled by default and exposes all the APIs supported by `geth`,</span>
<span class="term-fg31">-whereas the HTTP and WS interfaces need to manually be enabled and only expose a</span>
<span class="term-fg31">-subset of APIs due to security reasons. These can be turned on&#47;off and configured as</span>
<span class="term-fg31">-you&#39;d expect.</span>
<span class="term-fg32">+1. User crafts a usual legacy&#47;dynamic transaction, which calls the contract of their liking</span>
<span class="term-fg32">+2. User crafts the confidential computation request (`OffchainTx`):</span>
<span class="term-fg32">+    1. User choses an execution node of their liking, that is an address whose signature over the confidential computation result will be trusted</span>
<span class="term-fg32">+    2. User embeds the transaction from (1.) into an `OffchainTx` together with the desired execution node&#39;s address</span>
<span class="term-fg32">+    3. User signs and sends the confidential computation request to an execution node via `eth_sendRawTransaction` (possibly passing in additional confidential data)</span>
<span class="term-fg32">+3. The execution node executes the transaction in the confidential mode, providing access to the usual off-chain APIs</span>
<span class="term-fg32">+4. Execution node creates an `OffchainExecutedTx` using the confidential computation request the result of its execution, signs and submits the transaction into the mempool</span>
<span class="term-fg32">+5. The transaction makes its way into a block, by executing the `OffchainResult` as calldata, as long as the execution node&#39;s signature matches the requested executor node in (2.1.)</span>
&nbsp;
<span class="term-fg31">-HTTP based JSON-RPC API options:</span>
<span class="term-fg32">+The user passes in any confidential data through the new `confidential_data` parameter of the `eth_sendRawTransaction` RPC method. The initial confidential computation has access to both the public and confidential data, but only the public data becomes part of the transaction propagated through the mempool. Any confidential data passed in by the user is discarded after the execution.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+Architecture reference</span>
<span class="term-fg32">+![image](suave&#47;docs&#47;execution_node_architecture.png)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+Mind, that the results are not reproducible as they are based on confidential data that is dropped after execution, and off-chain data that might change with time. On-chain state transition only depends on the result of the confidential computation, so it is fully reproducible.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+### SUAVE Bids</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+On the SUAVE chain, bids serve as the primary transaction unit, and are used for interactions between smart contracts and the Confidential Store.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+A `Bid` is a data structure encapsulating key information about a transaction on the SUAVE chain.</span>
&nbsp;
<span class="term-fg31">-  * `--http` Enable the HTTP-RPC server</span>
<span class="term-fg31">-  * `--http.addr` HTTP-RPC server listening interface (default: `localhost`)</span>
<span class="term-fg31">-  * `--http.port` HTTP-RPC server listening port (default: `8545`)</span>
<span class="term-fg31">-  * `--http.api` API&#39;s offered over the HTTP-RPC interface (default: `eth,net,web3`)</span>
<span class="term-fg31">-  * `--http.corsdomain` Comma separated list of domains from which to accept cross origin requests (browser enforced)</span>
<span class="term-fg31">-  * `--ws` Enable the WS-RPC server</span>
<span class="term-fg31">-  * `--ws.addr` WS-RPC server listening interface (default: `localhost`)</span>
<span class="term-fg31">-  * `--ws.port` WS-RPC server listening port (default: `8546`)</span>
<span class="term-fg31">-  * `--ws.api` API&#39;s offered over the WS-RPC interface (default: `eth,net,web3`)</span>
<span class="term-fg31">-  * `--ws.origins` Origins from which to accept WebSocket requests</span>
<span class="term-fg31">-  * `--ipcdisable` Disable the IPC-RPC server</span>
<span class="term-fg31">-  * `--ipcapi` API&#39;s offered over the IPC-RPC interface (default: `admin,debug,eth,miner,net,personal,txpool,web3`)</span>
<span class="term-fg31">-  * `--ipcpath` Filename for IPC socket&#47;pipe within the datadir (explicit paths escape it)</span>
<span class="term-fg32">+```go</span>
<span class="term-fg32">+type Bid struct {</span>
<span class="term-fg32">+	Id                  BidId            `json:&quot;id&quot;`</span>
<span class="term-fg32">+	DecryptionCondition uint64           `json:&quot;decryptionCondition&quot;`</span>
<span class="term-fg32">+	AllowedPeekers      []common.Address `json:&quot;allowedPeekers&quot;`</span>
<span class="term-fg32">+	Version             string           `json:&quot;version&quot;`</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+```</span>
&nbsp;
<span class="term-fg31">-You&#39;ll need to use your own programming environments&#39; capabilities (libraries, tools, etc) to</span>
<span class="term-fg31">-connect via HTTP, WS or IPC to a `geth` node configured with the above flags and you&#39;ll</span>
<span class="term-fg31">-need to speak [JSON-RPC](https:&#47;&#47;www.jsonrpc.org&#47;specification) on all transports. You</span>
<span class="term-fg31">-can reuse the same connection for multiple requests!</span>
<span class="term-fg32">+Each `Bid` has an `Id`, a `DecryptionCondition`, an array of `AllowedPeekers`, and a `Version`. The `DecryptionCondition` signifies the block number at which the bid can be decrypted and is typically derived from the source contract or may even be a contract itself. The `AllowedPeekers` are the addresses that are permitted to access the data associated with the bid, providing an added layer of access control. The `Version` indicates the version of the protocol used for the bid.</span>
&nbsp;
<span class="term-fg31">-**Note: Please understand the security implications of opening up an HTTP&#47;WS based</span>
<span class="term-fg31">-transport before doing so! Hackers on the internet are actively trying to subvert</span>
<span class="term-fg31">-Ethereum nodes with exposed APIs! Further, all browser tabs can access locally</span>
<span class="term-fg31">-running web servers, so malicious web pages could try to subvert locally available</span>
<span class="term-fg31">-APIs!**</span>
<span class="term-fg32">+### SUAVE library</span>
&nbsp;
<span class="term-fg31">-### Operating a private network</span>
<span class="term-fg32">+Along the SUAVE precompiles, we provide a convenient wrapper for calling them from Solidity. The [library](suave&#47;sol&#47;libraries&#47;Suave.sol) makes the precompiles easier to call by providing the signatures, and the library functions themselves simply perform a `staticcall` of the requested precompile.</span>
&nbsp;
<span class="term-fg31">-Maintaining your own private network is more involved as a lot of configurations taken for</span>
<span class="term-fg31">-granted in the official networks need to be manually set up.</span>
<span class="term-fg32">+```solidity</span>
<span class="term-fg32">+library Suave {</span>
<span class="term-fg32">+    error PeekerReverted(address, bytes);</span>
&nbsp;
<span class="term-fg31">-#### Defining the private genesis state</span>
<span class="term-fg32">+    type BidId is bytes16;</span>
&nbsp;
<span class="term-fg31">-First, you&#39;ll need to create the genesis state of your networks, which all nodes need to be</span>
<span class="term-fg31">-aware of and agree upon. This consists of a small JSON file (e.g. call it `genesis.json`):</span>
<span class="term-fg32">+    struct Bid {</span>
<span class="term-fg32">+        BidId id;</span>
<span class="term-fg32">+        uint64 decryptionCondition;</span>
<span class="term-fg32">+        address[] allowedPeekers;</span>
<span class="term-fg32">+    }</span>
&nbsp;
<span class="term-fg31">-```json</span>
<span class="term-fg31">-{</span>
<span class="term-fg31">-  &quot;config&quot;: {</span>
<span class="term-fg31">-    &quot;chainId&quot;: &lt;arbitrary positive integer&gt;,</span>
<span class="term-fg31">-    &quot;homesteadBlock&quot;: 0,</span>
<span class="term-fg31">-    &quot;eip150Block&quot;: 0,</span>
<span class="term-fg31">-    &quot;eip155Block&quot;: 0,</span>
<span class="term-fg31">-    &quot;eip158Block&quot;: 0,</span>
<span class="term-fg31">-    &quot;byzantiumBlock&quot;: 0,</span>
<span class="term-fg31">-    &quot;constantinopleBlock&quot;: 0,</span>
<span class="term-fg31">-    &quot;petersburgBlock&quot;: 0,</span>
<span class="term-fg31">-    &quot;istanbulBlock&quot;: 0,</span>
<span class="term-fg31">-    &quot;berlinBlock&quot;: 0,</span>
<span class="term-fg31">-    &quot;londonBlock&quot;: 0</span>
<span class="term-fg31">-  },</span>
<span class="term-fg31">-  &quot;alloc&quot;: {},</span>
<span class="term-fg31">-  &quot;coinbase&quot;: &quot;0x0000000000000000000000000000000000000000&quot;,</span>
<span class="term-fg31">-  &quot;difficulty&quot;: &quot;0x20000&quot;,</span>
<span class="term-fg31">-  &quot;extraData&quot;: &quot;&quot;,</span>
<span class="term-fg31">-  &quot;gasLimit&quot;: &quot;0x2fefd8&quot;,</span>
<span class="term-fg31">-  &quot;nonce&quot;: &quot;0x0000000000000042&quot;,</span>
<span class="term-fg31">-  &quot;mixhash&quot;: &quot;0x0000000000000000000000000000000000000000000000000000000000000000&quot;,</span>
<span class="term-fg31">-  &quot;parentHash&quot;: &quot;0x0000000000000000000000000000000000000000000000000000000000000000&quot;,</span>
<span class="term-fg31">-  &quot;timestamp&quot;: &quot;0x00&quot;</span>
<span class="term-fg32">+    function isOffchain() internal view returns (bool b)</span>
<span class="term-fg32">+    function confidentialInputs() internal view returns (bytes memory)</span>
<span class="term-fg32">+    function newBid(uint64 decryptionCondition, address[] memory allowedPeekers, string memory BidType) internal view returns (Bid memory)</span>
<span class="term-fg32">+    function fetchBids(uint64 cond, string memory namespace) internal view returns (Bid[] memory)</span>
<span class="term-fg32">+    function confidentialStoreStore(BidId bidId, string memory key, bytes memory data) internal view</span>
<span class="term-fg32">+    function confidentialStoreRetrieve(BidId bidId, string memory key) internal view returns (bytes memory)</span>
<span class="term-fg32">+    function simulateBundle(bytes memory bundleData) internal view returns (bool, uint64)</span>
<span class="term-fg32">+    function extractHint(bytes memory bundleData) internal view returns (bytes memory)</span>
<span class="term-fg32">+    function buildEthBlock(BuildBlockArgs memory blockArgs, BidId bid, string memory namespace) internal view returns (bytes memory, bytes memory)</span>
<span class="term-fg32">+    function submitEthBlockBidToRelay(string memory relayUrl, bytes memory builderBid) internal view returns (bool, bytes memory)</span>
 }
 ```
&nbsp;
<span class="term-fg31">-The above fields should be fine for most purposes, although we&#39;d recommend changing</span>
<span class="term-fg31">-the `nonce` to some random value so you prevent unknown remote nodes from being able</span>
<span class="term-fg31">-to connect to you. If you&#39;d like to pre-fund some accounts for easier testing, create</span>
<span class="term-fg31">-the accounts and populate the `alloc` field with their addresses.</span>
<span class="term-fg32">+### Offchain APIs</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+Off-chain precompiles have access to the following [off-chain APIs](suave&#47;core&#47;types.go) during execution.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+```go</span>
<span class="term-fg32">+type ConfiendialStoreBackend interface {</span>
<span class="term-fg32">+    Initialize(bid Bid, key string, value []byte) (Bid, error)</span>
<span class="term-fg32">+    Store(bidId BidId, caller common.Address, key string, value []byte) (Bid, error)</span>
<span class="term-fg32">+    Retrieve(bid BidId, caller common.Address, key string) ([]byte, error)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+type MempoolBackend interface {</span>
<span class="term-fg32">+    SubmitBid(Bid) error</span>
<span class="term-fg32">+    FetchBidById(BidId) (Bid, error)</span>
<span class="term-fg32">+    FetchBidsByProtocolAndBlock(blockNumber uint64, namespace string) []Bid</span>
<span class="term-fg32">+}</span>
&nbsp;
<span class="term-fg31">-```json</span>
<span class="term-fg31">-&quot;alloc&quot;: {</span>
<span class="term-fg31">-  &quot;0x0000000000000000000000000000000000000001&quot;: {</span>
<span class="term-fg31">-    &quot;balance&quot;: &quot;111111111&quot;</span>
<span class="term-fg31">-  },</span>
<span class="term-fg31">-  &quot;0x0000000000000000000000000000000000000002&quot;: {</span>
<span class="term-fg31">-    &quot;balance&quot;: &quot;222222222&quot;</span>
<span class="term-fg31">-  }</span>
<span class="term-fg32">+type OffchainEthBackend interface {</span>
<span class="term-fg32">+    BuildEthBlock(ctx context.Context, args *BuildBlockArgs, txs types.Transactions) (*engine.ExecutionPayloadEnvelope, error)</span>
<span class="term-fg32">+    BuildEthBlockFromBundles(ctx context.Context, args *BuildBlockArgs, bundles []types.SBundle) (*engine.ExecutionPayloadEnvelope, error)</span>
 }
 ```
&nbsp;
<span class="term-fg31">-With the genesis state defined in the above JSON file, you&#39;ll need to initialize **every**</span>
<span class="term-fg31">-`geth` node with it prior to starting it up to ensure all blockchain parameters are correctly</span>
<span class="term-fg31">-set:</span>
<span class="term-fg32">+### Confidential Store</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+The Confidential Store is an integral part of the SUAVE chain, designed to facilitate secure and privacy-preserving transactions and smart contract interactions. It functions as a key-value store where users can safely store and retrieve confidential data related to their bids. The Confidential Store restricts access (both reading and writing) only to the allowed peekers of each bid, allowing developers to define the entire data model of their application!</span>
&nbsp;
<span class="term-fg31">-```shell</span>
<span class="term-fg31">-$ geth init path&#47;to&#47;genesis.json</span>
<span class="term-fg32">+The current, and certainly not final, implementation of the Confidential Store is managed by the `LocalConfidentialStore` struct. It provides thread-safe access to the bids&#39; confidential data. The `LocalConfidentialStore` struct is composed of a mutex lock and a map of bid data, `ACData`, indexed by a `BidId`.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+```go</span>
<span class="term-fg32">+type LocalConfidentialStore struct {</span>
<span class="term-fg32">+	lock sync.Mutex</span>
<span class="term-fg32">+	bids map[suave.BidId]ACData</span>
<span class="term-fg32">+}</span>
 ```
<span class="term-fg32">+`ACData` is another struct that contains a `bid` and a `dataMap`. The `dataMap` is a key-value store that holds the actual confidential data of the bids.</span>
&nbsp;
<span class="term-fg31">-#### Creating the rendezvous point</span>
<span class="term-fg32">+```go</span>
<span class="term-fg32">+type ACData struct {</span>
<span class="term-fg32">+	bid     suave.Bid</span>
<span class="term-fg32">+	dataMap map[string][]byte</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+```</span>
&nbsp;
<span class="term-fg31">-With all nodes that you want to run initialized to the desired genesis state, you&#39;ll need to</span>
<span class="term-fg31">-start a bootstrap node that others can use to find each other in your network and&#47;or over</span>
<span class="term-fg31">-the internet. The clean way is to configure and run a dedicated bootnode:</span>
<span class="term-fg32">+The `LocalConfidentialStore` provides the following key methods:</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+- **Initialize**: This method is used to initialize a bid with a given `bid.Id`. If no `bid.Id` is provided, a new one is created. The method is trusted, meaning it is not directly accessible through precompiles.</span>
<span class="term-fg32">+- **Store**: This method stores a given value under a specified key in a bid&#39;s `dataMap`. Access is restricted only to addresses listed in the bid&#39;s `AllowedPeekers`.</span>
<span class="term-fg32">+- **Retrieve**: This method retrieves data associated with a given key from a bid&#39;s `dataMap`. Similar to the `Store` method, access is restricted only to addresses listed in the bid&#39;s `AllowedPeekers`.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+It is important to note that the actual implementation of the Confidential Store will vary depending on future requirements and the privacy mechanisms used.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+### SUAVE Mempool</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+The SUAVE mempool is a temporary storage pool for transactions waiting to be added to the blockchain. This mempool, `MempoolOnConfidentialStore`, operates on the Confidential Store, hence facilitating the privacy-preserving handling of bid transactions. The `MempoolOnConfidentialStore` is designed to handle SUAVE bids, namely the submission, retrieval, and grouping of bids by decryption condition such as block number and protocol. It provides a secure and efficient mechanism for managing these transactions while preserving their confidentiality.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+The `MempoolOnConfidentialStore` interacts directly with the `ConfiendialStoreBackend` interface.</span>
&nbsp;
<span class="term-fg31">-```shell</span>
<span class="term-fg31">-$ bootnode --genkey=boot.key</span>
<span class="term-fg31">-$ bootnode --nodekey=boot.key</span>
<span class="term-fg32">+```go</span>
<span class="term-fg32">+type MempoolOnConfidentialStore struct {</span>
<span class="term-fg32">+	cs suave.ConfiendialStoreBackend</span>
<span class="term-fg32">+}</span>
 ```
<span class="term-fg32">+It is initialized with a predefined `mempoolConfidentialStoreBid` that&#39;s only accessible by a particular address `mempoolConfStoreAddr`.</span>
&nbsp;
<span class="term-fg31">-With the bootnode online, it will display an [`enode` URL](https:&#47;&#47;ethereum.org&#47;en&#47;developers&#47;docs&#47;networking-layer&#47;network-addresses&#47;#enode)</span>
<span class="term-fg31">-that other nodes can use to connect to it and exchange peer information. Make sure to</span>
<span class="term-fg31">-replace the displayed IP address information (most probably `[::]`) with your externally</span>
<span class="term-fg31">-accessible IP to get the actual `enode` URL.</span>
<span class="term-fg32">+```go</span>
<span class="term-fg32">+mempoolConfidentialStoreBid = suave.Bid{Id: mempoolConfStoreId, AllowedPeekers: []common.Address{mempoolConfStoreAddr}}</span>
<span class="term-fg32">+```</span>
<span class="term-fg32">+The `MempoolOnConfidentialStore` includes three primary methods:</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+- **SubmitBid**: This method submits a bid to the mempool. The bid is stored in the Confidential Store with its ID as the key. Additionally, the bid is grouped by block number and protocol, which are also stored in the Confidential Store.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+- **FetchBidById**: This method retrieves a bid from the mempool using its ID.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+- **FetchBidsByProtocolAndBlock**: This method fetches all bids from a particular block and matching a specified protocol.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+The mempool operates on the underlying Confidential Store, thereby maintaining the confidentiality of the bids throughout the transaction process. As such, all data access is subject to the Confidential Store&#39;s security controls, ensuring privacy and integrity. Please note that while this initial implementation provides an idea of the ideal functionality, the final version will most likely incorporate additional features or modifications.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+## Notable differences from standard issue go-ethereum</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+### Changes to RPC methods</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+1. New `IsOffchain` and `ExecutionNode` fields are added to TransactionArgs, used in `eth_sendTransaction` and `eth_call` methods.</span>
<span class="term-fg32">+If `IsOffchain` is set to true, the call will be performed as an off-chain call, using the `ExecutionNode` passed in for constructing `OffchainTx`.</span>
<span class="term-fg32">+`OffchainExecutedTx` is the result of `eth_sendTransaction`!</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+2. New optional argument - `confidential_data` is added to `eth_sendRawTransaction`, `eth_sendTransaction` and `eth_call` methods.</span>
<span class="term-fg32">+The confidential data is made available to the EVM in the confidential mode via a precompile, but does not become a part of the transaction that makes it to chain. This allows performing computation based on confidential data (like simulating a bundle, putting the data into confidential store).</span>
&nbsp;
<span class="term-fg31">-*Note: You could also use a full-fledged `geth` node as a bootnode, but it&#39;s the less</span>
<span class="term-fg31">-recommended way.*</span>
&nbsp;
<span class="term-fg31">-#### Starting up your member nodes</span>
<span class="term-fg32">+### SuavePrecompiledContract</span>
&nbsp;
<span class="term-fg31">-With the bootnode operational and externally reachable (you can try</span>
<span class="term-fg31">-`telnet &lt;ip&gt; &lt;port&gt;` to ensure it&#39;s indeed reachable), start every subsequent `geth`</span>
<span class="term-fg31">-node pointed to the bootnode for peer discovery via the `--bootnodes` flag. It will</span>
<span class="term-fg31">-probably also be desirable to keep the data directory of your private network separated, so</span>
<span class="term-fg31">-do also specify a custom `--datadir` flag.</span>
<span class="term-fg32">+We introduce a new interface [SuavePrecompiledContract](core&#47;vm&#47;contracts.go) for SUAVE precompiles.</span>
&nbsp;
<span class="term-fg31">-```shell</span>
<span class="term-fg31">-$ geth --datadir=path&#47;to&#47;custom&#47;data&#47;folder --bootnodes=&lt;bootnode-enode-url-from-above&gt;</span>
<span class="term-fg32">+```</span>
<span class="term-fg32">+type SuavePrecompiledContract interface {</span>
<span class="term-fg32">+	PrecompiledContract</span>
<span class="term-fg32">+	RunOffchain(backend *SuaveExecutionBackend, input []byte) ([]byte, error)</span>
<span class="term-fg32">+}</span>
 ```
&nbsp;
<span class="term-fg31">-*Note: Since your network will be completely cut off from the main and test networks, you&#39;ll</span>
<span class="term-fg31">-also need to configure a miner to process transactions and create new blocks for you.*</span>
<span class="term-fg32">+The method `RunOffchain` is invoked during confidential execution, and the suave execution backend which provides access to off-chain APIs is passed in as input.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+### SUAVE precompile wrapper</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+We introduce [SuavePrecompiledContractWrapper](core&#47;vm&#47;suave.go) implementing the `PrecompiledContract` interface. The new structure captures the off-chain APIs in its constructor, and passes the off-chain APIs during the usual contract&#39;s `Run` method to a separate method - `RunOffchain`</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+### SuaveExecutionBackend</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+We introduce [SuaveExecutionBackend](core&#47;vm&#47;suave.go), which allows access to off-chain capabilities during confidential execution:</span>
<span class="term-fg32">+* Access to off-chain APIs</span>
<span class="term-fg32">+* Access to confidential input</span>
<span class="term-fg32">+* Caller stack tracing</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+The backend is only available to confidential execution!</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+### EVM Interpreter</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+The [EVM interpreter](core&#47;vm&#47;interpreter.go) is modified to allow for confidential computation&#39;s needs:</span>
<span class="term-fg32">+* We introduce `IsOffchain` to the interpreter&#39;s config</span>
<span class="term-fg32">+* We modify the `Run` function to accept off-chain APIs `func (in *EVMInterpreter) Run(*SuaveExecutionBackend, *Contract, []byte, bool) ([]byte, err)`</span>
<span class="term-fg32">+* We modify the `Run` function to trace the caller stack</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+Like `eth_sendTransaction`, this method accepts an additional, optional confidential inputs argument.</span>
&nbsp;
<span class="term-fg31">-#### Running a private miner</span>
&nbsp;
<span class="term-fg32">+### Basic Eth block building RPC</span>
&nbsp;
<span class="term-fg31">-In a private network setting a single CPU miner instance is more than enough for</span>
<span class="term-fg31">-practical purposes as it can produce a stable stream of blocks at the correct intervals</span>
<span class="term-fg31">-without needing heavy resources (consider running on a single thread, no need for multiple</span>
<span class="term-fg31">-ones either). To start a `geth` instance for mining, run it with all your usual flags, extended</span>
<span class="term-fg31">-by:</span>
<span class="term-fg32">+We implement two rpc methods that allow building Ethereum blocks from a list of either transactions or bundles: `BuildEth2Block` and `BuildEth2BlockFromBundles`.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+This methods are defined in [BlockChainAPI](internal&#47;ethapi&#47;api.go)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+```go</span>
<span class="term-fg32">+func (s *BlockChainAPI) BuildEth2Block(ctx context.Context, buildArgs *types.BuildBlockArgs, txs types.Transactions) (*engine.ExecutionPayloadEnvelope, error)</span>
<span class="term-fg32">+func (s *BlockChainAPI) BuildEth2BlockFromBundles(ctx context.Context, buildArgs *types.BuildBlockArgs, bundles []types.SBundle) (*engine.ExecutionPayloadEnvelope, error)</span>
&nbsp;
<span class="term-fg31">-```shell</span>
<span class="term-fg31">-$ geth &lt;usual-flags&gt; --mine --miner.threads=1 --miner.etherbase=0x0000000000000000000000000000000000000000</span>
 ```
&nbsp;
<span class="term-fg31">-Which will start mining blocks and transactions on a single CPU thread, crediting all</span>
<span class="term-fg31">-proceedings to the account specified by `--miner.etherbase`. You can further tune the mining</span>
<span class="term-fg31">-by changing the default gas limit blocks converge to (`--miner.targetgaslimit`) and the price</span>
<span class="term-fg31">-transactions are accepted at (`--miner.gasprice`).</span>
<span class="term-fg32">+The methods are implemented in [worker](miner&#47;worker.go), by `buildBlockFromTxs` and `buildBlockFromBundles` respectively.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+`buildBlockFromTxs` will simply build a block out of the transactions provided, while `buildBlockFromBundles` will in addition forward the block profit to the requested fee recipient, as needed for boost relay payments.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+## SUAVE precompiles</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+Additional precompiles available via the EVM.</span>
<span class="term-fg32">+Only `IsOffchain` is available during on-chain execution, and simply returns false.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+For details and implementation see [contracts_suave.go](core&#47;vm&#47;contracts_suave.go)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+### IsOffchain</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+|   |   |</span>
<span class="term-fg32">+|---|---|</span>
<span class="term-fg32">+| Address | `0x42010000` |</span>
<span class="term-fg32">+| Inputs | None |</span>
<span class="term-fg32">+| Outputs | boolean |</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+Outputs whether execution mode is regular (on-chain) or confidential.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+### ConfidentialInputs</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+|   |   |</span>
<span class="term-fg32">+|---|---|</span>
<span class="term-fg32">+| Address | `0x42010001` |</span>
<span class="term-fg32">+| Inputs | None |</span>
<span class="term-fg32">+| Outputs | bytes |</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+Outputs the confidential inputs passed in with the confidential computation request.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+NOTE: currently all precompiles have access to the data passed in. This might change in the future.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+### ConfidentialStore</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+|   |   |</span>
<span class="term-fg32">+|---|---|</span>
<span class="term-fg32">+| Address | `0x42020000` |</span>
<span class="term-fg32">+| Inputs | (Suave.BidId bidId, string key, bytes data) |</span>
<span class="term-fg32">+| Outputs | None |</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+Stores the value in underlying confidential store.</span>
<span class="term-fg32">+Requires that the caller is present in the `AllowedPeekers` of the bid passed in!</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+### ConfidentialRetrieve</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+|   |   |</span>
<span class="term-fg32">+|---|---|</span>
<span class="term-fg32">+| Address | `0x42020001` |</span>
<span class="term-fg32">+| Inputs | (Suave.BidId bidId, string key) |</span>
<span class="term-fg32">+| Outputs | bytes |</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+Retrieves the value from underlying confidential store.</span>
<span class="term-fg32">+Requires that the caller is present in the `AllowedPeekers` of the bid passed in!</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+### NewBid</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+|   |   |</span>
<span class="term-fg32">+|---|---|</span>
<span class="term-fg32">+| Address | `0x42030000` |</span>
<span class="term-fg32">+| Inputs | (uint64 decryptionCondition, string[] allowedPeekers) |</span>
<span class="term-fg32">+| Outputs | Suave.Bid |</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+Initializes the bid in ConfidentialStore. All bids must be initialized before attempting to store data on them.</span>
<span class="term-fg32">+Initialization of bids can *only* be done through this precompile!</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+### FetchBids</span>
&nbsp;
<span class="term-fg31">-## Contribution</span>
<span class="term-fg32">+|   |   |</span>
<span class="term-fg32">+|---|---|</span>
<span class="term-fg32">+| Address | `0x42030001` |</span>
<span class="term-fg32">+| Inputs | uint64 DecryptionCondition |</span>
<span class="term-fg32">+| Outputs | Suave.Bid[] |</span>
&nbsp;
<span class="term-fg31">-Thank you for considering helping out with the source code! We welcome contributions</span>
<span class="term-fg31">-from anyone on the internet, and are grateful for even the smallest of fixes!</span>
<span class="term-fg32">+Returns all bids matching the decryption condition.</span>
<span class="term-fg32">+This method is subject to change! In the near future bids will be stored in a different way, possibly changing how they are accessed.</span>
&nbsp;
<span class="term-fg31">-If you&#39;d like to contribute to go-ethereum, please fork, fix, commit and send a pull request</span>
<span class="term-fg31">-for the maintainers to review and merge into the main code base. If you wish to submit</span>
<span class="term-fg31">-more complex changes though, please check up with the core devs first on [our Discord Server](https:&#47;&#47;discord.gg&#47;invite&#47;nthXNEv)</span>
<span class="term-fg31">-to ensure those changes are in line with the general philosophy of the project and&#47;or get</span>
<span class="term-fg31">-some early feedback which can make both your efforts much lighter as well as our review</span>
<span class="term-fg31">-and merge procedures quick and simple.</span>
<span class="term-fg32">+### SimulateBundle</span>
&nbsp;
<span class="term-fg31">-Please make sure your contributions adhere to our coding guidelines:</span>
<span class="term-fg32">+|   |   |</span>
<span class="term-fg32">+|---|---|</span>
<span class="term-fg32">+| Address | `0x42100000` |</span>
<span class="term-fg32">+| Inputs | bytes bundleArgs (json) |</span>
<span class="term-fg32">+| Outputs | (bool success, uint64 egp) |</span>
&nbsp;
<span class="term-fg31">- * Code must adhere to the official Go [formatting](https:&#47;&#47;golang.org&#47;doc&#47;effective_go.html#formatting)</span>
<span class="term-fg31">-   guidelines (i.e. uses [gofmt](https:&#47;&#47;golang.org&#47;cmd&#47;gofmt&#47;)).</span>
<span class="term-fg31">- * Code must be documented adhering to the official Go [commentary](https:&#47;&#47;golang.org&#47;doc&#47;effective_go.html#commentary)</span>
<span class="term-fg31">-   guidelines.</span>
<span class="term-fg31">- * Pull requests need to be based on and opened against the `master` branch.</span>
<span class="term-fg31">- * Commit messages should be prefixed with the package(s) they modify.</span>
<span class="term-fg31">-   * E.g. &quot;eth, rpc: make trace configs optional&quot;</span>
<span class="term-fg32">+Simulates the bundle by building a block containing it, returns whether the apply was successful and the EGP of the resulting block.</span>
&nbsp;
<span class="term-fg31">-Please see the [Developers&#39; Guide](https:&#47;&#47;geth.ethereum.org&#47;docs&#47;developers&#47;geth-developer&#47;dev-guide)</span>
<span class="term-fg31">-for more details on configuring your environment, managing project dependencies, and</span>
<span class="term-fg31">-testing procedures.</span>
<span class="term-fg32">+### ExtractHint</span>
&nbsp;
<span class="term-fg31">-### Contributing to geth.ethereum.org</span>
<span class="term-fg32">+|   |   |</span>
<span class="term-fg32">+|---|---|</span>
<span class="term-fg32">+| Address | `0x42100037` |</span>
<span class="term-fg32">+| Inputs | bytes bundleData (json) |</span>
<span class="term-fg32">+| Outputs | bytes hintData (json) |</span>
&nbsp;
<span class="term-fg31">-For contributions to the [go-ethereum website](https:&#47;&#47;geth.ethereum.org), please checkout and raise pull requests against the `website` branch.</span>
<span class="term-fg31">-For more detailed instructions please see the `website` branch [README](https:&#47;&#47;github.com&#47;ethereum&#47;go-ethereum&#47;tree&#47;website#readme) or the </span>
<span class="term-fg31">-[contributing](https:&#47;&#47;geth.ethereum.org&#47;docs&#47;developers&#47;geth-developer&#47;contributing) page of the website.</span>
<span class="term-fg32">+Parses the bundle data and extracts the hint - &quot;To&quot; address and the calldata.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+The return structure is encoded as follows:</span>
<span class="term-fg32">+```</span>
<span class="term-fg32">+struct {</span>
<span class="term-fg32">+    To   common.Address</span>
<span class="term-fg32">+    Data []byte</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+```</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+### BuildEthBlock</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+|   |   |</span>
<span class="term-fg32">+|---|---|</span>
<span class="term-fg32">+| Address | `0x42100001` |</span>
<span class="term-fg32">+| Inputs | (Suave.BuildBlockArgs blockArgs, Suave.BidId bidId) |</span>
<span class="term-fg32">+| Outputs | (bytes builderBid, bytes blockPayload) |</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+Builds an Ethereum block based on the bid passed in.</span>
<span class="term-fg32">+The bid can either hold `ethBundle` in its confidential store, or be a &quot;merged bid&quot;, ie contain a list of bids in `mergedBids` in its confidential store. The merged bids should themselves hold `ethBundle`.</span>
<span class="term-fg32">+The block is built *in order*, without any attepmts at re-ordering. The block will contain the transactions unless they failed to apply. The caller should check whether the bids applied successfully, ie whether they revert only if are allowed to.</span>
&nbsp;
<span class="term-fg31">-## License</span>
<span class="term-fg32">+### SubmitEthBlockBidToRelay</span>
&nbsp;
<span class="term-fg31">-The go-ethereum library (i.e. all code outside of the `cmd` directory) is licensed under the</span>
<span class="term-fg31">-[GNU Lesser General Public License v3.0](https:&#47;&#47;www.gnu.org&#47;licenses&#47;lgpl-3.0.en.html),</span>
<span class="term-fg31">-also included in our repository in the `COPYING.LESSER` file.</span>
<span class="term-fg32">+|   |   |</span>
<span class="term-fg32">+|---|---|</span>
<span class="term-fg32">+| Address | `0x42100002` |</span>
<span class="term-fg32">+| Inputs | (string relayUrl, bytes builderBid (json) |</span>
<span class="term-fg32">+| Outputs | (bytes error) |</span>
&nbsp;
<span class="term-fg31">-The go-ethereum binaries (i.e. all code inside of the `cmd` directory) are licensed under the</span>
<span class="term-fg31">-[GNU General Public License v3.0](https:&#47;&#47;www.gnu.org&#47;licenses&#47;gpl-3.0.en.html), also</span>
<span class="term-fg31">-included in our repository in the `COPYING` file.</span>
<span class="term-fg32">+Submits provided builderBid to a boost relay. If the submission is successful, returns nothing, otherwise returns an error string.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+---</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+Made with ☀️ by the ⚡🤖 collective.</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-442de210c650cba68e22d876" role="button"
                   aria-expanded="false" aria-controls="id-442de210c650cba68e22d876">
                    <code>go.mod</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/e501b3b05db8e169f67dc78b7b59bc352b3c638d/go.mod" target="_blank">ethereum/go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/go.mod" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+24</span></div>
                        <div class="text-start"><span class="text-danger">-14</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-442de210c650cba68e22d876"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;go.mod flashbots&#47;suave-geth&#47;go.mod</span>
<span class="term-fg1">index ef4ea6ee74086e53704b77facbeb8642416051bd..03670070a36f1be887d0404ac6ee2d589e7735e1 100644</span>
<span class="term-fg1">--- ethereum&#47;go-ethereum&#47;go.mod</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;go.mod</span>
<span class="term-fg36">@@ -5,24 +5,27 @@</span>
 require (
 	github.com&#47;Azure&#47;azure-sdk-for-go&#47;sdk&#47;storage&#47;azblob v0.3.0
 	github.com&#47;VictoriaMetrics&#47;fastcache v1.6.0
<span class="term-fg32">+	github.com&#47;attestantio&#47;go-builder-client v0.3.0</span>
<span class="term-fg32">+	github.com&#47;attestantio&#47;go-eth2-client v0.16.4</span>
 	github.com&#47;aws&#47;aws-sdk-go-v2 v1.2.0
 	github.com&#47;aws&#47;aws-sdk-go-v2&#47;config v1.1.1
 	github.com&#47;aws&#47;aws-sdk-go-v2&#47;credentials v1.1.1
 	github.com&#47;aws&#47;aws-sdk-go-v2&#47;service&#47;route53 v1.1.1
<span class="term-fg31">-	github.com&#47;btcsuite&#47;btcd&#47;btcec&#47;v2 v2.2.0</span>
<span class="term-fg32">+	github.com&#47;btcsuite&#47;btcd&#47;btcec&#47;v2 v2.3.2</span>
 	github.com&#47;cespare&#47;cp v0.1.0
 	github.com&#47;cloudflare&#47;cloudflare-go v0.14.0
 	github.com&#47;cockroachdb&#47;pebble v0.0.0-20230209160836-829675f94811
<span class="term-fg31">-	github.com&#47;consensys&#47;gnark-crypto v0.10.0</span>
<span class="term-fg32">+	github.com&#47;consensys&#47;gnark-crypto v0.11.0</span>
 	github.com&#47;crate-crypto&#47;go-kzg-4844 v0.2.0
 	github.com&#47;davecgh&#47;go-spew v1.1.1
 	github.com&#47;deckarep&#47;golang-set&#47;v2 v2.1.0
 	github.com&#47;docker&#47;docker v1.6.2
 	github.com&#47;dop251&#47;goja v0.0.0-20230122112309-96b1610dd4f7
 	github.com&#47;ethereum&#47;c-kzg-4844 v0.2.0
<span class="term-fg31">-	github.com&#47;fatih&#47;color v1.7.0</span>
<span class="term-fg32">+	github.com&#47;fatih&#47;color v1.15.0</span>
 	github.com&#47;fjl&#47;gencodec v0.0.0-20230517082657-f9840df7b83e
 	github.com&#47;fjl&#47;memsize v0.0.0-20190710130421-bcb5799ab5e5
<span class="term-fg32">+	github.com&#47;flashbots&#47;go-boost-utils v1.7.0</span>
 	github.com&#47;fsnotify&#47;fsnotify v1.6.0
 	github.com&#47;gballet&#47;go-libpcsclite v0.0.0-20190607065134-2772fd86a8ff
 	github.com&#47;gballet&#47;go-verkle v0.0.0-20220902153445-097bd83b7732
<span class="term-fg36">@@ -37,7 +40,7 @@</span> 	github.com&#47;gorilla&#47;websocket v1.4.2
 	github.com&#47;graph-gophers&#47;graphql-go v1.3.0
 	github.com&#47;hashicorp&#47;go-bexpr v0.1.10
 	github.com&#47;holiman&#47;bloomfilter&#47;v2 v2.0.3
<span class="term-fg31">-	github.com&#47;holiman&#47;uint256 v1.2.2-0.20230321075855-87b91420868c</span>
<span class="term-fg32">+	github.com&#47;holiman&#47;uint256 v1.2.2</span>
 	github.com&#47;huin&#47;goupnp v1.0.3
 	github.com&#47;influxdata&#47;influxdb-client-go&#47;v2 v2.4.0
 	github.com&#47;influxdata&#47;influxdb1-client v0.0.0-20220302092344-a9ab5670611c
<span class="term-fg36">@@ -47,24 +50,26 @@</span> 	github.com&#47;julienschmidt&#47;httprouter v1.3.0
 	github.com&#47;karalabe&#47;usb v0.0.2
 	github.com&#47;kylelemons&#47;godebug v1.1.0
 	github.com&#47;mattn&#47;go-colorable v0.1.13
<span class="term-fg31">-	github.com&#47;mattn&#47;go-isatty v0.0.16</span>
<span class="term-fg32">+	github.com&#47;mattn&#47;go-isatty v0.0.18</span>
 	github.com&#47;naoina&#47;toml v0.1.2-0.20170918210437-9fafd6967416
 	github.com&#47;olekukonko&#47;tablewriter v0.0.5
 	github.com&#47;peterh&#47;liner v1.1.1-0.20190123174540-a2c9a5303de7
<span class="term-fg32">+	github.com&#47;pkg&#47;errors v0.9.1</span>
 	github.com&#47;protolambda&#47;bls12-381-util v0.0.0-20220416220906-d8552aa452c7
<span class="term-fg32">+	github.com&#47;r3labs&#47;sse v0.0.0-20210224172625-26fe804710bc</span>
 	github.com&#47;rs&#47;cors v1.7.0
 	github.com&#47;shirou&#47;gopsutil v3.21.4-0.20210419000835-c7a38de76ee5+incompatible
 	github.com&#47;status-im&#47;keycard-go v0.2.0
<span class="term-fg31">-	github.com&#47;stretchr&#47;testify v1.8.1</span>
<span class="term-fg32">+	github.com&#47;stretchr&#47;testify v1.8.4</span>
 	github.com&#47;supranational&#47;blst v0.3.11-0.20230406105308-e9dfc5ee724b
 	github.com&#47;syndtr&#47;goleveldb v1.0.1-0.20210819022825-2ae1ddf74ef7
 	github.com&#47;tyler-smith&#47;go-bip39 v1.1.0
 	github.com&#47;urfave&#47;cli&#47;v2 v2.17.2-0.20221006022127-8f469abc00aa
<span class="term-fg31">-	golang.org&#47;x&#47;crypto v0.1.0</span>
<span class="term-fg32">+	golang.org&#47;x&#47;crypto v0.8.0</span>
 	golang.org&#47;x&#47;exp v0.0.0-20230206171751-46f607a40771
 	golang.org&#47;x&#47;sync v0.1.0
<span class="term-fg31">-	golang.org&#47;x&#47;sys v0.7.0</span>
<span class="term-fg31">-	golang.org&#47;x&#47;text v0.8.0</span>
<span class="term-fg32">+	golang.org&#47;x&#47;sys v0.8.0</span>
<span class="term-fg32">+	golang.org&#47;x&#47;text v0.10.0</span>
 	golang.org&#47;x&#47;time v0.0.0-20220922220347-f3bd1da661af
 	golang.org&#47;x&#47;tools v0.7.0
 	gopkg.in&#47;natefinch&#47;lumberjack.v2 v2.0.0
<span class="term-fg36">@@ -91,41 +96,46 @@</span> 	github.com&#47;cockroachdb&#47;redact v1.1.3 &#47;&#47; indirect
 	github.com&#47;consensys&#47;bavard v0.1.13 &#47;&#47; indirect
 	github.com&#47;cpuguy83&#47;go-md2man&#47;v2 v2.0.2 &#47;&#47; indirect
 	github.com&#47;crate-crypto&#47;go-ipa v0.0.0-20220523130400-f11357ae11c7 &#47;&#47; indirect
<span class="term-fg31">-	github.com&#47;decred&#47;dcrd&#47;dcrec&#47;secp256k1&#47;v4 v4.0.1 &#47;&#47; indirect</span>
<span class="term-fg32">+	github.com&#47;decred&#47;dcrd&#47;dcrec&#47;secp256k1&#47;v4 v4.1.0 &#47;&#47; indirect</span>
 	github.com&#47;deepmap&#47;oapi-codegen v1.8.2 &#47;&#47; indirect
 	github.com&#47;dlclark&#47;regexp2 v1.7.0 &#47;&#47; indirect
<span class="term-fg32">+	github.com&#47;ferranbt&#47;fastssz v0.1.3 &#47;&#47; indirect</span>
 	github.com&#47;garslo&#47;gogen v0.0.0-20170306192744-1d203ffc1f61 &#47;&#47; indirect
 	github.com&#47;getsentry&#47;sentry-go v0.18.0 &#47;&#47; indirect
 	github.com&#47;go-ole&#47;go-ole v1.2.1 &#47;&#47; indirect
 	github.com&#47;go-sourcemap&#47;sourcemap v2.1.3+incompatible &#47;&#47; indirect
<span class="term-fg32">+	github.com&#47;goccy&#47;go-yaml v1.11.0 &#47;&#47; indirect</span>
 	github.com&#47;gogo&#47;protobuf v1.3.2 &#47;&#47; indirect
 	github.com&#47;influxdata&#47;line-protocol v0.0.0-20210311194329-9aa0e372d097 &#47;&#47; indirect
 	github.com&#47;kilic&#47;bls12-381 v0.1.0 &#47;&#47; indirect
 	github.com&#47;klauspost&#47;compress v1.15.15 &#47;&#47; indirect
<span class="term-fg32">+	github.com&#47;klauspost&#47;cpuid&#47;v2 v2.2.4 &#47;&#47; indirect</span>
 	github.com&#47;kr&#47;pretty v0.3.1 &#47;&#47; indirect
 	github.com&#47;kr&#47;text v0.2.0 &#47;&#47; indirect
 	github.com&#47;mattn&#47;go-runewidth v0.0.9 &#47;&#47; indirect
 	github.com&#47;matttproud&#47;golang_protobuf_extensions v1.0.4 &#47;&#47; indirect
<span class="term-fg31">-	github.com&#47;mitchellh&#47;mapstructure v1.4.1 &#47;&#47; indirect</span>
<span class="term-fg32">+	github.com&#47;minio&#47;sha256-simd v1.0.0 &#47;&#47; indirect</span>
<span class="term-fg32">+	github.com&#47;mitchellh&#47;mapstructure v1.5.0 &#47;&#47; indirect</span>
 	github.com&#47;mitchellh&#47;pointerstructure v1.2.0 &#47;&#47; indirect
 	github.com&#47;mmcloughlin&#47;addchain v0.4.0 &#47;&#47; indirect
 	github.com&#47;naoina&#47;go-stringutil v0.1.0 &#47;&#47; indirect
 	github.com&#47;opentracing&#47;opentracing-go v1.1.0 &#47;&#47; indirect
<span class="term-fg31">-	github.com&#47;pkg&#47;errors v0.9.1 &#47;&#47; indirect</span>
 	github.com&#47;pmezard&#47;go-difflib v1.0.0 &#47;&#47; indirect
 	github.com&#47;prometheus&#47;client_golang v1.14.0 &#47;&#47; indirect
 	github.com&#47;prometheus&#47;client_model v0.3.0 &#47;&#47; indirect
 	github.com&#47;prometheus&#47;common v0.39.0 &#47;&#47; indirect
 	github.com&#47;prometheus&#47;procfs v0.9.0 &#47;&#47; indirect
<span class="term-fg32">+	github.com&#47;prysmaticlabs&#47;go-bitfield v0.0.0-20210809151128-385d8c5e3fb7 &#47;&#47; indirect</span>
 	github.com&#47;rogpeppe&#47;go-internal v1.9.0 &#47;&#47; indirect
 	github.com&#47;russross&#47;blackfriday&#47;v2 v2.1.0 &#47;&#47; indirect
 	github.com&#47;tklauser&#47;go-sysconf v0.3.5 &#47;&#47; indirect
 	github.com&#47;tklauser&#47;numcpus v0.2.2 &#47;&#47; indirect
 	github.com&#47;xrash&#47;smetrics v0.0.0-20201216005158-039620a65673 &#47;&#47; indirect
 	golang.org&#47;x&#47;mod v0.9.0 &#47;&#47; indirect
<span class="term-fg31">-	golang.org&#47;x&#47;net v0.8.0 &#47;&#47; indirect</span>
<span class="term-fg31">-	golang.org&#47;x&#47;xerrors v0.0.0-20220517211312-f3a8303e98df &#47;&#47; indirect</span>
<span class="term-fg32">+	golang.org&#47;x&#47;net v0.9.0 &#47;&#47; indirect</span>
<span class="term-fg32">+	golang.org&#47;x&#47;xerrors v0.0.0-20220907171357-04be3eba64a2 &#47;&#47; indirect</span>
 	google.golang.org&#47;protobuf v1.28.1 &#47;&#47; indirect
<span class="term-fg32">+	gopkg.in&#47;cenkalti&#47;backoff.v1 v1.1.0 &#47;&#47; indirect</span>
 	gopkg.in&#47;yaml.v2 v2.4.0 &#47;&#47; indirect
 	rsc.io&#47;tmplfunc v0.0.3 &#47;&#47; indirect
 )</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-a241e08785247891c0e2e43b" role="button"
                   aria-expanded="false" aria-controls="id-a241e08785247891c0e2e43b">
                    <code>go.sum</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/e501b3b05db8e169f67dc78b7b59bc352b3c638d/go.sum" target="_blank">ethereum/go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/go.sum" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        <div class="text-end"><span class="text-success">+57</span></div>
                        <div class="text-start"><span class="text-danger">-29</span></div>
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-a241e08785247891c0e2e43b"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;go.sum flashbots&#47;suave-geth&#47;go.sum</span>
<span class="term-fg1">index e02153096313fb634fac20c9488426d5f894e8f4..f5e6e35e50fbb823359aca166e5e2d6fe84a2146 100644</span>
<span class="term-fg1">--- ethereum&#47;go-ethereum&#47;go.sum</span>
<span class="term-fg1">+++ flashbots&#47;suave-geth&#47;go.sum</span>
<span class="term-fg36">@@ -22,6 +22,10 @@</span> github.com&#47;ajg&#47;form v1.5.1&#47;go.mod h1:uL1WgH+h2mgNtvBq0339dVnzXdBETtL2LeUXaIv25UY=
 github.com&#47;allegro&#47;bigcache v1.2.1-0.20190218064605-e24eb225f156 h1:eMwmnE&#47;GDgah4HI848JfFxHt+iPb26b4zyfspmqY0&#47;8=
 github.com&#47;allegro&#47;bigcache v1.2.1-0.20190218064605-e24eb225f156&#47;go.mod h1:Cb&#47;ax3seSYIx7SuZdm2G2xzfwmv3TPSk2ucNfQESPXM=
 github.com&#47;armon&#47;consul-api v0.0.0-20180202201655-eb2c6b5be1b6&#47;go.mod h1:grANhF5doyWs3UAsr3K4I6qtAmlQcZDesFNEHPZAzj8=
<span class="term-fg32">+github.com&#47;attestantio&#47;go-builder-client v0.3.0 h1:NY7pUNT070T3tx&#47;N8hCaO5KpExvaVQhH&#47;&#47;9zsgRh43M=</span>
<span class="term-fg32">+github.com&#47;attestantio&#47;go-builder-client v0.3.0&#47;go.mod h1:DwesMTOqnCp4u+n3uZ+fWL8wwnSBZVD9VMIVPDR+AZE=</span>
<span class="term-fg32">+github.com&#47;attestantio&#47;go-eth2-client v0.16.4 h1:utfGx49JZN4W7IT6&#47;txdwE9qobP3b&#47;eTa3Ge1PJFRJg=</span>
<span class="term-fg32">+github.com&#47;attestantio&#47;go-eth2-client v0.16.4&#47;go.mod h1:lgxKsjRSxQnHSWxSbtZLGYlFkE3vFM4L+DK4bXqAxAU=</span>
 github.com&#47;aws&#47;aws-sdk-go-v2 v1.2.0 h1:BS+UYpbsElC82gB+2E2jiCBg36i8HlubTB&#47;dO&#47;moQ9c=
 github.com&#47;aws&#47;aws-sdk-go-v2 v1.2.0&#47;go.mod h1:zEQs02YRBw1DjK0PoJv3ygDYOFTre1ejlJWl8FwAuQo=
 github.com&#47;aws&#47;aws-sdk-go-v2&#47;config v1.1.1 h1:ZAoq32boMzcaTW9bcUacBswAmHTbvlvDJICgHFZuECo=
<span class="term-fg36">@@ -45,8 +49,8 @@</span> github.com&#47;beorn7&#47;perks v1.0.1 h1:VlbKKnNfV8bJzeqoa4cOKqO6bYr3WgKZxO8Z16+hsOM=
 github.com&#47;beorn7&#47;perks v1.0.1&#47;go.mod h1:G2ZrVWU2WbWT9wwq4&#47;hrbKbnv&#47;1ERSJQ0ibhJ6rlkpw=
 github.com&#47;bits-and-blooms&#47;bitset v1.7.0 h1:YjAGVd3XmtK9ktAbX8Zg2g2PwLIMjGREZJHlV4j7NEo=
 github.com&#47;bits-and-blooms&#47;bitset v1.7.0&#47;go.mod h1:gIdJ4wp64HaoK2YrL1Q5&#47;N7Y16edYb8uY+O0FJTyyDA=
<span class="term-fg31">-github.com&#47;btcsuite&#47;btcd&#47;btcec&#47;v2 v2.2.0 h1:fzn1qaOt32TuLjFlkzYSsBC35Q3KUjT1SwPxiMSCF5k=</span>
<span class="term-fg31">-github.com&#47;btcsuite&#47;btcd&#47;btcec&#47;v2 v2.2.0&#47;go.mod h1:U7MHm051Al6XmscBQ0BoNydpOTsFAn707034b5nY8zU=</span>
<span class="term-fg32">+github.com&#47;btcsuite&#47;btcd&#47;btcec&#47;v2 v2.3.2 h1:5n0X6hX0Zk+6omWcihdYvdAlGf2DfasC0GMf7DClJ3U=</span>
<span class="term-fg32">+github.com&#47;btcsuite&#47;btcd&#47;btcec&#47;v2 v2.3.2&#47;go.mod h1:zYzJ8etWJQIv1Ogk7OzpWjowwOdXY1W&#47;17j2MW85J04=</span>
 github.com&#47;btcsuite&#47;btcd&#47;chaincfg&#47;chainhash v1.0.1 h1:q0rUy8C&#47;TYNBQS1+CGKw68tLOFYSNEs0TFnxxnS9+4U=
 github.com&#47;census-instrumentation&#47;opencensus-proto v0.2.1&#47;go.mod h1:f6KPmirojxKA12rnyqOA5BBL4O983OfeGPqjHWSTneU=
 github.com&#47;cespare&#47;cp v0.1.0 h1:SE+dxFebS7Iik5LK0tsi1k9ZCxEaFX4AjQmoyA+1dJk=
<span class="term-fg36">@@ -72,8 +76,8 @@</span> github.com&#47;cockroachdb&#47;redact v1.1.3&#47;go.mod h1:BVNblN9mBWFyMyqK1k3AAiSxhvhfK2oOZZ2lK+dpvRg=
 github.com&#47;codegangsta&#47;inject v0.0.0-20150114235600-33e0aa1cb7c0&#47;go.mod h1:4Zcjuz89kmFXt9morQgcfYZAYZ5n8WHjt81YYWIwtTM=
 github.com&#47;consensys&#47;bavard v0.1.13 h1:oLhMLOFGTLdlda&#47;kma4VOJazblc7IM5y5QPd2A&#47;YjhQ=
 github.com&#47;consensys&#47;bavard v0.1.13&#47;go.mod h1:9ItSMtA&#47;dXMAiL7BG6bqW2m3NdSEObYWoH223nGHukI=
<span class="term-fg31">-github.com&#47;consensys&#47;gnark-crypto v0.10.0 h1:zRh22SR7o4K35SoNqouS9J&#47;TKHTyU2QWaj5ldehyXtA=</span>
<span class="term-fg31">-github.com&#47;consensys&#47;gnark-crypto v0.10.0&#47;go.mod h1:Iq&#47;P3HHl0ElSjsg2E1gsMwhAyxnxoKK5nVyZKd+&#47;KhU=</span>
<span class="term-fg32">+github.com&#47;consensys&#47;gnark-crypto v0.11.0 h1:QqzHQlwEqlQr5jfWblGDkwlKHpT+4QodYqqExkAtyks=</span>
<span class="term-fg32">+github.com&#47;consensys&#47;gnark-crypto v0.11.0&#47;go.mod h1:Iq&#47;P3HHl0ElSjsg2E1gsMwhAyxnxoKK5nVyZKd+&#47;KhU=</span>
 github.com&#47;coreos&#47;etcd v3.3.10+incompatible&#47;go.mod h1:uF7uidLiAD3TWHmW31ZFd&#47;JWoc32PjwdhPthX9715RE=
 github.com&#47;coreos&#47;go-etcd v2.0.0+incompatible&#47;go.mod h1:Jez6KQU2B&#47;sWsbdaef3ED8NzMklzPG4d5KIOhIy30Tk=
 github.com&#47;coreos&#47;go-semver v0.2.0&#47;go.mod h1:nnelYz7RCh+5ahJtPPxZlU+153eP4D4r3EedlOD2RNk=
<span class="term-fg36">@@ -93,9 +97,8 @@</span> github.com&#47;davecgh&#47;go-spew v1.1.1&#47;go.mod h1:J7Y8YcW2NihsgmVo&#47;mv3lAwl&#47;skON4iLHjSsI+c5H38=
 github.com&#47;deckarep&#47;golang-set&#47;v2 v2.1.0 h1:g47V4Or+DUdzbs8FxCCmgb6VYd+ptPAngjM6dtGktsI=
 github.com&#47;deckarep&#47;golang-set&#47;v2 v2.1.0&#47;go.mod h1:VAky9rY&#47;yGXJOLEDv3OMci+7wtDpOF4IN+y82NBOac4=
 github.com&#47;decred&#47;dcrd&#47;crypto&#47;blake256 v1.0.0 h1:&#47;8DMNYp9SGi5f0w7uCm6d6M4OU2rGFK09Y2A4Xv7EE0=
<span class="term-fg31">-github.com&#47;decred&#47;dcrd&#47;crypto&#47;blake256 v1.0.0&#47;go.mod h1:sQl2p6Y26YV+ZOcSTP6thNdn47hh8kt6rqSlvmrXFAc=</span>
<span class="term-fg31">-github.com&#47;decred&#47;dcrd&#47;dcrec&#47;secp256k1&#47;v4 v4.0.1 h1:YLtO71vCjJRCBcrPMtQ9nqBsqpA1m5sE92cU+pd5Mcc=</span>
<span class="term-fg31">-github.com&#47;decred&#47;dcrd&#47;dcrec&#47;secp256k1&#47;v4 v4.0.1&#47;go.mod h1:hyedUtir6IdtD&#47;7lIxGeCxkaw7y45JueMRL4DIyJDKs=</span>
<span class="term-fg32">+github.com&#47;decred&#47;dcrd&#47;dcrec&#47;secp256k1&#47;v4 v4.1.0 h1:HbphB4TFFXpv7MNrT52FGrrgVXF1owhMVTHFZIlnvd4=</span>
<span class="term-fg32">+github.com&#47;decred&#47;dcrd&#47;dcrec&#47;secp256k1&#47;v4 v4.1.0&#47;go.mod h1:DZGJHZMqrU4JJqFAWUS2UO1+lbSKsdiOoYi9Zzey7Fc=</span>
 github.com&#47;deepmap&#47;oapi-codegen v1.6.0&#47;go.mod h1:ryDa9AgbELGeB+YEXE1dR53yAjHwFvE9iAUlWl9Al3M=
 github.com&#47;deepmap&#47;oapi-codegen v1.8.2 h1:SegyeYGcdi0jLLrpbCMoJxnUUn8GBXHsvr4rbzjuhfU=
 github.com&#47;deepmap&#47;oapi-codegen v1.8.2&#47;go.mod h1:YLgSKSDv&#47;bZQB7N4ws6luhozi3cEdRktEqrX88CvjIw=
<span class="term-fg36">@@ -125,13 +128,17 @@</span> github.com&#47;etcd-io&#47;bbolt v1.3.3&#47;go.mod h1:ZF2nL25h33cCyBtcyWeZ2&#47;I3HQOfTP+0PIEvHjkjCrw=
 github.com&#47;ethereum&#47;c-kzg-4844 v0.2.0 h1:+cUvymlnoDDQgMInp25Bo3OmLajmmY8mLJ&#47;tLjqd77Q=
 github.com&#47;ethereum&#47;c-kzg-4844 v0.2.0&#47;go.mod h1:WI2Nd82DMZAAZI1wV2neKGost9EKjvbpQR9OqE5Qqa8=
 github.com&#47;fasthttp-contrib&#47;websocket v0.0.0-20160511215533-1f3b11f56072&#47;go.mod h1:duJ4Jxv5lDcvg4QuQr0oowTf7dz4&#47;CR8NtyCooz9HL8=
<span class="term-fg31">-github.com&#47;fatih&#47;color v1.7.0 h1:DkWD4oS2D8LGGgTQ6IvwJJXSL5Vp2ffcQg58nFV38Ys=</span>
<span class="term-fg31">-github.com&#47;fatih&#47;color v1.7.0&#47;go.mod h1:Zm6kSWBoL9eyXnKyktHP6abPY2pDugNf5KwzbycvMj4=</span>
<span class="term-fg32">+github.com&#47;fatih&#47;color v1.15.0 h1:kOqh6YHBtK8aywxGerMG2Eq3H6Qgoqeo13Bk2Mv&#47;nBs=</span>
<span class="term-fg32">+github.com&#47;fatih&#47;color v1.15.0&#47;go.mod h1:0h5ZqXfHYED7Bhv2ZJamyIOUej9KtShiJESRwBDUSsw=</span>
 github.com&#47;fatih&#47;structs v1.1.0&#47;go.mod h1:9NiDSp5zOcgEDl+j00MP&#47;WkGVPOlPRLejGD8Ga6PJ7M=
<span class="term-fg32">+github.com&#47;ferranbt&#47;fastssz v0.1.3 h1:ZI+z3JH05h4kgmFXdHuR1aWYsgrg7o+Fw7&#47;NCzM16Mo=</span>
<span class="term-fg32">+github.com&#47;ferranbt&#47;fastssz v0.1.3&#47;go.mod h1:0Y9TEd&#47;9XuFlh7mskMPfXiI2Dkw4Ddg9EyXt1W7MRvE=</span>
 github.com&#47;fjl&#47;gencodec v0.0.0-20230517082657-f9840df7b83e h1:bBLctRc7kr01YGvaDfgLbTwjFNW5jdp5y5rj8XXBHfY=
 github.com&#47;fjl&#47;gencodec v0.0.0-20230517082657-f9840df7b83e&#47;go.mod h1:AzA8Lj6YtixmJWL+wkKoBGsLWy9gFrAzi4g+5bCKwpY=
 github.com&#47;fjl&#47;memsize v0.0.0-20190710130421-bcb5799ab5e5 h1:FtmdgXiUlNeRsoNMFlKLDt+S+6hbjVMEW6RGQ7aUf7c=
 github.com&#47;fjl&#47;memsize v0.0.0-20190710130421-bcb5799ab5e5&#47;go.mod h1:VvhXpOYNQvB+uIk2RvXzuaQtkQJzzIx6lSBe1xv7hi0=
<span class="term-fg32">+github.com&#47;flashbots&#47;go-boost-utils v1.7.0 h1:BaLeGl71nD&#47;ro0aUzCYqHc8PiqIIaErLwcgMOQWoBZY=</span>
<span class="term-fg32">+github.com&#47;flashbots&#47;go-boost-utils v1.7.0&#47;go.mod h1:1Y0rD&#47;e57KZZIRgkCcXRvvztW+v+eZHnWu25wxtGstU=</span>
 github.com&#47;fsnotify&#47;fsnotify v1.4.7&#47;go.mod h1:jwhsz4b93w&#47;PPRr&#47;qN1Yymfu8t87LnFCMoQvtojpjFo=
 github.com&#47;fsnotify&#47;fsnotify v1.4.9&#47;go.mod h1:znqG4EE+3YCdAaPaxE2ZRY&#47;06pZUdp0tY4IgpuI1SZQ=
 github.com&#47;fsnotify&#47;fsnotify v1.6.0 h1:n+5WquG0fcWoWp6xPWfHdbskMCQaFnG6PfBrh1Ky4HY=
<span class="term-fg36">@@ -160,6 +167,9 @@</span> github.com&#47;go-ole&#47;go-ole v1.2.1 h1:2lOsA72HgjxAuMlKpFiCbHTvu44PIVkZ5hqm3RSdI&#47;E=
 github.com&#47;go-ole&#47;go-ole v1.2.1&#47;go.mod h1:7FAglXiTm7HKlQRDeOQ6ZNUHidzCWXuZWq&#47;1dTyBNF8=
 github.com&#47;go-openapi&#47;jsonpointer v0.19.5&#47;go.mod h1:Pl9vOtqEWErmShwVjC8pYs9cog34VGT37dQOVbmoatg=
 github.com&#47;go-openapi&#47;swag v0.19.5&#47;go.mod h1:POnQmlKehdgb5mhVOsnJFsivZCEZ&#47;vjK9gh66Z9tfKk=
<span class="term-fg32">+github.com&#47;go-playground&#47;locales v0.14.0 h1:u50s323jtVGugKlcYeyzC0etD1HifMjqmJqb8WugfUU=</span>
<span class="term-fg32">+github.com&#47;go-playground&#47;universal-translator v0.18.0 h1:82dyy6p4OuJq4&#47;CByFNOn&#47;jYrnRPArHwAcmLoJZxyho=</span>
<span class="term-fg32">+github.com&#47;go-playground&#47;validator&#47;v10 v10.11.1 h1:prmOlTVv+YjZjmRmNSF3VmspqJIxJWXmqUsHwfTRRkQ=</span>
 github.com&#47;go-sourcemap&#47;sourcemap v2.1.3+incompatible h1:W1iEw64niKVGogNgBN3ePyLFfuisuzeidWPMPWmECqU=
 github.com&#47;go-sourcemap&#47;sourcemap v2.1.3+incompatible&#47;go.mod h1:F8jJfvm2KbVjc5NqelyYJmf&#47;v5J0dwNLS2mL4sNA1Jg=
 github.com&#47;go-stack&#47;stack v1.8.1 h1:ntEHSVwIt7PNXNpgPmVfMrNhLtgjlmnZha2kOpuRiDw=
<span class="term-fg36">@@ -167,6 +177,8 @@</span> github.com&#47;go-stack&#47;stack v1.8.1&#47;go.mod h1:dcoOX6HbPZSZptuspn9bctJ+N&#47;CnF5gGygcUP3XYfe4=
 github.com&#47;gobwas&#47;httphead v0.0.0-20180130184737-2c6c146eadee&#47;go.mod h1:L0fX3K22YWvt&#47;FAX9NnzrNzcI4wNYi9Yku4O0LKYflo=
 github.com&#47;gobwas&#47;pool v0.2.0&#47;go.mod h1:q8bcK0KcYlCgd9e7WYLm9LpyS+YeLd8JVDW6WezmKEw=
 github.com&#47;gobwas&#47;ws v1.0.2&#47;go.mod h1:szmBTxLgaFppYjEmNtny&#47;v3w89xOydFnnZMcgRRu&#47;EM=
<span class="term-fg32">+github.com&#47;goccy&#47;go-yaml v1.11.0 h1:n7Z+zx8S9f9KgzG6KtQKf+kwqXZlLNR2F6018Dgau54=</span>
<span class="term-fg32">+github.com&#47;goccy&#47;go-yaml v1.11.0&#47;go.mod h1:H+mJrWtjPTJAHvRbV09MCK9xYwODM+wRTVFFTWckfng=</span>
 github.com&#47;gofrs&#47;flock v0.8.1 h1:+gYjHKf32LDeiEEFhQaotPbLuUXjY5ZqxKgXy7n59aw=
 github.com&#47;gofrs&#47;flock v0.8.1&#47;go.mod h1:F1TvTiK9OcQqauNUHlbJvyl9Qa1QvF&#47;gOUDKA14jxHU=
 github.com&#47;gogo&#47;googleapis v0.0.0-20180223154316-0cd9801be74a&#47;go.mod h1:gf4bu3Q80BeJ6H1S1vYPm8&#47;ELATdvryBaNFGgqEef3s=
<span class="term-fg36">@@ -230,8 +242,8 @@</span> github.com&#47;hashicorp&#47;go-version v1.2.0&#47;go.mod h1:fltr4n8CU8Ke44wwGCBoEymUuxUHl09ZGVZPK5anwXA=
 github.com&#47;hashicorp&#47;hcl v1.0.0&#47;go.mod h1:E5yfLk+7swimpb2L&#47;Alb&#47;PJmXilQ&#47;rhwaUYs4T20WEQ=
 github.com&#47;holiman&#47;bloomfilter&#47;v2 v2.0.3 h1:73e0e&#47;V0tCydx14a0SCYS&#47;EWCxgwLZ18CZcZKVu0fao=
 github.com&#47;holiman&#47;bloomfilter&#47;v2 v2.0.3&#47;go.mod h1:zpoh+gs7qcpqrHr3dB55AMiJwo0iURXE7ZOP9L9hSkA=
<span class="term-fg31">-github.com&#47;holiman&#47;uint256 v1.2.2-0.20230321075855-87b91420868c h1:DZfsyhDK1hnSS5lH8l+JggqzEleHteTYfutAiVlSUM8=</span>
<span class="term-fg31">-github.com&#47;holiman&#47;uint256 v1.2.2-0.20230321075855-87b91420868c&#47;go.mod h1:SC8Ryt4n+UBbPbIBKaG9zbbDlp4jOru9xFZmPzLUTxw=</span>
<span class="term-fg32">+github.com&#47;holiman&#47;uint256 v1.2.2 h1:TXKcSGc2WaxPD2+bmzAsVthL4+pEN0YwXcL5qED83vk=</span>
<span class="term-fg32">+github.com&#47;holiman&#47;uint256 v1.2.2&#47;go.mod h1:SC8Ryt4n+UBbPbIBKaG9zbbDlp4jOru9xFZmPzLUTxw=</span>
 github.com&#47;hpcloud&#47;tail v1.0.0&#47;go.mod h1:ab1qPbhIpdTxEkNHXyeSf5vhxWSCs&#47;tWer42PpOxQnU=
 github.com&#47;huin&#47;goupnp v1.0.3 h1:N8No57ls+MnjlB+JPiCVSOyy&#47;ot7MJTqlo7rn+NYSqQ=
 github.com&#47;huin&#47;goupnp v1.0.3&#47;go.mod h1:ZxNlw5WqJj6wSsRK5+YfflQGXYfccj5VgQsMNixHM7Y=
<span class="term-fg36">@@ -279,6 +291,9 @@</span> github.com&#47;klauspost&#47;compress v1.9.7&#47;go.mod h1:RyIbtBH6LamlWaDj8nUwkbUhJ87Yi3uG0guNDohfE1A=
 github.com&#47;klauspost&#47;compress v1.15.15 h1:EF27CXIuDsYJ6mmvtBRlEuB2UVOqHG1tAXgZ7yIO+lw=
 github.com&#47;klauspost&#47;compress v1.15.15&#47;go.mod h1:ZcK2JAFqKOpnBlxcLsJzYfrS9X1akm9fHZNnD9+Vo&#47;4=
 github.com&#47;klauspost&#47;cpuid v1.2.1&#47;go.mod h1:Pj4uuM528wm8OyEC2QMXAi2YiTZ96dNQPGgoMS4s3ek=
<span class="term-fg32">+github.com&#47;klauspost&#47;cpuid&#47;v2 v2.0.4&#47;go.mod h1:FInQzS24&#47;EEf25PyTYn52gqo7WaD8xa0213Md&#47;qVLRg=</span>
<span class="term-fg32">+github.com&#47;klauspost&#47;cpuid&#47;v2 v2.2.4 h1:acbojRNwl3o09bUq+yDCtZFc1aiwaAAxtcn8YkZXnvk=</span>
<span class="term-fg32">+github.com&#47;klauspost&#47;cpuid&#47;v2 v2.2.4&#47;go.mod h1:RVVoqg1df56z8g3pUjL&#47;3lE5UfnlrJX8tyFgg4nqhuY=</span>
 github.com&#47;kr&#47;pretty v0.1.0&#47;go.mod h1:dAy3ld7l9f0ibDNOQOHHMYYIIbhfbHSm3C4ZsoJORNo=
 github.com&#47;kr&#47;pretty v0.2.1&#47;go.mod h1:ipq&#47;a2n7PKx3OHsz4KJII5eveXtPO4qwEXGdVfWzfnI=
 github.com&#47;kr&#47;pretty v0.3.0&#47;go.mod h1:640gp4NfQd8pI5XOwp5fnNeVWj67G7CFk&#47;SaSQn7NBk=
<span class="term-fg36">@@ -295,6 +310,7 @@</span> github.com&#47;labstack&#47;echo&#47;v4 v4.5.0&#47;go.mod h1:czIriw4a0C1dFun+ObrXp7ok03xON0N1awStJ6ArI7Y=
 github.com&#47;labstack&#47;gommon v0.3.0&#47;go.mod h1:MULnywXg0yavhxWKc+lOruYdAhDwPK9wf0OL7NoOu+k=
 github.com&#47;leanovate&#47;gopter v0.2.9 h1:fQjYxZaynp97ozCzfOyOuAGOU4aU&#47;z37zf&#47;tOujFk7c=
 github.com&#47;leanovate&#47;gopter v0.2.9&#47;go.mod h1:U2L&#47;78B+KVFIx2VmW6onHJQzXtFb+p5y3y2Sh+Jxxv8=
<span class="term-fg32">+github.com&#47;leodido&#47;go-urn v1.2.1 h1:BqpAaACuzVSgi&#47;VLzGZIobT2z4v53pjosyNd9Yv6n&#47;w=</span>
 github.com&#47;magiconair&#47;properties v1.8.0&#47;go.mod h1:PppfXfuXeibc&#47;6YijjN8zIbojt8czPbwD3XqdrwzmxQ=
 github.com&#47;mailru&#47;easyjson v0.0.0-20190614124828-94de47d64c63&#47;go.mod h1:C1wdFJiN94OJF2b5HbByQZoLdCWB1Yqtg26g4irojpc=
 github.com&#47;mailru&#47;easyjson v0.0.0-20190626092158-b2ccc519800e&#47;go.mod h1:C1wdFJiN94OJF2b5HbByQZoLdCWB1Yqtg26g4irojpc=
<span class="term-fg36">@@ -310,8 +326,9 @@</span> github.com&#47;mattn&#47;go-isatty v0.0.8&#47;go.mod h1:Iq45c&#47;XA43vh69&#47;j3iqttzPXn0bhXyGjM0Hdxcsrc5s=
 github.com&#47;mattn&#47;go-isatty v0.0.9&#47;go.mod h1:YNRxwqDuOph6SZLI9vUUz6OYw3QyUt7WiY2yME+cCiQ=
 github.com&#47;mattn&#47;go-isatty v0.0.12&#47;go.mod h1:cbi8OIDigv2wuxKPP5vlRcQ1OAZbq2CE4Kysco4FUpU=
 github.com&#47;mattn&#47;go-isatty v0.0.14&#47;go.mod h1:7GGIvUiUoEMVVmxf&#47;4nioHXj79iQHKdU27kJ6hsGG94=
<span class="term-fg31">-github.com&#47;mattn&#47;go-isatty v0.0.16 h1:bq3VjFmv&#47;sOjHtdEhmkEV4x1AJtvUvOJ2PFAZ5+peKQ=</span>
 github.com&#47;mattn&#47;go-isatty v0.0.16&#47;go.mod h1:kYGgaQfpe5nmfYZH+SKPsOc2e4SrIfOl2e&#47;yFXSvRLM=
<span class="term-fg32">+github.com&#47;mattn&#47;go-isatty v0.0.18 h1:DOKFKCQ7FNG2L1rbrmstDN4QVRdS89Nkh85u68Uwp98=</span>
<span class="term-fg32">+github.com&#47;mattn&#47;go-isatty v0.0.18&#47;go.mod h1:W+V8PltTTMOvKvAeJH7IuucS94S2C6jfK&#47;D7dTCTo3Y=</span>
 github.com&#47;mattn&#47;go-runewidth v0.0.3&#47;go.mod h1:LwmH8dsx7+W8Uxz3IHJYH5QSwggIsqBzpuz5H&#47;&#47;U1FU=
 github.com&#47;mattn&#47;go-runewidth v0.0.9 h1:Lm995f3rfxdpd6TSmuVCHVb&#47;QhupuXlYr8sCI&#47;QdE+0=
 github.com&#47;mattn&#47;go-runewidth v0.0.9&#47;go.mod h1:H031xJmbD&#47;WCDINGzjvQ9THkh0rPKHF+m2gUSrubnMI=
<span class="term-fg36">@@ -320,10 +337,13 @@</span> github.com&#47;matttproud&#47;golang_protobuf_extensions v1.0.4 h1:mmDVorXM7PCGKw94cs5zkfA9PSy5pEvNWRP0ET0TIVo=
 github.com&#47;matttproud&#47;golang_protobuf_extensions v1.0.4&#47;go.mod h1:BSXmuO+STAnVfrANrmjBb36TMTDstsz7MSK+HVaYKv4=
 github.com&#47;mediocregopher&#47;radix&#47;v3 v3.4.2&#47;go.mod h1:8FL3F6UQRXHXIBSPUs5h0RybMF8i4n7wVopoX3x7Bv8=
 github.com&#47;microcosm-cc&#47;bluemonday v1.0.2&#47;go.mod h1:iVP4YcDBq+n&#47;5fb23BhYFvIMq&#47;leAFZyRl6bYmGDlGc=
<span class="term-fg32">+github.com&#47;minio&#47;sha256-simd v1.0.0 h1:v1ta+49hkWZyvaKwrQB8elexRqm6Y0aMLjCNsrYxo6g=</span>
<span class="term-fg32">+github.com&#47;minio&#47;sha256-simd v1.0.0&#47;go.mod h1:OuYzVNI5vcoYIAmbIvHPl3N3jUzVedXbKy5RFepssQM=</span>
 github.com&#47;mitchellh&#47;go-homedir v1.1.0&#47;go.mod h1:SfyaCUpYCn1Vlf4IUYiD9fPX4A5wJrkLzIz1N1q0pr0=
 github.com&#47;mitchellh&#47;mapstructure v1.1.2&#47;go.mod h1:FVVH3fgwuzCH5S8UJGiWEs2h04kUh9fWfEaFds41c1Y=
<span class="term-fg31">-github.com&#47;mitchellh&#47;mapstructure v1.4.1 h1:CpVNEelQCZBooIPDn+AR3NpivK&#47;TIKU8bDxdASFVQag=</span>
 github.com&#47;mitchellh&#47;mapstructure v1.4.1&#47;go.mod h1:bFUtVrKA4DC2yAKiSyO&#47;QUcy7e+RRV2QTWOzhPopBRo=
<span class="term-fg32">+github.com&#47;mitchellh&#47;mapstructure v1.5.0 h1:jeMsZIYE&#47;09sWLaz43PL7Gy6RuMjD2eJVyuac5Z2hdY=</span>
<span class="term-fg32">+github.com&#47;mitchellh&#47;mapstructure v1.5.0&#47;go.mod h1:bFUtVrKA4DC2yAKiSyO&#47;QUcy7e+RRV2QTWOzhPopBRo=</span>
 github.com&#47;mitchellh&#47;pointerstructure v1.2.0 h1:O+i9nHnXS3l&#47;9Wu7r4NrEdwA2VFTicjUEN1uBnDo34A=
 github.com&#47;mitchellh&#47;pointerstructure v1.2.0&#47;go.mod h1:BRAsLI5zgXmw97Lf6s25bs8ohIXc3tViBH44KcwB2g4=
 github.com&#47;mmcloughlin&#47;addchain v0.4.0 h1:SobOdjm2xLj1KkXN5&#47;n0xTIWyZA2+s99UCY1iPfkHRY=
<span class="term-fg36">@@ -379,6 +399,10 @@</span> github.com&#47;prometheus&#47;procfs v0.9.0 h1:wzCHvIvM5SxWqYvwgVL7yJY8Lz3PKn49KQtpgMYJfhI=
 github.com&#47;prometheus&#47;procfs v0.9.0&#47;go.mod h1:+pB4zwohETzFnmlpe6yd2lSc+0&#47;46IYZRB&#47;chUwxUZY=
 github.com&#47;protolambda&#47;bls12-381-util v0.0.0-20220416220906-d8552aa452c7 h1:cZC+usqsYgHtlBaGulVnZ1hfKAi8iWtujBnRLQE698c=
 github.com&#47;protolambda&#47;bls12-381-util v0.0.0-20220416220906-d8552aa452c7&#47;go.mod h1:IToEjHuttnUzwZI5KBSM&#47;LOOW3qLbbrHOEfp3SbECGY=
<span class="term-fg32">+github.com&#47;prysmaticlabs&#47;go-bitfield v0.0.0-20210809151128-385d8c5e3fb7 h1:0tVE4tdWQK9ZpYygoV7+vS6QkDvQVySboMVEIxBJmXw=</span>
<span class="term-fg32">+github.com&#47;prysmaticlabs&#47;go-bitfield v0.0.0-20210809151128-385d8c5e3fb7&#47;go.mod h1:wmuf&#47;mdK4VMD+jA9ThwcUKjg3a2XWM9cVfFYjDyY4j4=</span>
<span class="term-fg32">+github.com&#47;r3labs&#47;sse v0.0.0-20210224172625-26fe804710bc h1:zAsgcP8MhzAbhMnB1QQ2O7ZhWYVGYSR2iVcjzQuPV+o=</span>
<span class="term-fg32">+github.com&#47;r3labs&#47;sse v0.0.0-20210224172625-26fe804710bc&#47;go.mod h1:S8xSOnV3CgpNrWd0GQ&#47;OoQfMtlg2uPRSuTzcSGrzwK8=</span>
 github.com&#47;rogpeppe&#47;go-internal v1.6.1&#47;go.mod h1:xXDCJY+GAPziupqXw64V24skbSoqbTEfhy4qGm1nDQc=
 github.com&#47;rogpeppe&#47;go-internal v1.8.1&#47;go.mod h1:JeRgkft04UBgHMgCIwADu4Pn6Mtm5d4nPKWu0nJ5d+o=
 github.com&#47;rogpeppe&#47;go-internal v1.9.0 h1:73kH8U+JUqXU8lRuOHeVHaa&#47;SZPifC7BkcraZVejAe8=
<span class="term-fg36">@@ -406,17 +430,13 @@</span> github.com&#47;spf13&#47;viper v1.3.2&#47;go.mod h1:ZiWeW+zYFKm7srdB9IoDzzZXaJaI5eL9QjNiN&#47;DMA2s=
 github.com&#47;status-im&#47;keycard-go v0.2.0 h1:QDLFswOQu1r5jsycloeQh3bVU8n&#47;NatHHaZobtDnDzA=
 github.com&#47;status-im&#47;keycard-go v0.2.0&#47;go.mod h1:wlp8ZLbsmrF6g6WjugPAx+IzoLrkdf9+mHxBEeo3Hbg=
 github.com&#47;stretchr&#47;objx v0.1.0&#47;go.mod h1:HFkY916IF+rwdDfMAkV7OtwuqBVzrE8GR6GFx+wExME=
<span class="term-fg31">-github.com&#47;stretchr&#47;objx v0.4.0&#47;go.mod h1:YvHI0jy2hoMjB+UWwv71VJQ9isScKT&#47;TqJzVSSt89Yw=</span>
<span class="term-fg31">-github.com&#47;stretchr&#47;objx v0.5.0&#47;go.mod h1:Yh+to48EsGEfYuaHDzXPcE3xhTkx73EhmCGUpEOglKo=</span>
 github.com&#47;stretchr&#47;testify v1.2.2&#47;go.mod h1:a8OnRcib4nhh0OaRAV+Yts87kKdq0PP7pXfy6kDkUVs=
 github.com&#47;stretchr&#47;testify v1.3.0&#47;go.mod h1:M5WIy9Dh21IEIfnGCwXGc5bZfKNJtfHm1UVUgZn+9EI=
 github.com&#47;stretchr&#47;testify v1.4.0&#47;go.mod h1:j7eGeouHqKxXV5pUuKE4zz7dFj8WfuZ+81PSLYec5m4=
 github.com&#47;stretchr&#47;testify v1.5.1&#47;go.mod h1:5W2xD1RspED5o8YsWQXVCued0rvSQ+mT+I5cxcmMvtA=
 github.com&#47;stretchr&#47;testify v1.7.0&#47;go.mod h1:6Fq8oRcR53rry900zMqJjRRixrwX3KX962&#47;h&#47;Wwjteg=
<span class="term-fg31">-github.com&#47;stretchr&#47;testify v1.7.1&#47;go.mod h1:6Fq8oRcR53rry900zMqJjRRixrwX3KX962&#47;h&#47;Wwjteg=</span>
<span class="term-fg31">-github.com&#47;stretchr&#47;testify v1.8.0&#47;go.mod h1:yNjHg4UonilssWZ8iaSj1OCr&#47;vHnekPRkoO+kdMU+MU=</span>
<span class="term-fg31">-github.com&#47;stretchr&#47;testify v1.8.1 h1:w7B6lhMri9wdJUVmEZPGGhZzrYTPvgJArz7wNPgYKsk=</span>
<span class="term-fg31">-github.com&#47;stretchr&#47;testify v1.8.1&#47;go.mod h1:w2LPCIKwWwSfY2zedu0+kehJoqGctiVI29o6fzry7u4=</span>
<span class="term-fg32">+github.com&#47;stretchr&#47;testify v1.8.4 h1:CcVxjf3Q8PM0mHUKJCdn+eZZtm5yQwehR5yeSVQQcUk=</span>
<span class="term-fg32">+github.com&#47;stretchr&#47;testify v1.8.4&#47;go.mod h1:sz&#47;lmYIOXD&#47;1dqDmKjjqLyZ2RngseejIcXlSw2iwfAo=</span>
 github.com&#47;supranational&#47;blst v0.3.11-0.20230406105308-e9dfc5ee724b h1:u49mjRnygnB34h8OKbnNJFVUtWSKIKb1KukdV8bILUM=
 github.com&#47;supranational&#47;blst v0.3.11-0.20230406105308-e9dfc5ee724b&#47;go.mod h1:jZJtfjgudtNl4en1tzwPIV3KjUnQUvG3&#47;j+w+fVonLw=
 github.com&#47;syndtr&#47;goleveldb v1.0.1-0.20210819022825-2ae1ddf74ef7 h1:epCh84lMvA70Z7CTTCmYQn2CKbY8j86K7&#47;FAIr141uY=
<span class="term-fg36">@@ -425,12 +445,14 @@</span> github.com&#47;tklauser&#47;go-sysconf v0.3.5 h1:uu3Xl4nkLzQfXNsWn15rPc&#47;HQCJKObbt1dKJeWp3vU4=
 github.com&#47;tklauser&#47;go-sysconf v0.3.5&#47;go.mod h1:MkWzOF4RMCshBAMXuhXJs64Rte09mITnppBXY&#47;rYEFI=
 github.com&#47;tklauser&#47;numcpus v0.2.2 h1:oyhllyrScuYI6g+h&#47;zUvNXNp1wy7x8qQy3t&#47;piefldA=
 github.com&#47;tklauser&#47;numcpus v0.2.2&#47;go.mod h1:x3qojaO3uyYt0i56EW&#47;VUYs7uBvdl2fkfZFu0T9wgjM=
<span class="term-fg32">+github.com&#47;trailofbits&#47;go-fuzz-utils v0.0.0-20210901195358-9657fcfd256c h1:4WU+p200eLYtBsx3M5CKXvkjVdf5SC3W9nMg37y0TFI=</span>
 github.com&#47;tyler-smith&#47;go-bip39 v1.1.0 h1:5eUemwrMargf3BSLRRCalXT93Ns6pQJIjYQN2nyfOP8=
 github.com&#47;tyler-smith&#47;go-bip39 v1.1.0&#47;go.mod h1:gUYDtqQw1JS3ZJ8UWVcGTGqqr6YIN3CWg+kkNaLt55U=
 github.com&#47;ugorji&#47;go v1.1.4&#47;go.mod h1:uQMGLiO92mf5W77hV&#47;PUCpI3pbzQx3CRekS0kk+RGrc=
 github.com&#47;ugorji&#47;go v1.1.7&#47;go.mod h1:kZn38zHttfInRq0xu&#47;PH0az30d+z6vm202qpg1oXVMw=
 github.com&#47;ugorji&#47;go&#47;codec v0.0.0-20181204163529-d75b2dcb6bc8&#47;go.mod h1:VFNgLljTbGfSG7qAOspJ7OScBnGdDN&#47;yBr0sguwnwf0=
 github.com&#47;ugorji&#47;go&#47;codec v1.1.7&#47;go.mod h1:Ax+UKWsSmolVDwsd+7N3ZtXu+yMGCf907BLYF3GoBXY=
<span class="term-fg32">+github.com&#47;umbracle&#47;gohashtree v0.0.2-alpha.0.20230207094856-5b775a815c10 h1:CQh33pStIp&#47;E30b7TxDlXfM0145bn2e8boI30IxAhTg=</span>
 github.com&#47;urfave&#47;cli&#47;v2 v2.3.0&#47;go.mod h1:LJmUH05zAU44vOAcrfzZQKsZbVcdbOG8rtL3&#47;XcUArI=
 github.com&#47;urfave&#47;cli&#47;v2 v2.17.2-0.20221006022127-8f469abc00aa h1:5SqCsI&#47;2Qya2bCzK15ozrqo2sZxkh0FHynJZOTVoV6Q=
 github.com&#47;urfave&#47;cli&#47;v2 v2.17.2-0.20221006022127-8f469abc00aa&#47;go.mod h1:1CNUng3PtjQMtRzJO4FMXBQvkGtuYRxxiR9xMa7jMwI=
<span class="term-fg36">@@ -464,8 +486,8 @@</span> golang.org&#47;x&#47;crypto v0.0.0-20200820211705-5c72a883971a&#47;go.mod h1:LzIPMQfyMNhhGPhUkYOs5KpL4U8rLKemX1yGLhDgUto=
 golang.org&#47;x&#47;crypto v0.0.0-20201221181555-eec23a3978ad&#47;go.mod h1:jdWPYTVW3xRLrWPugEBEK3UY2ZEsg3UU495nc5E+M+I=
 golang.org&#47;x&#47;crypto v0.0.0-20210322153248-0c34fe9e7dc2&#47;go.mod h1:T9bdIzuCu7OtxOm1hfPfRQxPLYneinmdGuTeoZ9dtd4=
 golang.org&#47;x&#47;crypto v0.0.0-20210921155107-089bfa567519&#47;go.mod h1:GvvjBRRGRdwPK5ydBHafDWAxML&#47;pGHZbMvKqRZ5+Abc=
<span class="term-fg31">-golang.org&#47;x&#47;crypto v0.1.0 h1:MDRAIl0xIo9Io2xV565hzXHw3zVseKrJKodhohM5CjU=</span>
<span class="term-fg31">-golang.org&#47;x&#47;crypto v0.1.0&#47;go.mod h1:RecgLatLF4+eUMCP1PoPZQb+cVrJcOPbHkTkbkB9sbw=</span>
<span class="term-fg32">+golang.org&#47;x&#47;crypto v0.8.0 h1:pd9TJtTueMTVQXzk8E2XESSMQDj&#47;U7OUu0PqJqPXQjQ=</span>
<span class="term-fg32">+golang.org&#47;x&#47;crypto v0.8.0&#47;go.mod h1:mRqEX+O9&#47;h5TFCrQhkgjo2yKi0yYA+9ecGkdQoHrywE=</span>
 golang.org&#47;x&#47;exp v0.0.0-20190121172915-509febef88a4&#47;go.mod h1:CJ0aWSM057203Lf6IL+f9T1iT9GByDxfZKAQTCR3kQA=
 golang.org&#47;x&#47;exp v0.0.0-20230206171751-46f607a40771 h1:xP7rWLUr1e1n2xkK5YB4LI0hPEy3LJC6Wk+D4pGlOJg=
 golang.org&#47;x&#47;exp v0.0.0-20230206171751-46f607a40771&#47;go.mod h1:CxIveKay+FTh1D0yPZemJVgC&#47;95VzuuOLq5Qi4xnoYc=
<span class="term-fg36">@@ -490,6 +512,7 @@</span> golang.org&#47;x&#47;net v0.0.0-20190404232315-eb5bcb51f2a3&#47;go.mod h1:t9HGtf8HONx5eT2rtn7q6eTqICYqUVnKs3thJo3Qplg=
 golang.org&#47;x&#47;net v0.0.0-20190503192946-f4e77d36d62c&#47;go.mod h1:t9HGtf8HONx5eT2rtn7q6eTqICYqUVnKs3thJo3Qplg=
 golang.org&#47;x&#47;net v0.0.0-20190620200207-3b0461eec859&#47;go.mod h1:z5CRVTTTmAJ677TzLLGU+0bjPO0LkuOLi4&#47;5GtJWs&#47;s=
 golang.org&#47;x&#47;net v0.0.0-20190827160401-ba9fcec4b297&#47;go.mod h1:z5CRVTTTmAJ677TzLLGU+0bjPO0LkuOLi4&#47;5GtJWs&#47;s=
<span class="term-fg32">+golang.org&#47;x&#47;net v0.0.0-20191116160921-f9c825593386&#47;go.mod h1:z5CRVTTTmAJ677TzLLGU+0bjPO0LkuOLi4&#47;5GtJWs&#47;s=</span>
 golang.org&#47;x&#47;net v0.0.0-20191209160850-c0dbc17a3553&#47;go.mod h1:z5CRVTTTmAJ677TzLLGU+0bjPO0LkuOLi4&#47;5GtJWs&#47;s=
 golang.org&#47;x&#47;net v0.0.0-20200226121028-0de0cce0169b&#47;go.mod h1:z5CRVTTTmAJ677TzLLGU+0bjPO0LkuOLi4&#47;5GtJWs&#47;s=
 golang.org&#47;x&#47;net v0.0.0-20200520004742-59133d7f0dd7&#47;go.mod h1:qpuaurCH72eLCgpAm&#47;N6yyVIVM9cpaDIP3A8BGJEC5A=
<span class="term-fg36">@@ -504,8 +527,8 @@</span> golang.org&#47;x&#47;net v0.0.0-20210405180319-a5a99cb37ef4&#47;go.mod h1:p54w0d4576C0XHj96bSt6lcn1PtDYWL6XObtHCRCNQM=
 golang.org&#47;x&#47;net v0.0.0-20210610132358-84b48f89b13b&#47;go.mod h1:9nx3DQGgdP8bBQD5qxJ1jj9UTztislL4KSBs9R2vV5Y=
 golang.org&#47;x&#47;net v0.0.0-20210805182204-aaa1db679c0d&#47;go.mod h1:9nx3DQGgdP8bBQD5qxJ1jj9UTztislL4KSBs9R2vV5Y=
 golang.org&#47;x&#47;net v0.0.0-20211008194852-3b03d305991f&#47;go.mod h1:9nx3DQGgdP8bBQD5qxJ1jj9UTztislL4KSBs9R2vV5Y=
<span class="term-fg31">-golang.org&#47;x&#47;net v0.8.0 h1:Zrh2ngAOFYneWTAIAPethzeaQLuHwhuBkuV6ZiRnUaQ=</span>
<span class="term-fg31">-golang.org&#47;x&#47;net v0.8.0&#47;go.mod h1:QVkue5JL9kW&#47;&#47;ek3r6jTKnTFis1tRmNAW2P1shuFdJc=</span>
<span class="term-fg32">+golang.org&#47;x&#47;net v0.9.0 h1:aWJ&#47;m6xSmxWBx+V0XRHTlrYrPG56jKsLdTFmsSsCzOM=</span>
<span class="term-fg32">+golang.org&#47;x&#47;net v0.9.0&#47;go.mod h1:d48xBJpPfHeWQsugry2m+kC02ZBRGRgulfHnEXEuWns=</span>
 golang.org&#47;x&#47;oauth2 v0.0.0-20180821212333-d2e6202438be&#47;go.mod h1:N&#47;0e6XlmueqKjAGxoOufVs8QHGRruUQn6yWY3a++T0U=
 golang.org&#47;x&#47;sync v0.0.0-20180314180146-1d60e4601c6f&#47;go.mod h1:RxMgew5VJxzue5&#47;jJTE5uejpjVlOe&#47;izrB70Jof72aM=
 golang.org&#47;x&#47;sync v0.0.0-20181108010431-42b317875d0f&#47;go.mod h1:RxMgew5VJxzue5&#47;jJTE5uejpjVlOe&#47;izrB70Jof72aM=
<span class="term-fg36">@@ -551,10 +574,12 @@</span> golang.org&#47;x&#47;sys v0.0.0-20210927094055-39ccf1dd6fa6&#47;go.mod h1:oPkhp1MJrh7nUepCBck5+mAzfO9JrbApNNgaTdGDITg=
 golang.org&#47;x&#47;sys v0.0.0-20211007075335-d3039528d8ac&#47;go.mod h1:oPkhp1MJrh7nUepCBck5+mAzfO9JrbApNNgaTdGDITg=
 golang.org&#47;x&#47;sys v0.0.0-20211020174200-9d6173849985&#47;go.mod h1:oPkhp1MJrh7nUepCBck5+mAzfO9JrbApNNgaTdGDITg=
 golang.org&#47;x&#47;sys v0.0.0-20220209214540-3681064d5158&#47;go.mod h1:oPkhp1MJrh7nUepCBck5+mAzfO9JrbApNNgaTdGDITg=
<span class="term-fg32">+golang.org&#47;x&#47;sys v0.0.0-20220704084225-05e143d24a9e&#47;go.mod h1:oPkhp1MJrh7nUepCBck5+mAzfO9JrbApNNgaTdGDITg=</span>
 golang.org&#47;x&#47;sys v0.0.0-20220811171246-fbc7d0a398ab&#47;go.mod h1:oPkhp1MJrh7nUepCBck5+mAzfO9JrbApNNgaTdGDITg=
 golang.org&#47;x&#47;sys v0.0.0-20220908164124-27713097b956&#47;go.mod h1:oPkhp1MJrh7nUepCBck5+mAzfO9JrbApNNgaTdGDITg=
<span class="term-fg31">-golang.org&#47;x&#47;sys v0.7.0 h1:3jlCCIQZPdOYu1h8BkNvLz8Kgwtae2cagcG&#47;VamtZRU=</span>
<span class="term-fg31">-golang.org&#47;x&#47;sys v0.7.0&#47;go.mod h1:oPkhp1MJrh7nUepCBck5+mAzfO9JrbApNNgaTdGDITg=</span>
<span class="term-fg32">+golang.org&#47;x&#47;sys v0.6.0&#47;go.mod h1:oPkhp1MJrh7nUepCBck5+mAzfO9JrbApNNgaTdGDITg=</span>
<span class="term-fg32">+golang.org&#47;x&#47;sys v0.8.0 h1:EBmGv8NaZBZTWvrbjNoL6HVt+IVy3QDQpJs7VRIw3tU=</span>
<span class="term-fg32">+golang.org&#47;x&#47;sys v0.8.0&#47;go.mod h1:oPkhp1MJrh7nUepCBck5+mAzfO9JrbApNNgaTdGDITg=</span>
 golang.org&#47;x&#47;term v0.0.0-20201117132131-f5c789dd3221&#47;go.mod h1:Nr5EML6q2oocZ2LXRh80K7BxOlk5&#47;8JxuGnuhpl+muw=
 golang.org&#47;x&#47;term v0.0.0-20201126162022-7de9c90e9dd1&#47;go.mod h1:bj7SfCRtBDWHUb9snDiAeCFNEtKQo2Wmx5Cou7ajbmo=
 golang.org&#47;x&#47;text v0.3.0&#47;go.mod h1:NqM8EUOU14njkJ3fqMW+pc6Ldnwhi&#47;IjpwHt7yyuwOQ=
<span class="term-fg36">@@ -564,8 +589,8 @@</span> golang.org&#47;x&#47;text v0.3.4&#47;go.mod h1:5Zoc&#47;QRtKVWzQhOtBMvqHzDpF6irO9z98xDceosuGiQ=
 golang.org&#47;x&#47;text v0.3.5&#47;go.mod h1:5Zoc&#47;QRtKVWzQhOtBMvqHzDpF6irO9z98xDceosuGiQ=
 golang.org&#47;x&#47;text v0.3.6&#47;go.mod h1:5Zoc&#47;QRtKVWzQhOtBMvqHzDpF6irO9z98xDceosuGiQ=
 golang.org&#47;x&#47;text v0.3.7&#47;go.mod h1:u+2+&#47;6zg+i71rQMx5EYifcz6MCKuco9NR6JIITiCfzQ=
<span class="term-fg31">-golang.org&#47;x&#47;text v0.8.0 h1:57P1ETyNKtuIjB4SRd15iJxuhj8Gc416Y78H3qgMh68=</span>
<span class="term-fg31">-golang.org&#47;x&#47;text v0.8.0&#47;go.mod h1:e1OnstbJyHTd6l&#47;uOt8jFFHp6TRDWZR&#47;bV3emEE&#47;zU8=</span>
<span class="term-fg32">+golang.org&#47;x&#47;text v0.10.0 h1:UpjohKhiEgNc0CSauXmwYftY1+LlaC75SJwh0SgCX58=</span>
<span class="term-fg32">+golang.org&#47;x&#47;text v0.10.0&#47;go.mod h1:TvPlkZtksWOMsz7fbANvkp4WM8x&#47;WCo&#47;om8BMLbz+aE=</span>
 golang.org&#47;x&#47;time v0.0.0-20201208040808-7e3f01d25324&#47;go.mod h1:tRJNPiyCQ0inRvYxbN9jk5I+vvW&#47;OXSQhTDSoE431IQ=
 golang.org&#47;x&#47;time v0.0.0-20210220033141-f8bda1e9f3ba&#47;go.mod h1:tRJNPiyCQ0inRvYxbN9jk5I+vvW&#47;OXSQhTDSoE431IQ=
 golang.org&#47;x&#47;time v0.0.0-20220922220347-f3bd1da661af h1:Yx9k8YCG3dvF87UAn2tu2HQLf2dt&#47;eR1bXxpLMWeH+Y=
<span class="term-fg36">@@ -590,8 +615,8 @@</span> golang.org&#47;x&#47;xerrors v0.0.0-20190717185122-a985d3407aa7&#47;go.mod h1:I&#47;5z698sn9Ka8TeJc9MKroUUfqBBauWjQqLJ2OPfmY0=
 golang.org&#47;x&#47;xerrors v0.0.0-20191011141410-1b5146add898&#47;go.mod h1:I&#47;5z698sn9Ka8TeJc9MKroUUfqBBauWjQqLJ2OPfmY0=
 golang.org&#47;x&#47;xerrors v0.0.0-20191204190536-9bdfabe68543&#47;go.mod h1:I&#47;5z698sn9Ka8TeJc9MKroUUfqBBauWjQqLJ2OPfmY0=
 golang.org&#47;x&#47;xerrors v0.0.0-20200804184101-5ec99f83aff1&#47;go.mod h1:I&#47;5z698sn9Ka8TeJc9MKroUUfqBBauWjQqLJ2OPfmY0=
<span class="term-fg31">-golang.org&#47;x&#47;xerrors v0.0.0-20220517211312-f3a8303e98df h1:5Pf6pFKu98ODmgnpvkJ3kFUOQGGLIzLIkbzUHp47618=</span>
<span class="term-fg31">-golang.org&#47;x&#47;xerrors v0.0.0-20220517211312-f3a8303e98df&#47;go.mod h1:K8+ghG5WaK9qNqU5K3HdILfMLy1f3aNYFI&#47;wnl100a8=</span>
<span class="term-fg32">+golang.org&#47;x&#47;xerrors v0.0.0-20220907171357-04be3eba64a2 h1:H2TDz8ibqkAF6YGhCdN3jS9O0&#47;s90v0rJh3X&#47;OLHEUk=</span>
<span class="term-fg32">+golang.org&#47;x&#47;xerrors v0.0.0-20220907171357-04be3eba64a2&#47;go.mod h1:K8+ghG5WaK9qNqU5K3HdILfMLy1f3aNYFI&#47;wnl100a8=</span>
 google.golang.org&#47;appengine v1.1.0&#47;go.mod h1:EbEs0AVv82hx2wNQdGPgUI5lhzA&#47;G0D9YwlJXL52JkM=
 google.golang.org&#47;appengine v1.4.0&#47;go.mod h1:xpcJRLb0r&#47;rnEns0DIKYYv+WjYCduHsrkT7&#47;EB5XEv4=
 google.golang.org&#47;genproto v0.0.0-20180518175338-11a468237815&#47;go.mod h1:JiN7NxoALGmiZfu7CAH4rXhgtRTLTxftemlI0sWmxmc=
<span class="term-fg36">@@ -618,6 +643,8 @@</span> google.golang.org&#47;protobuf v1.26.0-rc.1&#47;go.mod h1:jlhhOSvTdKEhbULTjvd4ARK9grFBp09yW+WbY&#47;TyQbw=
 google.golang.org&#47;protobuf v1.26.0&#47;go.mod h1:9q0QmTI4eRPtz6boOQmLYwt+qCgq0jsYwAQnmE0givc=
 google.golang.org&#47;protobuf v1.28.1 h1:d0NfwRgPtno5B1Wa6L2DAG+KivqkdutMf1UhdNx175w=
 google.golang.org&#47;protobuf v1.28.1&#47;go.mod h1:HV8QOd&#47;L58Z+nl8r43ehVNZIU&#47;HEI6OcFqwMG9pJV4I=
<span class="term-fg32">+gopkg.in&#47;cenkalti&#47;backoff.v1 v1.1.0 h1:Arh75ttbsvlpVA7WtVpH4u9h6Zl46xuptxqLxPiSo4Y=</span>
<span class="term-fg32">+gopkg.in&#47;cenkalti&#47;backoff.v1 v1.1.0&#47;go.mod h1:J6Vskwqd+OMVJl8C33mmtxTBs2gyzfv7UDAkHu8BrjI=</span>
 gopkg.in&#47;check.v1 v0.0.0-20161208181325-20d25e280405&#47;go.mod h1:Co6ibVJAznAaIkqp8huTwlJQCZ016jof&#47;cbN4VW5Yz0=
 gopkg.in&#47;check.v1 v1.0.0-20180628173108-788fd7840127&#47;go.mod h1:Co6ibVJAznAaIkqp8huTwlJQCZ016jof&#47;cbN4VW5Yz0=
 gopkg.in&#47;check.v1 v1.0.0-20190902080502-41f04d3bba15&#47;go.mod h1:Co6ibVJAznAaIkqp8huTwlJQCZ016jof&#47;cbN4VW5Yz0=
<span class="term-fg36">@@ -648,6 +675,7 @@</span> gopkg.in&#47;yaml.v3 v3.0.0-20200313102051-9f266ea9e77c&#47;go.mod h1:K4uyk7z7BCEPqu6E+C64Yfv1cQ7kz7rIZviUmN+EgEM=
 gopkg.in&#47;yaml.v3 v3.0.0-20210107192922-496545a6307b&#47;go.mod h1:K4uyk7z7BCEPqu6E+C64Yfv1cQ7kz7rIZviUmN+EgEM=
 gopkg.in&#47;yaml.v3 v3.0.1 h1:fxVm&#47;GzAzEWqLHuvctI91KS9hhNmmWOoWu0XTYJS7CA=
 gopkg.in&#47;yaml.v3 v3.0.1&#47;go.mod h1:K4uyk7z7BCEPqu6E+C64Yfv1cQ7kz7rIZviUmN+EgEM=
<span class="term-fg32">+gotest.tools v2.2.0+incompatible h1:VsBPFP1AI068pPrMxtb&#47;S8Zkgf9xEmTLJjfM+P5UIEo=</span>
 honnef.co&#47;go&#47;tools v0.0.0-20190102054323-c2f93a96b099&#47;go.mod h1:rf3lG4BRIbNafJWhAfAdb&#47;ePZxsR&#47;4RtNHQocxwk9r4=
 honnef.co&#47;go&#47;tools v0.0.0-20190523083050-ea95bdfd59fc&#47;go.mod h1:rf3lG4BRIbNafJWhAfAdb&#47;ePZxsR&#47;4RtNHQocxwk9r4=
 rsc.io&#47;tmplfunc v0.0.3 h1:53XFQh69AfOa8Tw0Jm7t+GV7KZhOi6jzsCzTtKbMvzU=</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-090fc9c1ea76b74694caf905" role="button"
                   aria-expanded="false" aria-controls="id-090fc9c1ea76b74694caf905">
                    <code>suave/docs/conf_comp_request_flow.png</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/suave/docs/conf_comp_request_flow.png" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <span class="text-secondary">(binary file)</span>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-090fc9c1ea76b74694caf905"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;suave&#47;docs&#47;conf_comp_request_flow.png flashbots&#47;suave-geth&#47;suave&#47;docs&#47;conf_comp_request_flow.png</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..8792262d58099dffe416396da2a9fd26ca3b030c</span>
<span class="term-fg1">Binary files &#47;dev&#47;null and flashbots&#47;suave-geth&#47;suave&#47;docs&#47;conf_comp_request_flow.png differ</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-b3e5f0b24e9cc19d9dd2562c" role="button"
                   aria-expanded="false" aria-controls="id-b3e5f0b24e9cc19d9dd2562c">
                    <code>suave/docs/execution_node_architecture.png</code>
                </a>
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/flashbots/suave-geth/blob/5df7bb8508536375ffb0292a804363ec1188ed08/suave/docs/execution_node_architecture.png" target="_blank">flashbots/suave-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <span class="text-secondary">(binary file)</span>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-b3e5f0b24e9cc19d9dd2562c"><span class="term-fg1">diff --git ethereum&#47;go-ethereum&#47;suave&#47;docs&#47;execution_node_architecture.png flashbots&#47;suave-geth&#47;suave&#47;docs&#47;execution_node_architecture.png</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..962c86c70eb53c8bde8b9fa57e2fa756b531a26e</span>
<span class="term-fg1">Binary files &#47;dev&#47;null and flashbots&#47;suave-geth&#47;suave&#47;docs&#47;execution_node_architecture.png differ</span></div>
    </div>

            
        </div>
        <div>
            
        </div>
    </div>
</div>

                    </div>
                
            </div>
        </main>
    </div>

    <footer class="col-xl-10 col-xxl-8 mx-auto px-3 pt-5 my-5 text-muted border-top">
        <p>created with <a href="https://github.com/protolambda/forkdiff">forkdiff</a> &hellip; <a href="https://github.com/sambarnes/suave-geth-diff">github</a></p>

    </footer>

    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js" integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.min.js" integrity="sha384-mQ93GR66B00ZXjt0YO5KlohRA5SY2XofN4zfuZxLkoj1gXtW8ANNCe9d5Y3eG5eD" crossorigin="anonymous"></script>
    <script type="text/javascript">
        const storedTheme = localStorage.getItem('theme')

        // Get the preferred theme from the user's OS
        const getPreferredTheme = () => {
            if (storedTheme) {
                return storedTheme
            }

            return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light'
        }

        // Set the bootstrap theme
        const setTheme = function (theme) {
            document.documentElement.setAttribute('data-bs-theme', theme)
            if (theme === 'dark') {
                document.getElementById('dark-mode-toggle').setAttribute('checked', true)
                document.getElementById('dark-mode-icon').classList.replace('bi-brightness-high-fill', 'bi-brightness-low')
            } else {
                document.getElementById('dark-mode-toggle').setAttribute('checked', false)
                document.getElementById('dark-mode-icon').classList.replace('bi-brightness-low', 'bi-brightness-high-fill')
            }
        }

        // Returns true if the current theme is dark
        const isDark = () => {
            return document.documentElement.getAttribute('data-bs-theme') === 'dark'
        }

        // Toggles dark mode
        const toggleDarkMode = () => {
            const newTheme = isDark() ? 'light' : 'dark'
            setTheme(newTheme)
            localStorage.setItem('theme', newTheme)
        }

        // Set the preferred theme on page load
        window.onload = () => {
            // Set preferred theme
            setTheme(getPreferredTheme());
            // Initialize tooltips
            const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
            const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
        }

        // Toggle dark mode when the toggle button is clicked
        addEventListener("click", (event) => {
            if (event.target.id === 'dark-mode-toggle') {
                toggleDarkMode();
                // De-focus the toggle
                document.activeElement.blur()
            }
        });
    </script>
</body>
</html>
